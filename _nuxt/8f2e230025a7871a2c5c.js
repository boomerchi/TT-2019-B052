(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{401:function(t,e,n){(function(e){!function(){var n;function o(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function r(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:o(a)}}function h(a){for(var b,t=[];!(b=a.next()).done;)t.push(b.value);return t}var l,c="function"==typeof Object.create?Object.create:function(a){function b(){}return b.prototype=a,new b};if("function"==typeof Object.setPrototypeOf)l=Object.setPrototypeOf;else{var f;t:{var d={};try{d.__proto__={a:!0},f=d.a;break t}catch(t){}f=!1}l=f?function(a,b){if(a.__proto__=b,a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var y=l;function m(a,b){if(a.prototype=c(b.prototype),a.prototype.constructor=a,y)y(a,b);else for(var t in b)if("prototype"!=t)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,t);e&&Object.defineProperty(a,t,e)}else a[t]=b[t];a.LA=b.prototype}var v="undefined"!=typeof window&&window===self?self:void 0!==e&&null!=e?e:self,x="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,t){a!=Array.prototype&&a!=Object.prototype&&(a[b]=t.value)};!function(a){if(a){for(var b=v,t=["Array","prototype","fill"],e=0;e<t.length-1;e++){var n=t[e];n in b||(b[n]={}),b=b[n]}(a=a(e=b[t=t[t.length-1]]))!=e&&null!=a&&x(b,t,{writable:!0,value:a})}}((function(a){return a||function(a,t,e){var b=this.length||0;for(0>t&&(t=Math.max(0,b+t)),(null==e||e>b)&&(e=b),0>(e=Number(e))&&(e=Math.max(0,b+e)),t=Number(t||0);t<e;t++)this[t]=a;return this}}));var w="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||"object"==typeof window&&window.window===window&&window||{};function k(){}function M(a,b){var t=-1;return function(){var e=this,n=arguments;-1!==t&&w.clearTimeout(t),t=S((function(){t=-1,a.apply(e,n)}),b)}}function S(a,b){return w.setTimeout(a,b)}function P(a){return w.document.createElement(a)}function N(a){throw Error(a)}function C(a,b){a="The object is frozen, so its properties cannot be set: "+a.toString(),void 0!==b&&(a+="  to value: "+b),N(a)}function T(a,b,t,e){t=null===t?"*":"string"==typeof t?t:"function"==typeof t&&"string"==typeof t.className?t.className:"",void 0!==e&&(t+="."+e),N(t+" is not in the range "+b+": "+a)}function L(a){w.console&&w.console.log(a)}function A(){w.console&&w.console.log("Warning: List/Map/Set constructors no longer take an argument that enforces type.Instead they take an optional collection of Values to add to the collection. See 2.0 changelog for details.")}function j(a){return"object"==typeof a&&null!==a}function D(a){return Array.isArray(a)||w.NodeList&&a instanceof w.NodeList||w.HTMLCollection&&a instanceof w.HTMLCollection}function F(a){return Array.prototype.slice.call(a)}function O(a,b,t){Array.isArray(a)?b>=a.length?a.push(t):a.splice(b,0,t):N("Cannot insert an object into an HTMLCollection or NodeList: "+t+" at "+b)}function B(a,b){Array.isArray(a)?b>=a.length?a.pop():a.splice(b,1):N("Cannot remove an object from an HTMLCollection or NodeList at "+b)}function I(){var a=$.pop();return void 0===a?[]:a}function R(a){a.length=0,$.push(a)}function E(a){if("function"==typeof a){if(a.className)return a.className;if(a.name)return a.name;var b=a.toString();if(""!==(b=b.substring(9,b.indexOf("(")).trim()))return a._className=b}else if(j(a)&&a.constructor)return E(a.constructor);return typeof a}function z(a){var b=a;return j(a)&&(a.text?b=a.text:a.name?b=a.name:void 0!==a.key?b=a.key:void 0!==a.id?b=a.id:a.constructor===Object&&(a.Text?b=a.Text:a.Name?b=a.Name:void 0!==a.Key?b=a.Key:void 0!==a.Id?b=a.Id:void 0!==a.ID&&(b=a.ID))),void 0===b?"undefined":null===b?"null":b.toString()}function V(a,b){if(a.hasOwnProperty(b))return!0;for(a=Object.getPrototypeOf(a);a&&a!==Function;){if(a.hasOwnProperty(b))return!0;var t=a.FA;if(t&&t[b])return!0;a=Object.getPrototypeOf(a)}return!1}function Y(a,b,t){Object.defineProperty(ze.prototype,a,{get:b,set:t})}function G(){var a=Q;if(0===a.length)for(var b=w.document.getElementsByTagName("canvas"),t=b.length,e=0;e<t;e++){var n=b[e];n.parentElement&&n.parentElement.B&&a.push(n.parentElement.B)}return a}function X(a){for(var b=[],t=0;256>t;t++)b["0123456789abcdef".charAt(t>>4)+"0123456789abcdef".charAt(15&t)]=String.fromCharCode(t);a.length%2&&(a="0"+a),t=[];for(var e=0,n=0;n<a.length;n+=2)t[e++]=b[a.substr(n,2)];for(a=""===(a=t.join(""))?"0":a,b=[],t=0;256>t;t++)b[t]=t;for(t=e=0;256>t;t++)e=(e+b[t]+119)%256,n=b[t],b[t]=b[e],b[e]=n;e=t=0;for(var o="",g=0;g<a.length;g++)e=(e+b[t=(t+1)%256])%256,n=b[t],b[t]=b[e],b[e]=n,o+=String.fromCharCode(a.charCodeAt(g)^b[(b[t]+b[e])%256]);return o}void 0===w.requestAnimationFrame&&(w.requestAnimationFrame=w.setImmediate);var U=void 0!==w.navigator&&0<w.navigator.userAgent.indexOf("MSIE 9.0"),K=void 0!==w.navigator&&0<w.navigator.userAgent.indexOf("MSIE 10.0"),H=void 0!==w.navigator&&0<w.navigator.userAgent.indexOf("Trident/7"),W=void 0!==w.navigator&&0<w.navigator.userAgent.indexOf("Edge/"),J=void 0!==w.navigator&&void 0!==w.navigator.platform&&0<=w.navigator.platform.toUpperCase().indexOf("MAC"),Z=void 0!==w.navigator&&void 0!==w.navigator.platform&&null!==w.navigator.platform.match(/(iPhone|iPod|iPad)/i),$=[];Object.freeze([]);var Q=[];function _(a,b,t){ft(this),this.l=a,this.Qa=b,this.v=t}function tt(a,b){return null==b||""===b?null:a[b]}function it(){this.Ow=[]}function et(){}function nt(){}k.className="Util",k.Dx="32ab5ff3b26f42dc0ed90f21442913b5",k.adym="gojs.net",k.vfo="28e647fdb263",k.className="Util",_.prototype.toString=function(){return"EnumValue."+this.Qa},v.Object.defineProperties(_.prototype,{classType:{get:function(){return this.l}},name:{get:function(){return this.Qa}},value:{get:function(){return this.v}}}),_.className="EnumValue",it.prototype.toString=function(){return this.Ow.join("")},it.prototype.add=function(a){""!==a&&this.Ow.push(a)},it.className="StringBuilder",et.className="PropertyCollection",nt.prototype.reset=function(){},nt.prototype.next=function(){return!1},nt.prototype.ed=function(){return!1},nt.prototype.first=function(){return null},nt.prototype.any=function(){return!1},nt.prototype.all=function(){return!0},nt.prototype.each=function(){return this},nt.prototype.map=function(){return this},nt.prototype.filter=function(){return this},nt.prototype.Cd=function(){},nt.prototype.toString=function(){return"EmptyIterator"},v.Object.defineProperties(nt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return 0}}}),nt.prototype.first=nt.prototype.first,nt.prototype.hasNext=nt.prototype.ed,nt.prototype.next=nt.prototype.next,nt.prototype.reset=nt.prototype.reset;var ot;function st(a){this.key=-1,this.value=a}function at(a){this.nb=a,this.af=null,a.Fa=null,this.ia=a.Aa,this.Oa=-1}function ht(a){this.nb=a,a.bh=null,this.ia=a.Aa,this.Oa=a.j.length}function lt(a){ft(this),this.s=!1,this.j=[],this.Aa=0,this.bh=this.Fa=null,void 0!==a&&("function"==typeof a||"string"==typeof a?A():this.addAll(a))}function ut(a){this.rg=a,a.Fa=null,this.ia=a.Aa,this.la=null}function ct(a){ft(this),this.s=!1,this.Eb={},this.Cb=0,this.Fa=null,this.Aa=0,this.Ve=this.ba=null,void 0!==a&&("function"==typeof a||"string"==typeof a?A():this.addAll(a))}function ft(a){a.__gohashid=yt++}function pt(a){var b=a.__gohashid;return void 0===b&&(b=yt++,a.__gohashid=b),b}function gt(a){return a.__gohashid}nt.className="EmptyIterator",ot=new nt,st.prototype.reset=function(){this.key=-1},st.prototype.next=function(){return-1===this.key&&(this.key=0,!0)},st.prototype.ed=function(){return this.next()},st.prototype.first=function(){return this.key=0,this.value},st.prototype.any=function(a){return this.key=-1,a(this.value)},st.prototype.all=function(a){return this.key=-1,a(this.value)},st.prototype.each=function(a){return this.key=-1,a(this.value),this},st.prototype.map=function(a){return new st(a(this.value))},st.prototype.filter=function(a){return a(this.value)?new st(this.value):ot},st.prototype.Cd=function(){this.value=null},st.prototype.toString=function(){return"SingletonIterator("+this.value+")"},v.Object.defineProperties(st.prototype,{iterator:{get:function(){return this}},count:{get:function(){return 1}}}),st.prototype.first=st.prototype.first,st.prototype.hasNext=st.prototype.ed,st.prototype.next=st.prototype.next,st.prototype.reset=st.prototype.reset,st.className="SingletonIterator",at.prototype.reset=function(){var a=this.nb;a.Fa=null,this.ia=a.Aa,this.Oa=-1},at.prototype.next=function(){var a=this.nb;if(a.Aa!==this.ia&&0>this.key)return!1;var b=(a=a.j).length,t=++this.Oa,e=this.af;if(null!==e)for(;t<b;){var n=a[t];if(e(n))return this.key=this.Oa=t,this.value=n,!0;t++}else{if(t<b)return this.key=t,this.value=a[t],!0;this.Cd()}return!1},at.prototype.ed=function(){return this.next()},at.prototype.first=function(){var a=this.nb;this.ia=a.Aa,this.Oa=0;var b=(a=a.j).length,t=this.af;if(null!==t){for(var e=0;e<b;){var n=a[e];if(t(n))return this.key=this.Oa=e,this.value=n;e++}return null}return 0<b?(a=a[0],this.key=0,this.value=a):null},at.prototype.any=function(a){var b=this.nb;b.Fa=null,this.Oa=-1;for(var t=(b=b.j).length,e=this.af,n=0;n<t;n++){var o=b[n];if((null===e||e(o))&&a(o))return!0}return!1},at.prototype.all=function(a){var b=this.nb;b.Fa=null,this.Oa=-1;for(var t=(b=b.j).length,e=this.af,n=0;n<t;n++){var o=b[n];if((null===e||e(o))&&!a(o))return!1}return!0},at.prototype.each=function(a){var b=this.nb;b.Fa=null,this.Oa=-1;for(var t=(b=b.j).length,e=this.af,n=0;n<t;n++){var o=b[n];(null===e||e(o))&&a(o)}return this},at.prototype.map=function(a){var b=this.nb;b.Fa=null,this.Oa=-1;for(var t=[],e=(b=b.j).length,n=this.af,o=0;o<e;o++){var g=b[o];(null===n||n(g))&&t.push(a(g))}return(a=new lt).j=t,a.ib(),a.iterator},at.prototype.filter=function(a){var b=this.nb;b.Fa=null,this.Oa=-1;for(var t=[],e=(b=b.j).length,n=this.af,o=0;o<e;o++){var g=b[o];(null===n||n(g))&&a(g)&&t.push(g)}return(a=new lt).j=t,a.ib(),a.iterator},at.prototype.Cd=function(){this.key=-1,this.value=null,this.ia=-1,this.af=null,this.nb.Fa=this},at.prototype.toString=function(){return"ListIterator@"+this.Oa+"/"+this.nb.count},v.Object.defineProperties(at.prototype,{iterator:{get:function(){return this}},predicate:{get:function(){return this.af},set:function(a){this.af=a}},count:{get:function(){var a=this.af;if(null!==a){for(var b=0,t=this.nb.j,e=t.length,n=0;n<e;n++)a(t[n])&&b++;return b}return this.nb.j.length}}}),at.prototype.first=at.prototype.first,at.prototype.hasNext=at.prototype.ed,at.prototype.next=at.prototype.next,at.prototype.reset=at.prototype.reset,at.className="ListIterator",ht.prototype.reset=function(){var a=this.nb;a.bh=null,this.ia=a.Aa,this.Oa=a.j.length},ht.prototype.next=function(){var a=this.nb;if(a.Aa!==this.ia&&0>this.key)return!1;var b=--this.Oa;return 0<=b?(this.key=b,this.value=a.j[b],!0):(this.Cd(),!1)},ht.prototype.ed=function(){return this.next()},ht.prototype.first=function(){var a=this.nb;this.ia=a.Aa;var b=a.j;return this.Oa=a=b.length-1,0<=a?(b=b[a],this.key=a,this.value=b):null},ht.prototype.any=function(a){var b=this.nb;b.bh=null;var t=(b=b.j).length;for(this.Oa=t,--t;0<=t;t--)if(a(b[t]))return!0;return!1},ht.prototype.all=function(a){var b=this.nb;b.bh=null;var t=(b=b.j).length;for(this.Oa=t,--t;0<=t;t--)if(!a(b[t]))return!1;return!0},ht.prototype.each=function(a){var b=this.nb;b.bh=null;var t=(b=b.j).length;for(this.Oa=t,--t;0<=t;t--)a(b[t]);return this},ht.prototype.map=function(a){var b=this.nb;b.bh=null;var t=[],e=(b=b.j).length;for(this.Oa=e,--e;0<=e;e--)t.push(a(b[e]));return(a=new lt).j=t,a.ib(),a.iterator},ht.prototype.filter=function(a){var b=this.nb;b.bh=null;var t=[],e=(b=b.j).length;for(this.Oa=e,--e;0<=e;e--){var n=b[e];a(n)&&t.push(n)}return(a=new lt).j=t,a.ib(),a.iterator},ht.prototype.Cd=function(){this.key=-1,this.value=null,this.ia=-1,this.nb.bh=this},ht.prototype.toString=function(){return"ListIteratorBackwards("+this.Oa+"/"+this.nb.count+")"},v.Object.defineProperties(ht.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.nb.j.length}}}),ht.prototype.first=ht.prototype.first,ht.prototype.hasNext=ht.prototype.ed,ht.prototype.next=ht.prototype.next,ht.prototype.reset=ht.prototype.reset,ht.className="ListIteratorBackwards",(n=lt.prototype).ib=function(){var a=this.Aa;999999999<++a&&(a=0),this.Aa=a},n.freeze=function(){return this.s=!0,this},n.ea=function(){return this.s=!1,this},n.toString=function(){return"List()#"+gt(this)},n.add=function(a){return null===a||(this.s&&C(this,a),this.j.push(a),this.ib()),this},n.push=function(a){this.add(a)},n.addAll=function(a){if(null===a)return this;this.s&&C(this);var b=this.j;if(D(a))for(var t=a.length,e=0;e<t;e++)b.push(a[e]);else for(a=a.iterator;a.next();)b.push(a.value);return this.ib(),this},n.clear=function(){this.s&&C(this),this.j.length=0,this.ib()},n.contains=function(a){return null!==a&&-1!==this.j.indexOf(a)},n.has=function(a){return this.contains(a)},n.indexOf=function(a){return null===a?-1:this.j.indexOf(a)},n.L=function(a){var b=this.j;return(0>a||a>=b.length)&&T(a,"0 <= i < length",lt,"elt:i"),b[a]},n.get=function(a){return this.L(a)},n.hd=function(a,b){var t=this.j;(0>a||a>=t.length)&&T(a,"0 <= i < length",lt,"setElt:i"),this.s&&C(this,a),t[a]=b},n.set=function(a,b){this.hd(a,b)},n.first=function(){var a=this.j;return 0===a.length?null:a[0]},n.Xb=function(){var a=this.j,b=a.length;return 0<b?a[b-1]:null},n.pop=function(){this.s&&C(this);var a=this.j;return 0<a.length?a.pop():null},lt.prototype.any=function(a){for(var b=this.j,t=b.length,e=0;e<t;e++)if(a(b[e]))return!0;return!1},lt.prototype.all=function(a){for(var b=this.j,t=b.length,e=0;e<t;e++)if(!a(b[e]))return!1;return!0},lt.prototype.each=function(a){for(var b=this.j,t=b.length,e=0;e<t;e++)a(b[e]);return this},lt.prototype.map=function(a){for(var b=new lt,t=[],e=this.j,n=e.length,o=0;o<n;o++)t.push(a(e[o]));return b.j=t,b.ib(),b},lt.prototype.filter=function(a){for(var b=new lt,t=[],e=this.j,n=e.length,o=0;o<n;o++){var g=e[o];a(g)&&t.push(g)}return b.j=t,b.ib(),b},(n=lt.prototype).Kb=function(a,b){0>a&&T(a,">= 0",lt,"insertAt:i"),this.s&&C(this,a);var t=this.j;a>=t.length?t.push(b):t.splice(a,0,b),this.ib()},n.remove=function(a){if(null===a)return!1;this.s&&C(this,a);var b=this.j;return-1!==(a=b.indexOf(a))&&(a===b.length-1?b.pop():b.splice(a,1),this.ib(),!0)},n.delete=function(a){return this.remove(a)},n.lb=function(a){var b=this.j;(0>a||a>=b.length)&&T(a,"0 <= i < length",lt,"removeAt:i"),this.s&&C(this,a),a===b.length-1?b.pop():b.splice(a,1),this.ib()},n.removeRange=function(a,b){var t=this.j,e=t.length;if(0>a)a=0;else if(a>=e)return this;if(0>b)return this;if(b>=e&&(b=e-1),a>b)return this;this.s&&C(this);for(var n=a,o=b+1;o<e;)t[n++]=t[o++];return t.length=e-(b-a+1),this.ib(),this},lt.prototype.copy=function(){var a=new lt,b=this.j;return 0<b.length&&(a.j=Array.prototype.slice.call(b)),a},(n=lt.prototype).na=function(){for(var a=this.j,b=this.count,t=Array(b),e=0;e<b;e++)t[e]=a[e];return t},n.mw=function(){for(var a=new ct,b=this.j,t=this.count,e=0;e<t;e++)a.add(b[e]);return a},n.sort=function(a){return this.s&&C(this),this.j.sort(a),this.ib(),this},n.ej=function(a,b,t){var e=this.j,n=e.length;void 0===b&&(b=0),void 0===t&&(t=n),this.s&&C(this);var o=t-b;if(1>=o)return this;if((0>b||b>=n-1)&&T(b,"0 <= from < length",lt,"sortRange:from"),2===o)return 0<a(t=e[b],n=e[b+1])&&(e[b]=n,e[b+1]=t,this.ib()),this;if(0===b)if(t>=n)e.sort(a);else for((b=e.slice(0,t)).sort(a),a=0;a<t;a++)e[a]=b[a];else if(t>=n)for((t=e.slice(b)).sort(a),a=b;a<n;a++)e[a]=t[a-b];else for((n=e.slice(b,t)).sort(a),a=b;a<t;a++)e[a]=n[a-b];return this.ib(),this},n.reverse=function(){return this.s&&C(this),this.j.reverse(),this.ib(),this},v.Object.defineProperties(lt.prototype,{_dataArray:{get:function(){return this.j}},count:{get:function(){return this.j.length}},size:{get:function(){return this.j.length}},length:{get:function(){return this.j.length}},iterator:{get:function(){if(0>=this.j.length)return ot;var a=this.Fa;return null!==a?(a.reset(),a):new at(this)}},iteratorBackwards:{get:function(){if(0>=this.j.length)return ot;var a=this.bh;return null!==a?(a.reset(),a):new ht(this)}}}),lt.prototype.reverse=lt.prototype.reverse,lt.prototype.sortRange=lt.prototype.ej,lt.prototype.sort=lt.prototype.sort,lt.prototype.toSet=lt.prototype.mw,lt.prototype.toArray=lt.prototype.na,lt.prototype.removeRange=lt.prototype.removeRange,lt.prototype.removeAt=lt.prototype.lb,lt.prototype.delete=lt.prototype.delete,lt.prototype.remove=lt.prototype.remove,lt.prototype.insertAt=lt.prototype.Kb,lt.prototype.pop=lt.prototype.pop,lt.prototype.last=lt.prototype.Xb,lt.prototype.first=lt.prototype.first,lt.prototype.set=lt.prototype.set,lt.prototype.setElt=lt.prototype.hd,lt.prototype.get=lt.prototype.get,lt.prototype.elt=lt.prototype.L,lt.prototype.indexOf=lt.prototype.indexOf,lt.prototype.has=lt.prototype.has,lt.prototype.contains=lt.prototype.contains,lt.prototype.clear=lt.prototype.clear,lt.prototype.addAll=lt.prototype.addAll,lt.prototype.push=lt.prototype.push,lt.prototype.add=lt.prototype.add,lt.prototype.thaw=lt.prototype.ea,lt.prototype.freeze=lt.prototype.freeze,lt.className="List",ut.prototype.reset=function(){var a=this.rg;a.Fa=null,this.ia=a.Aa,this.la=null},ut.prototype.next=function(){var a=this.rg;if(a.Aa!==this.ia&&null===this.key)return!1;var b=this.la;return null!==(b=null===b?a.ba:b.oa)?(this.la=b,this.value=b.value,this.key=b.key,!0):(this.Cd(),!1)},ut.prototype.ed=function(){return this.next()},ut.prototype.first=function(){var a=this.rg;if(this.ia=a.Aa,null!==(a=a.ba)){this.la=a;var b=a.value;return this.key=a.key,this.value=b}return null},ut.prototype.any=function(a){var b=this.rg;for(this.la=b.Fa=null,b=b.ba;null!==b;){if(a(b.value))return!0;b=b.oa}return!1},ut.prototype.all=function(a){var b=this.rg;for(this.la=b.Fa=null,b=b.ba;null!==b;){if(!a(b.value))return!1;b=b.oa}return!0},ut.prototype.each=function(a){var b=this.rg;for(this.la=b.Fa=null,b=b.ba;null!==b;)a(b.value),b=b.oa;return this},ut.prototype.map=function(a){var b=this.rg;b.Fa=null;var t=new lt;for(b=b.ba;null!==b;)t.add(a(b.value)),b=b.oa;return t.iterator},ut.prototype.filter=function(a){var b=this.rg;b.Fa=null;var t=new lt;for(b=b.ba;null!==b;){var e=b.value;a(e)&&t.add(e),b=b.oa}return t.iterator},ut.prototype.Cd=function(){this.value=this.key=null,this.ia=-1,this.rg.Fa=this},ut.prototype.toString=function(){return null!==this.la?"SetIterator@"+this.la.value:"SetIterator"},v.Object.defineProperties(ut.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.rg.Cb}}}),ut.prototype.first=ut.prototype.first,ut.prototype.hasNext=ut.prototype.ed,ut.prototype.next=ut.prototype.next,ut.prototype.reset=ut.prototype.reset,ut.className="SetIterator",(n=ct.prototype).ib=function(){var a=this.Aa;999999999<++a&&(a=0),this.Aa=a},n.freeze=function(){return this.s=!0,this},n.ea=function(){return this.s=!1,this},n.toString=function(){return"Set()#"+gt(this)},n.add=function(a){if(null===a)return this;this.s&&C(this,a);var b=a;return j(a)&&(b=pt(a)),void 0===this.Eb[b]&&(this.Cb++,a=new bt(a,a),this.Eb[b]=a,null===(b=this.Ve)?this.ba=a:(a.Dl=b,b.oa=a),this.Ve=a,this.ib()),this},n.addAll=function(a){if(null===a)return this;if(this.s&&C(this),D(a))for(var b=a.length,t=0;t<b;t++)this.add(a[t]);else for(a=a.iterator;a.next();)this.add(a.value);return this},n.contains=function(a){if(null===a)return!1;var b=a;return(!j(a)||void 0!==(b=gt(a)))&&void 0!==this.Eb[b]},n.has=function(a){return this.contains(a)},n.Uy=function(a){if(null===a)return!0;for(a=a.iterator;a.next();)if(!this.contains(a.value))return!1;return!0},n.Vy=function(a){if(null===a)return!0;for(a=a.iterator;a.next();)if(this.contains(a.value))return!0;return!1},n.first=function(){var a=this.ba;return null===a?null:a.value},ct.prototype.any=function(a){for(var b=this.ba;null!==b;){if(a(b.value))return!0;b=b.oa}return!1},ct.prototype.all=function(a){for(var b=this.ba;null!==b;){if(!a(b.value))return!1;b=b.oa}return!0},ct.prototype.each=function(a){for(var b=this.ba;null!==b;)a(b.value),b=b.oa;return this},ct.prototype.map=function(a){for(var b=new ct,t=this.ba;null!==t;)b.add(a(t.value)),t=t.oa;return b},ct.prototype.filter=function(a){for(var b=new ct,t=this.ba;null!==t;){var e=t.value;a(e)&&b.add(e),t=t.oa}return b},(n=ct.prototype).remove=function(a){if(null===a)return!1;this.s&&C(this,a);var b=a;if(j(a)&&void 0===(b=gt(a)))return!1;if(void 0===(a=this.Eb[b]))return!1;var t=a.oa,e=a.Dl;return null!==t&&(t.Dl=e),null!==e&&(e.oa=t),this.ba===a&&(this.ba=t),this.Ve===a&&(this.Ve=e),delete this.Eb[b],this.Cb--,this.ib(),!0},n.delete=function(a){return this.remove(a)},n.Fq=function(a){if(null===a)return this;if(this.s&&C(this),D(a))for(var b=a.length,t=0;t<b;t++)this.remove(a[t]);else for(a=a.iterator;a.next();)this.remove(a.value);return this},n.qA=function(a){if(null===a||0===this.count)return this;this.s&&C(this);var b=new ct;b.addAll(a),a=[];for(var t=this.iterator;t.next();){var e=t.value;b.contains(e)||a.push(e)}return this.Fq(a),this},n.clear=function(){this.s&&C(this),this.Eb={},this.Cb=0,null!==this.Fa&&this.Fa.reset(),this.Ve=this.ba=null,this.ib()},ct.prototype.copy=function(){var t,a=new ct,b=this.Eb;for(t in b)a.add(b[t].value);return a},ct.prototype.na=function(){var t,a=Array(this.Cb),b=this.Eb,e=0;for(t in b)a[e]=b[t].value,e++;return a},ct.prototype.lw=function(){var t,a=new lt,b=this.Eb;for(t in b)a.add(b[t].value);return a},v.Object.defineProperties(ct.prototype,{count:{get:function(){return this.Cb}},size:{get:function(){return this.Cb}},iterator:{get:function(){if(0>=this.Cb)return ot;var a=this.Fa;return null!==a?(a.reset(),a):new ut(this)}}}),ct.prototype.toList=ct.prototype.lw,ct.prototype.toArray=ct.prototype.na,ct.prototype.clear=ct.prototype.clear,ct.prototype.retainAll=ct.prototype.qA,ct.prototype.removeAll=ct.prototype.Fq,ct.prototype.delete=ct.prototype.delete,ct.prototype.remove=ct.prototype.remove,ct.prototype.first=ct.prototype.first,ct.prototype.containsAny=ct.prototype.Vy,ct.prototype.containsAll=ct.prototype.Uy,ct.prototype.has=ct.prototype.has,ct.prototype.contains=ct.prototype.contains,ct.prototype.addAll=ct.prototype.addAll,ct.prototype.add=ct.prototype.add,ct.prototype.thaw=ct.prototype.ea,ct.prototype.freeze=ct.prototype.freeze;var yt=1;function mt(a){this.fa=a,this.ia=a.Aa,this.la=null}function vt(a){ct.call(this),ft(this),this.s=!0,this.fa=a}function xt(a){this.fa=a,a.Ue=null,this.ia=a.Aa,this.la=null}function bt(a,b){this.key=a,this.value=b,this.Dl=this.oa=null}function wt(a){this.fa=a,a.Fa=null,this.ia=a.Aa,this.la=null}function kt(a){ft(this),this.s=!1,this.Eb={},this.Cb=0,this.Ue=this.Fa=null,this.Aa=0,this.Ve=this.ba=null,void 0!==a&&("function"==typeof a||"string"==typeof a?A():this.addAll(a))}function Mt(a,b){void 0===a?this.y=this.x=0:"number"==typeof a&&"number"==typeof b?(this.x=a,this.y=b):N("Invalid arguments to Point constructor: "+a+", "+b),this.s=!1}function St(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];e&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;return(e=a[b++])&&(n=parseFloat(e)),new Mt(t,n)}return new Mt}function Pt(a){return a.x.toString()+" "+a.y.toString()}function Nt(a,b){if(0===a)return 0<b?90:0>b?270:0;if(0===b)return 0<a?0:180;if(isNaN(a)||isNaN(b))return 0;var t=180*Math.atan(Math.abs(b/a))/Math.PI;return 0>a?t=0>b?t+180:180-t:0>b&&(t=360-t),t}function Ct(a,b){return b.Wd(a),a}function Tt(a,b,t,e,n,o){var g=n-t,r=o-e,h=g*g+r*r,l=-(t-=a)*g-(e-=b)*r;return 0>=l||l>=h?(g=n-a,r=o-b,Math.min(t*t+e*e,g*g+r*r)):(a=g*e-r*t)*a/h}function Lt(a,b,t,e){return(a=t-a)*a+(b=e-b)*b}function At(a,b,t,e){return b=e-b,0===(a=t-a)?0<b?90:0>b?270:0:0===b?0<a?0:180:isNaN(a)||isNaN(b)?0:(e=180*Math.atan(Math.abs(b/a))/Math.PI,0>a?e=0>b?e+180:180-e:0>b&&(e=360-e),e)}ct.className="Set",ct.uniqueHash=ft,ct.hashIdUnique=pt,ct.hashId=gt,mt.prototype.reset=function(){this.ia=this.fa.Aa,this.la=null},mt.prototype.next=function(){var a=this.fa;if(a.Aa!==this.ia&&null===this.key)return!1;var b=this.la;return null!==(b=null===b?a.ba:b.oa)?(this.la=b,this.value=this.key=a=b.key,!0):(this.Cd(),!1)},mt.prototype.ed=function(){return this.next()},mt.prototype.first=function(){var a=this.fa;return this.ia=a.Aa,null!==(a=a.ba)?(this.la=a,this.value=this.key=a=a.key):null},mt.prototype.any=function(a){var b=this.fa;for(this.la=null,b=b.ba;null!==b;){if(a(b.key))return!0;b=b.oa}return!1},mt.prototype.all=function(a){var b=this.fa;for(this.la=null,b=b.ba;null!==b;){if(!a(b.key))return!1;b=b.oa}return!0},mt.prototype.each=function(a){var b=this.fa;for(this.la=null,b=b.ba;null!==b;)a(b.key),b=b.oa;return this},mt.prototype.map=function(a){var b=this.fa;this.la=null;var t=new lt;for(b=b.ba;null!==b;)t.add(a(b.key)),b=b.oa;return t.iterator},mt.prototype.filter=function(a){var b=this.fa;this.la=null;var t=new lt;for(b=b.ba;null!==b;){var e=b.key;a(e)&&t.add(e),b=b.oa}return t.iterator},mt.prototype.Cd=function(){this.value=this.key=null,this.ia=-1},mt.prototype.toString=function(){return null!==this.la?"MapKeySetIterator@"+this.la.value:"MapKeySetIterator"},v.Object.defineProperties(mt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.fa.Cb}}}),mt.prototype.first=mt.prototype.first,mt.prototype.hasNext=mt.prototype.ed,mt.prototype.next=mt.prototype.next,mt.prototype.reset=mt.prototype.reset,mt.className="MapKeySetIterator",m(vt,ct),(n=vt.prototype).freeze=function(){return this},n.ea=function(){return this},n.toString=function(){return"MapKeySet("+this.fa.toString()+")"},n.add=function(){return N("This Set is read-only: "+this.toString()),this},n.contains=function(a){return this.fa.contains(a)},n.has=function(a){return this.contains(a)},n.remove=function(){return N("This Set is read-only: "+this.toString()),!1},n.delete=function(a){return this.remove(a)},n.clear=function(){N("This Set is read-only: "+this.toString())},n.first=function(){var a=this.fa.ba;return null!==a?a.key:null},vt.prototype.any=function(a){for(var b=this.fa.ba;null!==b;){if(a(b.key))return!0;b=b.oa}return!1},vt.prototype.all=function(a){for(var b=this.fa.ba;null!==b;){if(!a(b.key))return!1;b=b.oa}return!0},vt.prototype.each=function(a){for(var b=this.fa.ba;null!==b;)a(b.key),b=b.oa;return this},vt.prototype.map=function(a){for(var b=new ct,t=this.fa.ba;null!==t;)b.add(a(t.key)),t=t.oa;return b},vt.prototype.filter=function(a){for(var b=new ct,t=this.fa.ba;null!==t;){var e=t.key;a(e)&&b.add(e),t=t.oa}return b},vt.prototype.copy=function(){return new vt(this.fa)},vt.prototype.mw=function(){var t,a=new ct,b=this.fa.Eb;for(t in b)a.add(b[t].key);return a},vt.prototype.na=function(){var t,a=this.fa.Eb,b=Array(this.fa.Cb),e=0;for(t in a)b[e]=a[t].key,e++;return b},vt.prototype.lw=function(){var t,a=new lt,b=this.fa.Eb;for(t in b)a.add(b[t].key);return a},v.Object.defineProperties(vt.prototype,{count:{get:function(){return this.fa.Cb}},size:{get:function(){return this.fa.Cb}},iterator:{get:function(){return 0>=this.fa.Cb?ot:new mt(this.fa)}}}),vt.prototype.toList=vt.prototype.lw,vt.prototype.toArray=vt.prototype.na,vt.prototype.toSet=vt.prototype.mw,vt.prototype.first=vt.prototype.first,vt.prototype.clear=vt.prototype.clear,vt.prototype.delete=vt.prototype.delete,vt.prototype.remove=vt.prototype.remove,vt.prototype.has=vt.prototype.has,vt.prototype.contains=vt.prototype.contains,vt.prototype.add=vt.prototype.add,vt.prototype.thaw=vt.prototype.ea,vt.prototype.freeze=vt.prototype.freeze,vt.className="MapKeySet",xt.prototype.reset=function(){var a=this.fa;a.Ue=null,this.ia=a.Aa,this.la=null},xt.prototype.next=function(){var a=this.fa;if(a.Aa!==this.ia&&null===this.key)return!1;var b=this.la;return null!==(b=null===b?a.ba:b.oa)?(this.la=b,this.value=b.value,this.key=b.key,!0):(this.Cd(),!1)},xt.prototype.ed=function(){return this.next()},xt.prototype.first=function(){var a=this.fa;if(this.ia=a.Aa,null!==(a=a.ba)){this.la=a;var b=a.value;return this.key=a.key,this.value=b}return null},xt.prototype.any=function(a){var b=this.fa;for(this.la=b.Ue=null,b=b.ba;null!==b;){if(a(b.value))return!0;b=b.oa}return!1},xt.prototype.all=function(a){var b=this.fa;for(this.la=b.Ue=null,b=b.ba;null!==b;){if(!a(b.value))return!1;b=b.oa}return!0},xt.prototype.each=function(a){var b=this.fa;for(this.la=b.Ue=null,b=b.ba;null!==b;)a(b.value),b=b.oa;return this},xt.prototype.map=function(a){var b=this.fa;this.la=b.Ue=null;var t=new lt;for(b=b.ba;null!==b;)t.add(a(b.value)),b=b.oa;return t.iterator},xt.prototype.filter=function(a){var b=this.fa;this.la=b.Ue=null;var t=new lt;for(b=b.ba;null!==b;){var e=b.value;a(e)&&t.add(e),b=b.oa}return t.iterator},xt.prototype.Cd=function(){this.value=this.key=null,this.ia=-1,this.fa.Ue=this},xt.prototype.toString=function(){return null!==this.la?"MapValueSetIterator@"+this.la.value:"MapValueSetIterator"},v.Object.defineProperties(xt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.fa.Cb}}}),xt.prototype.first=xt.prototype.first,xt.prototype.hasNext=xt.prototype.ed,xt.prototype.next=xt.prototype.next,xt.prototype.reset=xt.prototype.reset,xt.className="MapValueSetIterator",bt.prototype.toString=function(){return"{"+this.key+":"+this.value+"}"},bt.className="KeyValuePair",wt.prototype.reset=function(){var a=this.fa;a.Fa=null,this.ia=a.Aa,this.la=null},wt.prototype.next=function(){var a=this.fa;if(a.Aa!==this.ia&&null===this.key)return!1;var b=this.la;return null!==(b=null===b?a.ba:b.oa)?(this.la=b,this.key=b.key,this.value=b.value,!0):(this.Cd(),!1)},wt.prototype.ed=function(){return this.next()},wt.prototype.first=function(){var a=this.fa;return this.ia=a.Aa,null!==(a=a.ba)?(this.la=a,this.key=a.key,this.value=a.value,a):null},wt.prototype.any=function(a){var b=this.fa;for(this.la=b.Fa=null,b=b.ba;null!==b;){if(a(b))return!0;b=b.oa}return!1},wt.prototype.all=function(a){var b=this.fa;for(this.la=b.Fa=null,b=b.ba;null!==b;){if(!a(b))return!1;b=b.oa}return!0},wt.prototype.each=function(a){var b=this.fa;for(this.la=b.Fa=null,b=b.ba;null!==b;)a(b),b=b.oa;return this},wt.prototype.map=function(a){var b=this.fa;this.la=b.Fa=null;var t=new lt;for(b=b.ba;null!==b;)t.add(a(b)),b=b.oa;return t.iterator},wt.prototype.filter=function(a){var b=this.fa;this.la=b.Fa=null;var t=new lt;for(b=b.ba;null!==b;)a(b)&&t.add(b),b=b.oa;return t.iterator},wt.prototype.Cd=function(){this.value=this.key=null,this.ia=-1,this.fa.Fa=this},wt.prototype.toString=function(){return null!==this.la?"MapIterator@"+this.la:"MapIterator"},v.Object.defineProperties(wt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.fa.Cb}}}),wt.prototype.first=wt.prototype.first,wt.prototype.hasNext=wt.prototype.ed,wt.prototype.next=wt.prototype.next,wt.prototype.reset=wt.prototype.reset,wt.className="MapIterator",(n=kt.prototype).ib=function(){var a=this.Aa;999999999<++a&&(a=0),this.Aa=a},n.freeze=function(){return this.s=!0,this},n.ea=function(){return this.s=!1,this},n.toString=function(){return"Map()#"+gt(this)},n.add=function(a,b){this.s&&C(this,a);var t=a;j(a)&&(t=pt(a));var e=this.Eb[t];return void 0===e?(this.Cb++,a=new bt(a,b),this.Eb[t]=a,null===(t=this.Ve)?this.ba=a:(a.Dl=t,t.oa=a),this.Ve=a,this.ib()):e.value=b,this},n.set=function(a,b){return this.add(a,b)},n.addAll=function(a){if(null===a)return this;if(D(a))for(var b=a.length,t=0;t<b;t++){var e=a[t];this.add(e.key,e.value)}else if(a instanceof kt)for(a=a.iterator;a.next();)this.add(a.key,a.value);else for(a=a.iterator;a.next();)b=a.value,this.add(b.key,b.value);return this},n.first=function(){return this.ba},kt.prototype.any=function(a){for(var b=this.ba;null!==b;){if(a(b))return!0;b=b.oa}return!1},kt.prototype.all=function(a){for(var b=this.ba;null!==b;){if(!a(b))return!1;b=b.oa}return!0},kt.prototype.each=function(a){for(var b=this.ba;null!==b;)a(b),b=b.oa;return this},kt.prototype.map=function(a){for(var b=new kt,t=this.ba;null!==t;)b.add(t.key,a(t)),t=t.oa;return b},kt.prototype.filter=function(a){for(var b=new kt,t=this.ba;null!==t;)a(t)&&b.add(t.key,t.value),t=t.oa;return b},(n=kt.prototype).contains=function(a){var b=a;return(!j(a)||void 0!==(b=gt(a)))&&void 0!==this.Eb[b]},n.has=function(a){return this.contains(a)},n.H=function(a){var b=a;return j(a)&&void 0===(b=gt(a))||void 0===(a=this.Eb[b])?null:a.value},n.get=function(a){return this.H(a)},n.remove=function(a){if(null===a)return!1;this.s&&C(this,a);var b=a;if(j(a)&&void 0===(b=gt(a)))return!1;if(void 0===(a=this.Eb[b]))return!1;var t=a.oa,e=a.Dl;return null!==t&&(t.Dl=e),null!==e&&(e.oa=t),this.ba===a&&(this.ba=t),this.Ve===a&&(this.Ve=e),delete this.Eb[b],this.Cb--,this.ib(),!0},n.delete=function(a){return this.remove(a)},n.clear=function(){this.s&&C(this),this.Eb={},this.Cb=0,null!==this.Fa&&this.Fa.reset(),null!==this.Ue&&this.Ue.reset(),this.Ve=this.ba=null,this.ib()},kt.prototype.copy=function(){var t,a=new kt,b=this.Eb;for(t in b){var e=b[t];a.add(e.key,e.value)}return a},kt.prototype.na=function(){var t,a=this.Eb,b=Array(this.Cb),e=0;for(t in a){var n=a[t];b[e]=new bt(n.key,n.value),e++}return b},kt.prototype.Df=function(){return new vt(this)},v.Object.defineProperties(kt.prototype,{count:{get:function(){return this.Cb}},size:{get:function(){return this.Cb}},iterator:{get:function(){if(0>=this.count)return ot;var a=this.Fa;return null!==a?(a.reset(),a):new wt(this)}},iteratorKeys:{get:function(){return 0>=this.count?ot:new mt(this)}},iteratorValues:{get:function(){if(0>=this.count)return ot;var a=this.Ue;return null!==a?(a.reset(),a):new xt(this)}}}),kt.prototype.toKeySet=kt.prototype.Df,kt.prototype.toArray=kt.prototype.na,kt.prototype.clear=kt.prototype.clear,kt.prototype.delete=kt.prototype.delete,kt.prototype.remove=kt.prototype.remove,kt.prototype.get=kt.prototype.get,kt.prototype.getValue=kt.prototype.H,kt.prototype.has=kt.prototype.has,kt.prototype.contains=kt.prototype.contains,kt.prototype.first=kt.prototype.first,kt.prototype.addAll=kt.prototype.addAll,kt.prototype.set=kt.prototype.set,kt.prototype.add=kt.prototype.add,kt.prototype.thaw=kt.prototype.ea,kt.prototype.freeze=kt.prototype.freeze,kt.className="Map",Mt.prototype.assign=function(a){return this.x=a.x,this.y=a.y,this},Mt.prototype.h=function(a,b){return this.x=a,this.y=b,this},Mt.prototype.Fg=function(a,b){return this.x=a,this.y=b,this},Mt.prototype.set=function(a){return this.x=a.x,this.y=a.y,this},Mt.prototype.copy=function(){var a=new Mt;return a.x=this.x,a.y=this.y,a},(n=Mt.prototype).ca=function(){return this.s=!0,Object.freeze(this),this},n.G=function(){return this.s||Object.isFrozen(this)?this:this.copy().freeze()},n.freeze=function(){return this.s=!0,this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,this},n.toString=function(){return"Point("+this.x+","+this.y+")"},n.w=function(a){return a instanceof Mt&&(this.x===a.x&&this.y===a.y)},n.Ri=function(a,b){return this.x===a&&this.y===b},n.Ma=function(a){return ne.A(this.x,a.x)&&ne.A(this.y,a.y)},n.add=function(a){return this.x+=a.x,this.y+=a.y,this},n.$d=function(a){return this.x-=a.x,this.y-=a.y,this},n.offset=function(a,b){return this.x+=a,this.y+=b,this},Mt.prototype.rotate=function(a){if(0===a)return this;var b=this.x,t=this.y;if(0===b&&0===t)return this;if(360<=a?a-=360:0>a&&(a+=360),90===a){a=0;var e=1}else 180===a?(a=-1,e=0):270===a?(a=0,e=-1):(e=a*Math.PI/180,a=Math.cos(e),e=Math.sin(e));return this.x=a*b-e*t,this.y=e*b+a*t,this},(n=Mt.prototype).scale=function(a,b){return this.x*=a,this.y*=b,this},n.Be=function(a){var b=a.x-this.x;return b*b+(a=a.y-this.y)*a},n.dd=function(a,b){return(a-=this.x)*a+(b-=this.y)*b},n.normalize=function(){var a=this.x,b=this.y,t=Math.sqrt(a*a+b*b);return 0<t&&(this.x=a/t,this.y=b/t),this},n.Sa=function(a){return Nt(a.x-this.x,a.y-this.y)},n.direction=function(a,b){return Nt(a-this.x,b-this.y)},n.kA=function(a,b,t,e){return ne.Lh(a,b,t,e,this.x,this.y,this),this},n.lA=function(a,b){return ne.Lh(a.x,a.y,b.x,b.y,this.x,this.y,this),this},n.wA=function(a,b,t,e){return ne.mq(this.x,this.y,a,b,t,e,this),this},n.xA=function(a,b){return ne.mq(this.x,this.y,a.x,a.y,b.width,b.height,this),this},n.dj=function(a,b){return this.x=a.x+b.x*a.width+b.offsetX,this.y=a.y+b.y*a.height+b.offsetY,this},n.xk=function(a,b,t,e,n){return this.x=a+n.x*t+n.offsetX,this.y=b+n.y*e+n.offsetY,this},n.transform=function(a){return a.ra(this),this},n.u=function(){return isFinite(this.x)&&isFinite(this.y)},Mt.alloc=function(){var a=Xt.pop();return void 0===a?new Mt:a},Mt.allocAt=function(a,b){var t=Xt.pop();return void 0===t?new Mt(a,b):(t.x=a,t.y=b,t)},Mt.free=function(a){Xt.push(a)},Mt.prototype.isReal=Mt.prototype.u,Mt.prototype.setSpot=Mt.prototype.xk,Mt.prototype.setRectSpot=Mt.prototype.dj,Mt.prototype.snapToGridPoint=Mt.prototype.xA,Mt.prototype.snapToGrid=Mt.prototype.wA,Mt.prototype.projectOntoLineSegmentPoint=Mt.prototype.lA,Mt.prototype.projectOntoLineSegment=Mt.prototype.kA,Mt.intersectingLineSegments=function(a,b,t,e,n,o,g,r){return ne.sq(a,b,t,e,n,o,g,r)},Mt.prototype.direction=Mt.prototype.direction,Mt.prototype.directionPoint=Mt.prototype.Sa,Mt.prototype.normalize=Mt.prototype.normalize,Mt.prototype.distanceSquared=Mt.prototype.dd,Mt.prototype.distanceSquaredPoint=Mt.prototype.Be,Mt.prototype.scale=Mt.prototype.scale,Mt.prototype.rotate=Mt.prototype.rotate,Mt.prototype.offset=Mt.prototype.offset,Mt.prototype.subtract=Mt.prototype.$d,Mt.prototype.add=Mt.prototype.add,Mt.prototype.equalsApprox=Mt.prototype.Ma,Mt.prototype.equalTo=Mt.prototype.Ri,Mt.prototype.equals=Mt.prototype.w,Mt.prototype.set=Mt.prototype.set,Mt.prototype.setTo=Mt.prototype.Fg;var jt,Dt,Ft,Ot,Bt,It,Rt,Et,zt,Vt,Yt,Gt,Xt=[];function qt(a,b){void 0===a?this.height=this.width=0:"number"==typeof a&&(0<=a||isNaN(a))&&"number"==typeof b&&(0<=b||isNaN(b))?(this.width=a,this.height=b):N("Invalid arguments to Size constructor: "+a+", "+b),this.s=!1}function Ut(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];e&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;return(e=a[b++])&&(n=parseFloat(e)),new qt(t,n)}return new qt}function Kt(a){return a.width.toString()+" "+a.height.toString()}Mt.className="Point",Mt.parse=St,Mt.stringify=Pt,Mt.distanceLineSegmentSquared=Tt,Mt.distanceSquared=Lt,Mt.direction=At,Mt.Origin=jt=new Mt(0,0).ca(),Mt.InfiniteTopLeft=Dt=new Mt(-1/0,-1/0).ca(),Mt.InfiniteBottomRight=Ft=new Mt(1/0,1/0).ca(),Mt.SixPoint=Ot=new Mt(6,6).ca(),Mt.NoPoint=Bt=new Mt(NaN,NaN).ca(),Mt.parse=St,Mt.stringify=Pt,Mt.distanceLineSegmentSquared=Tt,Mt.distanceSquared=Lt,Mt.direction=At,qt.prototype.assign=function(a){return this.width=a.width,this.height=a.height,this},qt.prototype.h=function(a,b){return this.width=a,this.height=b,this},qt.prototype.Fg=function(a,b){return this.width=a,this.height=b,this},qt.prototype.set=function(a){return this.width=a.width,this.height=a.height,this},qt.prototype.copy=function(){var a=new qt;return a.width=this.width,a.height=this.height,a},(n=qt.prototype).ca=function(){return this.s=!0,Object.freeze(this),this},n.G=function(){return this.s||Object.isFrozen(this)?this:this.copy().freeze()},n.freeze=function(){return this.s=!0,this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,this},n.toString=function(){return"Size("+this.width+","+this.height+")"},n.w=function(a){return a instanceof qt&&(this.width===a.width&&this.height===a.height)},n.Ri=function(a,b){return this.width===a&&this.height===b},n.Ma=function(a){return ne.A(this.width,a.width)&&ne.A(this.height,a.height)},n.u=function(){return isFinite(this.width)&&isFinite(this.height)},qt.alloc=function(){var a=Ht.pop();return void 0===a?new qt:a},qt.free=function(a){Ht.push(a)},qt.prototype.isReal=qt.prototype.u,qt.prototype.equalsApprox=qt.prototype.Ma,qt.prototype.equalTo=qt.prototype.Ri,qt.prototype.equals=qt.prototype.w,qt.prototype.set=qt.prototype.set,qt.prototype.setTo=qt.prototype.Fg;var Ht=[];function Wt(a,b,t,e){void 0===a?this.height=this.width=this.y=this.x=0:a instanceof Mt?(t=a.x,a=a.y,b instanceof Mt?(e=b.x,b=b.y,this.x=Math.min(t,e),this.y=Math.min(a,b),this.width=Math.abs(t-e),this.height=Math.abs(a-b)):b instanceof qt?(this.x=t,this.y=a,this.width=b.width,this.height=b.height):N("Incorrect arguments supplied to Rect constructor")):"number"==typeof a&&"number"==typeof b&&"number"==typeof t&&(0<=t||isNaN(t))&&"number"==typeof e&&(0<=e||isNaN(e))?(this.x=a,this.y=b,this.width=t,this.height=e):N("Invalid arguments to Rect constructor: "+a+", "+b+", "+t+", "+e),this.s=!1}function Jt(a,b,t){a.width=b,a.height=t}function Zt(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];e&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;(e=a[b++])&&(n=parseFloat(e));for(var o=0;""===a[b];)b++;(e=a[b++])&&(o=parseFloat(e));for(var g=0;""===a[b];)b++;return(e=a[b++])&&(g=parseFloat(e)),new Wt(t,n,o,g)}return new Wt}function $t(a){return a.x.toString()+" "+a.y.toString()+" "+a.width.toString()+" "+a.height.toString()}function Qt(a,b){return ne.$(a.x,b.x)&&ne.$(a.y,b.y)&&ne.$(a.width,b.width)&&ne.$(a.height,b.height)}function _t(a,b,t,e,n){var o=a.width;return t+n<=-o?(a.x+=o/2,a.width=0):(a.x-=n,a.width+=t+n),b+e<=-(t=a.height)?(a.y+=t/2,a.height=0):(a.y-=b,a.height+=b+e),a}function ti(a,b,t,e,n){var o=Math.max(a.x,b),g=Math.max(a.y,t);return b=Math.min(a.x+a.width,b+e),t=Math.min(a.y+a.height,t+n),a.x=o,a.y=g,a.width=Math.max(0,b-o),a.height=Math.max(0,t-g),a}function ii(a,b){var t=a.width,e=a.x,n=b.x-10;return!(e>b.width+10+10+n||n>t+e)&&(t=a.height,a=a.y,e=b.y-10,!(a>b.height+10+10+e||e>t+a))}function ei(a,b,t,e,n){var o=Math.min(a.x,b),g=Math.min(a.y,t);return b=Math.max(a.x+a.width,b+e),t=Math.max(a.y+a.height,t+n),a.x=o,a.y=g,a.width=b-o,a.height=t-g,a}function ni(a,b,t,e,n,o,g,r){return void 0===g&&(g=0),void 0===r&&(r=0),a<=n&&n+g<=a+t&&b<=o&&o+r<=b+e}function oi(a,b,t,e,n,o,g,r){return!(a>g+n||n>t+a)&&!(b>r+o||o>e+b)}qt.className="Size",qt.parse=Ut,qt.stringify=Kt,qt.ZeroSize=It=new qt(0,0).ca(),qt.OneSize=Rt=new qt(1,1).ca(),qt.SixSize=Et=new qt(6,6).ca(),qt.EightSize=zt=new qt(8,8).ca(),qt.TenSize=Vt=new qt(10,10).ca(),qt.InfiniteSize=Yt=new qt(1/0,1/0).ca(),qt.NoSize=Gt=new qt(NaN,NaN).ca(),qt.parse=Ut,qt.stringify=Kt,(n=Wt.prototype).assign=function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this},n.h=function(a,b,t,e){return this.x=a,this.y=b,this.width=t,this.height=e,this},n.Fg=function(a,b,t,e){return this.x=a,this.y=b,this.width=t,this.height=e,this},n.set=function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this},n.jd=function(a){return this.x=a.x,this.y=a.y,this},n.uA=function(a){return this.width=a.width,this.height=a.height,this},Wt.prototype.copy=function(){var a=new Wt;return a.x=this.x,a.y=this.y,a.width=this.width,a.height=this.height,a},(n=Wt.prototype).ca=function(){return this.s=!0,Object.freeze(this),this},n.G=function(){return this.s||Object.isFrozen(this)?this:this.copy().freeze()},n.freeze=function(){return this.s=!0,this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,this},n.toString=function(){return"Rect("+this.x+","+this.y+","+this.width+","+this.height+")"},n.w=function(a){return a instanceof Wt&&(this.x===a.x&&this.y===a.y&&this.width===a.width&&this.height===a.height)},n.Ri=function(a,b,t,e){return this.x===a&&this.y===b&&this.width===t&&this.height===e},n.Ma=function(a){return ne.A(this.x,a.x)&&ne.A(this.y,a.y)&&ne.A(this.width,a.width)&&ne.A(this.height,a.height)},n.aa=function(a){return this.x<=a.x&&this.x+this.width>=a.x&&this.y<=a.y&&this.y+this.height>=a.y},n.Ae=function(a){return this.x<=a.x&&a.x+a.width<=this.x+this.width&&this.y<=a.y&&a.y+a.height<=this.y+this.height},n.contains=function(a,b,t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.x<=a&&a+t<=this.x+this.width&&this.y<=b&&b+e<=this.y+this.height},n.offset=function(a,b){return this.x+=a,this.y+=b,this},n.Vc=function(a,b){return _t(this,b,a,b,a)},n.cq=function(a){return _t(this,a.top,a.right,a.bottom,a.left)},n.kw=function(a){return _t(this,-a.top,-a.right,-a.bottom,-a.left)},n.Oz=function(a,b,t,e){return _t(this,a,b,t,e)},n.Sz=function(a){return ti(this,a.x,a.y,a.width,a.height)},n.Ev=function(a,b,t,e){return ti(this,a,b,t,e)},n.Gc=function(a){return this.Fv(a.x,a.y,a.width,a.height)},n.Fv=function(a,b,t,e){var n=this.width,o=this.x;return!(1/0!==n&&1/0!==t&&(n+=o,t+=a,isNaN(t)||isNaN(n)||o>t||a>n))&&(a=this.height,t=this.y,!(1/0!==a&&1/0!==e&&(a+=t,e+=b,isNaN(e)||isNaN(a)||t>e||b>a)))},n.Ie=function(a){return ei(this,a.x,a.y,0,0)},n.Hc=function(a){return ei(this,a.x,a.y,a.width,a.height)},n.rw=function(a,b,t,e){return void 0===t&&(t=0),void 0===e&&(e=0),ei(this,a,b,t,e)},n.xk=function(a,b,t){return this.x=a-t.offsetX-t.x*this.width,this.y=b-t.offsetY-t.y*this.height,this},n.u=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},n.Uz=function(){return 0===this.width&&0===this.height},Wt.alloc=function(){var a=ai.pop();return void 0===a?new Wt:a},Wt.allocAt=function(a,b,t,e){var n=ai.pop();return void 0===n?new Wt(a,b,t,e):n.h(a,b,t,e)},Wt.free=function(a){ai.push(a)},v.Object.defineProperties(Wt.prototype,{left:{get:function(){return this.x},set:function(a){this.x=a}},top:{get:function(){return this.y},set:function(a){this.y=a}},right:{get:function(){return this.x+this.width},set:function(a){this.x+=a-(this.x+this.width)}},bottom:{get:function(){return this.y+this.height},set:function(a){this.y+=a-(this.y+this.height)}},position:{get:function(){return new Mt(this.x,this.y)},set:function(a){this.x=a.x,this.y=a.y}},size:{get:function(){return new qt(this.width,this.height)},set:function(a){this.width=a.width,this.height=a.height}},center:{get:function(){return new Mt(this.x+this.width/2,this.y+this.height/2)},set:function(a){this.x=a.x-this.width/2,this.y=a.y-this.height/2}},centerX:{get:function(){return this.x+this.width/2},set:function(a){this.x=a-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(a){this.y=a-this.height/2}}}),Wt.prototype.isEmpty=Wt.prototype.Uz,Wt.prototype.isReal=Wt.prototype.u,Wt.intersectsLineSegment=function(a,b,t,e,n,o,g,r){return ne.Rx(a,b,t,e,n,o,g,r)},Wt.prototype.setSpot=Wt.prototype.xk,Wt.prototype.union=Wt.prototype.rw,Wt.prototype.unionRect=Wt.prototype.Hc,Wt.prototype.unionPoint=Wt.prototype.Ie,Wt.prototype.intersects=Wt.prototype.Fv,Wt.prototype.intersectsRect=Wt.prototype.Gc,Wt.prototype.intersect=Wt.prototype.Ev,Wt.prototype.intersectRect=Wt.prototype.Sz,Wt.prototype.grow=Wt.prototype.Oz,Wt.prototype.subtractMargin=Wt.prototype.kw,Wt.prototype.addMargin=Wt.prototype.cq,Wt.prototype.inflate=Wt.prototype.Vc,Wt.prototype.offset=Wt.prototype.offset,Wt.prototype.contains=Wt.prototype.contains,Wt.prototype.containsRect=Wt.prototype.Ae,Wt.prototype.containsPoint=Wt.prototype.aa,Wt.prototype.equalsApprox=Wt.prototype.Ma,Wt.prototype.equalTo=Wt.prototype.Ri,Wt.prototype.equals=Wt.prototype.w,Wt.prototype.setSize=Wt.prototype.uA,Wt.prototype.setPoint=Wt.prototype.jd,Wt.prototype.set=Wt.prototype.set,Wt.prototype.setTo=Wt.prototype.Fg;var ri,si,ai=[];function hi(a,b,t,e){void 0===a?this.left=this.bottom=this.right=this.top=0:void 0===b?this.left=this.bottom=this.right=this.top=a:void 0===t?(this.top=a,this.right=b,this.bottom=a,this.left=b):void 0!==e?(this.top=a,this.right=b,this.bottom=t,this.left=e):N("Invalid arguments to Margin constructor: "+a+", "+b+", "+t+", "+e),this.s=!1}function ui(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=NaN;""===a[b];)b++;var e=a[b++];if(e&&(t=parseFloat(e)),isNaN(t))return new hi;for(var n=NaN;""===a[b];)b++;if((e=a[b++])&&(n=parseFloat(e)),isNaN(n))return new hi(t);for(var o=NaN;""===a[b];)b++;if((e=a[b++])&&(o=parseFloat(e)),isNaN(o))return new hi(t,n);for(var g=NaN;""===a[b];)b++;return(e=a[b++])&&(g=parseFloat(e)),isNaN(g)?new hi(t,n):new hi(t,n,o,g)}return new hi}function ci(a){return a.top.toString()+" "+a.right.toString()+" "+a.bottom.toString()+" "+a.left.toString()}Wt.className="Rect",Wt.parse=Zt,Wt.stringify=$t,Wt.contains=ni,Wt.intersects=oi,Wt.ZeroRect=ri=new Wt(0,0,0,0).ca(),Wt.NoRect=si=new Wt(NaN,NaN,NaN,NaN).ca(),Wt.parse=Zt,Wt.stringify=$t,Wt.contains=ni,Wt.intersects=oi,hi.prototype.assign=function(a){return this.top=a.top,this.right=a.right,this.bottom=a.bottom,this.left=a.left,this},hi.prototype.Fg=function(a,b,t,e){return this.top=a,this.right=b,this.bottom=t,this.left=e,this},hi.prototype.set=function(a){return this.top=a.top,this.right=a.right,this.bottom=a.bottom,this.left=a.left,this},hi.prototype.copy=function(){var a=new hi;return a.top=this.top,a.right=this.right,a.bottom=this.bottom,a.left=this.left,a},(n=hi.prototype).ca=function(){return this.s=!0,Object.freeze(this),this},n.G=function(){return this.s||Object.isFrozen(this)?this:this.copy().freeze()},n.freeze=function(){return this.s=!0,this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,this},n.toString=function(){return"Margin("+this.top+","+this.right+","+this.bottom+","+this.left+")"},n.w=function(a){return a instanceof hi&&(this.top===a.top&&this.right===a.right&&this.bottom===a.bottom&&this.left===a.left)},n.Ri=function(a,b,t,e){return this.top===a&&this.right===b&&this.bottom===t&&this.left===e},n.Ma=function(a){return ne.A(this.top,a.top)&&ne.A(this.right,a.right)&&ne.A(this.bottom,a.bottom)&&ne.A(this.left,a.left)},n.u=function(){return isFinite(this.top)&&isFinite(this.right)&&isFinite(this.bottom)&&isFinite(this.left)},hi.alloc=function(){var a=Ji.pop();return void 0===a?new hi:a},hi.free=function(a){Ji.push(a)},hi.prototype.isReal=hi.prototype.u,hi.prototype.equalsApprox=hi.prototype.Ma,hi.prototype.equalTo=hi.prototype.Ri,hi.prototype.equals=hi.prototype.w,hi.prototype.set=hi.prototype.set,hi.prototype.setTo=hi.prototype.Fg;var fi,di,pi,gi,yi,mi,vi,xi,bi,wi,ki,Mi,Si,Pi,Ni,Ci,Ti,Li,Ai,ji,Di,Fi,Oi,Bi,Ii,Ri,Ei,zi,Vi,Yi,Gi,dd,Xi,qi,Ui,Ki,Hi,Wi,Ji=[];function Zi(a,b,t,e){void 0===a?this.offsetY=this.offsetX=this.y=this.x=0:(void 0===b&&(b=0),void 0===t&&(t=0),void 0===e&&(e=0),this.x=a,this.y=b,this.offsetX=t,this.offsetY=e),this.s=!1}function $i(a,b){return a.x=NaN,a.y=NaN,a.offsetX=b,a}function Qi(a){if("string"==typeof a){if("None"===(a=a.trim()))return pi;if("TopLeft"===a)return gi;if("Top"===a||"TopCenter"===a||"MiddleTop"===a)return yi;if("TopRight"===a)return mi;if("Left"===a||"LeftCenter"===a||"MiddleLeft"===a)return vi;if("Center"===a)return xi;if("Right"===a||"RightCenter"===a||"MiddleRight"===a)return bi;if("BottomLeft"===a)return wi;if("Bottom"===a||"BottomCenter"===a||"MiddleBottom"===a)return ki;if("BottomRight"===a)return Mi;if("TopSide"===a)return Si;if("LeftSide"===a)return Pi;if("RightSide"===a)return Ni;if("BottomSide"===a)return Ci;if("TopBottomSides"===a)return Ti;if("LeftRightSides"===a)return Li;if("TopLeftSides"===a)return Ai;if("TopRightSides"===a)return ji;if("BottomLeftSides"===a)return Di;if("BottomRightSides"===a)return Fi;if("NotTopSide"===a)return Oi;if("NotLeftSide"===a)return Bi;if("NotRightSide"===a)return Ii;if("NotBottomSide"===a)return Ri;if("AllSides"===a)return Ei;if("Default"===a)return zi;a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];void 0!==e&&0<e.length&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;void 0!==(e=a[b++])&&0<e.length&&(n=parseFloat(e));for(var o=0;""===a[b];)b++;void 0!==(e=a[b++])&&0<e.length&&(o=parseFloat(e));for(var g=0;""===a[b];)b++;return void 0!==(e=a[b++])&&0<e.length&&(g=parseFloat(e)),new Zi(t,n,o,g)}return new Zi}function _i(a){return a.eb()?a.x.toString()+" "+a.y.toString()+" "+a.offsetX.toString()+" "+a.offsetY.toString():a.toString()}hi.className="Margin",hi.parse=ui,hi.stringify=ci,hi.ZeroMargin=fi=new hi(0,0,0,0).ca(),hi.TwoMargin=di=new hi(2,2,2,2).ca(),hi.parse=ui,hi.stringify=ci,Zi.prototype.assign=function(a){return this.x=a.x,this.y=a.y,this.offsetX=a.offsetX,this.offsetY=a.offsetY,this},Zi.prototype.Fg=function(a,b,t,e){return this.x=a,this.y=b,this.offsetX=t,this.offsetY=e,this},Zi.prototype.set=function(a){return this.x=a.x,this.y=a.y,this.offsetX=a.offsetX,this.offsetY=a.offsetY,this},Zi.prototype.copy=function(){var a=new Zi;return a.x=this.x,a.y=this.y,a.offsetX=this.offsetX,a.offsetY=this.offsetY,a},(n=Zi.prototype).ca=function(){return this.s=!0,Object.freeze(this),this},n.G=function(){return this.s||Object.isFrozen(this)?this:this.copy().freeze()},n.freeze=function(){return this.s=!0,this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,this},n.toString=function(){return this.eb()?0===this.offsetX&&0===this.offsetY?"Spot("+this.x+","+this.y+")":"Spot("+this.x+","+this.y+","+this.offsetX+","+this.offsetY+")":this.w(pi)?"None":this.w(gi)?"TopLeft":this.w(yi)?"Top":this.w(mi)?"TopRight":this.w(vi)?"Left":this.w(xi)?"Center":this.w(bi)?"Right":this.w(wi)?"BottomLeft":this.w(ki)?"Bottom":this.w(Mi)?"BottomRight":this.w(Si)?"TopSide":this.w(Pi)?"LeftSide":this.w(Ni)?"RightSide":this.w(Ci)?"BottomSide":this.w(Ti)?"TopBottomSides":this.w(Li)?"LeftRightSides":this.w(Ai)?"TopLeftSides":this.w(ji)?"TopRightSides":this.w(Di)?"BottomLeftSides":this.w(Fi)?"BottomRightSides":this.w(Oi)?"NotTopSide":this.w(Bi)?"NotLeftSide":this.w(Ii)?"NotRightSide":this.w(Ri)?"NotBottomSide":this.w(Ei)?"AllSides":this.w(zi)?"Default":"None"},n.w=function(a){return a instanceof Zi&&((this.x===a.x||isNaN(this.x)&&isNaN(a.x))&&(this.y===a.y||isNaN(this.y)&&isNaN(a.y))&&this.offsetX===a.offsetX&&this.offsetY===a.offsetY)},n.Qv=function(){return new Zi(.5-(this.x-.5),.5-(this.y-.5),-this.offsetX,-this.offsetY)},n.xf=function(a){if(!this.gd())return!1;if(!a.gd())if(a.w(Vi))a=Pi;else if(a.w(Yi))a=Ni;else if(a.w(Gi))a=Si;else{if(!a.w(dd))return!1;a=Ci}return a=a.offsetY,(this.offsetY&a)===a},n.eb=function(){return!isNaN(this.x)&&!isNaN(this.y)},n.jc=function(){return isNaN(this.x)||isNaN(this.y)},n.gd=function(){return isNaN(this.x)&&isNaN(this.y)&&1===this.offsetX&&0!==this.offsetY},n.wt=function(){return isNaN(this.x)&&isNaN(this.y)&&0===this.offsetX&&0===this.offsetY},n.Mb=function(){return isNaN(this.x)&&isNaN(this.y)&&-1===this.offsetX&&0===this.offsetY},Zi.alloc=function(){var a=te.pop();return void 0===a?new Zi:a},Zi.free=function(a){te.push(a)},Zi.prototype.isDefault=Zi.prototype.Mb,Zi.prototype.isNone=Zi.prototype.wt,Zi.prototype.isSide=Zi.prototype.gd,Zi.prototype.isNoSpot=Zi.prototype.jc,Zi.prototype.isSpot=Zi.prototype.eb,Zi.prototype.includesSide=Zi.prototype.xf,Zi.prototype.opposite=Zi.prototype.Qv,Zi.prototype.equals=Zi.prototype.w,Zi.prototype.set=Zi.prototype.set,Zi.prototype.setTo=Zi.prototype.Fg;var te=[];function ie(){this.m11=1,this.m21=this.m12=0,this.m22=1,this.dy=this.dx=0}Zi.className="Spot",Zi.parse=Qi,Zi.stringify=_i,Zi.None=pi=$i(new Zi(0,0,0,0),0).ca(),Zi.Default=zi=$i(new Zi(0,0,-1,0),-1).ca(),Zi.TopLeft=gi=new Zi(0,0,0,0).ca(),Zi.TopCenter=yi=new Zi(.5,0,0,0).ca(),Zi.TopRight=mi=new Zi(1,0,0,0).ca(),Zi.LeftCenter=vi=new Zi(0,.5,0,0).ca(),Zi.Center=xi=new Zi(.5,.5,0,0).ca(),Zi.RightCenter=bi=new Zi(1,.5,0,0).ca(),Zi.BottomLeft=wi=new Zi(0,1,0,0).ca(),Zi.BottomCenter=ki=new Zi(.5,1,0,0).ca(),Zi.BottomRight=Mi=new Zi(1,1,0,0).ca(),Zi.MiddleTop=Xi=yi,Zi.MiddleLeft=qi=vi,Zi.MiddleRight=Ui=bi,Zi.MiddleBottom=Ki=ki,Zi.Top=Gi=yi,Zi.Left=Vi=vi,Zi.Right=Yi=bi,Zi.Bottom=dd=ki,Zi.TopSide=Si=$i(new Zi(0,0,1,1),1).ca(),Zi.LeftSide=Pi=$i(new Zi(0,0,1,2),1).ca(),Zi.RightSide=Ni=$i(new Zi(0,0,1,4),1).ca(),Zi.BottomSide=Ci=$i(new Zi(0,0,1,8),1).ca(),Zi.TopBottomSides=Ti=$i(new Zi(0,0,1,9),1).ca(),Zi.LeftRightSides=Li=$i(new Zi(0,0,1,6),1).ca(),Zi.TopLeftSides=Ai=$i(new Zi(0,0,1,3),1).ca(),Zi.TopRightSides=ji=$i(new Zi(0,0,1,5),1).ca(),Zi.BottomLeftSides=Di=$i(new Zi(0,0,1,10),1).ca(),Zi.BottomRightSides=Fi=$i(new Zi(0,0,1,12),1).ca(),Zi.NotTopSide=Oi=$i(new Zi(0,0,1,14),1).ca(),Zi.NotLeftSide=Bi=$i(new Zi(0,0,1,13),1).ca(),Zi.NotRightSide=Ii=$i(new Zi(0,0,1,11),1).ca(),Zi.NotBottomSide=Ri=$i(new Zi(0,0,1,7),1).ca(),Zi.AllSides=Ei=$i(new Zi(0,0,1,15),1).ca(),Hi=new Zi(.156,.156).ca(),Wi=new Zi(.844,.844).ca(),Zi.parse=Qi,Zi.stringify=_i,ie.prototype.set=function(a){return this.m11=a.m11,this.m12=a.m12,this.m21=a.m21,this.m22=a.m22,this.dx=a.dx,this.dy=a.dy,this},ie.prototype.copy=function(){var a=new ie;return a.m11=this.m11,a.m12=this.m12,a.m21=this.m21,a.m22=this.m22,a.dx=this.dx,a.dy=this.dy,a},(n=ie.prototype).toString=function(){return"Transform("+this.m11+","+this.m12+","+this.m21+","+this.m22+","+this.dx+","+this.dy+")"},n.w=function(a){return this.m11===a.m11&&this.m12===a.m12&&this.m21===a.m21&&this.m22===a.m22&&this.dx===a.dx&&this.dy===a.dy},n.ut=function(){return 0===this.dx&&0===this.dy&&1===this.m11&&0===this.m12&&0===this.m21&&1===this.m22},n.reset=function(){return this.m11=1,this.m21=this.m12=0,this.m22=1,this.dy=this.dx=0,this},n.multiply=function(a){var b=this.m11*a.m11+this.m21*a.m12,t=this.m12*a.m11+this.m22*a.m12,e=this.m11*a.m21+this.m21*a.m22,n=this.m12*a.m21+this.m22*a.m22;return this.dx=this.m11*a.dx+this.m21*a.dy+this.dx,this.dy=this.m12*a.dx+this.m22*a.dy+this.dy,this.m11=b,this.m12=t,this.m21=e,this.m22=n,this},n.Mv=function(a){var b=1/(a.m11*a.m22-a.m12*a.m21),t=a.m22*b,e=-a.m12*b,n=-a.m21*b,o=a.m11*b,g=b*(a.m21*a.dy-a.m22*a.dx);return a=b*(a.m12*a.dx-a.m11*a.dy),b=this.m11*t+this.m21*e,t=this.m12*t+this.m22*e,e=this.m11*n+this.m21*o,n=this.m12*n+this.m22*o,this.dx=this.m11*g+this.m21*a+this.dx,this.dy=this.m12*g+this.m22*a+this.dy,this.m11=b,this.m12=t,this.m21=e,this.m22=n,this},n.tt=function(){var a=1/(this.m11*this.m22-this.m12*this.m21),b=-this.m12*a,t=-this.m21*a,e=this.m11*a,n=a*(this.m21*this.dy-this.m22*this.dx),o=a*(this.m12*this.dx-this.m11*this.dy);return this.m11=this.m22*a,this.m12=b,this.m21=t,this.m22=e,this.dx=n,this.dy=o,this},ie.prototype.rotate=function(a,b,t){if(360<=a?a-=360:0>a&&(a+=360),0===a)return this;if(this.translate(b,t),90===a){a=0;var e=1}else 180===a?(a=-1,e=0):270===a?(a=0,e=-1):(e=a*Math.PI/180,a=Math.cos(e),e=Math.sin(e));var n=this.m12*a+this.m22*e,o=this.m11*-e+this.m21*a,g=this.m12*-e+this.m22*a;return this.m11=this.m11*a+this.m21*e,this.m12=n,this.m21=o,this.m22=g,this.translate(-b,-t),this},(n=ie.prototype).translate=function(a,b){return this.dx+=this.m11*a+this.m21*b,this.dy+=this.m12*a+this.m22*b,this},n.scale=function(a,b){return void 0===b&&(b=a),this.m11*=a,this.m12*=a,this.m21*=b,this.m22*=b,this},n.ra=function(a){var b=a.x,t=a.y;return a.h(b*this.m11+t*this.m21+this.dx,b*this.m12+t*this.m22+this.dy)},n.Wd=function(a){var b=1/(this.m11*this.m22-this.m12*this.m21),t=a.x,e=a.y;return a.h(t*this.m22*b+e*-this.m21*b+b*(this.m21*this.dy-this.m22*this.dx),t*-this.m12*b+e*this.m11*b+b*(this.m12*this.dx-this.m11*this.dy))},n.qw=function(a){var b=a.x,t=a.y,e=b+a.width,n=t+a.height,o=this.m11,g=this.m12,r=this.m21,h=this.m22,l=this.dx,c=this.dy,f=b*o+t*r+l,p=b*g+t*h+c,d=e*o+t*r+l,q=e*g+t*h+c;return t=b*o+n*r+l,b=b*g+n*h+c,o=e*o+n*r+l,e=e*g+n*h+c,n=Math.min(f,d),f=Math.max(f,d),d=Math.min(p,q),p=Math.max(p,q),n=Math.min(n,t),f=Math.max(f,t),d=Math.min(d,b),p=Math.max(p,b),n=Math.min(n,o),f=Math.max(f,o),d=Math.min(d,e),p=Math.max(p,e),a.h(n,d,f-n,p-d),a},ie.alloc=function(){var a=ee.pop();return void 0===a?new ie:a},ie.free=function(a){ee.push(a)},ie.prototype.transformRect=ie.prototype.qw,ie.prototype.invertedTransformPoint=ie.prototype.Wd,ie.prototype.transformPoint=ie.prototype.ra,ie.prototype.scale=ie.prototype.scale,ie.prototype.translate=ie.prototype.translate,ie.prototype.rotate=ie.prototype.rotate,ie.prototype.invert=ie.prototype.tt,ie.prototype.multiplyInverted=ie.prototype.Mv,ie.prototype.multiply=ie.prototype.multiply,ie.prototype.reset=ie.prototype.reset,ie.prototype.isIdentity=ie.prototype.ut,ie.prototype.equals=ie.prototype.w,ie.prototype.set=ie.prototype.set;var ee=[];ie.className="Transform",ie.xF="54a702f3e53909c447824c6706603faf4c";var ne={DA:"7da71ca0ad381e90",Ig:(Math.sqrt(2)-1)/3*4,Hw:null,sqrt:function(a){if(0>=a)return 0;var b=ne.Hw;if(null===b){b=[];for(var t=0;2e3>=t;t++)b[t]=Math.sqrt(t);ne.Hw=b}return 1>a?2e3>=(t=1/a)?1/b[0|t]:Math.sqrt(a):2e3>=a?b[0|a]:Math.sqrt(a)},A:function(a,b){return.5>(a-=b)&&-.5<a},$:function(a,b){return 5e-8>(a-=b)&&-5e-8<a},Nb:function(a,b,t,e,n,o,g){if(0>=n&&(n=1e-6),a<t)var r=a,h=t;else r=t,h=a;if(b<e)var l=b,c=e;else l=e,c=b;if(a===t)return l<=g&&g<=c&&a-n<=o&&o<=a+n;if(b===e)return r<=o&&o<=h&&b-n<=g&&g<=b+n;if(h+=n,(r-=n)<=o&&o<=h&&(c+=n,(l-=n)<=g&&g<=c))if(h-r>c-l){if(!(a-t>n||t-a>n))return!0;if((o=(e-b)/(t-a)*(o-a)+b)-n<=g&&g<=o+n)return!0}else{if(!(b-e>n||e-b>n))return!0;if((g=(t-a)/(e-b)*(g-b)+a)-n<=o&&o<=g+n)return!0}return!1},at:function(a,b,t,e,n,o,g,r,h,l,c,f){if(ne.Nb(a,b,g,r,f,t,e)&&ne.Nb(a,b,g,r,f,n,o))return ne.Nb(a,b,g,r,f,l,c);var p=(a+t)/2,d=(b+e)/2,q=(t+n)/2,u=(e+o)/2,y=((e=(p+q)/2)+(q=(q+(n=(n+g)/2))/2))/2,m=((t=(d+u)/2)+(u=(u+(o=(o+r)/2))/2))/2;return ne.at(a,b,p,d,e,t,y,m,h,l,c,f)||ne.at(y,m,q,u,n,o,g,r,h,l,c,f)},Qy:function(a,b,t,e,n,o,g,r,h){var l=(t+n)/2,c=(e+o)/2;return h.h((((a+t)/2+l)/2+(l+(n+g)/2)/2)/2,(((b+e)/2+c)/2+(c+(o+r)/2)/2)/2),h},Py:function(a,b,t,e,n,o,g,r){var h=(t+n)/2,l=(e+o)/2;return At(((a+t)/2+h)/2,((b+e)/2+l)/2,(h+(n+g)/2)/2,(l+(o+r)/2)/2)},bm:function(a,b,t,e,n,o,g,r,h,l){if(ne.Nb(a,b,g,r,h,t,e)&&ne.Nb(a,b,g,r,h,n,o))ei(l,a,b,0,0),ei(l,g,r,0,0);else{var c=(a+t)/2,f=(b+e)/2,p=(t+n)/2,d=(e+o)/2,q=((e=(c+p)/2)+(p=(p+(n=(n+g)/2))/2))/2,u=((t=(f+d)/2)+(d=(d+(o=(o+r)/2))/2))/2;ne.bm(a,b,c,f,e,t,q,u,h,l),ne.bm(q,u,p,d,n,o,g,r,h,l)}return l},ze:function(a,b,t,e,n,o,g,r,h,l){if(ne.Nb(a,b,g,r,h,t,e)&&ne.Nb(a,b,g,r,h,n,o))0===l.length&&(l.push(a),l.push(b)),l.push(g),l.push(r);else{var c=(a+t)/2,f=(b+e)/2,p=(t+n)/2,d=(e+o)/2,q=((e=(c+p)/2)+(p=(p+(n=(n+g)/2))/2))/2,u=((t=(f+d)/2)+(d=(d+(o=(o+r)/2))/2))/2;ne.ze(a,b,c,f,e,t,q,u,h,l),ne.ze(q,u,p,d,n,o,g,r,h,l)}return l},Tv:function(a,b,t,e,n,o,g,r,h,l){if(ne.Nb(a,b,n,o,l,t,e))return ne.Nb(a,b,n,o,l,r,h);var c=(a+t)/2,f=(b+e)/2,p=(c+(t=(t+n)/2))/2,d=(f+(e=(e+o)/2))/2;return ne.Tv(a,b,c,f,p,d,g,r,h,l)||ne.Tv(p,d,t,e,n,o,g,r,h,l)},JA:function(a,b,t,e,n,o,g){return g.h(((a+t)/2+(t+n)/2)/2,((b+e)/2+(e+o)/2)/2),g},Sv:function(a,b,t,e,n,o,g,r){if(ne.Nb(a,b,n,o,g,t,e))ei(r,a,b,0,0),ei(r,n,o,0,0);else{var h=(a+t)/2,l=(b+e)/2,c=(h+(t=(t+n)/2))/2,f=(l+(e=(e+o)/2))/2;ne.Sv(a,b,h,l,c,f,g,r),ne.Sv(c,f,t,e,n,o,g,r)}return r},Cq:function(a,b,t,e,n,o,g,r){if(ne.Nb(a,b,n,o,g,t,e))0===r.length&&(r.push(a),r.push(b)),r.push(n),r.push(o);else{var h=(a+t)/2,l=(b+e)/2,c=(h+(t=(t+n)/2))/2,f=(l+(e=(e+o)/2))/2;ne.Cq(a,b,h,l,c,f,g,r),ne.Cq(c,f,t,e,n,o,g,r)}return r},eq:function(a,b,t,e,n,o,g,r,h,l,c,f,p,d){if(ne.Nb(a,b,g,r,p,t,e)&&ne.Nb(a,b,g,r,p,n,o)){var q=(a-g)*(l-f)-(b-r)*(h-c);if(0===q)return!1;if(p=((a*r-b*g)*(h-c)-(a-g)*(h*f-l*c))/q,q=((a*r-b*g)*(l-f)-(b-r)*(h*f-l*c))/q,(h>c?h-c:c-h)<(l>f?l-f:f-l)){if(b<r?g=b:(g=r,r=b),q<g||q>r)return!1}else if(a<g?r=a:(r=g,g=a),p<r||p>g)return!1;return d.h(p,q),!0}var u=(b+e)/2,y=((q=(a+t)/2)+(t=(t+n)/2))/2,m=(u+(e=(e+o)/2))/2,v=(y+(t=(t+(n=(n+g)/2))/2))/2,x=(m+(e=(e+(o=(o+r)/2))/2))/2,w=(c-h)*(c-h)+(f-l)*(f-l),k=!1;return ne.eq(a,b,q,u,y,m,v,x,h,l,c,f,p,d)&&((a=(d.x-h)*(d.x-h)+(d.y-l)*(d.y-l))<w&&(w=a,k=!0)),a=d.x,b=d.y,ne.eq(v,x,t,e,n,o,g,r,h,l,c,f,p,d)&&((d.x-h)*(d.x-h)+(d.y-l)*(d.y-l)<w?k=!0:d.h(a,b)),k},fq:function(a,b,t,e,n,o,g,r,h,l,c,f,p){var d=0;if(ne.Nb(a,b,g,r,p,t,e)&&ne.Nb(a,b,g,r,p,n,o)){if(0===(p=(a-g)*(l-f)-(b-r)*(h-c)))return d;var q=((a*r-b*g)*(h-c)-(a-g)*(h*f-l*c))/p,u=((a*r-b*g)*(l-f)-(b-r)*(h*f-l*c))/p;if(q>=c)return d;if((h>c?h-c:c-h)<(l>f?l-f:f-l)){if(b<r?(a=b,b=r):a=r,u<a||u>b)return d}else if(a<g?(b=a,a=g):b=g,q<b||q>a)return d;0<p?d++:0>p&&d--}else{u=(b+e)/2;var y=(t+n)/2,m=(e+o)/2,v=((e=((q=(a+t)/2)+y)/2)+(y=(y+(n=(n+g)/2))/2))/2,x=((t=(u+m)/2)+(m=(m+(o=(o+r)/2))/2))/2;d+=ne.fq(a,b,q,u,e,t,v,x,h,l,c,f,p),d+=ne.fq(v,x,y,m,n,o,g,r,h,l,c,f,p)}return d},Lh:function(a,b,t,e,n,o,g){return ne.$(a,t)?(b<e?(t=b,b=e):t=e,o<t?(g.h(a,t),!1):o>b?(g.h(a,b),!1):(g.h(a,o),!0)):ne.$(b,e)?(a<t?(e=a,a=t):e=t,n<e?(g.h(e,b),!1):n>a?(g.h(a,b),!1):(g.h(n,b),!0)):-5e-6>(n=((a-n)*(a-t)+(b-o)*(b-e))/((t-a)*(t-a)+(e-b)*(e-b)))?(g.h(a,b),!1):1.000005<n?(g.h(t,e),!1):(g.h(a+n*(t-a),b+n*(e-b)),!0)},Ee:function(a,b,t,e,n,o,g,r,h){return ne.A(a,t)&&ne.A(b,e)?(h.h(a,b),!1):ne.$(n,g)?ne.$(a,t)?(ne.Lh(a,b,t,e,n,o,h),!1):ne.Lh(a,b,t,e,n,(e-b)/(t-a)*(n-a)+b,h):(r=(r-o)/(g-n),ne.$(a,t)?(t=r*(a-n)+o,b<e?(n=b,b=e):n=e,t<n?(h.h(a,n),!1):t>b?(h.h(a,b),!1):(h.h(a,t),!0)):(g=(e-b)/(t-a),ne.$(r,g)?(ne.Lh(a,b,t,e,n,o,h),!1):(n=(g*a-r*n+o-b)/(g-r),ne.$(g,0)?(a<t?(e=a,a=t):e=t,n<e?(h.h(e,b),!1):n>a?(h.h(a,b),!1):(h.h(n,b),!0)):ne.Lh(a,b,t,e,n,g*(n-a)+b,h))))},IA:function(a,b,t,e,n){return ne.Ee(t.x,t.y,e.x,e.y,a.x,a.y,b.x,b.y,n)},HA:function(a,b,t,e,n,o,g,r,h,l){function c(t,e){var n=(t-a)*(t-a)+(e-b)*(e-b);n<f&&(f=n,h.h(t,e))}var f=1/0;c(h.x,h.y);var p=0,d=0,q=0,u=0;if(n<g?(p=n,d=g):(p=g,d=n),o<r?(q=n,u=g):(q=g,u=n),p=(d-p)/2+l,l=(u-q)/2+l,n=(n+g)/2,o=(o+r)/2,0===p||0===l)return h;if(.5>(t>a?t-a:a-t)){if(0>(p=1-(t-n)*(t-n)/(p*p)))return h;e=-l*(p=Math.sqrt(p))+o,c(t,l*p+o),c(t,e)}else{if(0>(p=(r=2*(t=(e-b)/(t-a))*(b-t*a)/(l*l)-2*t*o/(l*l)-2*n/(p*p))*r-4*(e=1/(p*p)+t*t/(l*l))*(2*t*a*o/(l*l)-2*b*o/(l*l)+o*o/(l*l)+n*n/(p*p)-1+(b-t*a)*(b-t*a)/(l*l))))return h;c(l=(-r+(p=Math.sqrt(p)))/(2*e),t*l-t*a+b),c(p=(-r-p)/(2*e),t*p-t*a+b)}return h},Uc:function(a,b,t,e,n,o,g,r,h){var l=1e21,c=a,f=b;if(ne.Ee(a,b,a,e,n,o,g,r,h)){var p=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o);p<l&&(l=p,c=h.x,f=h.y)}return ne.Ee(t,b,t,e,n,o,g,r,h)&&((p=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o))<l&&(l=p,c=h.x,f=h.y)),ne.Ee(a,b,t,b,n,o,g,r,h)&&((b=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o))<l&&(l=b,c=h.x,f=h.y)),ne.Ee(a,e,t,e,n,o,g,r,h)&&((a=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o))<l&&(l=a,c=h.x,f=h.y)),h.h(c,f),1e21>l},GA:function(a,b,t,e,n,o,g,r,h){return g=n-g,0===(t=a-t)||0===g?0===t?n=(b=(o-r)/g)*(r=a)+(o-b*n):n=(o=(b-e)/t)*(r=n)+(b-o*a):n=(e=(b-e)/t)*(r=(o-(r=(o-r)/g)*n-(a=b-e*a))/(e-r))+a,h.h(r,n),h},rt:function(a,b,t){return ne.Rx(a.x,a.y,a.width,a.height,b.x,b.y,t.x,t.y)},Rx:function(a,b,t,e,n,o,g,r){var h=a+t,l=b+e;return n===g?(o<r?(g=o,o=r):g=r,a<=n&&n<=h&&g<=l&&o>=b):o===r?(n<g?(r=n,n=g):r=g,b<=o&&o<=l&&r<=h&&n>=a):!!(ni(a,b,t,e,n,o)||ni(a,b,t,e,g,r)||ne.sq(a,b,h,b,n,o,g,r)||ne.sq(h,b,h,l,n,o,g,r)||ne.sq(h,l,a,l,n,o,g,r)||ne.sq(a,l,a,b,n,o,g,r))},sq:function(a,b,t,e,n,o,g,r){return 0>=ne.dt(a,b,t,e,n,o)*ne.dt(a,b,t,e,g,r)&&0>=ne.dt(n,o,g,r,a,b)*ne.dt(n,o,g,r,t,e)},dt:function(a,b,t,e,n,o){return t-=a,0===(o=(a=n-a)*(e-=b)-(b=o-b)*t)&&(0<(o=a*t+b*e)&&(0>(o=(a-t)*t+(b-e)*e)&&(o=0))),0>o?-1:0<o?1:0},zq:function(a){return 0>a&&(a+=360),360<=a&&(a-=360),a},Cx:function(a,b,t,e,n,o){var g=Math.PI;o||(e*=g/180,n*=g/180);var r=e>n?-1:1;o=[];var h=g/2,l=e;if(1e-5>(e=Math.min(2*g,Math.abs(n-e))))return h=l+r*Math.min(e,h),r=a+t*Math.cos(l),l=b+t*Math.sin(l),a+=t*Math.cos(h),b+=t*Math.sin(h),t=(r+a)/2,h=(l+b)/2,o.push([r,l,t,h,t,h,a,b]),o;for(;1e-5<e;)n=l+r*Math.min(e,h),o.push(ne.Xy(t,l,n,a,b)),e-=Math.abs(n-l),l=n;return o},Xy:function(a,b,t,e,n){var o=(t-b)/2,g=a*Math.cos(o),r=a*Math.sin(o),h=-r,l=g*g+h*h,c=l+g*g+h*r;return r=g-(l=4/3*(Math.sqrt(2*l*c)-c)/(g*r-h*g))*h,h=-(g=h+l*g),l=o+b,o=Math.cos(l),l=Math.sin(l),[e+a*Math.cos(b),n+a*Math.sin(b),e+r*o-g*l,n+r*l+g*o,e+r*o-h*l,n+r*l+h*o,e+a*Math.cos(t),n+a*Math.sin(t)]},mq:function(a,b,t,e,n,o,g){var r=t=Math.floor((a-t)/n)*n+t;return t+n-a<n/2&&(r=t+n),a=e=Math.floor((b-e)/o)*o+e,e+o-b<o/2&&(a=e+o),g.h(r,a),g},Nx:function(a,b){var t,e=Math.max(a,b);a=Math.min(a,b);do{b=e%a,e=t=a,a=b}while(0<b);return t},bz:function(a,b,t,e){var n=0>t,o=0>e;if(a<b)var g=1,r=0;else g=0,r=1;var h=0===g?a:b,l=0===g?t:e;return(0===g?n:o)&&(l=-l),t=0===(g=r)?t:e,(0===g?n:o)&&(t=-t),ne.cz(h,0===g?a:b,l,t,0,0)},cz:function(a,b,t,e,n,o){if(0<e)if(0<t){n=a*a,a*=t;var g=b*e,r=-(o=b*b)+g,h=-o+Math.sqrt(a*a+g*g);b=r;for(var l=0;9999999999>l&&((b=.5*(r+h))!==r&&b!==h);++l){var c=a/(b+n),f=g/(b+o);if(0<(c=c*c+f*f-1))r=b;else{if(!(0>c))break;h=b}}t=n*t/(b+n)-t,e=o*e/(b+o)-e,t=Math.sqrt(t*t+e*e)}else t=Math.abs(e-b);else(o=a*t)<(e=a*a-b*b)?(e=o/e,o=b*Math.sqrt(Math.abs(1-e*e)),t=a*e-t,t=Math.sqrt(t*t+o*o)):t=Math.abs(t-a);return t},Ke:new et,Nm:new et,Ff:new et,Gf:0};function oe(a){ft(this),this.s=!1,void 0===a&&(a=td),this.pa=a,this.mc=this.ec=this.Sc=this.Rc=0,this.rj=new lt,this.Dr=this.rj.Aa,this.kr=(new Wt).freeze(),this.qa=!0,this.Tm=this.Gk=null,this.Um=NaN,this.jf=gi,this.kf=Mi,this.jl=this.kl=NaN,this.Qf=es}function re(a,b){return a.type===ge&&b.type===td&&!!(1===b.figures.count&&(b=b.figures.L(0),1===b.segments.count&&ne.A(a.startX,b.startX)&&ne.A(a.startY,b.startY)&&(b=b.segments.L(0),b.type===Me&&ne.A(a.endX,b.endX)&&ne.A(a.endY,b.endY))))}function se(a){return a.toString()}function ae(a,b){function t(){return u>=w-1||null!==h[u+1].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/)}function e(){return u++,h[u]}function n(){var a=new Mt(parseFloat(e()),parseFloat(e()));return y===y.toLowerCase()&&(a.x=x.x+a.x,a.y=x.y+a.y),a}function o(){return x=n()}function g(){return v=n()}function r(){var a=m.toLowerCase();return"c"!==a&&"s"!==a&&"q"!==a&&"t"!==a?x:new Mt(2*x.x-v.x,2*x.y-v.y)}void 0===b&&(b=!1);var h=(a=(a=(a=(a=(a=(a=(a=(a=(a=a.replace(/,/gm," ")).replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm,"$1 $2")).replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm,"$1 $2")).replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([^\s])/gm,"$1 $2")).replace(/([^\s])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2")).replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ")).replace(/[\s\r\t\n]+/gm," ")).replace(/^\s+|\s+$/g,"")).split(" ");for(a=0;a<h.length;a++){var l=h[a];if(null!==l.match(/(\.[0-9]*)(\.)/gm)){for(var c=I(),f="",p=!1,d=0;d<l.length;d++){var q=l[d];"."!==q||p?"."===q?(c.push(f),f="."):f+=q:(p=!0,f+=q)}for(c.push(f),h.splice(a,1),l=0;l<c.length;l++)h.splice(a+l,0,c[l]);a+=c.length-1,R(c)}}var u=-1,y="",m="";c=new Mt(0,0);var v=new Mt(0,0),x=new Mt(0,0),w=h.length;for(a=su(null),f=l=!1,p=!0,d=null;!(u>=w-1);)if(m=y,""!==(y=e()))switch(y.toUpperCase()){case"X":p=!0,f=l=!1;break;case"M":for(d=o(),null===a.fc||!0===p?(iu(a,d.x,d.y,l,!f),p=!1):a.moveTo(d.x,d.y),c=x;!t();)d=o(),a.lineTo(d.x,d.y);break;case"L":for(;!t();)d=o(),a.lineTo(d.x,d.y);break;case"H":for(;!t();)x=new Mt((y===y.toLowerCase()?x.x:0)+parseFloat(e()),x.y),a.lineTo(x.x,x.y);break;case"V":for(;!t();)x=new Mt(x.x,(y===y.toLowerCase()?x.y:0)+parseFloat(e())),a.lineTo(x.x,x.y);break;case"C":for(;!t();){d=n(),q=g();var k=o();nu(a,d.x,d.y,q.x,q.y,k.x,k.y)}break;case"S":for(;!t();)d=r(),q=g(),k=o(),nu(a,d.x,d.y,q.x,q.y,k.x,k.y);break;case"Q":for(;!t();)d=g(),q=o(),ou(a,d.x,d.y,q.x,q.y);break;case"T":for(;!t();)v=d=r(),q=o(),ou(a,d.x,d.y,q.x,q.y);break;case"B":for(;!t();){d=parseFloat(e()),q=parseFloat(e()),k=parseFloat(e());var M=parseFloat(e()),S=parseFloat(e()),P=S,N=!1;t()||(P=parseFloat(e()),t()||(N=0!==parseFloat(e()))),y===y.toLowerCase()&&(k+=x.x,M+=x.y),a.arcTo(d,q,k,M,S,P,N)}break;case"A":for(;!t();)ru(a,d=Math.abs(parseFloat(e())),q=Math.abs(parseFloat(e())),k=parseFloat(e()),M=!!parseFloat(e()),S=!!parseFloat(e()),(P=o()).x,P.y);break;case"Z":eu(a),x=c;break;case"F":for(d="",q=1;h[u+q];)if(null!==h[u+q].match(/[Uu]/))q++;else{if(null!==h[u+q].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/)){d=h[u+q];break}q++}d.match(/[Mm]/)?l=!0:0<a.fc.segments.length&&(a.fc.isFilled=!0);break;case"U":for(d="",q=1;h[u+q];)if(null!==h[u+q].match(/[Ff]/))q++;else{if(null!==h[u+q].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/)){d=h[u+q];break}q++}d.match(/[Mm]/)?f=!0:a.Lq(!1)}if(c=a.mt,au=a,b)for(b=c.figures.iterator;b.next();)b.value.isFilled=!0;return c}function he(a,b){for(var t=a.length,e=Mt.alloc(),n=0;n<t;n++){var o=a[n];e.x=o[0],e.y=o[1],b.ra(e),o[0]=e.x,o[1]=e.y,e.x=o[2],e.y=o[3],b.ra(e),o[2]=e.x,o[3]=e.y,e.x=o[4],e.y=o[5],b.ra(e),o[4]=e.x,o[5]=e.y,e.x=o[6],e.y=o[7],b.ra(e),o[6]=e.x,o[7]=e.y}Mt.free(e)}function le(a,b,t){switch(a.type){case ge:case ye:case me:t?b.h(a.Rc,a.Sc,0,0):ei(b,a.Rc,a.Sc,0,0),ei(b,a.ec,a.mc,0,0);break;case td:var e=a.figures;a=e.j,e=e.length;for(var n=0;n<e;n++){var o=a[n];t&&0===n?b.h(o.startX,o.startY,0,0):ei(b,o.startX,o.startY,0,0);for(var g=o.segments.j,r=g.length,h=o.startX,l=o.startY,c=0;c<r;c++){var f=g[c];switch(f.type){case Me:case ke:ei(b,h=f.endX,l=f.endY,0,0);break;case Se:ne.bm(h,l,f.point1X,f.point1Y,f.point2X,f.point2Y,f.endX,f.endY,.5,b),h=f.endX,l=f.endY;break;case Pe:ne.Sv(h,l,f.point1X,f.point1Y,f.endX,f.endY,.5,b),h=f.endX,l=f.endY;break;case Ne:case Ce:var p=f.type===Ne?be(f,o):we(f,o,h,l),d=p.length;if(0===d){ei(b,h=f.centerX,l=f.centerY,0,0);break}f=null;for(var q=0;q<d;q++)f=p[q],ne.bm(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],.5,b);null!==f&&(h=f[6],l=f[7]);break;default:N("Unknown Segment type: "+f.type)}}}break;default:N("Unknown Geometry type: "+a.type)}}function ue(a,b,t,e,n){var o=b.x;b=b.y;for(var r,h,l,c,g=a.bounds.x-20,f=0,p=a.figures.j,d=p.length,q=0;q<d;q++){var u=p[q];if(u.isFilled){if(e&&u.aa(o,b,t))return!0;for(var y=u.segments,m=r=u.startX,v=h=u.startY,x=y.j,w=0;w<=y.length;w++){var k=void 0;if(w!==y.length){var M=(k=x[w]).type;a=k.endX,c=k.endY}else M=Me,a=m,c=v;switch(M){case ke:if(m=ce(o,b,g,b,r,h,m,v),isNaN(m))return!0;f+=m,m=a,v=c;break;case Me:if(r=ce(o,b,g,b,r,h,a,c),isNaN(r))return!0;f+=r;break;case Se:f+=l=ne.fq(r,h,k.point1X,k.point1Y,k.point2X,k.point2Y,a,c,g,b,o,b,.5);break;case Pe:f+=l=ne.fq(r,h,(r+2*k.point1X)/3,(h+2*k.point1Y)/3,(2*k.point1X+a)/3,(2*k.point1Y+c)/3,a,c,g,b,o,b,.5);break;case Ne:case Ce:var S=(M=k.type===Ne?be(k,u):we(k,u,r,h)).length;if(0===S){if(r=ce(o,b,g,b,r,h,k.centerX,k.centerY),isNaN(r))return!0;f+=r;break}k=null;for(var P=0;P<S;P++){if(k=M[P],0===P){if(l=ce(o,b,g,b,r,h,k[0],k[1]),isNaN(l))return!0;f+=l}f+=l=ne.fq(k[0],k[1],k[2],k[3],k[4],k[5],k[6],k[7],g,b,o,b,.5)}null!==k&&(a=k[6],c=k[7]);break;default:N("Unknown Segment type: "+k.type)}r=a,h=c}if(0!==f)return!0;f=0}else if(u.aa(o,b,n?t:t+2))return!0}return 0!==f}function ce(a,b,t,e,n,o,g,r){if(ne.Nb(n,o,g,r,.05,a,b))return NaN;var h=(a-t)*(o-r);if(0===h)return 0;var l=((a*e-b*t)*(n-g)-(a-t)*(n*r-o*g))/h;if(b=(a*e-b*t)*(o-r)/h,l>=a)return 0;if((n>g?n-g:g-n)<(o>r?o-r:r-o)){if(o<r){if(b<o||b>r)return 0}else if(b<r||b>o)return 0}else if(n<g){if(l<n||l>g)return 0}else if(l<g||l>n)return 0;return 0<h?1:-1}function fe(a,b,t,e){for(var n=(a=a.figures.j).length,o=0;o<n;o++)if(a[o].aa(b,t,e))return!0;return!1}function de(a){if(null===a.Gk){var b=a.Gk=[],t=a.Tm=[],e=[],n=[];if(a.type===ge)e.push(a.startX),e.push(a.startY),e.push(a.endX),e.push(a.endY),b.push(e),n.push(Math.sqrt((a.startX-a.endX)*(a.startX-a.endX)+(a.startY-a.endY)*(a.startY-a.endY))),t.push(n);else if(a.type===ye)e.push(a.startX),e.push(a.startY),e.push(a.endX),e.push(a.startY),e.push(a.endX),e.push(a.endY),e.push(a.startX),e.push(a.endY),e.push(a.startX),e.push(a.startY),b.push(e),n.push(Math.abs(a.startX-a.endX)),n.push(Math.abs(a.startY-a.endY)),n.push(Math.abs(a.startX-a.endX)),n.push(Math.abs(a.startY-a.endY)),t.push(n);else if(a.type===me){var o=new ve;o.startX=a.endX,o.startY=(a.startY+a.endY)/2;var g=new xe(Ne);if(g.startAngle=0,g.sweepAngle=360,g.centerX=(a.startX+a.endX)/2,g.centerY=(a.startY+a.endY)/2,g.radiusX=Math.abs(a.startX-a.endX)/2,g.radiusY=Math.abs(a.startY-a.endY)/2,o.add(g),0===(n=(a=be(g,o)).length))e.push(g.centerX),e.push(g.centerY);else{g=o.startX,o=o.startY;for(var r=0;r<n;r++){var h=a[r];ne.ze(g,o,h[2],h[3],h[4],h[5],h[6],h[7],.5,e),g=h[6],o=h[7]}}b.push(e),t.push(pe(e))}else for(a=a.figures.iterator;a.next();){n=a.value,(e=[]).push(n.startX),e.push(n.startY),r=g=n.startX,h=o=n.startY;for(var l=n.segments.j,c=l.length,f=0;f<c;f++){var p=l[f];switch(p.type){case ke:4<=e.length&&(b.push(e),t.push(pe(e))),(e=[]).push(p.endX),e.push(p.endY),r=g=p.endX,h=o=p.endY;break;case Me:e.push(p.endX),e.push(p.endY),g=p.endX,o=p.endY;break;case Se:ne.ze(g,o,p.point1X,p.point1Y,p.point2X,p.point2Y,p.endX,p.endY,.5,e),g=p.endX,o=p.endY;break;case Pe:ne.Cq(g,o,p.point1X,p.point1Y,p.endX,p.endY,.5,e),g=p.endX,o=p.endY;break;case Ne:var d=be(p,n),q=d.length;if(0===q){e.push(p.centerX),e.push(p.centerY),g=p.centerX,o=p.centerY;break}for(var u=0;u<q;u++){var y=d[u];ne.ze(g,o,y[2],y[3],y[4],y[5],y[6],y[7],.5,e),g=y[6],o=y[7]}break;case Ce:if(0===(q=(d=we(p,n,g,o)).length)){e.push(p.centerX),e.push(p.centerY),g=p.centerX,o=p.centerY;break}for(u=0;u<q;u++)y=d[u],ne.ze(g,o,y[2],y[3],y[4],y[5],y[6],y[7],.5,e),g=y[6],o=y[7];break;default:N("Segment not of valid type: "+p.type)}p.isClosed&&(e.push(r),e.push(h))}4<=e.length&&(b.push(e),t.push(pe(e)))}}}function pe(a){for(var b=[],t=0,e=0,n=a.length,o=0;o<n;o+=2){var g=a[o],r=a[o+1];0!==o&&b.push(Math.sqrt(Lt(t,e,g,r))),t=g,e=r}return b}ne.za=ne.DA,oe.prototype.copy=function(){var a=new oe;a.pa=this.pa,a.Rc=this.Rc,a.Sc=this.Sc,a.ec=this.ec,a.mc=this.mc;for(var b=this.rj.j,t=b.length,e=a.rj,n=0;n<t;n++){var o=b[n].copy();e.add(o)}return a.Dr=this.Dr,a.kr.assign(this.kr),a.qa=this.qa,a.Gk=this.Gk,a.Tm=this.Tm,a.Um=this.Um,a.jf=this.jf.G(),a.kf=this.kf.G(),a.kl=this.kl,a.jl=this.jl,a.Qf=this.Qf,a},(n=oe.prototype).ca=function(){return this.freeze(),Object.freeze(this),this},n.freeze=function(){this.s=!0;var a=this.figures;a.freeze();for(var b=(a=a.j).length,t=0;t<b;t++)a[t].freeze();return this},n.ea=function(){Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1;var a=this.figures;a.ea();for(var b=(a=a.j).length,t=0;t<b;t++)a[t].ea();return this},n.Ma=function(a){if(!(a instanceof oe))return!1;if(this.type!==a.type)return this.type===ge&&a.type===td?re(this,a):a.type===ge&&this.type===td&&re(a,this);if(this.type===td){var b=this.figures.j;a=a.figures.j;var t=b.length;if(t!==a.length)return!1;for(var e=0;e<t;e++)if(!b[e].Ma(a[e]))return!1;return!0}return ne.A(this.startX,a.startX)&&ne.A(this.startY,a.startY)&&ne.A(this.endX,a.endX)&&ne.A(this.endY,a.endY)},n.cb=function(a){a.classType===oe&&(this.type=a)},n.toString=function(a){switch(void 0===a&&(a=-1),this.type){case ge:return 0>a?"M"+this.startX.toString()+" "+this.startY.toString()+"L"+this.endX.toString()+" "+this.endY.toString():"M"+this.startX.toFixed(a)+" "+this.startY.toFixed(a)+"L"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);case ye:var b=new Wt(this.startX,this.startY,0,0);return b.rw(this.endX,this.endY,0,0),0>a?"M"+b.x.toString()+" "+b.y.toString()+"H"+b.right.toString()+"V"+b.bottom.toString()+"H"+b.left.toString()+"z":"M"+b.x.toFixed(a)+" "+b.y.toFixed(a)+"H"+b.right.toFixed(a)+"V"+b.bottom.toFixed(a)+"H"+b.left.toFixed(a)+"z";case me:if((b=new Wt(this.startX,this.startY,0,0)).rw(this.endX,this.endY,0,0),0>a)return"M"+(a=b.left.toString()+" "+(b.y+b.height/2).toString())+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+b.right.toString()+" "+(b.y+b.height/2).toString()+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+a;var t=b.left.toFixed(a)+" "+(b.y+b.height/2).toFixed(a);return"M"+t+"A"+(b.width/2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+b.right.toFixed(a)+" "+(b.y+b.height/2).toFixed(a)+"A"+(b.width/2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+t;case td:b="";for(var e=(t=this.figures.j).length,n=0;n<e;n++){var o=t[n];0<n&&(b+=" x "),o.isFilled&&(b+="F "),b+=o.toString(a)}return b;default:return this.type.toString()}},n.Jv=function(){if(this.qa||this.Dr!==this.figures.Aa)return!0;for(var a=this.figures.j,b=a.length,t=0;t<b;t++)if(a[t].Jv())return!0;return!1},oe.prototype.computeBounds=function(){this.qa=!1,this.Tm=this.Gk=null,this.Um=NaN,this.Dr=this.figures.Aa;for(var a=this.figures.j,b=a.length,t=0;t<b;t++){var e=a[t];e.qa=!1;var n=e.segments;e.Is=n.Aa,n=(e=n.j).length;for(var o=0;o<n;o++){var g=e[o];g.qa=!1,g.Me=null}}(a=this.kr).ea(),isNaN(this.kl)||isNaN(this.jl)?a.h(0,0,0,0):a.h(0,0,this.kl,this.jl),le(this,a,!1),ei(a,0,0,0,0),a.freeze()},oe.prototype.Bx=function(){var a=new Wt;return le(this,a,!0),a},oe.prototype.normalize=function(){this.s&&C(this);var a=this.Bx();return this.offset(-a.x,-a.y),new Mt(-a.x,-a.y)},oe.prototype.offset=function(a,b){return this.s&&C(this),this.transform(1,0,0,1,a,b),this},oe.prototype.scale=function(a,b){return this.s&&C(this),this.transform(a,0,0,b,0,0),this},oe.prototype.rotate=function(a,b,t){this.s&&C(this),void 0===b&&(b=0),void 0===t&&(t=0);var e=ie.alloc();return e.reset(),e.rotate(a,b,t),this.transform(e.m11,e.m12,e.m21,e.m22,e.dx,e.dy),ie.free(e),this},(n=oe.prototype).transform=function(a,b,t,e,n,o){switch(this.type){case ge:case ye:case me:var g=this.Rc,r=this.Sc;this.Rc=g*a+r*t+n,this.Sc=g*b+r*e+o,g=this.ec,r=this.mc,this.ec=g*a+r*t+n,this.mc=g*b+r*e+o;break;case td:for(var h=this.figures.j,l=h.length,c=0;c<l;c++){var f=h[c];g=f.startX,r=f.startY,f.startX=g*a+r*t+n,f.startY=g*b+r*e+o;for(var p=(f=f.segments.j).length,d=0;d<p;d++){var q=f[d];switch(q.type){case Me:case ke:g=q.endX,r=q.endY,q.endX=g*a+r*t+n,q.endY=g*b+r*e+o;break;case Se:g=q.point1X,r=q.point1Y,q.point1X=g*a+r*t+n,q.point1Y=g*b+r*e+o,g=q.point2X,r=q.point2Y,q.point2X=g*a+r*t+n,q.point2Y=g*b+r*e+o,g=q.endX,r=q.endY,q.endX=g*a+r*t+n,q.endY=g*b+r*e+o;break;case Pe:g=q.point1X,r=q.point1Y,q.point1X=g*a+r*t+n,q.point1Y=g*b+r*e+o,g=q.endX,r=q.endY,q.endX=g*a+r*t+n,q.endY=g*b+r*e+o;break;case Ne:g=q.centerX,r=q.centerY,q.centerX=g*a+r*t+n,q.centerY=g*b+r*e+o,0!==b&&(0>(g=180*Math.atan2(b,a)/Math.PI)&&(g+=360),q.startAngle+=g),0>a&&(q.startAngle=180-q.startAngle,q.sweepAngle=-q.sweepAngle),0>e&&(q.startAngle=-q.startAngle,q.sweepAngle=-q.sweepAngle),q.radiusX*=Math.sqrt(a*a+t*t),void 0!==q.radiusY&&(q.radiusY*=Math.sqrt(b*b+e*e));break;case Ce:g=q.endX,r=q.endY,q.endX=g*a+r*t+n,q.endY=g*b+r*e+o,0!==b&&(0>(g=180*Math.atan2(b,a)/Math.PI)&&(g+=360),q.xAxisRotation+=g),0>a&&(q.xAxisRotation=180-q.xAxisRotation,q.isClockwiseArc=!q.isClockwiseArc),0>e&&(q.xAxisRotation=-q.xAxisRotation,q.isClockwiseArc=!q.isClockwiseArc),q.radiusX*=Math.sqrt(a*a+t*t),q.radiusY*=Math.sqrt(b*b+e*e);break;default:N("Unknown Segment type: "+q.type)}}}}return this.qa=!0,this},n.aa=function(a,b){void 0===b&&(b=0);var t=this.Rc,e=this.Sc,n=this.ec,o=this.mc;switch(this.type){case ge:return ne.Nb(t,e,n,o,b,a.x,a.y);case ye:var g=Wt.allocAt(Math.min(t,n)-b,Math.min(e,o)-b,Math.abs(n-t)+2*b,Math.abs(o-e)+2*b);return a=g.aa(a),Wt.free(g),a;case me:g=Math.min(t,n)-b;var r=Math.min(e,o)-b;return t=(Math.abs(n-t)+2*b)/2,b=(Math.abs(o-e)+2*b)/2,0>=t||0>=b?!1:1>=(g=a.x-(g+t))*g/(t*t)+(r=a.y-(r+b))*r/(b*b);case td:return ue(this,a,b,!0,!1);default:return!1}},n.zv=function(a,b){if(0>a?a=0:1<a&&(a=1),void 0===b&&(b=new Mt),this.type===ge)return b.h(this.startX+a*(this.endX-this.startX),this.startY+a*(this.endY-this.startY)),b;for(var t=this.flattenedSegments,e=this.flattenedLengths,n=t.length,o=this.flattenedTotalLength*a,g=0,r=0;r<n;r++){var h=e[r],l=h.length;for(a=0;a<l;a++){var c=h[a];if(g+c>=o)return e=o-g,e=0===c?0:e/c,r=(t=t[r])[2*a],n=t[2*a+1],b.h(r+(t[2*a+2]-r)*e,n+(t[2*a+3]-n)*e),b;g+=c}}return b},n.Ox=function(a){if(0>a?a=0:1<a&&(a=1),this.type===ge)return 180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI;for(var b=this.flattenedSegments,t=this.flattenedLengths,e=b.length,n=this.flattenedTotalLength*a,o=0,g=0;g<e;g++){var r=t[g],h=r.length;for(a=0;a<h;a++){var l=r[a];if(o+l>=n)return b=(n=b[g])[2*a],t=n[2*a+1],e=n[2*a+2],a=n[2*a+3],1>Math.abs(e-b)&&1>Math.abs(a-t)?0:1>Math.abs(e-b)?0<=a-t?90:270:1>Math.abs(a-t)?0<=e-b?0:180:180*Math.atan2(a-t,e-b)/Math.PI;o+=l}}return NaN},n.Av=function(a,b){if(0>a?a=0:1<a&&(a=1),void 0===b&&(b=[]),b.length=3,this.type===ge)return b[0]=this.startX+a*(this.endX-this.startX),b[1]=this.startY+a*(this.endY-this.startY),b[2]=180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI,b;for(var t=this.flattenedSegments,e=this.flattenedLengths,n=t.length,o=this.flattenedTotalLength*a,g=0,r=0;r<n;r++){var h=e[r],l=h.length;for(a=0;a<l;a++){var c=h[a];if(g+c>=o)return e=o-g,e=0===c?0:e/c,t=(c=t[r])[2*a],r=c[2*a+1],n=c[2*a+2],a=c[2*a+3],b[0]=t+(n-t)*e,b[1]=r+(a-r)*e,b[2]=1>Math.abs(n-t)&&1>Math.abs(a-r)?0:1>Math.abs(n-t)?0<=a-r?90:270:1>Math.abs(a-r)?0<=n-t?0:180:180*Math.atan2(a-r,n-t)/Math.PI,b;g+=c}}return b},n.Px=function(a){if(this.type===ge){var b=this.startX,t=this.startY,e=this.endX,n=this.endY;if(b!==e||t!==n){var o=a.x;if(a=a.y,b===e){if(t<n){var g=t;e=n}else g=n,e=t;return a<=g?g===t?0:1:a>=e?e===t?0:1:Math.abs(a-t)/(e-g)}if(t===n)return b<e?g=b:(g=e,e=b),o<=g?g===b?0:1:o>=e?e===b?0:1:Math.abs(o-b)/(e-g);g=(e-b)*(e-b)+(n-t)*(n-t);var r=Mt.alloc();return ne.Lh(b,t,e,n,o,a,r),a=r.x,o=r.y,Mt.free(r),Math.sqrt(((a-b)*(a-b)+(o-t)*(o-t))/g)}}else{if(this.type!==ye){b=this.flattenedSegments,t=this.flattenedLengths,o=this.flattenedTotalLength,e=Mt.alloc(),n=1/0,r=g=0,m=b.length;for(var h=v=0,l=0;l<m;l++)for(var p=b[l],c=t[l],q=p.length,u=0;u<q;u+=2){var f=p[u],d=p[u+1];if(0!==u){ne.Lh(v,h,f,d,a.x,a.y,e);var y=(e.x-a.x)*(e.x-a.x)+(e.y-a.y)*(e.y-a.y);y<n&&(n=y,g=r,g+=Math.sqrt((e.x-v)*(e.x-v)+(e.y-h)*(e.y-h))),r+=c[(u-2)/2]}v=f,h=d}return Mt.free(e),0>(a=g/o)?0:1<a?1:a}g=this.startX,r=this.startY;var m=this.endX;if(n=this.endY,g!==m||r!==n){o=2*(b=m-g)+2*(t=n-r),e=a.x,a=a.y,e=Math.min(Math.max(e,g),m),a=Math.min(Math.max(a,r),n),g=Math.abs(e-g),m=Math.abs(e-m),r=Math.abs(a-r),n=Math.abs(a-n);var v=Math.min(g,m,r,n);if(v===r)return e/o;if(v===m)return(b+a)/o;if(v===n)return(2*b+t-e)/o;if(v===g)return(2*b+2*t-a)/o}}return 0},n.add=function(a){return this.rj.add(a),this},n.Jm=function(a,b,t,e,n,o,g,r){return this.s&&C(this),this.jf=new Zi(a,b,n,o).freeze(),this.kf=new Zi(t,e,g,r).freeze(),this},v.Object.defineProperties(oe.prototype,{flattenedSegments:{get:function(){return de(this),this.Gk}},flattenedLengths:{get:function(){return de(this),this.Tm}},flattenedTotalLength:{get:function(){var a=this.Um;if(isNaN(a)){if(this.type===ge){a=Math.abs(this.endX-this.startX);var b=Math.abs(this.endY-this.startY);a=Math.sqrt(a*a+b*b)}else if(this.type===ye)a=2*Math.abs(this.endX-this.startX)+2*Math.abs(this.endY-this.startY);else for(var t=(b=this.flattenedLengths).length,e=a=0;e<t;e++)for(var n=b[e],o=n.length,g=0;g<o;g++)a+=n[g];this.Um=a}return a}},type:{get:function(){return this.pa},set:function(a){this.pa!==a&&(this.s&&C(this,a),this.pa=a,this.qa=!0)}},startX:{get:function(){return this.Rc},set:function(a){this.Rc!==a&&(this.s&&C(this,a),this.Rc=a,this.qa=!0)}},startY:{get:function(){return this.Sc},set:function(a){this.Sc!==a&&(this.s&&C(this,a),this.Sc=a,this.qa=!0)}},endX:{get:function(){return this.ec},set:function(a){this.ec!==a&&(this.s&&C(this,a),this.ec=a,this.qa=!0)}},endY:{get:function(){return this.mc},set:function(a){this.mc!==a&&(this.s&&C(this,a),this.mc=a,this.qa=!0)}},figures:{get:function(){return this.rj},set:function(a){this.rj!==a&&(this.s&&C(this,a),this.rj=a,this.qa=!0)}},spot1:{get:function(){return this.jf},set:function(a){this.s&&C(this,a),this.jf=a.G()}},spot2:{get:function(){return this.kf},set:function(a){this.s&&C(this,a),this.kf=a.G()}},defaultStretch:{get:function(){return this.Qf},set:function(a){this.s&&C(this,a),this.Qf=a}},bounds:{get:function(){return this.Jv()&&this.computeBounds(),this.kr}}}),oe.prototype.setSpots=oe.prototype.Jm,oe.prototype.add=oe.prototype.add,oe.prototype.getFractionForPoint=oe.prototype.Px,oe.prototype.getPointAndAngleAlongPath=oe.prototype.Av,oe.prototype.getAngleAlongPath=oe.prototype.Ox,oe.prototype.getPointAlongPath=oe.prototype.zv,oe.prototype.containsPoint=oe.prototype.aa,oe.prototype.transform=oe.prototype.transform,oe.prototype.rotate=oe.prototype.rotate,oe.prototype.scale=oe.prototype.scale,oe.prototype.offset=oe.prototype.offset,oe.prototype.normalize=oe.prototype.normalize,oe.prototype.computeBoundsWithoutOrigin=oe.prototype.Bx,oe.prototype.equalsApprox=oe.prototype.Ma;var ge=new _(oe,"Line",0),ye=new _(oe,"Rectangle",1),me=new _(oe,"Ellipse",2),td=new _(oe,"Path",3);function ve(a,b,t,e){ft(this),this.s=!1,void 0===t&&(t=!0),this.Or=t,void 0===e&&(e=!0),this.Sr=e,this.Rc=void 0!==a?a:0,this.Sc=void 0!==b?b:0,this.Kl=new lt,this.Is=this.Kl.Aa,this.qa=!0}function xe(a,b,t,e,n,o,g,r){ft(this),this.s=!1,void 0===a&&(a=Me),this.pa=a,this.ec=void 0!==b?b:0,this.mc=void 0!==t?t:0,void 0===e&&(e=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===g&&(g=0),a===Ce?(0>(a=o%360)&&(a+=360),this.ve=a,this.Di=0,this.Ei=Math.max(e,0),this.kh=Math.max(n,0),this.sl="boolean"==typeof g&&!!g,this.Kk=!!r):(this.ve=e,this.Di=n,a===Ne&&(o=Math.max(o,0)),this.Ei=o,"number"==typeof g?(a===Ne&&(g=Math.max(g,0)),this.kh=g):this.kh=0,this.Kk=this.sl=!1),this.wj=!1,this.qa=!0,this.Me=null}function be(a,b){if(null!==a.Me&&!1===b.qa)return a.Me;var t=a.radiusX,e=a.radiusY;if(void 0===e&&(e=t),0===t||0===e)return a.Me=[],a.Me;b=a.ve;var n=a.Di,o=ne.Cx(0,0,t<e?t:e,a.startAngle,a.startAngle+a.sweepAngle,!1);if(t!==e){var g=ie.alloc();g.reset(),t<e?g.scale(1,e/t):g.scale(t/e,1),he(o,g),ie.free(g)}for(t=o.length,e=0;e<t;e++)(g=o[e])[0]+=b,g[1]+=n,g[2]+=b,g[3]+=n,g[4]+=b,g[5]+=n,g[6]+=b,g[7]+=n;return a.Me=o,a.Me}function we(a,b,t,e){function n(a,b,t,e){return(a*e<b*t?-1:1)*Math.acos((a*t+b*e)/(Math.sqrt(a*a+b*b)*Math.sqrt(t*t+e*e)))}if(null!==a.Me&&!1===b.qa)return a.Me;b=a.Ei;var o=a.kh;0===b&&(b=1e-4),0===o&&(o=1e-4);var g=Math.PI/180*a.ve,r=a.sl,h=a.Kk,l=a.ec,c=a.mc,f=Math.cos(g),p=Math.sin(g),d=f*(t-l)/2+p*(e-c)/2,q=d*d/(b*b)+(g=-p*(t-l)/2+f*(e-c)/2)*g/(o*o);return 1<q&&(b*=Math.sqrt(q),o*=Math.sqrt(q)),q=(r===h?-1:1)*Math.sqrt((b*b*o*o-b*b*g*g-o*o*d*d)/(b*b*g*g+o*o*d*d)),isNaN(q)&&(q=0),r=q*b*g/o,q=q*-o*d/b,isNaN(r)&&(r=0),isNaN(q)&&(q=0),t=(t+l)/2+f*r-p*q,e=(e+c)/2+p*r+f*q,c=n(1,0,(d-r)/b,(g-q)/o),g=n(f=(d-r)/b,l=(g-q)/o,d=(-d-r)/b,r=(-g-q)/o),-1>=(d=(f*d+l*r)/(Math.sqrt(f*f+l*l)*Math.sqrt(d*d+r*r)))?g=Math.PI:1<=d&&(g=0),!h&&0<g&&(g-=2*Math.PI),h&&0>g&&(g+=2*Math.PI),h=b>o?1:b/o,d=b>o?o/b:1,b=ne.Cx(0,0,b>o?b:o,c,c+g,!0),(o=ie.alloc()).reset(),o.translate(t,e),o.rotate(a.ve,0,0),o.scale(h,d),he(b,o),ie.free(o),a.Me=b,a.Me}oe.className="Geometry",oe.stringify=se,oe.fillPath=function(a){for(var b=(a=a.split(/[Xx]/)).length,t="",e=0;e<b;e++){var n=a[e];t=null!==n.match(/[Ff]/)?0===e?t+n:t+"X"+(" "===n[0]?"":" ")+n:t+(0===e?"":"X ")+"F"+(" "===n[0]?"":" ")+n}return t},oe.parse=ae,oe.Line=ge,oe.Rectangle=ye,oe.Ellipse=me,oe.Path=td,ve.prototype.copy=function(){var a=new ve;a.Or=this.Or,a.Sr=this.Sr,a.Rc=this.Rc,a.Sc=this.Sc;for(var b=this.Kl.j,t=b.length,e=a.Kl,n=0;n<t;n++){var o=b[n].copy();e.add(o)}return a.Is=this.Is,a.qa=this.qa,a},(n=ve.prototype).Ma=function(a){if(!(a instanceof ve&&ne.A(this.startX,a.startX)&&ne.A(this.startY,a.startY)))return!1;var b=this.segments.j;a=a.segments.j;var t=b.length;if(t!==a.length)return!1;for(var e=0;e<t;e++)if(!b[e].Ma(a[e]))return!1;return!0},n.toString=function(a){void 0===a&&(a=-1);for(var b=0>a?"M"+this.startX.toString()+" "+this.startY.toString():"M"+this.startX.toFixed(a)+" "+this.startY.toFixed(a),t=this.segments.j,e=t.length,n=0;n<e;n++)b+=" "+t[n].toString(a);return b},n.freeze=function(){this.s=!0;var a=this.segments;a.freeze();var b=a.j;a=a.length;for(var t=0;t<a;t++)b[t].freeze();return this},n.ea=function(){this.s=!1;var a=this.segments;a.ea();for(var b=(a=a.j).length,t=0;t<b;t++)a[t].ea();return this},n.Jv=function(){if(this.qa)return!0;var a=this.segments;if(this.Is!==a.Aa)return!0;for(var b=(a=a.j).length,t=0;t<b;t++)if(a[t].qa)return!0;return!1},n.add=function(a){return this.Kl.add(a),this},n.aa=function(a,b,t){for(var e=this.startX,n=this.startY,o=e,g=n,r=this.segments.j,h=r.length,l=0;l<h;l++){var c=r[l];switch(c.type){case ke:o=c.endX,g=c.endY,e=c.endX,n=c.endY;break;case Me:if(ne.Nb(e,n,c.endX,c.endY,t,a,b))return!0;e=c.endX,n=c.endY;break;case Se:if(ne.at(e,n,c.point1X,c.point1Y,c.point2X,c.point2Y,c.endX,c.endY,.5,a,b,t))return!0;e=c.endX,n=c.endY;break;case Pe:if(ne.Tv(e,n,c.point1X,c.point1Y,c.endX,c.endY,.5,a,b,t))return!0;e=c.endX,n=c.endY;break;case Ne:case Ce:var f=c.type===Ne?be(c,this):we(c,this,e,n),p=f.length;if(0===p){if(ne.Nb(e,n,c.centerX,c.centerY,t,a,b))return!0;e=c.centerX,n=c.centerY;break}for(var d=null,q=0;q<p;q++)if(d=f[q],0===q&&ne.Nb(e,n,d[0],d[1],t,a,b)||ne.at(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],.5,a,b,t))return!0;null!==d&&(e=d[6],n=d[7]);break;default:N("Unknown Segment type: "+c.type)}if(c.isClosed&&(e!==o||n!==g)&&ne.Nb(e,n,o,g,t,a,b))return!0}return!1},v.Object.defineProperties(ve.prototype,{isFilled:{get:function(){return this.Or},set:function(a){this.s&&C(this,a),this.Or=a}},isShadowed:{get:function(){return this.Sr},set:function(a){this.s&&C(this,a),this.Sr=a}},startX:{get:function(){return this.Rc},set:function(a){this.s&&C(this,a),this.Rc=a,this.qa=!0}},startY:{get:function(){return this.Sc},set:function(a){this.s&&C(this,a),this.Sc=a,this.qa=!0}},segments:{get:function(){return this.Kl},set:function(a){this.s&&C(this,a),this.Kl=a,this.qa=!0}}}),ve.prototype.add=ve.prototype.add,ve.prototype.equalsApprox=ve.prototype.Ma,ve.className="PathFigure",xe.prototype.copy=function(){var a=new xe;return a.pa=this.pa,a.ec=this.ec,a.mc=this.mc,a.ve=this.ve,a.Di=this.Di,a.Ei=this.Ei,a.kh=this.kh,a.sl=this.sl,a.Kk=this.Kk,a.wj=this.wj,a.qa=this.qa,a},(n=xe.prototype).Ma=function(a){if(!(a instanceof xe)||this.type!==a.type||this.isClosed!==a.isClosed)return!1;switch(this.type){case ke:case Me:return ne.A(this.endX,a.endX)&&ne.A(this.endY,a.endY);case Se:return ne.A(this.endX,a.endX)&&ne.A(this.endY,a.endY)&&ne.A(this.point1X,a.point1X)&&ne.A(this.point1Y,a.point1Y)&&ne.A(this.point2X,a.point2X)&&ne.A(this.point2Y,a.point2Y);case Pe:return ne.A(this.endX,a.endX)&&ne.A(this.endY,a.endY)&&ne.A(this.point1X,a.point1X)&&ne.A(this.point1Y,a.point1Y);case Ne:return ne.A(this.startAngle,a.startAngle)&&ne.A(this.sweepAngle,a.sweepAngle)&&ne.A(this.centerX,a.centerX)&&ne.A(this.centerY,a.centerY)&&ne.A(this.radiusX,a.radiusX)&&ne.A(this.radiusY,a.radiusY);case Ce:return this.isClockwiseArc===a.isClockwiseArc&&this.isLargeArc===a.isLargeArc&&ne.A(this.xAxisRotation,a.xAxisRotation)&&ne.A(this.endX,a.endX)&&ne.A(this.endY,a.endY)&&ne.A(this.radiusX,a.radiusX)&&ne.A(this.radiusY,a.radiusY);default:return!1}},n.cb=function(a){a.classType===xe&&(this.type=a)},n.toString=function(a){switch(void 0===a&&(a=-1),this.type){case ke:a=0>a?"M"+this.endX.toString()+" "+this.endY.toString():"M"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Me:a=0>a?"L"+this.endX.toString()+" "+this.endY.toString():"L"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Se:a=0>a?"C"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.point2X.toString()+" "+this.point2Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"C"+this.point1X.toFixed(a)+" "+this.point1Y.toFixed(a)+" "+this.point2X.toFixed(a)+" "+this.point2Y.toFixed(a)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Pe:a=0>a?"Q"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"Q"+this.point1X.toFixed(a)+" "+this.point1Y.toFixed(a)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Ne:a=0>a?"B"+this.startAngle.toString()+" "+this.sweepAngle.toString()+" "+this.centerX.toString()+" "+this.centerY.toString()+" "+this.radiusX.toString()+" "+this.radiusY.toString():"B"+this.startAngle.toFixed(a)+" "+this.sweepAngle.toFixed(a)+" "+this.centerX.toFixed(a)+" "+this.centerY.toFixed(a)+" "+this.radiusX.toFixed(a)+" "+this.radiusY.toFixed(a);break;case Ce:a=0>a?"A"+this.radiusX.toString()+" "+this.radiusY.toString()+" "+this.xAxisRotation.toString()+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toString()+" "+this.endY.toString():"A"+this.radiusX.toFixed(a)+" "+this.radiusY.toFixed(a)+" "+this.xAxisRotation.toFixed(a)+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;default:a=this.type.toString()}return a+(this.wj?"z":"")},n.freeze=function(){return this.s=!0,this},n.ea=function(){return this.s=!1,this},n.close=function(){return this.wj=!0,this},v.Object.defineProperties(xe.prototype,{isClosed:{get:function(){return this.wj},set:function(a){this.wj!==a&&(this.wj=a,this.qa=!0)}},type:{get:function(){return this.pa},set:function(a){this.s&&C(this,a),this.pa=a,this.qa=!0}},endX:{get:function(){return this.ec},set:function(a){this.s&&C(this,a),this.ec=a,this.qa=!0}},endY:{get:function(){return this.mc},set:function(a){this.s&&C(this,a),this.mc=a,this.qa=!0}},point1X:{get:function(){return this.ve},set:function(a){this.s&&C(this,a),this.ve=a,this.qa=!0}},point1Y:{get:function(){return this.Di},set:function(a){this.s&&C(this,a),this.Di=a,this.qa=!0}},point2X:{get:function(){return this.Ei},set:function(a){this.s&&C(this,a),this.Ei=a,this.qa=!0}},point2Y:{get:function(){return this.kh},set:function(a){this.s&&C(this,a),this.kh=a,this.qa=!0}},centerX:{get:function(){return this.ve},set:function(a){this.s&&C(this,a),this.ve=a,this.qa=!0}},centerY:{get:function(){return this.Di},set:function(a){this.s&&C(this,a),this.Di=a,this.qa=!0}},radiusX:{get:function(){return this.Ei},set:function(a){0>a&&T(a,">= zero",xe,"radiusX"),this.s&&C(this,a),this.Ei=a,this.qa=!0}},radiusY:{get:function(){return this.kh},set:function(a){0>a&&T(a,">= zero",xe,"radiusY"),this.s&&C(this,a),this.kh=a,this.qa=!0}},startAngle:{get:function(){return this.ec},set:function(a){this.ec!==a&&(this.s&&C(this,a),0>(a%=360)&&(a+=360),this.ec=a,this.qa=!0)}},sweepAngle:{get:function(){return this.mc},set:function(a){this.s&&C(this,a),360<a&&(a=360),-360>a&&(a=-360),this.mc=a,this.qa=!0}},isClockwiseArc:{get:function(){return this.Kk},set:function(a){this.s&&C(this,a),this.Kk=a,this.qa=!0}},isLargeArc:{get:function(){return this.sl},set:function(a){this.s&&C(this,a),this.sl=a,this.qa=!0}},xAxisRotation:{get:function(){return this.ve},set:function(a){0>(a%=360)&&(a+=360),this.s&&C(this,a),this.ve=a,this.qa=!0}}}),xe.prototype.equalsApprox=xe.prototype.Ma;var ke=new _(xe,"Move",0),Me=new _(xe,"Line",1),Se=new _(xe,"Bezier",2),Pe=new _(xe,"QuadraticBezier",3),Ne=new _(xe,"Arc",4),Ce=new _(xe,"SvgArc",4);function Te(){this.B=null,this.Zu=new Mt(0,0).freeze(),this.ju=new Mt(0,0).freeze(),this.cr=this.fs=0,this.dr=1,this.Wr="",this.Ws=this.xr=!1,this.ur=this.fr=0,this.Mg=this.Hr=this.Qr=!1,this.Cr=null,this.Rs=0,this.bd=this.Qs=null}function Le(){this.B=null,this.Qa="",this.qs=this.Ps=null}function Ae(){this.dn=De,this.bf=this.es="",this.Oo=this.Po=this.Vo=this.Wo=this.Uo=this.B=this.ac=null}xe.className="PathSegment",xe.Move=ke,xe.Line=Me,xe.Bezier=Se,xe.QuadraticBezier=Pe,xe.Arc=Ne,xe.SvgArc=Ce,Te.prototype.copy=function(){var a=new Te;return this.clone(a)},Te.prototype.clone=function(a){return a.B=this.B,a.Zu.assign(this.viewPoint),a.ju.assign(this.documentPoint),a.fs=this.fs,a.cr=this.cr,a.dr=this.dr,a.Wr=this.Wr,a.xr=this.xr,a.Ws=this.Ws,a.fr=this.fr,a.ur=this.ur,a.Qr=this.Qr,a.Hr=this.Hr,a.Mg=this.Mg,a.Cr=this.Cr,a.Rs=this.Rs,a.Qs=this.Qs,a.bd=this.bd,a},Te.prototype.toString=function(){var a="^";return 0!==this.modifiers&&(a+="M:"+this.modifiers),0!==this.button&&(a+="B:"+this.button),""!==this.key&&(a+="K:"+this.key),0!==this.clickCount&&(a+="C:"+this.clickCount),0!==this.delta&&(a+="D:"+this.delta),this.handled&&(a+="h"),this.bubbles&&(a+="b"),null!==this.documentPoint&&(a+="@"+this.documentPoint.toString()),a},Te.prototype.oq=function(a,b){var t=this.diagram;return null===t||cr(t,this.event,a,b),b},Te.prototype.Ez=function(a,b){var t=this.diagram;return null===t||(cr(t,this.event,a,b),b.assign(t.Qt(b))),b},v.Object.defineProperties(Te.prototype,{diagram:{get:function(){return this.B},set:function(a){this.B=a}},viewPoint:{get:function(){return this.Zu},set:function(a){this.Zu.assign(a)}},documentPoint:{get:function(){return this.ju},set:function(a){this.ju.assign(a)}},modifiers:{get:function(){return this.fs},set:function(a){this.fs=a}},button:{get:function(){return this.cr},set:function(a){if(this.cr=a,null===this.event)switch(a){case 0:this.buttons=1;break;case 1:this.buttons=4;break;case 2:this.buttons=2}}},buttons:{get:function(){return this.dr},set:function(a){this.dr=a}},key:{get:function(){return this.Wr},set:function(a){this.Wr=a}},down:{get:function(){return this.xr},set:function(a){this.xr=a}},up:{get:function(){return this.Ws},set:function(a){this.Ws=a}},clickCount:{get:function(){return this.fr},set:function(a){this.fr=a}},delta:{get:function(){return this.ur},set:function(a){this.ur=a}},isMultiTouch:{get:function(){return this.Qr},set:function(a){this.Qr=a}},handled:{get:function(){return this.Hr},set:function(a){this.Hr=a}},bubbles:{get:function(){return this.Mg},set:function(a){this.Mg=a}},event:{get:function(){return this.Cr},set:function(a){this.Cr=a}},isTouchEvent:{get:function(){var a=w.TouchEvent,b=this.event;return!!(a&&b instanceof a)||(a=w.PointerEvent)&&b instanceof a&&("touch"===b.pointerType||"pen"===b.pointerType)}},timestamp:{get:function(){return this.Rs},set:function(a){this.Rs=a}},targetDiagram:{get:function(){return this.Qs},set:function(a){this.Qs=a}},targetObject:{get:function(){return this.bd},set:function(a){this.bd=a}},control:{get:function(){return 0!=(1&this.modifiers)},set:function(a){this.modifiers=a?1|this.modifiers:-2&this.modifiers}},shift:{get:function(){return 0!=(4&this.modifiers)},set:function(a){this.modifiers=a?4|this.modifiers:-5&this.modifiers}},alt:{get:function(){return 0!=(2&this.modifiers)},set:function(a){this.modifiers=a?2|this.modifiers:-3&this.modifiers}},meta:{get:function(){return 0!=(8&this.modifiers)},set:function(a){this.modifiers=a?8|this.modifiers:-9&this.modifiers}},left:{get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!=(1&this.buttons):0===this.button},set:function(a){this.buttons=a?1|this.buttons:-2&this.buttons}},right:{get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!=(2&this.buttons):2===this.button},set:function(a){this.buttons=a?2|this.buttons:-3&this.buttons}},middle:{get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!=(4&this.buttons):1===this.button},set:function(a){this.buttons=a?4|this.buttons:-5&this.buttons}}}),Te.prototype.getMultiTouchDocumentPoint=Te.prototype.Ez,Te.prototype.getMultiTouchViewPoint=Te.prototype.oq,Te.className="InputEvent",Le.prototype.copy=function(){var a=new Le;return a.B=this.B,a.Qa=this.Qa,a.Ps=this.Ps,a.qs=this.qs,a},Le.prototype.toString=function(){var a="*"+this.name;return null!==this.subject&&(a+=":"+this.subject.toString()),null!==this.parameter&&(a+="("+this.parameter.toString()+")"),a},v.Object.defineProperties(Le.prototype,{diagram:{get:function(){return this.B},set:function(a){this.B=a}},name:{get:function(){return this.Qa},set:function(a){this.Qa=a}},subject:{get:function(){return this.Ps},set:function(a){this.Ps=a}},parameter:{get:function(){return this.qs},set:function(a){this.qs=a}}}),Le.className="DiagramEvent",Ae.prototype.clear=function(){this.Oo=this.Po=this.Vo=this.Wo=this.Uo=this.B=this.ac=null},Ae.prototype.copy=function(){var a=new Ae;a.dn=this.dn,a.es=this.es,a.bf=this.bf,a.ac=this.ac,a.B=this.B,a.Uo=this.Uo;var b=this.Wo;return a.Wo=j(b)&&"function"==typeof b.G?b.G():b,b=this.Vo,a.Vo=j(b)&&"function"==typeof b.G?b.G():b,b=this.Po,a.Po=j(b)&&"function"==typeof b.G?b.G():b,b=this.Oo,a.Oo=j(b)&&"function"==typeof b.G?b.G():b,a},Ae.prototype.cb=function(a){a.classType===Ae&&(this.change=a)},Ae.prototype.toString=function(){var a="";return a=this.change===je?a+"* ":this.change===De?a+(null!==this.model?"!m":"!d"):a+(null!==this.model?"!m":"!d")+this.change,this.propertyName&&"string"==typeof this.propertyName&&(a+=" "+this.propertyName),this.modelChange&&this.modelChange!==this.propertyName&&(a+=" "+this.modelChange),a+=": ",this.change===je?null!==this.oldValue&&(a+=" "+this.oldValue):(null!==this.object&&(a+=z(this.object)),null!==this.oldValue&&(a+="  old: "+z(this.oldValue)),null!==this.oldParam&&(a+=" "+this.oldParam),null!==this.newValue&&(a+="  new: "+z(this.newValue)),null!==this.newParam&&(a+=" "+this.newParam)),a},Ae.prototype.H=function(a){return a?this.oldValue:this.newValue},Ae.prototype.Gz=function(a){return a?this.oldParam:this.newParam},Ae.prototype.canUndo=function(){return null!==this.model||null!==this.diagram},Ae.prototype.undo=function(){this.canUndo()&&(null!==this.model?this.model.changeState(this,!0):null!==this.diagram&&this.diagram.changeState(this,!0))},Ae.prototype.canRedo=function(){return null!==this.model||null!==this.diagram},Ae.prototype.redo=function(){this.canRedo()&&(null!==this.model?this.model.changeState(this,!1):null!==this.diagram&&this.diagram.changeState(this,!1))},v.Object.defineProperties(Ae.prototype,{model:{get:function(){return this.ac},set:function(a){this.ac=a}},diagram:{get:function(){return this.B},set:function(a){this.B=a}},change:{get:function(){return this.dn},set:function(a){this.dn=a}},modelChange:{get:function(){return this.es},set:function(a){this.es=a}},propertyName:{get:function(){return this.bf},set:function(a){this.bf=a}},isTransactionFinished:{get:function(){return this.dn===je&&("CommittedTransaction"===this.bf||"FinishedUndo"===this.bf||"FinishedRedo"===this.bf)}},object:{get:function(){return this.Uo},set:function(a){this.Uo=a}},oldValue:{get:function(){return this.Wo},set:function(a){this.Wo=a}},oldParam:{get:function(){return this.Vo},set:function(a){this.Vo=a}},newValue:{get:function(){return this.Po},set:function(a){this.Po=a}},newParam:{get:function(){return this.Oo},set:function(a){this.Oo=a}}}),Ae.prototype.redo=Ae.prototype.redo,Ae.prototype.canRedo=Ae.prototype.canRedo,Ae.prototype.undo=Ae.prototype.undo,Ae.prototype.canUndo=Ae.prototype.canUndo,Ae.prototype.getParam=Ae.prototype.Gz,Ae.prototype.getValue=Ae.prototype.H,Ae.prototype.clear=Ae.prototype.clear;var je=new _(Ae,"Transaction",-1),De=new _(Ae,"Property",0),Fe=new _(Ae,"Insert",1),Oe=new _(Ae,"Remove",2);function Be(){this.v=(new lt).freeze(),this.Qa="",this.l=!1}function Ie(){this.Gu=new ct,this.Mc=!1,this.I=(new lt).freeze(),this.Hd=-1,this.v=999,this.le=!1,this.rr=null,this.Li=0,this.l=!1,this.re=(new lt).freeze(),this.Al=new lt,this.qu=!0,this.Au=!1}function Re(a,b,t){if(a.isUndoingRedoing)return!1;a.checksTransactionLevel&&1>a.transactionLevel&&L("Ending transaction without having started a transaction: "+t);var e=1===a.transactionLevel;e&&b&&a.xb("CommittingTransaction",t,a.currentTransaction);var n=0;if(0<a.transactionLevel&&(a.Li--,a.isEnabled)){var o=a.re.count;0<o&&(""===t&&(t=a.re.L(0)),a.re.ea(),a.re.lb(o-1),a.re.freeze()),0<(o=a.Al.count)&&(n=a.Al.L(o-1),a.Al.lb(o-1))}if(o=a.currentTransaction,e){if(b){if(a.Au=!1,a.isEnabled&&null!==o){for((b=o).isComplete=!0,b.name=t,(e=a.history).ea(),n=e.count-1;n>a.historyIndex;n--)null!==(o=e.L(n))&&o.clear(),e.lb(n),a.Au=!0;0<=(n=a.maxHistoryLength)&&(0===n?e.clear():e.count>=n&&(null!==(o=e.L(0))&&o.clear(),e.lb(0),a.Hd--)),0!==n&&(e.add(b),a.Hd++),e.freeze(),o=b}a.xb("CommittedTransaction",t,o)}else{a.le=!0;try{a.isEnabled&&null!==o&&(o.isComplete=!0,o.undo())}finally{a.xb("RolledBackTransaction",t,o),a.le=!1}null!==o&&o.clear()}return a.rr=null,!0}if(a.isEnabled&&!b&&null!==o){for(a=n,b=(t=o.changes).count-1;b>=a;b--)null!==(e=t.L(b))&&e.undo(),t.ea(),t.lb(b);t.freeze()}return!1}function Ee(){ft(this),this.B=fs,this.Qa="",this.Mc=!0,this.kd=!1,this.Gw=null,this.Ey=new Te,this.Zs=-1}function ze(){Ee.call(this),this.name="ToolManager",this.Ic=new lt,this.Yc=new lt,this.Ef=new lt,this.Y=this.Ha=850,this.v=new qt(2,2).ca(),this.Za=5e3,this.Ia=Ye,this.I=qe,this.qr=this.l=null,this.Qj=-1}function Ve(a,b){a.standardMouseOver(),a.isBeyondDragSize()&&a.standardWaitAfter(a.isActive?a.holdDelay:a.hoverDelay,b.lastInput)}Ae.className="ChangedEvent",Ae.Transaction=je,Ae.Property=De,Ae.Insert=Fe,Ae.Remove=Oe,Be.prototype.toString=function(a){var b="Transaction: "+this.name+" "+this.changes.count.toString()+(this.isComplete?"":", incomplete");if(void 0!==a&&0<a){a=this.changes.count;for(var t=0;t<a;t++){var e=this.changes.L(t);null!==e&&(b+="\n  "+e.toString())}}return b},Be.prototype.clear=function(){var a=this.changes;a.ea();for(var b=a.count-1;0<=b;b--){var t=a.L(b);null!==t&&t.clear()}a.clear(),a.freeze()},Be.prototype.canUndo=function(){return this.isComplete},Be.prototype.undo=function(){if(this.canUndo())for(var a=this.changes.count-1;0<=a;a--){var b=this.changes.L(a);null!==b&&b.undo()}},Be.prototype.canRedo=function(){return this.isComplete},Be.prototype.redo=function(){if(this.canRedo())for(var a=this.changes.count,b=0;b<a;b++){var t=this.changes.L(b);null!==t&&t.redo()}},v.Object.defineProperties(Be.prototype,{changes:{get:function(){return this.v}},name:{get:function(){return this.Qa},set:function(a){this.Qa=a}},isComplete:{get:function(){return this.l},set:function(a){this.l=a}}}),Be.prototype.redo=Be.prototype.redo,Be.prototype.canRedo=Be.prototype.canRedo,Be.prototype.undo=Be.prototype.undo,Be.prototype.canUndo=Be.prototype.canUndo,Be.prototype.clear=Be.prototype.clear,Be.className="Transaction",Ie.prototype.toString=function(a){var b="UndoManager "+this.historyIndex+"<"+this.history.count+"<="+this.maxHistoryLength;b+="[";for(var t=this.nestedTransactionNames.count,e=0;e<t;e++)0<e&&(b+=" "),b+=this.nestedTransactionNames.L(e);if(b+="]",void 0!==a&&0<a)for(t=this.history.count,e=0;e<t;e++)b+="\n "+this.history.L(e).toString(a-1);return b},Ie.prototype.clear=function(){var a=this.history;a.ea();for(var b=a.count-1;0<=b;b--){var t=a.L(b);null!==t&&t.clear()}a.clear(),this.Hd=-1,a.freeze(),this.le=!1,this.rr=null,this.Li=0,this.re.ea(),this.re.clear(),this.re.freeze(),this.Al.clear()},Ie.prototype.copyProperties=function(a){this.isEnabled=a.isEnabled,this.maxHistoryLength=a.maxHistoryLength,this.checksTransactionLevel=a.checksTransactionLevel},(n=Ie.prototype).ux=function(a){this.Gu.add(a)},n.by=function(a){this.Gu.remove(a)},n.ua=function(a){if(void 0===a&&(a=""),null===a&&(a=""),this.isUndoingRedoing)return!1;!0===this.qu&&(this.qu=!1,this.Li++,this.xb("StartingFirstTransaction",a,this.currentTransaction),0<this.Li&&this.Li--),this.isEnabled&&(this.re.ea(),this.re.add(a),this.re.freeze(),null===this.currentTransaction?this.Al.add(0):this.Al.add(this.currentTransaction.changes.count)),this.Li++;var b=1===this.transactionLevel;return b&&this.xb("StartedTransaction",a,this.currentTransaction),b},n.Ua=function(a){return void 0===a&&(a=""),Re(this,!0,a)},n.Bf=function(){return Re(this,!1,"")},Ie.prototype.canUndo=function(){if(!this.isEnabled||0<this.transactionLevel)return!1;var a=this.transactionToUndo;return!(null===a||!a.canUndo())},Ie.prototype.undo=function(){if(this.canUndo()){var a=this.transactionToUndo;try{this.le=!0,this.xb("StartingUndo","Undo",a),this.Hd--,a.undo()}catch(t){L("undo error: "+t.toString())}finally{this.xb("FinishedUndo","Undo",a),this.le=!1}}},Ie.prototype.canRedo=function(){if(!this.isEnabled||0<this.transactionLevel)return!1;var a=this.transactionToRedo;return!(null===a||!a.canRedo())},Ie.prototype.redo=function(){if(this.canRedo()){var a=this.transactionToRedo;try{this.le=!0,this.xb("StartingRedo","Redo",a),this.Hd++,a.redo()}catch(t){L("redo error: "+t.toString())}finally{this.xb("FinishedRedo","Redo",a),this.le=!1}}},Ie.prototype.xb=function(a,b,t){void 0===t&&(t=null);var e=new Ae;for(e.change=je,e.propertyName=a,e.object=t,e.oldValue=b,a=this.models;a.next();)b=a.value,e.model=b,b.bt(e)},Ie.prototype.Dv=function(a){if(this.isEnabled&&!this.isUndoingRedoing&&!this.skipsEvent(a)){var b=this.currentTransaction;null===b&&(this.rr=b=new Be);var t=a.copy();(b=b.changes).ea(),b.add(t),b.freeze(),this.checksTransactionLevel&&0>=this.transactionLevel&&!this.qu&&(null!==(a=a.diagram)&&!1===a.kk||L("Change not within a transaction: "+t.toString()))}},Ie.prototype.skipsEvent=function(a){if(null===a||0>a.change.value)return!0;if(null===(a=a.object))return!1;if(void 0!==a.layer){if(null!==(a=a.layer)&&a.isTemporary)return!0}else if(a.isTemporary)return!0;return!1},v.Object.defineProperties(Ie.prototype,{models:{get:function(){return this.Gu.iterator}},isEnabled:{get:function(){return this.Mc},set:function(a){this.Mc=a}},transactionToUndo:{get:function(){return 0<=this.historyIndex&&this.historyIndex<=this.history.count-1?this.history.L(this.historyIndex):null}},transactionToRedo:{get:function(){return this.historyIndex<this.history.count-1?this.history.L(this.historyIndex+1):null}},isUndoingRedoing:{get:function(){return this.le}},history:{get:function(){return this.I}},maxHistoryLength:{get:function(){return this.v},set:function(a){this.v=a}},historyIndex:{get:function(){return this.Hd}},currentTransaction:{get:function(){return this.rr}},transactionLevel:{get:function(){return this.Li}},isInTransaction:{get:function(){return 0<this.Li}},checksTransactionLevel:{get:function(){return this.l},set:function(a){this.l=a}},nestedTransactionNames:{get:function(){return this.re}}}),Ie.prototype.handleChanged=Ie.prototype.Dv,Ie.prototype.redo=Ie.prototype.redo,Ie.prototype.undo=Ie.prototype.undo,Ie.prototype.canUndo=Ie.prototype.canUndo,Ie.prototype.rollbackTransaction=Ie.prototype.Bf,Ie.prototype.commitTransaction=Ie.prototype.Ua,Ie.prototype.startTransaction=Ie.prototype.ua,Ie.prototype.removeModel=Ie.prototype.by,Ie.prototype.addModel=Ie.prototype.ux,Ie.prototype.clear=Ie.prototype.clear,Ie.className="UndoManager",Ee.prototype.toString=function(){return""!==this.name?this.name+" Tool":E(this.constructor)},Ee.prototype.updateAdornments=function(){},Ee.prototype.canStart=function(){return this.isEnabled},Ee.prototype.doStart=function(){},Ee.prototype.doActivate=function(){this.isActive=!0},Ee.prototype.doDeactivate=function(){this.isActive=!1},Ee.prototype.doStop=function(){},Ee.prototype.doCancel=function(){this.transactionResult=null,this.stopTool()},Ee.prototype.stopTool=function(){var a=this.diagram;a.currentTool===this&&(a.currentTool=null,a.currentCursor="")},Ee.prototype.doMouseDown=function(){!this.isActive&&this.canStart()&&this.doActivate()},Ee.prototype.doMouseMove=function(){},Ee.prototype.doMouseUp=function(){this.stopTool()},Ee.prototype.doMouseWheel=function(){},Ee.prototype.canStartMultiTouch=function(){return!0},Ee.prototype.standardPinchZoomStart=function(){var a=this.diagram,b=a.lastInput,t=b.oq(0,Mt.allocAt(NaN,NaN)),e=b.oq(1,Mt.allocAt(NaN,NaN));if(t.u()&&e.u()&&(this.doCancel(),a.mm("hasGestureZoom"))){a.Cl=a.scale;var n=e.x-t.x,o=e.y-t.y;a.Tu=Math.sqrt(n*n+o*o),b.bubbles=!1}Mt.free(t),Mt.free(e)},Ee.prototype.standardPinchZoomMove=function(){var a=this.diagram,b=a.lastInput,t=b.oq(0,Mt.allocAt(NaN,NaN)),e=b.oq(1,Mt.allocAt(NaN,NaN));if(t.u()&&e.u()&&(this.doCancel(),a.mm("hasGestureZoom"))){var n=e.x-t.x,o=e.y-t.y;o=Math.sqrt(n*n+o*o)/a.Tu,n=new Mt((Math.min(e.x,t.x)+Math.max(e.x,t.x))/2,(Math.min(e.y,t.y)+Math.max(e.y,t.y))/2),o*=a.Cl;var g=a.commandHandler;if(o!==a.scale&&g.canResetZoom(o)){var r=a.zoomPoint;a.zoomPoint=n,g.resetZoom(o),a.zoomPoint=r}b.bubbles=!1}Mt.free(t),Mt.free(e)},Ee.prototype.doKeyDown=function(){"Esc"===this.diagram.lastInput.key&&this.doCancel()},Ee.prototype.doKeyUp=function(){},Ee.prototype.ua=function(a){return void 0===a&&(a=this.name),this.transactionResult=null,this.diagram.ua(a)},Ee.prototype.Hg=function(){var a=this.diagram;return null===this.transactionResult?a.Bf():a.Ua(this.transactionResult)},Ee.prototype.standardMouseSelect=function(){var a=this.diagram;if(a.allowSelect){var b=a.lastInput,t=a.jm(b.documentPoint,!1);if(null!==t){if(J?b.meta:b.control){for(a.R("ChangingSelection",a.selection),b=t;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&(b.isSelected=!b.isSelected),a.R("ChangedSelection",a.selection)}else if(b.shift){if(!t.isSelected){for(a.R("ChangingSelection",a.selection),b=t;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&(b.isSelected=!0),a.R("ChangedSelection",a.selection)}}else if(!t.isSelected){for(b=t;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&a.select(b)}}else!b.left||(J?b.meta:b.control)||b.shift||a.clearSelection()}},Ee.prototype.standardMouseClick=function(a,b){void 0===a&&(a=null),void 0===b&&(b=function(a){return!a.layer.isTemporary});var t=this.diagram,e=t.lastInput;return a=t.Ub(e.documentPoint,a,b),e.targetObject=a,function(a,b,t){if(b.handled=!1,null===a||a.Eg()){var e=0;b.left?e=1===b.clickCount?1:2===b.clickCount?2:1:b.right&&1===b.clickCount&&(e=3);var n="ObjectSingleClicked";if(null!==a){switch(e){case 1:n="ObjectSingleClicked";break;case 2:n="ObjectDoubleClicked";break;case 3:n="ObjectContextClicked"}0!==e&&t.R(n,a)}else{switch(e){case 1:n="BackgroundSingleClicked";break;case 2:n="BackgroundDoubleClicked";break;case 3:n="BackgroundContextClicked"}0!==e&&t.R(n)}if(null!==a)for(;null!==a;){switch(t=null,e){case 1:t=a.click;break;case 2:t=a.doubleClick?a.doubleClick:a.click;break;case 3:t=a.contextClick}if(null!==t&&(t(b,a),b.handled))break;a=a.panel}else{switch(a=null,e){case 1:a=t.click;break;case 2:a=t.doubleClick?t.doubleClick:t.click;break;case 3:a=t.contextClick}null!==a&&a(b)}}}(a,e,t),e.handled},Ee.prototype.standardMouseOver=function(){var a=this.diagram,b=a.lastInput;if(!0!==a.animationManager.qc){var t=a.skipsUndoManager;a.skipsUndoManager=!0;var e=a.viewportBounds.aa(b.documentPoint)?a.Ub(b.documentPoint,null,null):null;b.targetObject=e;var n=!1;if(e!==a.mj){var o=a.mj,g=o;for(a.mj=e,this.doCurrentObjectChanged(o,e),b.handled=!1;null!==o;){var r=o.mouseLeave;if(null!==r){if(e===o)break;if(null!==e&&e.Dg(o))break;if(r(b,o,e),n=!0,b.handled)break}o=o.panel}for(o=g,b.handled=!1;null!==e;){if(null!==(g=e.mouseEnter)){if(o===e)break;if(null!==o&&o.Dg(e))break;if(g(b,e,o),n=!0,b.handled)break}e=e.panel}e=a.mj}if(null!==e){for(o=e,g="";null!==o&&""===(g=o.cursor);)o=o.panel;for(a.currentCursor=g,b.handled=!1,o=e;null!==o&&(null===(e=o.mouseOver)||(e(b,o),n=!0,!b.handled));)o=o.panel}else a.currentCursor="",null!==(e=a.mouseOver)&&(e(b),n=!0);n&&a.Pb(),a.skipsUndoManager=t}},Ee.prototype.doCurrentObjectChanged=function(){},Ee.prototype.standardMouseWheel=function(){var a=this.diagram,b=a.lastInput,t=b.delta;if(0!==t&&a.documentBounds.u()){var e=a.commandHandler,n=a.toolManager.mouseWheelBehavior;if(null!==e&&(n===Ge&&!b.shift||n===Ye&&b.control))(0<t?e.canIncreaseZoom():e.canDecreaseZoom())&&(n=a.zoomPoint,a.zoomPoint=b.viewPoint,0<t?e.increaseZoom():e.decreaseZoom(),a.zoomPoint=n),b.bubbles=!1;else if(n===Ge&&b.shift||n===Ye&&!b.control){e=a.position.copy();var o=0<t?t:-t,g=b.event,r=g.deltaMode;if(n=g.deltaX,g=g.deltaY,(K||H||W)&&(r=1,0<n&&(n=3),0>n&&(n=-3),0<g&&(g=3),0>g&&(g=-3)),void 0===r||void 0===n||void 0===g||0===n&&0===g||b.shift)!b.shift&&a.allowVerticalScroll?(o=3*o*a.scrollVerticalLineChange,0<t?a.scroll("pixel","up",o):a.scroll("pixel","down",o)):b.shift&&a.allowHorizontalScroll&&(o=3*o*a.scrollHorizontalLineChange,0<t?a.scroll("pixel","left",o):a.scroll("pixel","right",o));else{switch(r){case 0:t="pixel";break;case 1:t="line";break;case 2:t="page";break;default:t="pixel"}0!==n&&a.allowHorizontalScroll&&(0<(n*=a.scrollHorizontalLineChange/16)?a.scroll(t,"left",-n):a.scroll(t,"right",n)),0!==g&&a.allowVerticalScroll&&(0<(g*=a.scrollVerticalLineChange/16)?a.scroll(t,"up",-g):a.scroll(t,"down",g))}a.position.w(e)||(b.bubbles=!1)}}},Ee.prototype.standardWaitAfter=function(a,b){void 0===b&&(b=this.diagram.lastInput),this.cancelWaitAfter();var t=this,e=b.clone(this.Ey);this.Zs=S((function(){t.doWaitAfter(e)}),a)},Ee.prototype.cancelWaitAfter=function(){-1!==this.Zs&&w.clearTimeout(this.Zs),this.Zs=-1},Ee.prototype.doWaitAfter=function(){},Ee.prototype.findToolHandleAt=function(a,b){return null===(a=this.diagram.Ub(a,(function(a){for(;null!==a&&!(a.panel instanceof Lu);)a=a.panel;return a})))?null:a.part.category===b?a:null},Ee.prototype.isBeyondDragSize=function(a,b){var t=this.diagram;void 0===a&&(a=t.firstInput.viewPoint),void 0===b&&(b=t.lastInput.viewPoint);var e=t.toolManager.dragSize,n=e.width;return e=e.height,t.firstInput.isTouchEvent&&(n+=6,e+=6),Math.abs(b.x-a.x)>n||Math.abs(b.y-a.y)>e},v.Object.defineProperties(Ee.prototype,{diagram:{get:function(){return this.B},set:function(a){a instanceof Vo&&(this.B=a)}},name:{get:function(){return this.Qa},set:function(a){this.Qa=a}},isEnabled:{get:function(){return this.Mc},set:function(a){this.Mc=a}},isActive:{get:function(){return this.kd},set:function(a){this.kd=a}},transactionResult:{get:function(){return this.Gw},set:function(a){this.Gw=a}}}),Ee.prototype.stopTransaction=Ee.prototype.Hg,Ee.prototype.startTransaction=Ee.prototype.ua,Ee.className="Tool",m(ze,Ee),ze.prototype.initializeStandardTools=function(){},ze.prototype.updateAdornments=function(a){var b=this.currentToolTip;if(b instanceof Lu&&this.qr===a){var t=b.adornedObject;(null!==a?t.part===a:null===t)?this.showToolTip(b,t):this.hideToolTip()}},ze.prototype.doMouseDown=function(){var a=this.diagram,b=a.lastInput;if(b.isTouchEvent&&this.gestureBehavior===Ue&&(b.bubbles=!1),b.isMultiTouch){if(this.cancelWaitAfter(),this.gestureBehavior===Ke)return void(b.bubbles=!0);if(this.gestureBehavior===Ue)return;if(a.currentTool.canStartMultiTouch())return void a.currentTool.standardPinchZoomStart()}for(var t=this.mouseDownTools.length,e=0;e<t;e++){var n=this.mouseDownTools.L(e);if(n.diagram=this.diagram,n.canStart())return a.doFocus(),a.currentTool=n,void(a.currentTool===n&&(n.isActive||n.doActivate(),n.doMouseDown()))}1===a.lastInput.button&&(this.mouseWheelBehavior===Ye?this.mouseWheelBehavior=Ge:this.mouseWheelBehavior===Ge&&(this.mouseWheelBehavior=Ye)),this.doActivate(),this.standardWaitAfter(this.holdDelay,b)},ze.prototype.doMouseMove=function(){var a=this.diagram,b=a.lastInput;if(b.isMultiTouch){if(this.gestureBehavior===Ke)return void(b.bubbles=!0);if(this.gestureBehavior===Ue)return;if(a.currentTool.canStartMultiTouch())return void a.currentTool.standardPinchZoomMove()}if(this.isActive)for(var t=this.mouseMoveTools.length,e=0;e<t;e++){var n=this.mouseMoveTools.L(e);if(n.diagram=this.diagram,n.canStart())return a.doFocus(),a.currentTool=n,void(a.currentTool===n&&(n.isActive||n.doActivate(),n.doMouseMove()))}Ve(this,a),null===(a=b.event)||"mousemove"!==a.type&&"pointermove"!==a.type&&a.cancelable||(b.bubbles=!0)},ze.prototype.doCurrentObjectChanged=function(a,b){null===(a=this.currentToolTip)||null!==b&&a instanceof Lu&&(b===a||b.Dg(a))||this.hideToolTip()},ze.prototype.doWaitAfter=function(a){var b=this.diagram;b.sa&&(this.doMouseHover(),this.isActive||this.doToolTip(),a.isTouchEvent&&!b.lastInput.handled&&((a=a.copy()).button=2,a.buttons=2,b.lastInput=a,b.Pj=!0,b.doMouseUp()))},ze.prototype.doMouseHover=function(){var a=this.diagram,b=a.lastInput;null===b.targetObject&&(b.targetObject=a.Ub(b.documentPoint,null,null));var t=b.targetObject;if(null!==t)for(b.handled=!1;null!==t&&(null===(a=this.isActive?t.mouseHold:t.mouseHover)||(a(b,t),!b.handled));)t=t.panel;else null!==(t=this.isActive?a.mouseHold:a.mouseHover)&&t(b)},ze.prototype.doToolTip=function(){var a=this.diagram,b=a.lastInput;if(null===b.targetObject&&(b.targetObject=a.Ub(b.documentPoint,null,null)),null!==(b=b.targetObject)){if(!((a=this.currentToolTip)instanceof Lu)||b!==a&&!b.Dg(a)){for(;null!==b;){if(null!==(a=b.toolTip))return void this.showToolTip(a,b);b=b.panel}this.hideToolTip()}}else null!==(b=a.toolTip)?this.showToolTip(b,null):this.hideToolTip()},ze.prototype.showToolTip=function(a,b){var t=this.diagram;if(a!==this.currentToolTip&&this.hideToolTip(),a instanceof Lu){a.layerName="Tool",a.selectable=!1,a.scale=1/t.scale,a.category="ToolTip",null!==a.placeholder&&(a.placeholder.scale=t.scale);var e=a.diagram;null!==e&&e!==t&&e.remove(a),t.add(a),null!==b?a.adornedObject=b:a.data=t.model,a.yb(),this.positionToolTip(a,b)}else a instanceof Rn&&a!==this.currentToolTip&&a.show(b,t,this);if(this.currentToolTip=a,-1!==this.Qj&&(w.clearTimeout(this.Qj),this.Qj=-1),0<(a=this.toolTipDuration)&&1/0!==a){var n=this;this.Qj=S((function(){n.hideToolTip()}),a)}},ze.prototype.positionToolTip=function(a){if(null===a.placeholder){var b=this.diagram,t=b.lastInput.documentPoint.copy(),e=a.measuredBounds,n=b.viewportBounds;b.lastInput.isTouchEvent&&(t.x-=e.width),t.x+e.width>n.right&&(t.x-=e.width+5/b.scale),t.x<n.x&&(t.x=n.x),t.y=t.y+20/b.scale+e.height>n.bottom?t.y-(e.height+5/b.scale):t.y+20/b.scale,t.y<n.y&&(t.y=n.y),a.position=t}},ze.prototype.hideToolTip=function(){-1!==this.Qj&&(w.clearTimeout(this.Qj),this.Qj=-1);var a=this.diagram,b=this.currentToolTip;null!==b&&(b instanceof Lu?(a.remove(b),null!==this.qr&&this.qr.Af(b.category),b.data=null,b.adornedObject=null):b instanceof Rn&&null!==b.hide&&b.hide(a,this),this.currentToolTip=null)},ze.prototype.doMouseUp=function(){this.cancelWaitAfter();var a=this.diagram;if(this.isActive)for(var b=this.mouseUpTools.length,t=0;t<b;t++){var e=this.mouseUpTools.L(t);if(e.diagram=this.diagram,e.canStart())return a.doFocus(),a.currentTool=e,void(a.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseUp()))}a.doFocus(),this.doDeactivate()},ze.prototype.doMouseWheel=function(){this.standardMouseWheel()},ze.prototype.doKeyDown=function(){var a=this.diagram;null!==a.commandHandler&&a.commandHandler.doKeyDown()},ze.prototype.doKeyUp=function(){var a=this.diagram;null!==a.commandHandler&&a.commandHandler.doKeyUp()},ze.prototype.findTool=function(a){for(var b=this.mouseDownTools.length,t=0;t<b;t++){var e=this.mouseDownTools.L(t);if(e.name===a)return e}for(b=this.mouseMoveTools.length,t=0;t<b;t++)if((e=this.mouseMoveTools.L(t)).name===a)return e;for(b=this.mouseUpTools.length,t=0;t<b;t++)if((e=this.mouseUpTools.L(t)).name===a)return e;return null},ze.prototype.replaceTool=function(a,b){null!==b&&(b.diagram=this.diagram);for(var t=this.mouseDownTools.length,e=0;e<t;e++){var n=this.mouseDownTools.L(e);if(n.name===a)return null!==b?this.mouseDownTools.hd(e,b):this.mouseDownTools.lb(e),n}for(t=this.mouseMoveTools.length,e=0;e<t;e++)if((n=this.mouseMoveTools.L(e)).name===a)return null!==b?this.mouseMoveTools.hd(e,b):this.mouseMoveTools.lb(e),n;for(t=this.mouseUpTools.length,e=0;e<t;e++)if((n=this.mouseUpTools.L(e)).name===a)return null!==b?this.mouseUpTools.hd(e,b):this.mouseUpTools.lb(e),n;return null},ze.prototype.Va=function(a,b,t){null!==b&&(b.name=a,b.diagram=this.diagram),this.findTool(a)?this.replaceTool(a,b):null!==b&&t.add(b)},v.Object.defineProperties(ze.prototype,{mouseWheelBehavior:{get:function(){return this.Ia},set:function(a){this.Ia=a}},gestureBehavior:{get:function(){return this.I},set:function(a){this.I=a}},currentToolTip:{get:function(){return this.l},set:function(a){this.l=a,this.qr=null!==a&&a instanceof Lu?a.adornedPart:null}},mouseDownTools:{get:function(){return this.Ic}},mouseMoveTools:{get:function(){return this.Yc}},mouseUpTools:{get:function(){return this.Ef}},hoverDelay:{get:function(){return this.Ha},set:function(a){this.Ha=a}},holdDelay:{get:function(){return this.Y},set:function(a){this.Y=a}},dragSize:{get:function(){return this.v},set:function(a){this.v=a.G()}},toolTipDuration:{get:function(){return this.Za},set:function(a){this.Za=a}}}),ze.prototype.replaceStandardTool=ze.prototype.Va;var Ye=new _(ze,"WheelScroll",0),Ge=new _(ze,"WheelZoom",1),Xe=new _(ze,"WheelNone",2),qe=new _(ze,"GestureZoom",3),Ue=new _(ze,"GestureCancel",4),Ke=new _(ze,"GestureNone",5);function He(){Ee.call(this),this.name="Dragging",this.I=this.Yc=!0,this.v=this.Za=this.Ha=this.og=null,this.Bn=this.Ef=!1,this.Ql=new Mt(NaN,NaN),this.Ns=new Mt,this.Ic=!0,this.Vk=100,this.Tg=[],this.Sq=(new ct).freeze(),this.Ia=new Xs,this.ko=null,this.Y="copy",this.Oh="",this.Je="no-drop"}function We(a,b){if(a.dragsLink){var t=a.diagram;t.allowRelink&&(t.model.ik()&&1===b.count&&b.first()instanceof Wu?(a.draggedLink=b.first(),a.draggedLink.canRelinkFrom()&&a.draggedLink.canRelinkTo()&&a.draggedLink.Yj(),a.og=t.toolManager.findTool("Relinking"),null===a.og&&(a.og=new kn,a.og.diagram=t)):(a.draggedLink=null,a.og=null))}}function Je(a){var b=a.diagram,t=b.skipsUndoManager;b.skipsUndoManager=!0,rn(a,b.lastInput,null),b.skipsUndoManager=t,a.Tg.length=0}function Ze(){var a=pn;_e(a),nn(a);var b=a.diagram;a.Ql.u()&&(b.position=a.Ql),b.Cf()}function $e(a,b){var t=1/0,e=1/0,n=-1/0,o=-1/0;for(a=a.iterator;a.next();){var g=a.value;if(g.Wb()&&g.isVisible()){var r=g.location;g=r.x,r=r.y,isNaN(g)||isNaN(r)||(g<t&&(t=g),r<e&&(e=r),g>n&&(n=g),r>o&&(o=r))}}1/0===t?b.h(0,0,0,0):b.h(t,e,n-t,o-e)}function Qe(a,b){if(null===a.copiedParts){var t=a.diagram;if((!b||!t.isReadOnly&&!t.isModelReadOnly)&&null!==a.draggedParts){var e=t.undoManager;for(e.isEnabled&&e.isInTransaction?null!==e.currentTransaction&&0<e.currentTransaction.changes.count&&(t.undoManager.Bf(),t.ua("Drag")):nn(a),t.skipsUndoManager=!b,t.partManager.addsToTemporaryLayer=!b,a.startPoint=t.firstInput.documentPoint,b=a.copiesEffectiveCollection?a.draggedParts.Df():t.selection,b=(t=t.ck(b,t,!0)).iterator;b.next();)b.value.location=b.key.location;for($e(t,b=Wt.alloc()),Wt.free(b),b=new kt,e=a.draggedParts.iterator;e.next();){var n=e.key;n.Wb()&&n.canCopy()&&(null!==(n=t.H(n))&&(n.yb(),b.add(n,a.td(n.location))))}for(t=t.iterator;t.next();)(e=t.value)instanceof Wu&&e.canCopy()&&b.add(e,a.td());a.copiedParts=b,We(a,b.Df()),null!==a.draggedLink&&(b=(t=a.draggedLink).routeBounds,$u(t,a.startPoint.x-(b.x+b.width/2),a.startPoint.y-(b.y+b.height/2)))}}}function _e(a){var b=a.diagram;if(null!==a.copiedParts&&(b.Jt(a.copiedParts.Df(),!1),a.copiedParts=null,null!==a.draggedParts))for(var t=a.draggedParts.iterator;t.next();)t.key instanceof Wu&&(t.value.point=new Mt(0,0));b.skipsUndoManager=!1,b.partManager.addsToTemporaryLayer=!1,a.startPoint=b.firstInput.documentPoint}function tn(a){if(null!==a.draggedLink){if(a.dragsLink&&null!==a.og){var b=a.og;b.diagram.remove(b.temporaryFromNode),b.diagram.remove(b.temporaryToNode)}a.draggedLink=null,a.og=null}}function en(a,b,t){var e=a.diagram,n=a.startPoint,o=Mt.alloc();o.assign(e.lastInput.documentPoint),a.moveParts(b,o.$d(n),t),Mt.free(o),!0===e.Ce("temporaryPixelRatio")&&null===e.uh&&30<e.xx&&(qo(e),e.Ht())}function nn(a){if(null!==a.draggedParts){for(var b=a.diagram,t=a.draggedParts.iterator;t.next();){var e=t.key;e.Wb()&&(e.location=t.value.point)}for(t=a.draggedParts.iterator;t.next();)if((e=t.key)instanceof Wu&&e.suspendsRouting){var n=t.value.point;a.draggedParts.add(e,a.td()),$u(e,-n.x,-n.y)}b.Wc()}}function on(a,b){var t=a.diagram;a.dragsLink&&(null!==a.draggedLink&&(a.draggedLink.fromNode=null,a.draggedLink.toNode=null),hn(a,!1));var e=a.findDragOverObject(b),n=t.lastInput;n.targetObject=e,a.doUpdateCursor(e);var o=t.skipsUndoManager,g=!1;try{if(t.skipsUndoManager=!0,g=rn(a,n,e),!a.isActive&&null===pn)return;var r=null!==e?e.part:null;if(null===r||t.handlesDragDropForTopLevelParts&&r.isTopLevel&&!(r instanceof qu)){var h=t.mouseDragOver;null!==h&&(h(n),g=!0)}if(!a.isActive&&null===pn)return;if(a.doDragOver(b,e),!a.isActive&&null===pn)return}finally{t.skipsUndoManager=o,g&&t.Wc()}a.ko=e,t.isReadOnly||!t.allowMove&&!t.allowCopy||!t.allowHorizontalScroll&&!t.allowVerticalScroll||t.gt(n.viewPoint)}function rn(a,b,t){var e=!1,n=a.Tg.length,o=0<n?a.Tg[0]:null;if(t===o)return!1;b.handled=!1;for(var g=0;g<n;g++){var r=a.Tg[g],h=r.mouseDragLeave;if(null!==h&&(h(b,r,t),e=!0,b.handled))break}if(a.Tg.length=0,!a.isActive&&null===pn||null===t)return e;for(b.handled=!1,n=t;null!==n;)a.Tg.push(n),n=sn(n);for(n=a.Tg.length,t=0;t<n&&(null===(r=(g=a.Tg[t]).mouseDragEnter)||(r(b,g,o),e=!0,!b.handled));t++);return e}function sn(a){var b=a.panel;return null!==b?b:a instanceof lu&&!(a instanceof qu)&&(null!==(a=a.containingGroup)&&a.handlesDragDropForMembers)?a:null}function an(a,b,t){var e=a.og;if(null===e)return null;var n=a.diagram.Ag(b,e.portGravity,(function(a){return e.findValidLinkablePort(a,t)}));a=Mt.alloc();var o=1/0,g=null;for(n=n.iterator;n.next();){var r=n.value;if(null!==r.part){var h=r.ga(xi,a);(h=b.Be(h))<o&&(g=r,o=h)}}return Mt.free(a),g}function hn(a,b){var t=a.draggedLink;if(null!==t&&!(2>t.pointsCount)){var e=a.diagram;if(!e.isReadOnly){var n=a.og;if(null!==n){var o=null,g=null;null===t.fromNode&&(null!==(o=an(a,t.i(0),!1))&&(g=o.part));var r=null,h=null;null===t.toNode&&(null!==(r=an(a,t.i(t.pointsCount-1),!0))&&(h=r.part)),n.isValidLink(g,o,h,r)?b?(t.defaultFromPoint=t.i(0),t.defaultToPoint=t.i(t.pointsCount-1),t.suspendsRouting=!1,t.fromNode=g,null!==o&&(t.fromPortId=o.portId),t.toNode=h,null!==r&&(t.toPortId=r.portId),t.fromPort!==e.Xx&&e.R("LinkRelinked",t,e.Xx),t.toPort!==e.Yx&&e.R("LinkRelinked",t,e.Yx)):Mn(n,g,o,h,r):Mn(n,null,null,null,null)}}}}function ln(a,b){var t=a.diagram;a.dragsLink&&hn(a,!0),Je(a);var e=a.findDragOverObject(b),n=t.lastInput;if(n.targetObject=e,null!==e){n.handled=!1;for(var o=e;null!==o;){var g=o.mouseDrop;if(null!==g&&(g(n,o),n.handled))break;un(a,n,o),o=sn(o)}}else null!==(o=t.mouseDrop)&&o(n);if(a.isActive||null!==pn){for(n=(a.copiedParts||a.draggedParts).iterator;n.next();)(o=n.key)instanceof Au&&o.linksConnected.each((function(a){a.suspendsRouting=!1}));if(a.doDropOnto(b,e),a.isActive||null!==pn){for(a=Wt.alloc(),b=t.selection.iterator;b.next();)(e=b.value)instanceof Au&&cn(t,e,a);Wt.free(a)}}}function un(a,b,t){a=a.diagram,t=t.part,!a.handlesDragDropForTopLevelParts||!t.isTopLevel||t instanceof qu||null!==(t=a.mouseDrop)&&t(b)}function cn(a,b,t){var e=!1;if(b.getAvoidableRect(t),a.viewportBounds.Ae(t)&&(e=!0),0!==(a=a.vv(t,(function(a){return a.part}),(function(a){return a instanceof Wu}),!0,(function(a){return a instanceof Wu}),e)).count)for(a=a.iterator;a.next();)!(t=a.value).Xd(b)&&t.isAvoiding&&t.Ta()}function fn(a,b,t,e){if(null===a.copiedParts){var n=a.diagram;if(!n.isReadOnly&&!n.isModelReadOnly){n.skipsUndoManager=!t,n.partManager.addsToTemporaryLayer=!t,a.startPoint=e.documentPoint,t=n.ck(b,n,!0);var o=Wt.alloc();$e(b,o),e=o.x+o.width/2,n=o.y+o.height/2,Wt.free(o),o=a.Ns;var g=new kt,r=Mt.alloc();for(b=b.iterator;b.next();){var h=b.value,l=t.H(h);h.Wb()&&h.canCopy()?(h=h.location,r.h(o.x-(e-h.x),o.y-(n-h.y)),l.location=r,l.yb(),g.add(l,a.td(r))):l instanceof Wu&&h.canCopy()&&($u(l,o.x-e,o.y-n),g.add(l,a.td()))}Mt.free(r),a.copiedParts=g,We(a,g.Df()),null!==a.draggedLink&&(e=(t=a.draggedLink).routeBounds,$u(t,a.startPoint.x-(e.x+e.width/2),a.startPoint.y-(e.y+e.height/2)))}}}ze.className="ToolManager",ze.WheelScroll=Ye,ze.WheelZoom=Ge,ze.WheelNone=Xe,ze.GestureZoom=qe,ze.GestureCancel=Ue,ze.GestureNone=Ke,m(He,Ee),He.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(a.isReadOnly&&!a.allowDragOut||!a.allowMove&&!a.allowCopy&&!a.allowDragOut||!a.allowSelect)return!1;var b=a.lastInput;return!(!b.left||a.currentTool!==this&&(!this.isBeyondDragSize()||b.isTouchEvent&&b.timestamp-a.firstInput.timestamp<this.Vk))&&null!==this.findDraggablePart()},He.prototype.findDraggablePart=function(){var a=this.diagram;if(null===(a=a.jm(a.firstInput.documentPoint,!1)))return null;for(;null!==a&&!a.canSelect();)a=a.containingGroup;return null!==a&&(a.canMove()||a.canCopy())?a:null},He.prototype.standardMouseSelect=function(){var a=this.diagram;if(a.allowSelect){var b=a.jm(a.firstInput.documentPoint,!1);if(null!==b){for(;null!==b&&!b.canSelect();)b=b.containingGroup;this.currentPart=b,null===this.currentPart||this.currentPart.isSelected||(a.R("ChangingSelection",a.selection),b=a.lastInput,(J?b.meta:b.control)||b.shift||a.clearSelection(!0),this.currentPart.isSelected=!0,a.R("ChangedSelection",a.selection))}}},He.prototype.doActivate=function(){var a=this.diagram;this.ko=null,null===this.currentPart&&this.standardMouseSelect();var b=this.currentPart;null!==b&&(b.canMove()||b.canCopy())&&(pn=null,this.isActive=!0,this.Ql.set(a.position),We(this,a.selection),this.Tg.length=0,this.draggedParts=this.computeEffectiveCollection(a.selection,this.dragOptions),a.Pt=!0,!0===a.Ce("temporaryPixelRatio")&&30<a.xx&&qo(a),Ar(a,this.draggedParts),this.ua("Drag"),this.startPoint=a.firstInput.documentPoint,a.isMouseCaptured=!0,a.allowDragOut&&(this.isDragOutStarted=!0,this.Bn=!1,pn=this,gn=this.diagram,this.doSimulatedDragOut()))},He.prototype.computeEffectiveCollection=function(a,b){return this.diagram.commandHandler.computeEffectiveCollection(a,b)},He.prototype.td=function(a){return void 0===a?new Ys(jt):this.isGridSnapEnabled?new Ys(new Mt(Math.round(a.x),Math.round(a.y))):new Ys(a.copy())},He.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;if(a.Cf(),Je(this),jr(a,this.draggedParts),this.draggedParts=this.currentPart=this.ko=null,this.Bn=this.isDragOutStarted=!1,0<dn.count){for(var b=dn,t=b.length,e=0;e<t;e++){var n=b.L(e);tn(n),_e(n),Je(n),n.diagram.Cf()}b.clear()}tn(this),this.Ql.h(NaN,NaN),pn=gn=null,_e(this),a.isMouseCaptured=!1,a.currentCursor="",a.Pt=!1,this.Hg(),Uo(a,!0)},He.prototype.doCancel=function(){_e(this),nn(this);var a=this.diagram;this.Ql.u()&&(a.position=this.Ql),this.stopTool()},He.prototype.doKeyDown=function(){this.isActive&&("Esc"===this.diagram.lastInput.key?this.doCancel():this.doMouseMove())},He.prototype.doKeyUp=function(){this.isActive&&this.doMouseMove()},He.prototype.moveParts=function(a,b,t){var e=this.diagram;null!==e&&Cr(e,a,b,this.dragOptions,t)},He.prototype.findDragOverObject=function(a){var b=this;return er(this.diagram,a,null,(function(a){return null===a?a=!0:a=!!(null===(a=a.part)||a instanceof Lu||a.layer.isTemporary||b.draggedParts&&b.draggedParts.contains(a)||b.copiedParts&&b.copiedParts.contains(a)),!a}))},He.prototype.doUpdateCursor=function(a){var b=this.diagram;this.ko!==a&&(!this.diagram.currentTool.isActive||this.mayCopy()?b.currentCursor=this.copyCursor:this.mayMove()?b.currentCursor=this.moveCursor:this.mayDragOut()&&(b.currentCursor=this.nodropCursor))},He.prototype.doDragOver=function(){},He.prototype.doDropOnto=function(){},He.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram,b=a.lastInput;this.simulatedMouseMove(b.event,b.documentPoint,b.targetDiagram)||null===this.currentPart||null===this.draggedParts||(this.mayCopy()?(Qe(this,!1),Ar(a,this.copiedParts),en(this,this.copiedParts,!1),jr(a,this.copiedParts)):this.mayMove()?(_e(this),en(this,this.draggedParts,!0)):this.mayDragOut()?(Qe(this,!1),en(this,this.copiedParts,!1)):_e(this),on(this,a.lastInput.documentPoint))}},He.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram,b=a.lastInput;if(!this.simulatedMouseUp(b.event,b.documentPoint,b.targetDiagram)){b=!1;var t=this.mayCopy();if(t&&null!==this.copiedParts?(_e(this),Qe(this,!0),Ar(a,this.copiedParts),en(this,this.copiedParts,!1),jr(a,this.copiedParts),null!==this.copiedParts&&(a.R("ChangingSelection",a.selection),a.clearSelection(!0),this.copiedParts.iteratorKeys.each((function(a){a.isSelected=!0})))):(b=!0,_e(this),this.mayMove()&&(en(this,this.draggedParts,!0),on(this,a.lastInput.documentPoint))),this.Bn=!0,ln(this,a.lastInput.documentPoint),this.isActive){var e=t?this.copiedParts.Df():this.draggedParts.Df();this.copiedParts=null,b&&function(a){if(null!==a.draggedParts)for(var b=a.draggedParts.iterator;b.next();){var t=b.key;t instanceof Au&&(null===(t=t.containingGroup)||null===t.placeholder||a.draggedParts.contains(t)||t.placeholder.o())}}(this),a.Na(),jr(a,this.draggedParts),this.transactionResult=t?"Copy":"Move",a.R(t?"SelectionCopied":"SelectionMoved",e)}this.stopTool(),t&&a.R("ChangedSelection",a.selection)}}},He.prototype.simulatedMouseMove=function(a,b,t){if(null===pn)return!1;var e=pn.diagram;t instanceof Vo||(t=null);var n=gn;return t!==n&&(null!==n&&n!==e&&(n.Cf(),pn.isDragOutStarted=!1,null!==(n=n.toolManager.findTool("Dragging"))&&n.doSimulatedDragLeave()),gn=t,null!==t&&t!==e&&(Ze(),null!==(n=t.toolManager.findTool("Dragging"))&&(dn.contains(n)||dn.add(n),n.doSimulatedDragEnter()))),!(null===t||t===e||!t.allowDrop||t.isReadOnly||!t.allowInsert)&&(null!==(e=t.toolManager.findTool("Dragging"))&&(null!==a&&(void 0!==a.targetTouches&&(0<a.targetTouches.length?a=a.targetTouches[0]:0<a.changedTouches.length&&(a=a.changedTouches[0])),b=t.getMouse(a)),t.lastInput.documentPoint=b,t.lastInput.viewPoint=t.Nq(b),t.lastInput.down=!1,t.lastInput.up=!1,e.doSimulatedDragOver()),!0)},He.prototype.simulatedMouseUp=function(a,b,t){if(null===pn)return!1;var e=gn,n=pn.diagram;if(null===t)return pn.doCancel(),!0;if(t!==e){var o=e.toolManager.findTool("Dragging");if(null!==e&&e!==n&&null!==o)return e.Cf(),pn.isDragOutStarted=!1,o.doSimulatedDragLeave(),!1;gn=t,null!==(e=t.toolManager.findTool("Dragging"))&&(Ze(),dn.contains(e)||dn.add(e),e.doSimulatedDragEnter())}return t!==this.diagram&&(null!==a?(void 0!==a.targetTouches&&(0<a.targetTouches.length?a=a.targetTouches[0]:0<a.changedTouches.length&&(a=a.changedTouches[0])),b=t.getMouse(a)):null===b&&(b=new Mt),t.lastInput.documentPoint=b,t.lastInput.viewPoint=t.Nq(b),t.lastInput.down=!1,t.lastInput.up=!0,null!==(a=t.toolManager.findTool("Dragging"))&&a.doSimulatedDrop(),null!==(a=pn)&&(t=a.mayCopy(),a.transactionResult=t?"Copy":"Move",a.stopTool()),!0)},He.prototype.mayCopy=function(){if(!this.isCopyEnabled)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.allowCopy||(J?!a.lastInput.alt:!a.lastInput.control))return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.Wb()&&b.canCopy())return!0}return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())},He.prototype.mayDragOut=function(){if(!this.isCopyEnabled)return!1;var a=this.diagram;if(!a.allowDragOut||!a.allowCopy||a.allowMove)return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.Wb()&&b.canCopy())return!0}return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())},He.prototype.mayMove=function(){var a=this.diagram;if(a.isReadOnly||!a.allowMove)return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.Wb()&&b.canMove())return!0}return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canMove())},He.prototype.computeBorder=function(a,b,t){return this.Bn||null===this.draggedParts||this.draggedParts.contains(a)?null:t.assign(b)},He.prototype.Bz=function(){return pn},He.prototype.mayDragIn=function(){var a=this.diagram;if(!a.allowDrop||a.isReadOnly||a.isModelReadOnly||!a.allowInsert)return!1;return null!==pn&&pn.diagram.model.dataFormat===a.model.dataFormat},He.prototype.doSimulatedDragEnter=function(){if(this.mayDragIn()){var a=this.diagram;a.animationManager.Xc(),dr(a),a.animationManager.Xc();null!==pn&&(pn.diagram.Pt=!1),this.doUpdateCursor(a.grid)}},He.prototype.doSimulatedDragLeave=function(){null!==pn&&pn.doSimulatedDragOut(),this.doCancel()},He.prototype.doSimulatedDragOver=function(){var a=this.diagram;a.animationManager.bn=!0;var b=pn;if(null!==b&&null!==b.draggedParts){if(!this.mayDragIn())return;fn(this,b.draggedParts.Df(),!1,a.firstInput),en(this,this.copiedParts,!1),on(this,a.lastInput.documentPoint)}a.animationManager.bn=!1},He.prototype.doSimulatedDrop=function(){var a=this.diagram,b=pn;if(null!==b){var t=b.diagram;if(b.Bn=!0,_e(this),!this.mayDragIn())return;a.animationManager.bn=!0,a.R("ChangingSelection",a.selection),this.ua("Drop"),fn(this,b.draggedParts.Df(),!0,a.lastInput),en(this,this.copiedParts,!1),null!==this.copiedParts&&(a.clearSelection(!0),this.copiedParts.iteratorKeys.each((function(a){a.isSelected=!0}))),ln(this,a.lastInput.documentPoint),a.Na(),b=a.selection,null!==this.copiedParts?this.transactionResult="ExternalCopy":b=new ct,this.copiedParts=null,a.doFocus(),a.R("ExternalObjectsDropped",b,t),this.Hg(),a.R("ChangedSelection",a.selection)}a.animationManager.bn=!1},He.prototype.doSimulatedDragOut=function(){var a=this.diagram;a.Pt=!1,this.mayCopy()||this.mayMove()?a.currentCursor="":a.currentCursor=this.nodropCursor,this.ko=null},He.prototype.computeMove=function(a,b,t,e){return null!==(t=this.diagram)?t.computeMove(a,b,this.dragOptions,e):new Mt},v.Object.defineProperties(He.prototype,{isCopyEnabled:{get:function(){return this.Yc},set:function(a){this.Yc=a}},copiesEffectiveCollection:{get:function(){return this.I},set:function(a){this.I=a}},dragOptions:{get:function(){return this.Ia},set:function(a){this.Ia=a}},isGridSnapEnabled:{get:function(){return this.dragOptions.isGridSnapEnabled},set:function(a){this.dragOptions.isGridSnapEnabled=a}},isComplexRoutingRealtime:{get:function(){return this.Ic},set:function(a){this.Ic=a}},isGridSnapRealtime:{get:function(){return this.dragOptions.isGridSnapRealtime},set:function(a){this.dragOptions.isGridSnapRealtime=a}},gridSnapCellSize:{get:function(){return this.dragOptions.gridSnapCellSize},set:function(a){this.dragOptions.gridSnapCellSize.w(a)||(a=a.G(),this.dragOptions.gridSnapCellSize=a)}},gridSnapCellSpot:{get:function(){return this.dragOptions.gridSnapCellSpot},set:function(a){this.dragOptions.gridSnapCellSpot.w(a)||(a=a.G(),this.dragOptions.gridSnapCellSpot=a)}},gridSnapOrigin:{get:function(){return this.dragOptions.gridSnapOrigin},set:function(a){this.dragOptions.gridSnapOrigin.w(a)||(a=a.G(),this.dragOptions.gridSnapOrigin=a)}},dragsLink:{get:function(){return this.dragOptions.dragsLink},set:function(a){this.dragOptions.dragsLink=a}},dragsTree:{get:function(){return this.dragOptions.dragsTree},set:function(a){this.dragOptions.dragsTree=a}},copyCursor:{get:function(){return this.Y},set:function(a){this.Y=a}},moveCursor:{get:function(){return this.Oh},set:function(a){this.Oh=a}},nodropCursor:{get:function(){return this.Je},set:function(a){this.Je=a}},currentPart:{get:function(){return this.Ha},set:function(a){this.Ha=a}},copiedParts:{get:function(){return this.v},set:function(a){this.v=a}},draggedParts:{get:function(){return this.Za},set:function(a){this.Za=a}},draggingParts:{get:function(){return null!==this.copiedParts?this.copiedParts.Df():null!==this.draggedParts?this.draggedParts.Df():this.Sq}},draggedLink:{get:function(){return this.diagram.draggedLink},set:function(a){this.diagram.draggedLink=a}},isDragOutStarted:{get:function(){return this.Ef},set:function(a){this.Ef=a}},startPoint:{get:function(){return this.Ns},set:function(a){this.Ns.w(a)||this.Ns.assign(a)}},delay:{get:function(){return this.Vk},set:function(a){this.Vk=a}}}),He.prototype.getDraggingSource=He.prototype.Bz;var dn=null,pn=null,gn=null;function yn(){Ee.call(this),this.Ef=100,this.Y=!1,this.fi="pointer";var a=new Wu,b=new rl;b.isPanelMain=!0,b.stroke="blue",a.add(b),(b=new rl).toArrow="Standard",b.fill="blue",b.stroke="blue",a.add(b),a.layerName="Tool",this.Dw=a,a=new Au,(b=new rl).portId="",b.figure="Rectangle",b.fill=null,b.stroke="magenta",b.strokeWidth=2,b.desiredSize=Rt,a.add(b),a.selectable=!1,a.layerName="Tool",this.Bw=a,this.Cw=b,a=new Au,(b=new rl).portId="",b.figure="Rectangle",b.fill=null,b.stroke="magenta",b.strokeWidth=2,b.desiredSize=Rt,a.add(b),a.selectable=!1,a.layerName="Tool",this.Ew=a,this.Fw=b,this.Yc=this.Ic=this.Ia=this.Ha=this.Za=null,this.I=!0,this.vy=new kt,this.Oh=this.xi=this.Sq=null}function mn(a,b,t,e,n){if(b===t)return!0;if(null===b||null===t)return!1;for(var o=b.linksConnected;o.next();){var g=o.value;if(g!==e&&(!n||g.isTreeLink)&&g.toNode===b&&((g=g.fromNode)!==b&&mn(a,g,t,e,n)))return!0}return!1}function vn(){yn.call(this),this.name="Linking",this.v={},this.l=null,this.J=xn,this.Je=null}He.className="DraggingTool",dn=new lt,Y("draggingTool",(function(){return this.findTool("Dragging")}),(function(a){this.Va("Dragging",a,this.mouseMoveTools)})),ze.prototype.doCancel=function(){null!==pn&&pn.doCancel(),Ee.prototype.doCancel.call(this)},m(yn,Ee),yn.prototype.doStop=function(){this.diagram.Cf(),this.originalToPort=this.originalToNode=this.originalFromPort=this.originalFromNode=this.originalLink=null,this.validPortsCache.clear(),this.targetPort=null},yn.prototype.copyPortProperties=function(a,b,t,e,n){if(null!==a&&null!==b&&null!==t&&null!==e){var o=b.vf(),g=qt.alloc();g.width=b.naturalBounds.width*o,g.height=b.naturalBounds.height*o,e.desiredSize=g,qt.free(g),n?(e.toSpot=b.toSpot,e.toEndSegmentLength=b.toEndSegmentLength):(e.fromSpot=b.fromSpot,e.fromEndSegmentLength=b.fromEndSegmentLength),t.locationSpot=xi,o=Mt.alloc(),t.location=b.ga(xi,o),Mt.free(o),e.angle=b.Xi(),null!==this.portTargeted&&this.portTargeted(a,b,t,e,n)}},yn.prototype.setNoTargetPortProperties=function(a,b,t){null!==b&&(b.desiredSize=Rt,b.fromSpot=pi,b.toSpot=pi),null!==a&&(a.location=this.diagram.lastInput.documentPoint),null!==this.portTargeted&&this.portTargeted(null,null,a,b,t)},yn.prototype.doMouseDown=function(){this.isActive&&this.doMouseMove()},yn.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram;if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort&&this.targetPort.part instanceof Au){var b=this.targetPort.part;this.isForwards?this.copyPortProperties(b,this.targetPort,this.temporaryToNode,this.temporaryToPort,!0):this.copyPortProperties(b,this.targetPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else this.isForwards?this.setNoTargetPortProperties(this.temporaryToNode,this.temporaryToPort,!0):this.setNoTargetPortProperties(this.temporaryFromNode,this.temporaryFromPort,!1);(a.allowHorizontalScroll||a.allowVerticalScroll)&&a.gt(a.lastInput.viewPoint)}},yn.prototype.findValidLinkablePort=function(a,b){if(null===a)return null;var t=a.part;if(!(t instanceof Au))return null;for(;null!==a;){var e=b?a.toLinkable:a.fromLinkable;if(!0===e&&(null!==a.portId||a instanceof Au)&&(b?this.isValidTo(t,a):this.isValidFrom(t,a)))return a;if(!1===e)break;a=a.panel}return null},yn.prototype.findTargetPort=function(a){var b=this.diagram,t=b.lastInput.documentPoint,e=this.portGravity;0>=e&&(e=.1);var n=this,o=b.Ag(t,e,(function(b){return n.findValidLinkablePort(b,a)}),null,!0);for(e=1/0,b=null,o=o.iterator;o.next();){var g=o.value,r=g.part;if(r instanceof Au){var h=g.ga(xi,Mt.alloc()),l=t.x-h.x,c=t.y-h.y;Mt.free(h),(h=l*l+c*c)<e&&(null!==(l=this.validPortsCache.H(g))?l&&(b=g,e=h):a&&this.isValidLink(this.originalFromNode,this.originalFromPort,r,g)||!a&&this.isValidLink(r,g,this.originalToNode,this.originalToPort)?(this.validPortsCache.add(g,!0),b=g,e=h):this.validPortsCache.add(g,!1))}}return null!==b&&((t=b.part)instanceof Au&&(null===t.layer||t.layer.allowLink))?b:null},yn.prototype.isValidFrom=function(a,b){if(null===a||null===b)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==a.layer&&!a.layer.allowLink||!0!==b.fromLinkable))return!1;var t=b.fromMaxLinks;if(1/0>t){if(null!==this.originalLink&&a===this.originalFromNode&&b===this.originalFromPort)return!0;if(null===(b=b.portId)&&(b=""),a.lq(b).count>=t)return!1}return!0},yn.prototype.isValidTo=function(a,b){if(null===a||null===b)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==a.layer&&!a.layer.allowLink||!0!==b.toLinkable))return!1;var t=b.toMaxLinks;if(1/0>t){if(null!==this.originalLink&&a===this.originalToNode&&b===this.originalToPort)return!0;if(null===(b=b.portId)&&(b=""),a.wd(b).count>=t)return!1}return!0},yn.prototype.isInSameNode=function(a,b){return null!==a&&null!==b&&(a===b||(a=a.part,b=b.part,null!==a&&a===b))},yn.prototype.isLinked=function(a,b){if(null===a||null===b)return!1;var t=a.part;if(!(t instanceof Au))return!1;null===(a=a.portId)&&(a="");var e=b.part;if(!(e instanceof Au))return!1;for(null===(b=b.portId)&&(b=""),b=e.wd(b);b.next();)if((e=b.value).fromNode===t&&e.fromPortId===a)return!0;return!1},yn.prototype.isValidLink=function(a,b,t,e){if(!this.isValidFrom(a,b)||!this.isValidTo(t,e)||!(null===b||null===e||(b.fromLinkableSelfNode&&e.toLinkableSelfNode||!this.isInSameNode(b,e))&&(b.fromLinkableDuplicates&&e.toLinkableDuplicates||!this.isLinked(b,e)))||null!==this.originalLink&&(null!==a&&this.isLabelDependentOnLink(a,this.originalLink)||null!==t&&this.isLabelDependentOnLink(t,this.originalLink))||null!==a&&null!==t&&(null===a.data&&null!==t.data||null!==a.data&&null===t.data)||!this.isValidCycle(a,t,this.originalLink))return!1;if(null!==a){var n=a.linkValidation;if(null!==n&&!n(a,b,t,e,this.originalLink))return!1}return!(null!==t&&null!==(n=t.linkValidation)&&!n(a,b,t,e,this.originalLink))&&(null===(n=this.linkValidation)||n(a,b,t,e,this.originalLink))},yn.prototype.isLabelDependentOnLink=function(a,b){if(null===a)return!1;var t=a.labeledLink;if(null===t)return!1;if(t===b)return!0;var e=new ct;return e.add(a),function t(a,b,e,n){if(b===e)return!0;var o=b.fromNode;return!(null===o||!o.isLinkLabel||(n.add(o),!t(a,o.labeledLink,e,n)))||!(null===(b=b.toNode)||!b.isLinkLabel||(n.add(b),!t(a,b.labeledLink,e,n)))}(this,t,b,e)},yn.prototype.isValidCycle=function(a,b,t){if(void 0===t&&(t=null),null===a||null===b)return this.isUnconnectedLinkValid;var e=this.diagram.validCycle;if(e!==ks){if(e===Ns){if(null!==(e=t||this.temporaryLink)&&!e.isTreeLink)return!0;for(e=b.linksConnected;e.next();){var n=e.value;if(n!==t&&n.isTreeLink&&n.toNode===b)return!1}return!mn(this,a,b,t,!0)}if(e===Cs){if(null!==(e=t||this.temporaryLink)&&!e.isTreeLink)return!0;for(e=a.linksConnected;e.next();)if((n=e.value)!==t&&n.isTreeLink&&n.fromNode===a)return!1;return!mn(this,a,b,t,!0)}if(e===Ms)return a===b?a=!0:((e=new ct).add(b),a=function t(a,b,e,n,o){if(e===n)return!0;if(null===e||null===n||b.contains(e))return!1;b.add(e);for(var r=e.linksConnected;r.next();){var g=r.value;if(g!==o&&g.toNode===e&&((g=g.fromNode)!==e&&t(a,b,g,n,o)))return!0}return!1}(this,e,a,b,t)),!a;if(e===Ss)return!mn(this,a,b,t,!1);if(e===Ps)return a===b?a=!0:((e=new ct).add(b),a=function t(a,b,e,n,o){if(e===n)return!0;if(null===e||null===n||b.contains(e))return!1;b.add(e);for(var r=e.linksConnected;r.next();){var g=r.value;if(g!==o){var h=g.fromNode;if(g=g.toNode,(h=h===e?g:h)!==e&&t(a,b,h,n,o))return!0}}return!1}(this,e,a,b,t)),!a}return!0},v.Object.defineProperties(yn.prototype,{portGravity:{get:function(){return this.Ef},set:function(a){0<=a&&(this.Ef=a)}},isUnconnectedLinkValid:{get:function(){return this.Y},set:function(a){this.Y=a}},linkingCursor:{get:function(){return this.fi},set:function(a){this.fi=a}},temporaryLink:{get:function(){return this.Dw},set:function(a){this.Dw=a}},temporaryFromNode:{get:function(){return this.Bw},set:function(a){this.Bw=a}},temporaryFromPort:{get:function(){return this.Cw},set:function(a){this.Cw=a}},temporaryToNode:{get:function(){return this.Ew},set:function(a){this.Ew=a}},temporaryToPort:{get:function(){return this.Fw},set:function(a){this.Fw=a}},originalLink:{get:function(){return this.Za},set:function(a){this.Za=a}},originalFromNode:{get:function(){return this.Ha},set:function(a){this.Ha=a}},originalFromPort:{get:function(){return this.Ia},set:function(a){this.Ia=a}},originalToNode:{get:function(){return this.Ic},set:function(a){this.Ic=a}},originalToPort:{get:function(){return this.Yc},set:function(a){this.Yc=a}},isForwards:{get:function(){return this.I},set:function(a){this.I=a}},validPortsCache:{get:function(){return this.vy}},targetPort:{get:function(){return this.Sq},set:function(a){this.Sq=a}},linkValidation:{get:function(){return this.xi},set:function(a){this.xi=a}},portTargeted:{get:function(){return this.Oh},set:function(a){this.Oh=a}}}),yn.className="LinkingBaseTool",m(vn,yn),vn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowLink||!a.model.vt()||!a.lastInput.left||a.currentTool!==this&&!this.isBeyondDragSize())&&null!==this.findLinkablePort()},vn.prototype.findLinkablePort=function(){var a=this.diagram,b=this.startObject;if(null===b&&(b=a.Ub(a.firstInput.documentPoint,null,null)),null===b||!(b.part instanceof Au))return null;if((a=this.direction)===xn||a===bn){var t=this.findValidLinkablePort(b,!1);if(null!==t)return this.isForwards=!0,t}return a!==xn&&a!==wn||null===(b=this.findValidLinkablePort(b,!0))?null:(this.isForwards=!1,b)},vn.prototype.doActivate=function(){var a=this.diagram,b=this.findLinkablePort();null!==b&&(this.ua(this.name),a.isMouseCaptured=!0,a.currentCursor=this.linkingCursor,this.isForwards?(null===this.temporaryToNode||this.temporaryToNode.location.u()||(this.temporaryToNode.location=a.lastInput.documentPoint),this.originalFromPort=b,(b=this.originalFromPort.part)instanceof Au&&(this.originalFromNode=b),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1)):(null===this.temporaryFromNode||this.temporaryFromNode.location.u()||(this.temporaryFromNode.location=a.lastInput.documentPoint),this.originalToPort=b,(b=this.originalToPort.part)instanceof Au&&(this.originalToNode=b),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0)),a.add(this.temporaryFromNode),a.add(this.temporaryToNode),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.temporaryLink.isTreeLink=this.isNewTreeLink(),this.temporaryLink.Ta(),a.add(this.temporaryLink)),this.isActive=!0)},vn.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.remove(this.temporaryLink),a.remove(this.temporaryFromNode),a.remove(this.temporaryToNode),a.isMouseCaptured=!1,a.currentCursor="",this.Hg()},vn.prototype.doStop=function(){yn.prototype.doStop.call(this),this.startObject=null},vn.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.transactionResult=null,t=null,e=null,n=null,o=null;try{var g=this.targetPort=this.findTargetPort(this.isForwards);if(null!==g){var r=g.part;r instanceof Au&&(this.isForwards?(null!==this.originalFromNode&&(b=this.originalFromNode,t=this.originalFromPort),e=r,n=g):(b=r,t=g,null!==this.originalToNode&&(e=this.originalToNode,n=this.originalToPort)))}else this.isForwards?null!==this.originalFromNode&&this.isUnconnectedLinkValid&&(b=this.originalFromNode,t=this.originalFromPort):null!==this.originalToNode&&this.isUnconnectedLinkValid&&(e=this.originalToNode,n=this.originalToPort);null!==b||null!==e?null!==(o=this.insertLink(b,t,e,n))?(null===g&&(this.isForwards?o.defaultToPoint=a.lastInput.documentPoint:o.defaultFromPoint=a.lastInput.documentPoint),a.allowSelect&&(a.R("ChangingSelection",a.selection),a.clearSelection(!0),o.isSelected=!0),this.transactionResult=this.name,a.R("LinkDrawn",o)):(a.model.gq(),this.doNoLink(b,t,e,n)):this.isForwards?this.doNoLink(this.originalFromNode,this.originalFromPort,null,null):this.doNoLink(null,null,this.originalToNode,this.originalToPort)}finally{this.stopTool(),o&&a.allowSelect&&a.R("ChangedSelection",a.selection)}}},vn.prototype.isNewTreeLink=function(){var a=this.archetypeLinkData;if(null===a)return!0;if(a instanceof Wu)return a.isTreeLink;var b=this.diagram;return null===b||(a=b.partManager.getLinkCategoryForData(a),null===(b=b.partManager.findLinkTemplateForCategory(a))||b.isTreeLink)},vn.prototype.insertLink=function(a,b,t,e){return this.diagram.partManager.insertLink(a,b,t,e)},vn.prototype.doNoLink=function(){},v.Object.defineProperties(vn.prototype,{archetypeLinkData:{get:function(){return this.v},set:function(a){this.v=a}},archetypeLabelNodeData:{get:function(){return this.l},set:function(a){this.l=a}},direction:{get:function(){return this.J},set:function(a){this.J=a}},startObject:{get:function(){return this.Je},set:function(a){this.Je=a}}});var xn=new _(vn,"Either",0),bn=new _(vn,"ForwardsOnly",0),wn=new _(vn,"BackwardsOnly",0);function kn(){yn.call(this),this.name="Relinking";var a=new rl;a.figure="Diamond",a.desiredSize=zt,a.fill="lightblue",a.stroke="dodgerblue",a.cursor=this.linkingCursor,a.segmentIndex=0,this.v=a,(a=new rl).figure="Diamond",a.desiredSize=zt,a.fill="lightblue",a.stroke="dodgerblue",a.cursor=this.linkingCursor,a.segmentIndex=-1,this.Je=a,this.l=null,this.gx=new Wt}function Mn(a,b,t,e,n){null!==b?(a.copyPortProperties(b,t,a.temporaryFromNode,a.temporaryFromPort,!1),a.diagram.add(a.temporaryFromNode)):a.diagram.remove(a.temporaryFromNode),null!==e?(a.copyPortProperties(e,n,a.temporaryToNode,a.temporaryToPort,!0),a.diagram.add(a.temporaryToNode)):a.diagram.remove(a.temporaryToNode)}function Sn(){Ee.call(this),this.name="LinkReshaping";var a=new rl;a.figure="Rectangle",a.desiredSize=Et,a.fill="lightblue",a.stroke="dodgerblue",this.v=a,(a=new rl).figure="Diamond",a.desiredSize=zt,a.fill="lightblue",a.stroke="dodgerblue",a.cursor="move",this.I=a,this.Y=3,this.Yt=this.l=null,this.hx=new Mt,this.ps=new lt}function Pn(a,b,t,e,n,o){return o?Math.abs(b.y-t.y)<a.resegmentingDistance&&Math.abs(t.y-e.y)<a.resegmentingDistance&&Math.abs(e.y-n.y)<a.resegmentingDistance:Math.abs(b.x-t.x)<a.resegmentingDistance&&Math.abs(t.x-e.x)<a.resegmentingDistance&&Math.abs(e.x-n.x)<a.resegmentingDistance}vn.className="LinkingTool",vn.Either=xn,vn.ForwardsOnly=bn,vn.BackwardsOnly=wn,m(kn,yn),kn.prototype.updateAdornments=function(a){if(null!==a&&a instanceof Wu){var b="RelinkFrom",t=null;if(a.isSelected&&!this.diagram.isReadOnly){var e=a.selectionObject;null!==e&&a.canRelinkFrom()&&a.actualBounds.u()&&a.isVisible()&&e.actualBounds.u()&&e.zf()&&(null===(t=a.fk(b))&&(t=this.makeAdornment(e,!1),a.Ch(b,t)))}null===t&&a.Af(b),b="RelinkTo",t=null,a.isSelected&&!this.diagram.isReadOnly&&(null!==(e=a.selectionObject)&&a.canRelinkTo()&&a.actualBounds.u()&&a.isVisible()&&e.actualBounds.u()&&e.zf()&&(null===(t=a.fk(b))?(t=this.makeAdornment(e,!0),a.Ch(b,t)):t.o())),null===t&&a.Af(b)}},kn.prototype.makeAdornment=function(a,b){var t=new Lu;return t.type=jh.Link,null!==(b=b?this.toHandleArchetype:this.fromHandleArchetype)&&t.add(b.copy()),t.adornedObject=a,t},kn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowRelink||!a.model.vt()||!a.lastInput.left)return!1;var b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkFrom");return null===b&&(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkTo")),null!==b},kn.prototype.doActivate=function(){var a=this.diagram;if(null===this.originalLink){var b=this.handle;if(null===b&&(null===(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkFrom"))&&(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkTo"))),null===b)return;var t=b.part;if(!(t instanceof Lu&&t.adornedPart instanceof Wu))return;this.handle=b,this.isForwards=null===t||"RelinkTo"===t.category,this.originalLink=t.adornedPart}this.ua(this.name),a.isMouseCaptured=!0,a.currentCursor=this.linkingCursor,this.originalFromPort=this.originalLink.fromPort,this.originalFromNode=this.originalLink.fromNode,this.originalToPort=this.originalLink.toPort,this.originalToNode=this.originalLink.toNode,this.gx.set(this.originalLink.actualBounds),null!==this.originalLink&&0<this.originalLink.pointsCount&&(null===this.originalLink.fromNode&&(null!==this.temporaryFromPort&&(this.temporaryFromPort.desiredSize=It),null!==this.temporaryFromNode&&(this.temporaryFromNode.location=this.originalLink.i(0))),null===this.originalLink.toNode&&(null!==this.temporaryToPort&&(this.temporaryToPort.desiredSize=It),null!==this.temporaryToNode&&(this.temporaryToNode.location=this.originalLink.i(this.originalLink.pointsCount-1)))),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0),a.add(this.temporaryFromNode),a.add(this.temporaryToNode),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.copyLinkProperties(this.originalLink,this.temporaryLink),this.temporaryLink.Ta(),a.add(this.temporaryLink)),this.isActive=!0},kn.prototype.copyLinkProperties=function(a,b){if(null!==a&&null!==b){b.adjusting=a.adjusting,b.corner=a.corner;var t=a.curve;t!==bc&&t!==xc||(t=mc),b.curve=t,b.curviness=a.curviness,b.isTreeLink=a.isTreeLink,b.points=a.points,b.routing=a.routing,b.smoothness=a.smoothness,b.fromSpot=a.fromSpot,b.fromEndSegmentLength=a.fromEndSegmentLength,b.fromShortLength=a.fromShortLength,b.toSpot=a.toSpot,b.toEndSegmentLength=a.toEndSegmentLength,b.toShortLength=a.toShortLength}},kn.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.remove(this.temporaryLink),a.remove(this.temporaryFromNode),a.remove(this.temporaryToNode),a.isMouseCaptured=!1,a.currentCursor="",this.Hg()},kn.prototype.doStop=function(){yn.prototype.doStop.call(this),this.handle=null},kn.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram;this.transactionResult=null;var b=this.originalFromNode,t=this.originalFromPort,e=this.originalToNode,n=this.originalToPort,o=this.originalLink;if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort){var g=this.targetPort.part;g instanceof Au&&(this.isForwards?(e=g,n=this.targetPort):(b=g,t=this.targetPort))}else this.isUnconnectedLinkValid?this.isForwards?n=e=null:t=b=null:o=null;null!==o?(this.reconnectLink(o,this.isForwards?e:b,this.isForwards?n:t,this.isForwards),null===this.targetPort&&(this.isForwards?o.defaultToPoint=a.lastInput.documentPoint:o.defaultFromPoint=a.lastInput.documentPoint,o.Ta()),a.allowSelect&&(o.isSelected=!0),this.transactionResult=this.name,a.R("LinkRelinked",o,this.isForwards?this.originalToPort:this.originalFromPort)):this.doNoRelink(this.originalLink,this.isForwards),this.originalLink.tq(this.gx)}this.stopTool()},kn.prototype.reconnectLink=function(a,b,t,e){return t=null!==t&&null!==t.portId?t.portId:"",e?(a.toNode=b,a.toPortId=t):(a.fromNode=b,a.fromPortId=t),!0},kn.prototype.doNoRelink=function(){},v.Object.defineProperties(kn.prototype,{fromHandleArchetype:{get:function(){return this.v},set:function(a){this.v=a}},toHandleArchetype:{get:function(){return this.Je},set:function(a){this.Je=a}},handle:{get:function(){return this.l},set:function(a){if(null!==a&&!(a.part instanceof Lu))throw Error("new handle is not in an Adornment: "+a);this.l=a}}}),kn.className="RelinkingTool",Y("linkingTool",(function(){return this.findTool("Linking")}),(function(a){this.Va("Linking",a,this.mouseMoveTools)})),Y("relinkingTool",(function(){return this.findTool("Relinking")}),(function(a){this.Va("Relinking",a,this.mouseDownTools)})),m(Sn,Ee),Sn.prototype.Bv=function(a){return a&&a.ws&&0!==a.ws.value?a.ws:Nn},Sn.prototype.Im=function(a,b){a.ws=b},Sn.prototype.updateAdornments=function(a){if(null!==a&&a instanceof Wu){var b=null;if(a.isSelected&&!this.diagram.isReadOnly){var t=a.path;null!==t&&a.canReshape()&&a.actualBounds.u()&&a.isVisible()&&t.actualBounds.u()&&t.zf()&&(null===(b=a.fk(this.name))||b.ax!==a.pointsCount||b.qx!==a.resegmentable)&&(null!==(b=this.makeAdornment(t))&&(b.ax=a.pointsCount,b.qx=a.resegmentable,a.Ch(this.name,b)))}null===b&&a.Af(this.name)}},Sn.prototype.makeAdornment=function(a){var b=a.part,t=b.pointsCount,e=b.isOrthogonal,n=null;if(null!==b.points&&1<t){(n=new Lu).type=jh.Link,t=b.firstPickIndex;var o=b.lastPickIndex,g=e?1:0;if(b.resegmentable&&b.computeCurve()!==vc)for(var r=t+g;r<o-g;r++){var h=this.makeResegmentHandle(a,r);null!==h&&(h.segmentIndex=r,h.segmentFraction=.5,h.fromMaxLinks=999,n.add(h))}for(g=t+1;g<o;g++)if(null!==(r=this.makeHandle(a,g))){if(r.segmentIndex=g,g!==t)if(g===t+1&&e){h=b.i(t);var l=b.i(t+1);ne.A(h.x,l.x)&&ne.A(h.y,l.y)&&(l=b.i(t-1)),ne.A(h.x,l.x)?(this.Im(r,Tn),r.cursor="n-resize"):ne.A(h.y,l.y)&&(this.Im(r,Cn),r.cursor="w-resize")}else g===o-1&&e?(h=b.i(o-1),l=b.i(o),ne.A(h.x,l.x)&&ne.A(h.y,l.y)&&(h=b.i(o+1)),ne.A(h.x,l.x)?(this.Im(r,Tn),r.cursor="n-resize"):ne.A(h.y,l.y)&&(this.Im(r,Cn),r.cursor="w-resize")):g!==o&&(this.Im(r,Ln),r.cursor="move");n.add(r)}n.adornedObject=a}return n},Sn.prototype.makeHandle=function(){var a=this.handleArchetype;return null===a?null:a.copy()},Sn.prototype.makeResegmentHandle=function(){var a=this.midHandleArchetype;return null===a?null:a.copy()},Sn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||!a.allowReshape||!a.lastInput.left)&&null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name)},Sn.prototype.doActivate=function(){var a=this.diagram;if(null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name)),null!==this.handle){var b=this.handle.part.adornedPart;if(b instanceof Wu){if(this.Yt=b,a.isMouseCaptured=!0,this.ua(this.name),b.resegmentable&&999===this.handle.fromMaxLinks){var t=b.points.copy(),e=this.getResegmentingPoint();if(t.Kb(this.handle.segmentIndex+1,e),b.isOrthogonal&&t.Kb(this.handle.segmentIndex+1,e),b.points=t,b.Lb(),b.updateAdornments(),this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name),null===this.handle)return void this.doDeactivate()}this.hx=b.i(this.handle.segmentIndex),this.ps=b.points.copy(),this.isActive=!0}}},Sn.prototype.doDeactivate=function(){this.Hg(),this.Yt=this.handle=null,this.isActive=this.diagram.isMouseCaptured=!1},Sn.prototype.doCancel=function(){var a=this.adornedLink;null!==a&&(a.points=this.ps),this.stopTool()},Sn.prototype.getResegmentingPoint=function(){return this.handle.ga(xi)},Sn.prototype.doMouseMove=function(){var a=this.diagram;this.isActive&&(a=this.computeReshape(a.lastInput.documentPoint),this.reshape(a))},Sn.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.computeReshape(a.lastInput.documentPoint);if(this.reshape(b),null!==(b=this.adornedLink)&&b.resegmentable){var t=this.handle.segmentIndex,e=b.i(t-1),n=b.i(t),o=b.i(t+1);if(b.isOrthogonal){if(t>b.firstPickIndex+1&&t<b.lastPickIndex-1){var g=b.i(t-2);if(Math.abs(e.x-n.x)<this.resegmentingDistance&&Math.abs(e.y-n.y)<this.resegmentingDistance&&(Pn(this,g,e,n,o,!0)||Pn(this,g,e,n,o,!1))){var r=b.points.copy();Pn(this,g,e,n,o,!0)?(r.hd(t-2,new Mt(g.x,(o.y+g.y)/2)),r.hd(t+1,new Mt(o.x,(o.y+g.y)/2))):(r.hd(t-2,new Mt((o.x+g.x)/2,g.y)),r.hd(t+1,new Mt((o.x+g.x)/2,o.y))),r.lb(t),r.lb(t-1),b.points=r,b.Lb()}else g=b.i(t+2),Math.abs(n.x-o.x)<this.resegmentingDistance&&Math.abs(n.y-o.y)<this.resegmentingDistance&&(Pn(this,e,n,o,g,!0)||Pn(this,e,n,o,g,!1))&&(r=b.points.copy(),Pn(this,e,n,o,g,!0)?(r.hd(t-1,new Mt(e.x,(e.y+g.y)/2)),r.hd(t+2,new Mt(g.x,(e.y+g.y)/2))):(r.hd(t-1,new Mt((e.x+g.x)/2,e.y)),r.hd(t+2,new Mt((e.x+g.x)/2,g.y))),r.lb(t+1),r.lb(t),b.points=r,b.Lb())}}else g=Mt.alloc(),ne.Lh(e.x,e.y,o.x,o.y,n.x,n.y,g)&&g.Be(n)<this.resegmentingDistance*this.resegmentingDistance&&((e=b.points.copy()).lb(t),b.points=e,b.Lb()),Mt.free(g)}a.Na(),this.transactionResult=this.name,a.R("LinkReshaped",this.adornedLink,this.ps)}this.stopTool()},Sn.prototype.reshape=function(a){var b=this.adornedLink;b.Nh();var t=this.handle.segmentIndex,e=this.Bv(this.handle);if(b.isOrthogonal)if(t===b.firstPickIndex+1)t=b.firstPickIndex+1,e===Tn?(b.K(t,b.i(t-1).x,a.y),b.K(t+1,b.i(t+2).x,a.y)):e===Cn&&(b.K(t,a.x,b.i(t-1).y),b.K(t+1,a.x,b.i(t+2).y));else if(t===b.lastPickIndex-1)t=b.lastPickIndex-1,e===Tn?(b.K(t-1,b.i(t-2).x,a.y),b.K(t,b.i(t+1).x,a.y)):e===Cn&&(b.K(t-1,a.x,b.i(t-2).y),b.K(t,a.x,b.i(t+1).y));else{e=t;var n=b.i(e),o=b.i(e-1),g=b.i(e+1);ne.A(o.x,n.x)&&ne.A(n.y,g.y)?(ne.A(o.x,b.i(e-2).x)&&!ne.A(o.y,b.i(e-2).y)?(b.m(e,a.x,o.y),t++,e++):b.K(e-1,a.x,o.y),ne.A(g.y,b.i(e+2).y)&&!ne.A(g.x,b.i(e+2).x)?b.m(e+1,g.x,a.y):b.K(e+1,g.x,a.y)):ne.A(o.y,n.y)&&ne.A(n.x,g.x)?(ne.A(o.y,b.i(e-2).y)&&!ne.A(o.x,b.i(e-2).x)?(b.m(e,o.x,a.y),t++,e++):b.K(e-1,o.x,a.y),ne.A(g.x,b.i(e+2).x)&&!ne.A(g.y,b.i(e+2).y)?b.m(e+1,a.x,g.y):b.K(e+1,a.x,g.y)):ne.A(o.x,n.x)&&ne.A(n.x,g.x)?(ne.A(o.x,b.i(e-2).x)&&!ne.A(o.y,b.i(e-2).y)?(b.m(e,a.x,o.y),t++,e++):b.K(e-1,a.x,o.y),ne.A(g.x,b.i(e+2).x)&&!ne.A(g.y,b.i(e+2).y)?b.m(e+1,a.x,g.y):b.K(e+1,a.x,g.y)):ne.A(o.y,n.y)&&ne.A(n.y,g.y)&&(ne.A(o.y,b.i(e-2).y)&&!ne.A(o.x,b.i(e-2).x)?(b.m(e,o.x,a.y),t++,e++):b.K(e-1,o.x,a.y),ne.A(g.y,b.i(e+2).y)&&!ne.A(g.x,b.i(e+2).x)?b.m(e+1,g.x,a.y):b.K(e+1,g.x,a.y)),b.K(t,a.x,a.y)}else b.K(t,a.x,a.y),e=b.fromNode,n=b.fromPort,null!==e&&(null!==(o=e.findVisibleNode())&&o!==e&&(n=(e=o).port)),1===t&&b.computeSpot(!0,n).jc()&&(o=n.ga(xi,Mt.alloc()),e=b.getLinkPointFromPoint(e,n,o,a,!0,Mt.alloc()),b.K(0,e.x,e.y),Mt.free(o),Mt.free(e)),e=b.toNode,n=b.toPort,null!==e&&(null!==(o=e.findVisibleNode())&&o!==e&&(n=(e=o).port)),t===b.pointsCount-2&&b.computeSpot(!1,n).jc()&&(t=n.ga(xi,Mt.alloc()),a=b.getLinkPointFromPoint(e,n,t,a,!1,Mt.alloc()),b.K(b.pointsCount-1,a.x,a.y),Mt.free(t),Mt.free(a));b.sf()},Sn.prototype.computeReshape=function(a){var b=this.adornedLink,t=this.handle.segmentIndex;switch(this.Bv(this.handle)){case Ln:return a;case Tn:return new Mt(b.i(t).x,a.y);case Cn:return new Mt(a.x,b.i(t).y);default:case Nn:return b.i(t)}},v.Object.defineProperties(Sn.prototype,{handleArchetype:{get:function(){return this.v},set:function(a){this.v=a}},midHandleArchetype:{get:function(){return this.I},set:function(a){this.I=a}},handle:{get:function(){return this.l},set:function(a){if(null!==a&&!(a.part instanceof Lu))throw Error("new handle is not in an Adornment: "+a);this.l=a}},adornedLink:{get:function(){return this.Yt}},resegmentingDistance:{get:function(){return this.Y},set:function(a){this.Y=a}},originalPoint:{get:function(){return this.hx}},originalPoints:{get:function(){return this.ps}}}),Sn.prototype.setReshapingBehavior=Sn.prototype.Im,Sn.prototype.getReshapingBehavior=Sn.prototype.Bv;var Nn=new _(Sn,"None",0),Cn=new _(Sn,"Horizontal",1),Tn=new _(Sn,"Vertical",2),Ln=new _(Sn,"All",3);function An(){Ee.call(this),this.name="Resizing",this.eg=new qt(1,1).freeze(),this.dg=new qt(9999,9999).freeze(),this.Ng=new qt(NaN,NaN).freeze(),this.I=!1,this.be=null;var a=new rl;a.alignmentFocus=xi,a.figure="Rectangle",a.desiredSize=Et,a.fill="lightblue",a.stroke="dodgerblue",a.strokeWidth=1,a.cursor="pointer",this.v=a,this.l=null,this.os=new Mt,this.ex=new qt,this.Xo=new Mt,this.ou=new qt(0,0),this.nu=new qt(1/0,1/0),this.mu=new qt(1,1),this.$w=!0}function jn(){Ee.call(this),this.name="Rotating",this.Ia=45,this.Ha=2,this.Xo=new Mt,this.be=null;var a=new rl;a.figure="Ellipse",a.desiredSize=zt,a.fill="lightblue",a.stroke="dodgerblue",a.strokeWidth=1,a.cursor="pointer",this.v=a,this.l=null,this.bx=0,this.Mu=new Mt(NaN,NaN),this.I=0,this.Y=50}function Dn(){Ee.call(this),this.name="ClickSelecting"}function Fn(){Ee.call(this),this.name="Action",this.Bk=null}function On(){Ee.call(this),this.name="ClickCreating",this.ij=null,this.v=!0,this.l=!1,this.Uw=new Mt(0,0)}function Bn(){Ee.call(this),this.name="DragSelecting",this.Vk=175,this.v=!1;var a=new lu;a.layerName="Tool",a.selectable=!1;var b=new rl;b.name="SHAPE",b.figure="Rectangle",b.fill=null,b.stroke="magenta",a.add(b),this.l=a}function In(){Ee.call(this),this.name="Panning",this.Ju=new Mt,this.Dy=new Mt,this.Mg=!1;var a=this;this.kx=function(){var b=a.diagram;null!==b&&b.removeEventListener(w.document,"scroll",a.kx,!1),a.stopTool()}}function Rn(){this.Y=this.I=this.l=this.v=null}function En(a,b,t){this.text=a,this.Ax=b,this.visible=t}function zn(){Ee.call(this),this.name="ContextMenu",this.v=this.du=this.l=null,this.Zw=new Mt,this.eu=null,this.yu=!1;var a=this;this.Xu=function(){a.stopTool()}}function Vn(a){return a.preventDefault(),!1}function Yn(a){var b=a.diagram;if(a.isActive){var t=a.currentContextMenu;if(null!==t){if(!(t instanceof Rn)){var e=b.Ub(b.lastInput.documentPoint,null,null);null!==e&&e.Dg(t)&&a.standardMouseClick(null,null)}a.stopTool(),a.canStart()&&(b.currentTool=a,a.doMouseUp())}}else a.canStart()&&(Gn(a,!0),a.isActive||a.stopTool())}function Gn(a,b,t){if(void 0===t&&(t=null),!a.yu&&(a.yu=!0,b&&a.standardMouseSelect(),b=a.standardMouseClick(),a.yu=!1,!b))if(a.isActive=!0,b=Xn,null===t&&(t=a.findObjectWithContextMenu()),null!==t){var e=t.contextMenu;null!==e?(a.currentObject=t instanceof _s?t:null,a.showContextMenu(e,a.currentObject)):null!==b&&a.showContextMenu(b,a.currentObject)}else null!==b&&a.showContextMenu(b,null)}Sn.className="LinkReshapingTool",Sn.None=Nn,Sn.Horizontal=Cn,Sn.Vertical=Tn,Sn.All=Ln,Y("linkReshapingTool",(function(){return this.findTool("LinkReshaping")}),(function(a){this.Va("LinkReshaping",a,this.mouseDownTools)})),m(An,Ee),An.prototype.updateAdornments=function(a){if(!(null===a||a instanceof Wu)){if(a.isSelected&&!this.diagram.isReadOnly){var b=a.resizeObject,t=a.fk(this.name);if(null!==b&&a.canResize()&&a.actualBounds.u()&&a.isVisible()&&b.actualBounds.u()&&b.zf()&&(null!==t&&t.adornedObject===b||(t=this.makeAdornment(b)),null!==t))return b=b.Xi(),Su(a)&&this.updateResizeHandles(t,b),void a.Ch(this.name,t)}a.Af(this.name)}},An.prototype.makeAdornment=function(a){var b=a.part.resizeAdornmentTemplate;if(null===b){(b=new Lu).type=jh.Spot,b.locationSpot=xi;var t=new Hu;t.isPanelMain=!0,b.add(t),b.add(this.makeHandle(a,gi)),b.add(this.makeHandle(a,mi)),b.add(this.makeHandle(a,Mi)),b.add(this.makeHandle(a,wi)),b.add(this.makeHandle(a,Xi)),b.add(this.makeHandle(a,Ui)),b.add(this.makeHandle(a,Ki)),b.add(this.makeHandle(a,qi))}else if(qh(b),null===(b=b.copy()))return null;return b.adornedObject=a,b},An.prototype.makeHandle=function(a,b){return null===(a=this.handleArchetype)?null:((a=a.copy()).alignment=b,a)},An.prototype.updateResizeHandles=function(a,b){if(null!==a)if(!a.alignment.Mb()&&("pointer"===a.cursor||0<a.cursor.indexOf("resize")))t:{var t=a.alignment;if(t.jc()&&(t=xi),0>=t.x)b=0>=t.y?b+225:1<=t.y?b+135:b+180;else if(1<=t.x)0>=t.y?b+=315:1<=t.y&&(b+=45);else if(0>=t.y)b+=270;else{if(!(1<=t.y))break t;b+=90}0>b?b+=360:360<=b&&(b-=360),a.cursor=22.5>b?"e-resize":67.5>b?"se-resize":112.5>b?"s-resize":157.5>b?"sw-resize":202.5>b?"w-resize":247.5>b?"nw-resize":292.5>b?"n-resize":337.5>b?"ne-resize":"e-resize"}else if(a instanceof jh)for(a=a.elements;a.next();)this.updateResizeHandles(a.value,b)},An.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||!a.allowResize||!a.lastInput.left)&&null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name)},An.prototype.doActivate=function(){var a=this.diagram;null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name)),null!==this.handle&&(this.adornedObject=this.handle.part.adornedObject,null!==this.adornedObject&&(this.os.set(this.adornedObject.ga(this.handle.alignment.Qv())),this.Xo.set(this.adornedObject.part.location),this.ex.set(this.adornedObject.desiredSize),this.mu=this.computeCellSize(),this.ou=this.computeMinSize(),this.nu=this.computeMaxSize(),a.isMouseCaptured=!0,this.$w=a.animationManager.isEnabled,a.animationManager.isEnabled=!1,this.ua(this.name),this.isActive=!0))},An.prototype.doDeactivate=function(){var a=this.diagram;this.Hg(),this.be=this.handle=null,this.isActive=a.isMouseCaptured=!1,a.animationManager.isEnabled=this.$w},An.prototype.doCancel=function(){null!==this.adornedObject&&(this.adornedObject.desiredSize=this.originalDesiredSize,this.adornedObject.part.location=this.originalLocation),this.stopTool()},An.prototype.doMouseMove=function(){var a=this.diagram;if(this.isActive){var b=this.ou,t=this.nu,e=this.mu,n=this.adornedObject.ot(a.lastInput.documentPoint,Mt.alloc()),o=this.computeReshape();b=this.computeResize(n,this.handle.alignment,b,t,e,o),this.resize(b),a.Wc(),Mt.free(n)}},An.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.ou,t=this.nu,e=this.mu,n=this.adornedObject.ot(a.lastInput.documentPoint,Mt.alloc()),o=this.computeReshape();b=this.computeResize(n,this.handle.alignment,b,t,e,o),this.resize(b),Mt.free(n),a.Na(),this.transactionResult=this.name,a.R("PartResized",this.adornedObject,this.originalDesiredSize)}this.stopTool()},An.prototype.resize=function(a){var b=this.diagram,t=this.adornedObject;if(null!==t){if(t.desiredSize=a.size,(a=t.part).yb(),t=t.ga(this.handle.alignment.Qv()),a instanceof qu){var e=new lt;e.add(a),b.moveParts(e,this.oppositePoint.copy().$d(t),!0)}else a.location=a.location.copy().$d(t).add(this.oppositePoint);b.Wc()}},An.prototype.computeResize=function(a,b,t,e,n,o){b.jc()&&(b=xi);var g=this.adornedObject.naturalBounds,r=g.x,h=g.y,l=g.x+g.width,c=g.y+g.height,f=1;if(!o){f=g.width;var p=g.height;0>=f&&(f=1),0>=p&&(p=1),f=p/f}return p=Mt.alloc(),ne.mq(a.x,a.y,r,h,n.width,n.height,p),a=g.copy(),0>=b.x?0>=b.y?(a.x=Math.max(p.x,l-e.width),a.x=Math.min(a.x,l-t.width),a.width=Math.max(l-a.x,t.width),a.y=Math.max(p.y,c-e.height),a.y=Math.min(a.y,c-t.height),a.height=Math.max(c-a.y,t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width),a.x=l-a.width,a.y=c-a.height)):1<=b.y?(a.x=Math.max(p.x,l-e.width),a.x=Math.min(a.x,l-t.width),a.width=Math.max(l-a.x,t.width),a.height=Math.max(Math.min(p.y-h,e.height),t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width),a.x=l-a.width)):(a.x=Math.max(p.x,l-e.width),a.x=Math.min(a.x,l-t.width),a.width=l-a.x,o||(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f,a.y=h+.5*(c-h-a.height))):1<=b.x?0>=b.y?(a.width=Math.max(Math.min(p.x-r,e.width),t.width),a.y=Math.max(p.y,c-e.height),a.y=Math.min(a.y,c-t.height),a.height=Math.max(c-a.y,t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width),a.y=c-a.height)):1<=b.y?(a.width=Math.max(Math.min(p.x-r,e.width),t.width),a.height=Math.max(Math.min(p.y-h,e.height),t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width))):(a.width=Math.max(Math.min(p.x-r,e.width),t.width),o||(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f,a.y=h+.5*(c-h-a.height))):0>=b.y?(a.y=Math.max(p.y,c-e.height),a.y=Math.min(a.y,c-t.height),a.height=c-a.y,o||(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width,a.x=r+.5*(l-r-a.width))):1<=b.y&&(a.height=Math.max(Math.min(p.y-h,e.height),t.height),o||(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width,a.x=r+.5*(l-r-a.width))),Mt.free(p),a},An.prototype.computeReshape=function(){var a=ns;return this.adornedObject instanceof rl&&(a=al(this.adornedObject)),!(a===os||this.diagram.lastInput.shift)},An.prototype.computeMinSize=function(){var a=this.adornedObject.minSize.copy(),b=this.minSize;return!isNaN(b.width)&&b.width>a.width&&(a.width=b.width),!isNaN(b.height)&&b.height>a.height&&(a.height=b.height),a},An.prototype.computeMaxSize=function(){var a=this.adornedObject.maxSize.copy(),b=this.maxSize;return!isNaN(b.width)&&b.width<a.width&&(a.width=b.width),!isNaN(b.height)&&b.height<a.height&&(a.height=b.height),a},An.prototype.computeCellSize=function(){var a=new qt(NaN,NaN),b=this.adornedObject.part;return null!==b&&(b=b.resizeCellSize,!isNaN(b.width)&&0<b.width&&(a.width=b.width),!isNaN(b.height)&&0<b.height&&(a.height=b.height)),b=this.cellSize,isNaN(a.width)&&!isNaN(b.width)&&0<b.width&&(a.width=b.width),isNaN(a.height)&&!isNaN(b.height)&&0<b.height&&(a.height=b.height),b=this.diagram,(isNaN(a.width)||isNaN(a.height))&&b&&(null!==(b=b.grid)&&b.visible&&this.isGridSnapEnabled&&(b=b.gridCellSize,isNaN(a.width)&&!isNaN(b.width)&&0<b.width&&(a.width=b.width),isNaN(a.height)&&!isNaN(b.height)&&0<b.height&&(a.height=b.height))),(isNaN(a.width)||0===a.width||1/0===a.width)&&(a.width=1),(isNaN(a.height)||0===a.height||1/0===a.height)&&(a.height=1),a},v.Object.defineProperties(An.prototype,{handleArchetype:{get:function(){return this.v},set:function(a){this.v=a}},handle:{get:function(){return this.l},set:function(a){if(null!==a&&!(a.part instanceof Lu))throw Error("new handle is not in an Adornment: "+a);this.l=a}},adornedObject:{get:function(){return this.be},set:function(a){if(null!==a&&a.part instanceof Lu)throw Error("new handle must not be in an Adornment: "+a);this.be=a}},minSize:{get:function(){return this.eg},set:function(a){if(!this.eg.w(a)){var b=a.width;isNaN(b)&&(b=0),a=a.height,isNaN(a)&&(a=0),this.eg.h(b,a)}}},maxSize:{get:function(){return this.dg},set:function(a){if(!this.dg.w(a)){var b=a.width;isNaN(b)&&(b=1/0),a=a.height,isNaN(a)&&(a=1/0),this.dg.h(b,a)}}},cellSize:{get:function(){return this.Ng},set:function(a){this.Ng.w(a)||this.Ng.assign(a)}},isGridSnapEnabled:{get:function(){return this.I},set:function(a){this.I=a}},oppositePoint:{get:function(){return this.os},set:function(a){this.os.w(a)||this.os.assign(a)}},originalDesiredSize:{get:function(){return this.ex}},originalLocation:{get:function(){return this.Xo}}}),An.className="ResizingTool",Y("resizingTool",(function(){return this.findTool("Resizing")}),(function(a){this.Va("Resizing",a,this.mouseDownTools)})),m(jn,Ee),jn.prototype.updateAdornments=function(a){if(null!==a){if(a.Kh()){var b=a.rotateObject;if(b===a||b===a.path||b.isPanelMain)return}if(a.isSelected&&!this.diagram.isReadOnly&&(null!==(b=a.rotateObject)&&a.canRotate()&&a.actualBounds.u()&&a.isVisible()&&b.actualBounds.u()&&b.zf())){var t=a.fk(this.name);if(null!==t&&t.adornedObject===b||(t=this.makeAdornment(b)),null!==t)return t.angle=b.Xi(),null===t.placeholder&&(t.location=this.computeAdornmentLocation(b)),void a.Ch(this.name,t)}a.Af(this.name)}},jn.prototype.makeAdornment=function(a){var b=a.part.rotateAdornmentTemplate;if(null===b){(b=new Lu).type=jh.Position,b.locationSpot=xi;var t=this.handleArchetype;null!==t&&b.add(t.copy())}else if(qh(b),null===(b=b.copy()))return null;return b.adornedObject=a,b},jn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||!a.allowRotate||!a.lastInput.left)&&null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name)},jn.prototype.doActivate=function(){var a=this.diagram;if(null===this.adornedObject){if(null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name)),null===this.handle)return;this.adornedObject=this.handle.part.adornedObject}null!==this.adornedObject&&(this.bx=this.adornedObject.angle,this.Mu=this.computeRotationPoint(this.adornedObject),this.Xo=this.adornedObject.part.location.copy(),a.isMouseCaptured=!0,a.delaysLayout=!0,this.ua(this.name),this.isActive=!0)},jn.prototype.computeRotationPoint=function(a){var b=a.part,t=b.locationObject;return b.rotationSpot.eb()?a.ga(b.rotationSpot):a===b||a===t?t.ga(b.locationSpot):a.ga(xi)},jn.prototype.computeAdornmentLocation=function(a){var b=this.rotationPoint;b.u()||(b=this.computeRotationPoint(a)),b=a.ot(b);var t=this.handleAngle;0>t?t+=360:360<=t&&(t-=360),t=Math.round(45*Math.round(t/45));var e=this.handleDistance;return 0===t?b.x=a.naturalBounds.width+e:45===t?(b.x=a.naturalBounds.width+e,b.y=a.naturalBounds.height+e):90===t?b.y=a.naturalBounds.height+e:135===t?(b.x=-e,b.y=a.naturalBounds.height+e):180===t?b.x=-e:225===t?(b.x=-e,b.y=-e):270===t?b.y=-e:315===t&&(b.x=a.naturalBounds.width+e,b.y=-e),a.ga(b)},jn.prototype.doDeactivate=function(){var a=this.diagram;this.Hg(),this.be=this.handle=null,this.Mu=new Mt(NaN,NaN),this.isActive=a.isMouseCaptured=!1},jn.prototype.doCancel=function(){this.diagram.delaysLayout=!1,this.rotate(this.originalAngle),this.stopTool()},jn.prototype.doMouseMove=function(){var a=this.diagram;this.isActive&&(a=this.computeRotate(a.lastInput.documentPoint),this.rotate(a))},jn.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){a.delaysLayout=!1;var b=this.computeRotate(a.lastInput.documentPoint);this.rotate(b),a.Na(),this.transactionResult=this.name,a.R("PartRotated",this.adornedObject,this.originalAngle)}this.stopTool()},jn.prototype.rotate=function(a){var b=this.adornedObject;if(null!==b){b.angle=a,(b=b.part).yb();var t=b.locationObject,e=b.rotateObject;(t===e||t.Dg(e))&&(t=this.Xo.copy(),b.location=t.$d(this.rotationPoint).rotate(a-this.originalAngle).add(this.rotationPoint)),this.diagram.Wc()}},jn.prototype.computeRotate=function(a){a=this.rotationPoint.Sa(a)-this.handleAngle;var b=this.adornedObject.panel;null!==b&&(a-=b.Xi()),360<=a?a-=360:0>a&&(a+=360),b=Math.min(Math.abs(this.snapAngleMultiple),180);var t=Math.min(Math.abs(this.snapAngleEpsilon),b/2);return!this.diagram.lastInput.shift&&0<b&&0<t&&(a%b<t?a=Math.floor(a/b)*b:a%b>b-t&&(a=(Math.floor(a/b)+1)*b)),360<=a?a-=360:0>a&&(a+=360),a},v.Object.defineProperties(jn.prototype,{handleArchetype:{get:function(){return this.v},set:function(a){this.v=a}},handle:{get:function(){return this.l},set:function(a){if(null!==a&&!(a.part instanceof Lu))throw Error("new handle is not in an Adornment: "+a);this.l=a}},adornedObject:{get:function(){return this.be},set:function(a){if(null!==a&&a.part instanceof Lu)throw Error("new handle must not be in an Adornment: "+a);this.be=a}},snapAngleMultiple:{get:function(){return this.Ia},set:function(a){this.Ia=a}},snapAngleEpsilon:{get:function(){return this.Ha},set:function(a){this.Ha=a}},originalAngle:{get:function(){return this.bx}},rotationPoint:{get:function(){return this.Mu}},handleAngle:{get:function(){return this.I},set:function(a){this.I=a}},handleDistance:{get:function(){return this.Y},set:function(a){this.Y=a}}}),jn.className="RotatingTool",Y("rotatingTool",(function(){return this.findTool("Rotating")}),(function(a){this.Va("Rotating",a,this.mouseDownTools)})),m(Dn,Ee),Dn.prototype.canStart=function(){return!(!this.isEnabled||this.isBeyondDragSize())},Dn.prototype.doMouseUp=function(){this.isActive&&(this.standardMouseSelect(),!this.standardMouseClick()&&this.diagram.lastInput.isTouchEvent&&this.diagram.toolManager.doToolTip()),this.stopTool()},Dn.className="ClickSelectingTool",m(Fn,Ee),Fn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram,b=a.lastInput,t=a.Ub(b.documentPoint,(function(a){for(;null!==a.panel&&!a.isActionable;)a=a.panel;return a}));return null!==t&&(!!t.isActionable&&(this.Bk=t,a.mj=a.Ub(b.documentPoint,null,null),!0))},Fn.prototype.doMouseDown=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.Bk;null!==b&&(a.targetObject=b,null!==b.actionDown&&b.actionDown(a,b))}else this.canStart()&&this.doActivate()},Fn.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.Bk;null!==b&&(a.targetObject=b,null!==b.actionMove&&b.actionMove(a,b))}},Fn.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.Bk;if(null===b)return;a.targetObject=b,null!==b.actionUp&&b.actionUp(a,b),this.standardMouseClick((function(a){for(;null!==a.panel&&(!a.isActionable||a!==b);)a=a.panel;return a}),(function(a){return a===b}))}this.stopTool()},Fn.prototype.doCancel=function(){var a=this.diagram.lastInput,b=this.Bk;null!==b&&(a.targetObject=b,null!==b.actionCancel&&b.actionCancel(a,b),this.stopTool())},Fn.prototype.doStop=function(){this.Bk=null},Fn.className="ActionTool",m(On,Ee),On.prototype.canStart=function(){if(!this.isEnabled||null===this.archetypeNodeData)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.lastInput.left||this.isBeyondDragSize())return!1;if(this.isDoubleClick){if(1===a.lastInput.clickCount&&(this.Uw=a.lastInput.viewPoint.copy()),2!==a.lastInput.clickCount||this.isBeyondDragSize(this.Uw))return!1}else if(1!==a.lastInput.clickCount)return!1;return a.currentTool===this||null===a.jm(a.lastInput.documentPoint,!0)},On.prototype.doMouseUp=function(){var a=this.diagram;this.isActive&&this.insertPart(a.lastInput.documentPoint),this.stopTool()},On.prototype.insertPart=function(a){var b=this.diagram,t=this.archetypeNodeData;if(null===t)return null;var e=null;try{if(b.R("ChangingSelection",b.selection),this.ua(this.name),t instanceof lu)t.Wb()&&(qh(t),null!==(e=t.copy())&&b.add(e));else if(null!==t){var n=b.model.copyNodeData(t);j(n)&&(b.model.qf(n),e=b.wc(n))}if(null!==e){var o=Mt.allocAt(a.x,a.y);this.isGridSnapEnabled&&Lr(this.diagram,e,a,o),e.location=o,b.allowSelect&&(b.clearSelection(!0),e.isSelected=!0),Mt.free(o)}b.Na(),this.transactionResult=this.name,b.R("PartCreated",e)}finally{this.Hg(),b.R("ChangedSelection",b.selection)}return e},v.Object.defineProperties(On.prototype,{archetypeNodeData:{get:function(){return this.ij},set:function(a){this.ij=a}},isDoubleClick:{get:function(){return this.v},set:function(a){this.v=a}},isGridSnapEnabled:{get:function(){return this.l},set:function(a){this.l=a}}}),On.className="ClickCreatingTool",m(Bn,Ee),Bn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(!a.allowSelect)return!1;var b=a.lastInput;return!(!b.left||a.currentTool!==this&&(!this.isBeyondDragSize()||b.timestamp-a.firstInput.timestamp<this.delay||null!==a.jm(b.documentPoint,!0)))},Bn.prototype.doActivate=function(){var a=this.diagram;this.isActive=!0,a.isMouseCaptured=!0,a.skipsUndoManager=!0,a.add(this.box),this.doMouseMove()},Bn.prototype.doDeactivate=function(){var a=this.diagram;a.Cf(),a.remove(this.box),a.skipsUndoManager=!1,this.isActive=a.isMouseCaptured=!1},Bn.prototype.doMouseMove=function(){var a=this.diagram;if(this.isActive&&null!==this.box){var b=this.computeBoxBounds(),t=this.box.Xa("SHAPE");null===t&&(t=this.box.zb());var e=qt.alloc().h(b.width,b.height);b=Mt.allocAt(b.x,b.y),t.desiredSize=e,this.box.position=b,qt.free(e),Mt.free(b),(a.allowHorizontalScroll||a.allowVerticalScroll)&&a.gt(a.lastInput.viewPoint)}},Bn.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram;a.remove(this.box);try{a.currentCursor="wait",a.R("ChangingSelection",a.selection),this.selectInRect(this.computeBoxBounds()),a.R("ChangedSelection",a.selection)}finally{a.currentCursor=""}}this.stopTool()},Bn.prototype.computeBoxBounds=function(){var a=this.diagram;return new Wt(a.firstInput.documentPoint,a.lastInput.documentPoint)},Bn.prototype.selectInRect=function(a){var b=this.diagram,t=b.lastInput;if(a=b.Mx(a,this.isPartialInclusion),J?t.meta:t.control)if(t.shift)for(a=a.iterator;a.next();)(b=a.value).isSelected&&(b.isSelected=!1);else for(a=a.iterator;a.next();)(b=a.value).isSelected=!b.isSelected;else if(t.shift)for(a=a.iterator;a.next();)(b=a.value).isSelected||(b.isSelected=!0);else{for(t=new lt,b=b.selection.iterator;b.next();){var e=b.value;a.contains(e)||t.add(e)}for(b=t.iterator;b.next();)b.value.isSelected=!1;for(a=a.iterator;a.next();)(b=a.value).isSelected||(b.isSelected=!0)}},v.Object.defineProperties(Bn.prototype,{delay:{get:function(){return this.Vk},set:function(a){this.Vk=a}},isPartialInclusion:{get:function(){return this.v},set:function(a){this.v=a}},box:{get:function(){return this.l},set:function(a){this.l=a}}}),Bn.className="DragSelectingTool",m(In,Ee),In.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(!a.allowHorizontalScroll&&!a.allowVerticalScroll||!a.lastInput.left||a.currentTool!==this&&!this.isBeyondDragSize())},In.prototype.doActivate=function(){var a=this.diagram;this.Mg?(a.lastInput.bubbles=!0,a.addEventListener(w.document,"scroll",this.kx,!1)):(a.currentCursor="move",a.isMouseCaptured=!0,this.Ju.assign(a.position)),this.isActive=!0},In.prototype.doDeactivate=function(){var a=this.diagram;a.currentCursor="",this.isActive=a.isMouseCaptured=!1},In.prototype.doCancel=function(){var a=this.diagram;a.position=this.Ju,a.isMouseCaptured=!1,this.stopTool()},In.prototype.doMouseMove=function(){this.move()},In.prototype.doMouseUp=function(){this.move(),this.stopTool()},In.prototype.move=function(){var a=this.diagram;if(this.isActive&&a)if(this.Mg)a.lastInput.bubbles=!0;else{var b=a.position,t=a.firstInput.documentPoint,e=a.lastInput.documentPoint,n=b.x+t.x-e.x;t=b.y+t.y-e.y,a.allowHorizontalScroll||(n=b.x),a.allowVerticalScroll||(t=b.y),a.position=this.Dy.h(n,t)}},v.Object.defineProperties(In.prototype,{bubbles:{get:function(){return this.Mg},set:function(a){this.Mg=a}},originalPosition:{get:function(){return this.Ju}}}),In.className="PanningTool",Y("clickCreatingTool",(function(){return this.findTool("ClickCreating")}),(function(a){this.Va("ClickCreating",a,this.mouseUpTools)})),Y("clickSelectingTool",(function(){return this.findTool("ClickSelecting")}),(function(a){this.Va("ClickSelecting",a,this.mouseUpTools)})),Y("panningTool",(function(){return this.findTool("Panning")}),(function(a){this.Va("Panning",a,this.mouseMoveTools)})),Y("dragSelectingTool",(function(){return this.findTool("DragSelecting")}),(function(a){this.Va("DragSelecting",a,this.mouseMoveTools)})),Y("actionTool",(function(){return this.findTool("Action")}),(function(a){this.Va("Action",a,this.mouseDownTools)})),v.Object.defineProperties(Rn.prototype,{mainElement:{get:function(){return this.I},set:function(a){this.I=a}},show:{get:function(){return this.v},set:function(a){this.v!==a&&(this.v=a)}},hide:{get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a)}},valueFunction:{get:function(){return this.Y},set:function(a){this.Y=a}}}),Rn.className="HTMLInfo",En.className="ContextMenuButtonInfo",m(zn,Ee),zn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(this.isBeyondDragSize()||!a.lastInput.right)&&!!(a.lastInput.isTouchEvent&&null!==this.defaultTouchContextMenu||null!==this.findObjectWithContextMenu())},zn.prototype.doStart=function(){this.Zw.set(this.diagram.firstInput.documentPoint)},zn.prototype.doStop=function(){this.hideContextMenu(),this.currentObject=null},zn.prototype.findObjectWithContextMenu=function(a){void 0===a&&(a=null);var b=this.diagram,t=b.lastInput,e=null;if(a instanceof Vo||(e=a instanceof _s?a:b.Ub(t.documentPoint,null,(function(a){return!a.layer.isTemporary}))),null!==e){for(a=e;null!==a;){if(null!==a.contextMenu)return a;a=a.panel}if(b.lastInput.isTouchEvent&&this.defaultTouchContextMenu)return e.part}else if(null!==b.contextMenu)return b;return null},zn.prototype.doActivate=function(){},zn.prototype.doMouseDown=function(){if(Ee.prototype.doMouseDown.call(this),this.isActive&&this.currentContextMenu instanceof Lu){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.canStart()&&(a.doActivate(),a.doMouseDown(),a.doDeactivate())}this.diagram.toolManager.mouseDownTools.contains(this)&&Yn(this)},zn.prototype.doMouseUp=function(){if(this.isActive&&this.currentContextMenu instanceof Lu){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.canStart()&&(a.doActivate(),a.doCancel(),a.doDeactivate())}Yn(this)},zn.prototype.doMouseMove=function(){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.doMouseMove(),this.isActive&&this.diagram.toolManager.doMouseMove()},zn.prototype.showContextMenu=function(a,b){var t=this.diagram;if(a!==this.currentContextMenu&&this.hideContextMenu(),a instanceof Lu){a.layerName="Tool",a.selectable=!1,a.scale=1/t.scale,a.category=this.name,null!==a.placeholder&&(a.placeholder.scale=t.scale);var e=a.diagram;null!==e&&e!==t&&e.remove(a),t.add(a),null!==b?a.adornedObject=b:a.data=t.model,a.yb(),this.positionContextMenu(a,b)}else a instanceof Rn&&a.show(b,t,this);this.currentContextMenu=a},zn.prototype.positionContextMenu=function(a){if(null===a.placeholder){var b=this.diagram,t=b.lastInput.documentPoint.copy(),e=a.measuredBounds,n=b.viewportBounds;b.lastInput.isTouchEvent&&(t.x-=e.width),t.x+e.width>n.right&&(t.x-=e.width+5/b.scale),t.x<n.x&&(t.x=n.x),t.y+e.height>n.bottom&&(t.y-=e.height+5/b.scale),t.y<n.y&&(t.y=n.y),a.position=t}},zn.prototype.hideContextMenu=function(){var a=this.diagram,b=this.currentContextMenu;null!==b&&(b instanceof Lu?(a.remove(b),null!==this.du&&this.du.Af(b.category),b.data=null,b.adornedObject=null):b instanceof Rn&&(null!==b.hide?b.hide(a,this):null!==b.mainElement&&(b.mainElement.style.display="none")),this.currentContextMenu=null,this.standardMouseOver())},zn.prototype.showDefaultContextMenu=function(){var a=this.diagram;null===this.eu&&(this.eu=function(a){var b=new lt;return b.add(new En("Copy",(function(a){a.commandHandler.copySelection()}),(function(a){return a.commandHandler.canCopySelection()}))),b.add(new En("Cut",(function(a){a.commandHandler.cutSelection()}),(function(a){return a.commandHandler.canCutSelection()}))),b.add(new En("Delete",(function(a){a.commandHandler.deleteSelection()}),(function(a){return a.commandHandler.canDeleteSelection()}))),b.add(new En("Paste",(function(b){b.commandHandler.pasteSelection(a.mouseDownPoint)}),(function(b){return b.commandHandler.canPasteSelection(a.mouseDownPoint)}))),b.add(new En("Select All",(function(a){a.commandHandler.selectAll()}),(function(a){return a.commandHandler.canSelectAll()}))),b.add(new En("Undo",(function(a){a.commandHandler.undo()}),(function(a){return a.commandHandler.canUndo()}))),b.add(new En("Redo",(function(a){a.commandHandler.redo()}),(function(a){return a.commandHandler.canRedo()}))),b.add(new En("Scroll To Part",(function(a){a.commandHandler.scrollToPart()}),(function(a){return a.commandHandler.canScrollToPart()}))),b.add(new En("Zoom To Fit",(function(a){a.commandHandler.zoomToFit()}),(function(a){return a.commandHandler.canZoomToFit()}))),b.add(new En("Reset Zoom",(function(a){a.commandHandler.resetZoom()}),(function(a){return a.commandHandler.canResetZoom()}))),b.add(new En("Group Selection",(function(a){a.commandHandler.groupSelection()}),(function(a){return a.commandHandler.canGroupSelection()}))),b.add(new En("Ungroup Selection",(function(a){a.commandHandler.ungroupSelection()}),(function(a){return a.commandHandler.canUngroupSelection()}))),b.add(new En("Edit Text",(function(a){a.commandHandler.editTextBlock()}),(function(a){return a.commandHandler.canEditTextBlock()}))),b}(this)),Kn.innerHTML="",Un.addEventListener("click",this.Xu,!1);var b=this,t=P("ul");t.className="goCXul",Kn.appendChild(t),t.innerHTML="";for(var e=this.eu.iterator;e.next();){var n=e.value,o=n.visible;if("function"==typeof n.Ax&&("function"!=typeof o||o(a))){(o=P("li")).className="goCXli";var g=P("a");g.className="goCXa",g.href="#",g.xy=n.Ax,g.addEventListener("click",(function(t){return this.xy(a),b.stopTool(),t.preventDefault(),!1}),!1),g.textContent=n.text,o.appendChild(g),t.appendChild(o)}}Kn.style.display="block",Un.style.display="block"},zn.prototype.hideDefaultContextMenu=function(){if(null!==this.currentContextMenu&&this.currentContextMenu===Xn){Kn.style.display="none",Un.style.display="none";var a=this.diagram;null!==a&&a.removeEventListener(Un,"click",this.Xu,!1),this.currentContextMenu=null}},v.Object.defineProperties(zn.prototype,{currentContextMenu:{get:function(){return this.l},set:function(a){this.l=a,this.du=a instanceof Lu?a.adornedPart:null}},defaultTouchContextMenu:{get:function(){return!1===qn&&null===Xn&&ys&&function(a){var b=new Rn;b.show=function(a,b,t){t.showDefaultContextMenu()},b.hide=function(a,b){b.hideDefaultContextMenu()},Xn=b,a.Xu=function(){a.stopTool()},b=P("div");var t=P("div");b.style.cssText="top: 0px;z-index:10002;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px",t.style.cssText="z-index:10001;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;opacity: 0.8;";var e=P("style");w.document.getElementsByTagName("head")[0].appendChild(e),e.sheet.insertRule(".goCXul { list-style: none; }",0),e.sheet.insertRule(".goCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }",0),e.sheet.insertRule(".goCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }",0),null!==(e=a.diagram)&&(e.addEventListener(b,"contextmenu",Vn,!1),e.addEventListener(b,"selectstart",Vn,!1),e.addEventListener(t,"contextmenu",Vn,!1)),b.className="goCXforeground",t.className="goCXbackground",w.document.body&&(w.document.body.appendChild(b),w.document.body.appendChild(t)),Kn=b,Un=t,qn=!0}(this),Xn},set:function(a){null===a&&(qn=!0),Xn=a}},currentObject:{get:function(){return this.v},set:function(a){this.v=a}},mouseDownPoint:{get:function(){return this.Zw}}});var Xn=null,qn=!1,Un=null,Kn=null;function Hn(){Ee.call(this),this.name="TextEditing",this.vh=new ml,this.Ia=null,this.Ha=to,this.Ji=null,this.ia=eo,this.I=1,this.Y=!0,this.v=null,this.l=new Rn,this.iu=null,function(a,b){if(ys){var t=P("textarea");a.iu=t,t.addEventListener("input",(function(){if(null!==a.textBlock){var b=a.Wx(this.value);this.style.width=20+b.measuredBounds.width*this.yA+"px",this.rows=b.lineCount}}),!1),t.addEventListener("keydown",(function(b){if(null!==a.textBlock){var t=b.which;13===t?(!1===a.textBlock.isMultiline&&b.preventDefault(),a.acceptText(Qn)):9===t?(a.acceptText($n),b.preventDefault()):27===t&&(a.doCancel(),null!==a.diagram&&a.diagram.doFocus())}}),!1),t.addEventListener("focus",(function(){if(null!==a.currentTextEditor&&a.state!==eo){var b=a.iu;a.ia===no&&(a.ia=oo),"function"==typeof b.select&&a.selectsTextOnActivate&&(b.select(),b.setSelectionRange(0,9999))}}),!1),t.addEventListener("blur",(function(){if(null!==a.currentTextEditor&&a.state!==eo){var b=a.iu;"function"==typeof b.focus&&b.focus(),"function"==typeof b.select&&a.selectsTextOnActivate&&(b.select(),b.setSelectionRange(0,9999))}}),!1),b.valueFunction=function(){return t.value},b.mainElement=t,b.show=function(a,b,e){if(a instanceof ml&&e instanceof Hn)if(e.state===so)t.style.border="3px solid red",t.focus();else{var n=a.ga(xi),o=b.position,r=b.scale,h=a.vf()*r;h<e.minimumEditorScale&&(h=e.minimumEditorScale);var l=a.naturalBounds.width*h+6,c=a.naturalBounds.height*h+2,p=(n.x-o.x)*r;n=(n.y-o.y)*r,t.value=a.text,b.div.style.font=a.font,t.style.position="absolute",t.style.zIndex="100",t.style.font="inherit",t.style.fontSize=100*h+"%",t.style.lineHeight="normal",t.style.width=l+"px",t.style.left=(p-l/2|0)-1+"px",t.style.top=(n-c/2|0)-1+"px",t.style.textAlign=a.textAlign,t.style.margin="0",t.style.padding="1px",t.style.border="0",t.style.outline="none",t.style.whiteSpace="pre-wrap",t.style.overflow="hidden",t.rows=a.lineCount,t.yA=h,t.className="goTXarea",b.div.appendChild(t),t.focus(),e.selectsTextOnActivate&&(t.select(),t.setSelectionRange(0,9999))}},b.hide=function(a){a.div.removeChild(t)}}}(this,this.l)}function Wn(a){var b=a.textBlock,t=a.diagram,e=a.currentTextEditor;if(null!==b&&null!==e){var n=b.text,o="";if(null!==e.valueFunction&&(o=e.valueFunction()),a.isValidText(b,n,o))a.ua(a.name),a.ia=ao,a.transactionResult=a.name,b.text=o,null!==(e=a.textBlock).textEdited&&e.textEdited(e,n,o),null!==t&&t.R("TextEdited",b,n),a.Hg(),a.stopTool(),null!==t&&t.doFocus();else{a.ia=so;var g=a.textBlock;null!==g.errorFunction&&g.errorFunction(a,n,o),e.show(b,t,a)}}}zn.className="ContextMenuTool",Y("contextMenuTool",(function(){return this.findTool("ContextMenu")}),(function(a){this.Va("ContextMenu",a,this.mouseUpTools)})),m(Hn,Ee),Hn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(null===a||a.isReadOnly||ho&&ho!==this&&(ho.acceptText(Zn),ho&&ho!==this)||!a.lastInput.left||this.isBeyondDragSize())return!1;var b=a.Ub(a.lastInput.documentPoint);return!!(null!==b&&b instanceof ml&&b.editable&&b.part.canEdit())&&!(null===(b=b.part)||this.starting===to&&!b.isSelected||this.starting===io&&2>a.lastInput.clickCount)},Hn.prototype.doStart=function(){ho=this,null!==this.textBlock&&this.doActivate()},Hn.prototype.doActivate=function(){if(!this.isActive){var a=this.diagram;if(null!==a){var b=this.textBlock;if(null===b&&(b=a.Ub(a.lastInput.documentPoint)),null!==b&&b instanceof ml&&(this.textBlock=b,null!==b.part)){this.isActive=!0,this.ia=no;var t=this.defaultTextEditor;null!==b.textEditor&&(t=b.textEditor),this.vh=this.textBlock.copy();var e=new Wt(this.textBlock.ga(gi),this.textBlock.ga(Mi));a.dw(e),t.show(b,a,this),this.currentTextEditor=t}}}},Hn.prototype.doCancel=function(){this.stopTool()},Hn.prototype.doMouseUp=function(){this.canStart()&&this.doActivate()},Hn.prototype.doMouseDown=function(){this.isActive&&this.acceptText(Zn)},Hn.prototype.acceptText=function(a){switch(a){case Zn:this.ia===ao?this.currentTextEditor instanceof HTMLElement&&this.currentTextEditor.focus():this.ia!==no&&this.ia!==so&&this.ia!==oo||(this.ia=ro,Wn(this));break;case Jn:case Qn:case $n:Qn===a&&!0===this.textBlock.isMultiline||this.ia!==no&&this.ia!==so&&this.ia!==oo||(this.ia=ro,Wn(this))}},Hn.prototype.doDeactivate=function(){var a=this.diagram;null!==a&&(this.ia=eo,this.textBlock=null,null!==this.currentTextEditor&&this.currentTextEditor.hide(a,this),this.isActive=!1)},Hn.prototype.doStop=function(){ho=null},Hn.prototype.isValidText=function(a,b,t){var e=this.textValidation;return!(null!==e&&!e(a,b,t))&&!(null!==(e=a.textValidation)&&!e(a,b,t))},Hn.prototype.Wx=function(a){var b=this.vh;return b.text=a,b.measure(this.textBlock.ti,1/0),b},v.Object.defineProperties(Hn.prototype,{textBlock:{get:function(){return this.Ia},set:function(a){this.Ia=a}},currentTextEditor:{get:function(){return this.v},set:function(a){this.v=a}},defaultTextEditor:{get:function(){return this.l},set:function(a){this.l=a}},starting:{get:function(){return this.Ha},set:function(a){this.Ha=a}},textValidation:{get:function(){return this.Ji},set:function(a){this.Ji=a}},minimumEditorScale:{get:function(){return this.I},set:function(a){this.I=a}},selectsTextOnActivate:{get:function(){return this.Y},set:function(a){this.Y=a}},state:{get:function(){return this.ia},set:function(a){this.ia!==a&&(this.ia=a)}}}),Hn.prototype.measureTemporaryTextBlock=Hn.prototype.Wx;var Jn=new _(Hn,"LostFocus",0),Zn=new _(Hn,"MouseDown",1),$n=new _(Hn,"Tab",2),Qn=new _(Hn,"Enter",3),_n=new _(Hn,"SingleClick",0),to=new _(Hn,"SingleClickSelected",1),io=new _(Hn,"DoubleClick",2),eo=new _(Hn,"StateNone",0),no=new _(Hn,"StateActive",1),oo=new _(Hn,"StateEditing",2),ro=new _(Hn,"StateValidating",3),so=new _(Hn,"StateInvalid",4),ao=new _(Hn,"StateValidated",5),ho=null;function lo(){wo||(xo(),wo=!0),this.B=fs,this.gl=this.$e=this.qc=this.Tr=this.hc=!1,this.px=!0,this.hl=ko,this.bn=!1,this.oi=this.Mc=!0,this.Ug=600,this.Mw=this.ox=!1,this.Le=new ct,this.Bd=new Po,this.Bd.Jc=this,this.Ck=new ct,this.Uu=new ct,this.Ss=new ct}function uo(a,b){co(a,b)&&(a.$e=!0)}function co(a,b){return!(!a.Mc||!a.canStart(b))&&(a.Le.add(b),a.defaultAnimation.isAnimating&&a.Xc(),a.qc=!0)}function fo(a){if(a.Mc&&a.qc){var b=a.Bd,t=a.B,e=a.Le.contains("Model");e&&(a.gl=!0,a.hl===ko?(b.isViewportUnconstrained=!0,b.pc.clear(),b.add(t,"position",t.position.copy().offset(0,-200),t.position),b.add(t,"opacity",0,1)):a.hl===So&&b.pc.clear(),t.R("InitialAnimationStarting",a)),e&&!a.oi||0===b.pc.count?(a.Le.clear(),a.qc=!1,a.$e=!1,b.pc.clear(),No(b),a.gl=!1,t.M()):(a.Le.clear(),t.xe=!1,w.requestAnimationFrame((function(){!1===a.qc||b.hc||(t.Ce("temporaryPixelRatio")&&qo(t),Ko(t),a.qc=!1,a.$e=!1,a.px=!(!e||a.hl!==Mo||!t.Ou.w(t.ma)),b.start(),go(a),t.Na(),Ao(b,0),dr(t,!0),yo(a),t.R("AnimationStarting",a))})))}}function po(a,b,t,e){b instanceof Wu&&(null!==b.fromNode||null!==b.toNode)||a.Bd.add(b,"position",t,e,!1)}function go(a){if(!a.Tr){var b=a.B;a.ox=b.skipsUndoManager,a.Mw=b.skipsModelSourceBindings,b.skipsUndoManager=!0,b.skipsModelSourceBindings=!0,a.Tr=!0}}function yo(a){var b=a.B;b.skipsUndoManager=a.ox,b.skipsModelSourceBindings=a.Mw,a.Tr=!1}function mo(a,b,t){a.$e&&!b.w(t)&&(a.B.kk||(b=t.copy()),Co(a.Bd,a.B,"position",b,t))}function vo(a,b,t,e,n){null===a&&(a="rgba(0,0,0,0)"),null===b&&(b="rgba(0,0,0,0)"),Ha(a),Wa();var o=fh.l,g=fh.I,r=fh.v;a=fh.Y,Ha(b),Wa();var h=fh.I,l=fh.v;return b=fh.Y,"hsla("+(o=n(t,o,fh.l-o,e))+", "+(g=n(t,g,h-g,e))+"%, "+(r=n(t,r,l-r,e))+"%, "+(t=n(t,a,b-a,e))+")"}function xo(){var a=new kt;a.add("position:diagram",(function(a,t,e,n,o,g){a.position=new Mt(n(o,t.x,e.x-t.x,g),n(o,t.y,e.y-t.y,g))})),a.add("position",(function(a,t,e,n,o,g){o<g?a.Kq(n(o,t.x,e.x-t.x,g),n(o,t.y,e.y-t.y,g),!1):a.position=new Mt(n(o,t.x,e.x-t.x,g),n(o,t.y,e.y-t.y,g))})),a.add("location",(function(a,t,e,n,o,g){o<g?a.Kq(n(o,t.x,e.x-t.x,g),n(o,t.y,e.y-t.y,g),!0):a.location=new Mt(n(o,t.x,e.x-t.x,g),n(o,t.y,e.y-t.y,g))})),a.add("position:placeholder",(function(a,t,e,n,o,g){o<g?a.Kq(n(o,t.x,e.x-t.x,g),n(o,t.y,e.y-t.y,g),!1):a.position=new Mt(n(o,t.x,e.x-t.x,g),n(o,t.y,e.y-t.y,g))})),a.add("position:node",(function(a,t,e,n,o,g){var b=a.actualBounds,r=e.actualBounds;e=r.x+r.width/2-b.width/2,b=r.y+r.height/2-b.height/2,o<g?a.Kq(n(o,t.x,e-t.x,g),n(o,t.y,b-t.y,g),!1):a.position=new Mt(n(o,t.x,e-t.x,g),n(o,t.y,b-t.y,g))})),a.add("desiredSize",(function(a,t,e,n,o,g){a.desiredSize=new Wt(n(o,t.width,e.width-t.width,g),n(o,t.height,e.height-t.height,g))})),a.add("width",(function(a,t,e,n,o,g){a.width=n(o,t,e-t,g)})),a.add("height",(function(a,t,e,n,o,g){a.height=n(o,t,e-t,g)})),a.add("fill",(function(a,t,e,n,o,g){a.fill=vo(t,e,o,g,n)})),a.add("stroke",(function(a,t,e,n,o,g){a.stroke=vo(t,e,o,g,n)})),a.add("strokeWidth",(function(a,t,e,n,o,g){a.strokeWidth=n(o,t,e-t,g)})),a.add("strokeDashOffset",(function(a,t,e,n,o,g){a.strokeDashOffset=n(o,t,e-t,g)})),a.add("background",(function(a,t,e,n,o,g){a.background=vo(t,e,o,g,n)})),a.add("areaBackground",(function(a,t,e,n,o,g){a.areaBackground=vo(t,e,o,g,n)})),a.add("opacity",(function(a,t,e,n,o,g){a.opacity=n(o,t,e-t,g)})),a.add("scale",(function(a,t,e,n,o,g){a.scale=n(o,t,e-t,g)})),a.add("angle",(function(a,t,e,n,o,g){a.angle=n(o,t,e-t,g)})),bo=a}Hn.className="TextEditingTool",Hn.LostFocus=Jn,Hn.MouseDown=Zn,Hn.Tab=$n,Hn.Enter=Qn,Hn.SingleClick=_n,Hn.SingleClickSelected=to,Hn.DoubleClick=io,Hn.StateNone=eo,Hn.StateActive=no,Hn.StateEditing=oo,Hn.StateValidating=ro,Hn.StateInvalid=so,Hn.StateValidated=ao,Y("textEditingTool",(function(){return this.findTool("TextEditing")}),(function(a){this.Va("TextEditing",a,this.mouseUpTools)})),lo.prototype.Zd=function(a){this.B=a},lo.prototype.canStart=function(){return!0},(n=lo.prototype).Dt=function(a){return this.Bd.Dt(a)},n.Hv=function(a){return this.Bd.Hv(a)},n.Xc=function(a){var b=this.Bd;if(!0===this.qc&&(this.gl=this.$e=this.qc=!1,this.Le.clear(),0<b.pc.count&&this.B.Pb()),this.hc&&this.Mc){if(b.gm(!0),b.pc.clear(),No(b),!0===a)for(a=this.Ck.na(),b=0;b<a.length;b++)a[b].gm(!0)}else b.pc.clear(),No(b)},n.gm=function(a){a===this.defaultAnimation&&this.defaultAnimation.pc.clear(),this.Ck.remove(a),0===this.Ck.count&&(this.hc=!1,this.B.Pb()),a===this.defaultAnimation&&(this.defaultAnimation.pc.clear(),this.B.R("AnimationFinished",this))},n.Vj=function(a,b){this.$e&&(this.Le.contains("Expand Tree")||this.Le.contains("Expand SubGraph"))&&this.Bd.Vj(a,b)},n.Tj=function(a,b){this.$e&&(this.Le.contains("Collapse Tree")||this.Le.contains("Collapse SubGraph"))&&(this.Bd.Tj(a,b),Co(this.Bd,b,"position",b.position,b.position))},v.Object.defineProperties(lo.prototype,{animationReasons:{get:function(){return this.Le}},isEnabled:{get:function(){return this.Mc},set:function(a){this.Mc=a}},duration:{get:function(){return this.Ug},set:function(a){1>a&&T(a,">= 1",lo,"duration"),this.Ug=a}},isAnimating:{get:function(){return this.hc}},isTicking:{get:function(){return this.Tr}},isInitial:{get:function(){return this.oi},set:function(a){this.oi=a}},defaultAnimation:{get:function(){return this.Bd}},activeAnimations:{get:function(){return this.Ck}},initialAnimationStyle:{get:function(){return this.hl},set:function(a){this.hl=a}}}),lo.prototype.stopAnimation=lo.prototype.Xc;var bo=null,wo=!1,ko=new _(lo,"Default",1),Mo=new _(lo,"AnimateLocations",2),So=new _(lo,"None",3);function Po(){this.Yu=this.nx=this.Jc=this.B=null,this.pl=this.hc=this.l=!1,this.Gn=this.ud=0,this.nr=this.lu=jo,this.ol=this.lp=!1,this.Nu=1,this.Lu=0,this.nd=this.Ug=NaN,this.Pw=0,this.Hn=null,this.v=jt,this.pc=new kt,this.Hu=new kt,this.Xl=new ct,this.Iu=new ct,this.Nw=Ts}function No(a){a.Hu.clear(),a.ol=!1,a.Lu=0,a.nd=NaN,0<a.Xl.count&&a.Xl.clear(),0<a.Iu.count&&a.Iu.clear()}function Co(a,b,t,e,n,o){var g=a.pc;if(b instanceof Vo&&"position"===t&&(t="position:diagram"),g.contains(b)){var r=g.H(b),h=r.start,l=r.end;void 0===h[t]&&(h[t]=To(e)),l[t]=To(n)}else l={},(h={})[t]=To(e),l[t]=To(n),r=h.position,b instanceof _s&&r instanceof Mt&&!r.u()&&b.diagram.animationManager.Le.contains("Expand SubGraph")&&r.assign(l.position),r=new Fo(h,l,o),g.add(b,r);(g=h[t])instanceof Mt&&!g.u()&&g.assign(a.v),o&&0===t.indexOf("position:")&&b instanceof lu?r.qv.location=To(b.location):o&&(r.qv[t]=To(e))}function To(a){return a instanceof Mt||a instanceof qt?a.copy():a}function Lo(a,b){if(!a.pl||b){var t=a.Jc;if(!1!==a.hc){var e=+new Date,n=e>a.Gn?a.nd:e-a.ud;b&&((n=a.Pw)<a.nd?(a.ud=+new Date-n,a.Gn=a.ud+a.nd):n=a.nd),go(t),Ao(a,n),dr(a.B,!0),yo(t),e>a.Gn&&(a.lp&&!a.ol?(a.ud=+new Date,a.Gn=a.ud+a.nd,a.ol=!0):a.gm(!1))}}}function Ao(a,b){for(var t=a.nd,e=a.pc.iterator,n=a.ol;e.next();){var o=e.key;if(!(o instanceof _s&&null===o.diagram)){var g=e.value,r=n?g.end:g.start;g=n?g.start:g.end;var h,l=bo;for(h in g)"position"===h&&(g["position:placeholder"]||g["position:node"])||null===l.get(h)||l.get(h)(o,r[h],g[h],a.nr,b,t,a)}}}function jo(a,b,t,e){return 1>(a/=e/2)?t/2*a*a+b:-t/2*(--a*(a-2)-1)+b}function Do(a,b,t,e){return a===e?b+t:t*(1-Math.pow(2,-10*a/e))+b}function Fo(a,b,t){this.start=a,this.end=b,this.qv={},this.lv=t,this.Vv=!1}function Oo(a,b,t){this.bd=null,this.bf=a,this.Mp=t||Bo,this.Hk=null,void 0!==b&&(this.Hk=b,void 0===t&&(this.Mp=Io))}lo.className="AnimationManager",lo.defineAnimationEffect=function(a,b){wo||(xo(),wo=!0),bo.add(a,b)},lo.Default=ko,lo.AnimateLocations=Mo,lo.None=So,Po.prototype.suspend=function(){this.pl=!0},Po.prototype.advanceTo=function(a,b){b&&(this.pl=!1),this.lp&&a>=this.nd&&(this.ol=!0,a-=this.nd),this.Pw=a,Lo(this,!0),go(this.Jc),dr(this.B),yo(this.Jc),this.B.Fe()},(n=Po.prototype).start=function(){if(0!==this.pc.count&&!this.hc){for(var a=this.B,b=this.pc.iterator;b.next();){var t=b.value.end,e=b.key;if(t["position:placeholder"]){var n=e.findVisibleNode();if(n instanceof qu&&null!==n.placeholder){var o=n.placeholder;n=o.ga(gi),o=o.padding,n.x+=o.left,n.y+=o.top,t["position:placeholder"]=n}}null===a&&(e instanceof Vo?a=e:e instanceof _s&&(a=e.diagram))}null!==a&&(this.B=a,b=this.Jc=a.animationManager,this.nd=isNaN(this.Ug)?b.duration:this.Ug,this.nr=this.lu,b.gl&&b.hl===ko&&this===b.defaultAnimation&&(this.nr=Do,this.nd=isNaN(this.Ug)?600===b.duration?900:b.duration:this.Ug),this.Nw=a.scrollMode,this.isViewportUnconstrained&&(a.Gi=Ls),go(b),this.Xl.each((function(b){b.data=null,a.add(b)})),yo(b),this.hc=!0,this.ud=+new Date,this.Gn=this.ud+this.nd,function(a,b){function t(){if(0<n.Ss.count&&(e.addAll(n.Ss),n.Ss.clear(),n.hc=!0),!1!==n.hc&&0!==e.count){n.Uu.addAll(e);for(var a=n.Uu.iterator;a.next();){var b=a.value;if(!1!==b.hc){t:if(0<b.Xl.count)var o=!0;else{for(o=b.pc.iterator;o.next();){var r=o.key;if(r instanceof _s&&null!==r.diagram||r instanceof Vo){o=!0;break t}}o=!1}o?Lo(b,!1):b.pl=!0}}n.Uu.clear(),go(n),dr(n.B),yo(n),w.requestAnimationFrame(t)}}var e=a.Ck,n=a;a.hc?a.Ss.add(b):(a.hc=!0,e.add(b),w.requestAnimationFrame((function(){t()})))}(b,this))}},n.Ly=function(a,b){a.Wb()&&(this.Xl.add(a),this.B=b)},n.add=function(a,b,t,e,n){"position"===b&&t.w(e)||(null===this.B&&(a instanceof Vo?this.B=a:a instanceof _s&&null!==a.diagram&&(this.B=a.diagram)),a instanceof lu&&!a.isAnimated||Co(this,a,b,t,e,n))},n.Dt=function(a){return!!this.hc&&(null!==(a=this.pc.H(a))&&a.Vv)},n.Hv=function(a){return!!this.hc&&(null!==(a=this.pc.H(a))&&(a.start.position||a.start.location))},n.stop=function(){this.hc&&this.gm(!0)},n.gm=function(a){if(null!==this.Yu&&this.Yu.sp.remove(this.nx),this.hc){var b=this.B,t=this.Jc;this.pl=this.hc=t.gl=!1,go(t);for(var e=this.pc,n=this.Xl.iterator;n.next();)b.remove(n.value);for(n=this.Iu.iterator;n.next();)n.value.o();n=this.lp,e=e.iterator;for(var o=bo;e.next();){var r,g=e.key,h=e.value,l=n?h.end:h.start,c=n?h.start:h.end,f=h.qv;for(r in c)if(null!==o.get(r)){var p=r;!h.lv||"position:node"!==p&&"position:placeholder"!==p||(p="position"),o.get(p)(g,l[r],void 0!==f[r]?f[r]:h.lv?l[r]:c[r],this.nr,this.nd,this.nd,this)}h.lv&&void 0!==f.location&&g instanceof lu&&(g.location=f.location),h.Vv&&g instanceof lu&&g.Ob(!1)}if(t.defaultAnimation===this)for(r=this.B.links;r.next();)null===(n=r.value).oh?null!==(e=n.path)&&(n.ld=!1,n.o(),e.o()):(n.points=n.oh,n.oh=null);b.yt.clear(),Uo(b,!1),b.Na(),b.M(),dr(b,!0),this.isViewportUnconstrained&&(b.scrollMode=this.Nw),yo(t),this.Lu++,!a&&this.Nu>this.Lu?(this.ol=!1,this.start()):(this.Hn&&this.Hn(this),No(this),t.gm(this),b.Pb())}},n.Vj=function(a,b){var t=b.actualBounds,e=null;if(b instanceof qu&&(e=b.placeholder),null!==e?(t=e.ga(gi),e=e.padding,t.x+=e.left,t.y+=e.top,this.add(a,"position",t,a.position,!1)):this.add(a,"position",new Mt(t.x+t.width/2,t.y+t.height/2),a.position,!1),this.add(a,"scale",.01,a.scale,!1),a instanceof qu)for(a=a.memberParts;a.next();)(e=a.value)instanceof Au&&this.Vj(e,b)},n.Tj=function(a,b){if(a.isVisible()){var t=null;if(b instanceof qu&&(t=b.placeholder),null!==t?this.add(a,"position:placeholder",a.position,t,!0):this.add(a,"position:node",a.position,b,!0),this.add(a,"scale",a.scale,.01,!0),(t=this.pc).contains(a)&&(t.H(a).Vv=!0),a instanceof qu)for(a=a.memberParts;a.next();)(t=a.value)instanceof Au&&this.Tj(t,b)}},n.Hz=function(a){var b=this.Hu.get(a);return null===b&&(b={},this.Hu.add(a,b)),b},v.Object.defineProperties(Po.prototype,{duration:{get:function(){return this.Ug},set:function(a){1>a&&T(a,">= 1",Po,"duration"),this.Ug=a}},reversible:{get:function(){return this.lp},set:function(a){this.lp=a}},runCount:{get:function(){return this.Nu},set:function(a){0<a?this.Nu=a:N("Animation.runCount value must be a positive integer.")}},finished:{get:function(){return this.Hn},set:function(a){this.Hn!==a&&(this.Hn=a)}},easing:{get:function(){return this.lu},set:function(a){this.lu=a}},isViewportUnconstrained:{get:function(){return this.l},set:function(a){this.l=a}},isAnimating:{get:function(){return this.hc}}}),Po.prototype.getTemporaryState=Po.prototype.Hz,Po.prototype.stop=Po.prototype.stop,Po.prototype.add=Po.prototype.add,Po.prototype.addTemporaryPart=Po.prototype.Ly,Po.className="Animation",Po.EaseLinear=function(a,b,t,e){return t*a/e+b},Po.EaseInOutQuad=jo,Po.EaseInQuad=function(a,b,t,e){return t*(a/=e)*a+b},Po.EaseOutQuad=function(a,b,t,e){return-t*(a/=e)*(a-2)+b},Po.EaseInExpo=function(a,b,t,e){return 0===a?b:t*Math.pow(2,10*(a/e-1))+b},Po.EaseOutExpo=Do,Fo.className="AnimationState",Oo.prototype.copy=function(){var a=new Oo(this.bf);a.Mp=this.Mp;var b=this.Hk;if(null!==b){var t={};void 0!==b.duration&&(t.Hx=b.duration),void 0!==b.finished&&(t.Hx=b.finished),void 0!==b.easing&&(t.Hx=b.easing),a.Hk=t}return a},v.Object.defineProperties(Oo.prototype,{propertyName:{get:function(){return this.bf},set:function(a){this.bf=a}},animationSettings:{get:function(){return this.Hk},set:function(a){this.Hk=a}},startCondition:{get:function(){return this.Mp},set:function(a){this.Mp=a}}});var Bo=new _(Oo,"Default",1),Io=new _(Oo,"Immediate",2),Ro=new _(Oo,"Bundled",3);function Eo(){ft(this),this.B=null,this.Ca=new lt,this.Qa="",this.qb=1,this.v=!1,this.Bi=this.I=this.$h=this.Zh=this.Yh=this.Xh=this.Vh=this.Wh=this.Uh=this.bi=this.Th=this.ai=this.Sh=this.Rh=!0,this.l=!1,this.Yo=[]}function zo(a,b){var t=1;return 1!==a.qb&&(t=b.globalAlpha,b.globalAlpha=t*a.qb),t}function li(a,b,t){if(b=function(a,b,t){var e=t.zOrder;if(isNaN(e))return b;var n=(a=a.Ca).count;if(1>=n)return b;if(0>b&&(b=a.indexOf(t)),0>b)return-1;for(var o=b-1,g=NaN;0<=o&&(g=a.L(o).zOrder,isNaN(g));)o--;for(var r=b+1,h=NaN;r<n&&(h=a.L(r).zOrder,isNaN(h));)r++;if(!isNaN(g)&&g>e)for(;;){if(-1===o||g<=e){if(++o===b)break;return a.lb(b),a.Kb(o,t),o}for(g=NaN;0<=--o&&(g=a.L(o).zOrder,isNaN(g)););}else if(!isNaN(h)&&h<e)for(;;){if(r===n||h>=e){if(--r===b)break;return a.lb(b),a.Kb(r,t),r}for(h=NaN;++r<n&&(h=a.L(r).zOrder,isNaN(h)););}return b}(a,b,t),t instanceof qu&&null!==t&&isNaN(t.zOrder)){if(0!==t.memberParts.count){for(var e=-1,n=a.Ca.j,o=n.length,g=0;g<o;g++){var r=n[g];if(r===t&&(b=g,0<=e))break;if(0>e&&r.containingGroup===t&&(e=g,0<=b))break}!(0>e)&&e<b&&((n=a.Ca).lb(b),n.Kb(e,t))}null!==(t=t.containingGroup)&&li(a,-1,t)}}function Vo(a){function b(){t.removeEventListener(w.document,"DOMContentLoaded",b,!1),t.setRTL()}1<arguments.length&&N("Diagram constructor can only take one optional argument, the DIV HTML element or its id."),Is||(Rs(),Is=!0),ft(this),fs=this,Q=[],this.Rb=!0,this.Jc=new lo,this.Jc.Zd(this),this.jb=17,this.nl=this.Qu=!1,this.zs="default",this.La=null;var t=this;ys&&(null!==w.document.body?this.setRTL():t.addEventListener(w.document,"DOMContentLoaded",b,!1)),this.Ja=new lt,this.va=this.wa=0,this.sa=null,this.jx=new kt,this.cf=this.Db=null,this.bw(),this.vj=null,this.aw(),this.qb=1,this.ma=new Mt(NaN,NaN).freeze(),this.Ou=new Mt(NaN,NaN),this.yn=this.ya=1,this.Kr=new Mt(NaN,NaN).freeze(),this.Lr=NaN,this.ds=1e-4,this.bs=100,this.kb=new ie,this.$s=new Mt(NaN,NaN).freeze(),this.Fr=new Wt(NaN,NaN,NaN,NaN).freeze(),this.Fi=new hi(0,0,0,0).freeze(),this.Gi=Ts,this.Hs=!1,this.As=this.vs=null,this.Lg=xs,this.lj=zi,this.Xf=xs,this.Xn=zi,this.Mr=this.Jr=gi,this.Ac=!0,this.ll=!1,this.od=new ct,this.Sg=new kt,this.Xk=!0,this.Zm=250,this.jj=-1,this.an=new hi(16,16,16,16).freeze(),this.pj=this.xe=!1,this.sj=!0,this.Uf=new Te,this.Uf.diagram=this,this.Qd=new Te,this.Qd.diagram=this,this.dh=new Te,this.dh.diagram=this,this.pe=this.Mf=null,this.Pj=!1,this.vr=this.wr=null,this.Vm=w.PointerEvent&&(K||H||W)&&w.navigator&&!1!==w.navigator.msPointerEnabled,Kr(this),this.zh=new ct,this.Ur=!0,this.Vs=As,this.vu=!1,this.Xs=ks,this.Ia=null,ds.add("Model",vf),this.pr=this.sr=this.Ts=null,this.xn=this.mr="auto",this.fg=this.gs=this.hg=this.ig=this.kg=this.Of=this.Sf=this.Nf=null,this.Ir=!1,this.Pf=this.ug=this.jg=this.gg=null,this.hs=!1,this.ts={},this.Kj=[null,null],this.gr=null,this.tr=this.Ls=this.Su=this.sg=!1,this.zu=!0,this.ni=this.Bc=!1,this.ac=null;var e=this;this.kd=function(a){var b=e.partManager;if(a.model===b.diagram.model&&b.diagram.Z){b.diagram.Z=!1;try{var t=a.change;""===a.modelChange&&t===De&&b.updateDataBindings(a.object,a.propertyName)}finally{b.diagram.Z=!0}}},this.Ic=function(a){e.partManager.doModelChanged(a)},this.av=!0,this.Hd=-2,this.Ci=new kt,this.ss=new lt,this.Zf=!1,this.Sh=this.Rh=this.Uq=this.Mc=!0,this.Vq=!1,this.ar=this.Zq=this.$h=this.Zh=this.Yh=this.Xh=this.Vh=this.Wh=this.Uh=this.Yq=this.bi=this.Th=this.ai=this.Wq=!0,this.Yf=this.xu=!1,this.$q=this.Xq=this.dl=this.cl=!0,this.Gs=this.Cs=16,this.Bs=this.vp=!1,this.wp=this.Es=null,this.Ds=this.Fs=0,this.bb=new hi(5).freeze(),this.Ru=(new ct).freeze(),this.cs=999999999,this.su=(new ct).freeze(),this.mi=this.li=this.ki=!0,this.Te=this.ie=!1,this.ic=null,this.If=!0,this.je=!1,this.Yw=new ct,this.tu=new ct,this.Gb=null,this.Cl=1,this.Tu=0,this.Sd={scale:1,position:new Mt,bounds:new Wt,Kv:!1},this.$u=new Wt(NaN,NaN,NaN,NaN).freeze(),this.Zl=new qt(NaN,NaN).freeze(),this.zn=new Wt(NaN,NaN,NaN,NaN).freeze(),this.Vr=!1,this.qo=this.Vn=this.Ro=this.gu=this.fu=this.hu=this.ag=this.ah=this.Ze=this.zr=null,Xo(this),this.Fb=null,this.Un=!1,this.mj=null,this.partManager=new vf,this.toolManager=new ze,this.toolManager.initializeStandardTools(),this.currentTool=this.defaultTool=this.toolManager,this.yr=null,this.Qk=new Xs,this.ns=this.ms=null,this.Op=!1,this.commandHandler=Go(),this.model=nd(),this.sg=!0,Ho(this),this.layout=new Zc,this.sg=!1,this.Rw=this.ku=null,this.Sb=1,this.uh=null,this.Bo=1,this.Io=0,this.Jo=[0,0,0,0,0],this.Ko=0,this.pd=1,this.Aj=0,this.lo=new Mt,this.Us=500,this.$m=new Mt,this.ke=!1,this.preventDefault=this.Ht=this.vm=this.wm=this.um=this.tm=this.rk=this.tk=this.sk=this.pk=this.qk=this.vw=this.nw=this.ow=this.pw=this.nh=this.Gl=this.mh=this.Fl=null,this.$n=!1,this.ji=new Es,this.Pp=!1,void 0!==a&&Vs(this,a),this.In=null,this.Jn=Bt,this.Rb=!1}function Yo(a,b){a.animationManager.Xc(!0),a.Ru=(new ct).freeze(),a.su=(new ct).freeze();var t=a.skipsUndoManager;null!==a.model&&(a.skipsUndoManager=!0);var e=null;null!==a.Fb&&(null!==(e=a.Fb.part)&&a.remove(e));var n=[],o=a.Ja.length;if(b){for(b=0;b<o;b++)for(var g=a.Ja.j[b].parts;g.next();){var r=g.value;r!==e&&null===r.data&&n.push(r)}for(b=0;b<n.length;b++)a.remove(n[b])}for(b=0;b<o;b++)a.Ja.j[b].clear();return a.partManager.clear(),a.od.clear(),a.Sg.clear(),a.zh.clear(),a.mj=null,$=[],null!==e&&(a.add(e),a.partManager.parts.remove(e)),null!==a.model&&(a.skipsUndoManager=t),n}function Go(){return null}function Xo(a){a.Ze=new kt;var b=new Au,t=new ml;t.bind(new ud("text","",z)),b.add(t),a.hu=b,a.Ze.add("",b),b=new Au,(t=new ml).stroke="brown",t.bind(new ud("text","",z)),b.add(t),a.Ze.add("Comment",b),(b=new Au).selectable=!1,b.avoidable=!1,(t=new rl).figure="Ellipse",t.fill="black",t.stroke=null,t.desiredSize=new qt(3,3).ca(),b.add(t),a.Ze.add("LinkLabel",b),a.ah=new kt,(b=new qu).selectionObjectName="GROUPPANEL",b.type=jh.Vertical,(t=new ml).font="bold 12pt sans-serif",t.bind(new ud("text","",z)),b.add(t),(t=new jh(jh.Auto)).name="GROUPPANEL";var e=new rl;e.figure="Rectangle",e.fill="rgba(128,128,128,0.2)",e.stroke="black",t.add(e),(e=new Hu).padding=new hi(5,5,5,5).ca(),t.add(e),b.add(t),a.fu=b,a.ah.add("",b),a.ag=new kt,b=new Wu,(t=new rl).isPanelMain=!0,b.add(t),(t=new rl).toArrow="Standard",t.fill="black",t.stroke=null,t.strokeWidth=0,b.add(t),a.gu=b,a.ag.add("",b),b=new Wu,(t=new rl).isPanelMain=!0,t.stroke="brown",b.add(t),a.ag.add("Comment",b),(b=new Lu).type=jh.Auto,(t=new rl).fill=null,t.stroke="dodgerblue",t.strokeWidth=3,b.add(t),(t=new Hu).margin=new hi(1.5,1.5,1.5,1.5).ca(),b.add(t),a.Ro=b,a.Vn=b,(b=new Lu).type=jh.Link,(t=new rl).isPanelMain=!0,t.fill=null,t.stroke="dodgerblue",t.strokeWidth=3,b.add(t),a.qo=b}function qo(a){30<a.Io&&(a.uh=1)}function Uo(a,b){null!==a.uh&&(a.uh=null,b&&a.Ht(),a.Io=0,a.Jo=[0,0,0,0,0],a.Ko=0)}function Ko(a){if(null!==a.sa){var b=a.La;if(0!==b.clientWidth&&0!==b.clientHeight){a.Qu||a.setScrollWidth();var t=a.Te?a.jb:0,e=a.ie?a.jb:0,n=a.Sb;a.Sb=a.computePixelRatio(),a.Sb!==n&&(a.ll=!0,a.Pb()),b.clientWidth===a.wa+t&&b.clientHeight===a.va+e||(a.li=!0,a.Ac=!0,null!==(b=a.layout)&&b.isViewportSized&&a.autoScale===xs&&(a.pj=!0,b.C()),a.Bc||a.Pb())}}}function Ho(a){var b=new Eo;b.name="Background",a.$l(b),(b=new Eo).name="",a.$l(b),(b=new Eo).name="Foreground",a.$l(b),(b=new Eo).name="Adornment",b.isTemporary=!0,a.$l(b),(b=new Eo).name="Tool",b.isTemporary=!0,b.isBoundsIncluded=!0,a.$l(b),(b=new Eo).name="Grid",b.allowSelect=!1,b.pickable=!1,b.isTemporary=!0,a.tx(b,a.im("Background"))}function Wo(a){a.Fb=new jh(jh.Grid),a.Fb.name="GRID";var b=new rl;b.figure="LineH",b.stroke="lightgray",b.strokeWidth=.5,b.interval=1,a.Fb.add(b),(b=new rl).figure="LineH",b.stroke="gray",b.strokeWidth=.5,b.interval=5,a.Fb.add(b),(b=new rl).figure="LineH",b.stroke="gray",b.strokeWidth=1,b.interval=10,a.Fb.add(b),(b=new rl).figure="LineV",b.stroke="lightgray",b.strokeWidth=.5,b.interval=1,a.Fb.add(b),(b=new rl).figure="LineV",b.stroke="gray",b.strokeWidth=.5,b.interval=5,a.Fb.add(b),(b=new rl).figure="LineV",b.stroke="gray",b.strokeWidth=1,b.interval=10,a.Fb.add(b),(b=new lu).add(a.Fb),b.layerName="Grid",b.zOrder=0,b.isInDocumentBounds=!1,b.isAnimated=!1,b.pickable=!1,b.locationObjectName="GRID",a.add(b),a.partManager.parts.remove(b),a.Fb.visible=!1}function Jo(){this.B.Bs?this.B.Bs=!1:this.B.isEnabled?this.B.Ex(this):Sr(this.B)}function Zo(a){this.B.isEnabled?(this.B.Fs=a.target.scrollTop,this.B.Ds=a.target.scrollLeft):Sr(this.B)}function $o(a){if(a.fixedBounds.u()){var b=a.fixedBounds.copy();return b.cq(a.bb),b}for(var t=!0,e=a.Ja.j,n=e.length,o=0;o<n;o++){var g=e[o];if(g.visible&&(!g.isTemporary||g.isBoundsIncluded))for(var r=(g=g.Ca.j).length,h=0;h<r;h++){var l=g[h];l.isInDocumentBounds&&l.isVisible()&&((l=l.actualBounds).u()&&(t?(t=!1,b=l.copy()):b.Hc(l)))}}return t&&(b=new Wt(0,0,0,0)),b.cq(a.bb),b}function Qo(a,b){if((b||a.je)&&!a.Rb&&null!==a.sa&&a.documentBounds.u()){if(b){var t=a.initialPosition;if(t.u())return void(a.position=t);(t=Mt.alloc()).dj(a.documentBounds,a.initialDocumentSpot);var e=a.viewportBounds;e=Wt.allocAt(0,0,e.width,e.height);var n=Mt.alloc();n.dj(e,a.initialViewportSpot),n.h(t.x-n.x,t.y-n.y),a.position=n,Wt.free(e),Mt.free(n),Mt.free(t)}a.Rb=!0,t=a.Lg,b&&a.Xf!==xs&&(t=a.Xf),e=t!==xs?_o(a,t):a.scale,t=a.viewportBounds.copy(),n=a.wa/e;var o=a.va/e,g=a.lj,r=a.Xn;b&&!g.eb()&&(r.eb()||r.Mb())&&(g=r.Mb()?xi:r),ir(a,a.documentBounds,n,o,g,b),b=a.scale,a.scale=e,a.Rb=!1,(e=a.viewportBounds).Ma(t)||a.Bq(t,e,b,!1),xr(a),fr(a,!0,!1)}}function _o(a,b){var t=a.yn;if(null===a.sa)return t;Yr(a);var e=a.documentBounds;if(!e.u())return t;var n=e.width;e=e.height;var o=a.wa+(a.Te?a.jb:0),g=a.va+(a.ie?a.jb:0),r=o/n,h=g/e;return b===bs?((b=Math.min(h,r))>t&&(b=t),b<a.minScale&&(b=a.minScale),b>a.maxScale&&(b=a.maxScale),b):b===ws?((b=h>r?(g-a.jb)/e:(o-a.jb)/n)>t&&(b=t),b<a.minScale&&(b=a.minScale),b>a.maxScale&&(b=a.maxScale),b):a.scale}function ir(a,b,t,e,n,o){var g=Mt.allocAt(a.ma.x,a.ma.y),r=g.x,h=g.y;if(null!==a.In){var l=Mt.alloc();r=(l=a.In.ga(gi,l)).x-a.Jn.x/a.scale,h=l.y-a.Jn.y/a.scale,n=pi,Mt.free(l)}(o||a.scrollMode===Ts)&&(n.eb()&&(t>b.width&&(r=b.x+(n.x*b.width+n.offsetX)-(n.x*t-n.offsetX)),e>b.height&&(h=b.y+(n.y*b.height+n.offsetY)-(n.y*e-n.offsetY))),n=a.Fi,o=t-b.width,t<b.width+n.left+n.right?(r=Math.min(r+t/2,b.right+Math.max(o,n.right)-t/2),r=Math.max(r,b.left-Math.max(o,n.left)+t/2),r-=t/2):r>b.left?r=b.left:r<b.right-t&&(r=b.right-t),t=e-b.height,e<b.height+n.top+n.bottom?(h=Math.min(h+e/2,b.bottom+Math.max(t,n.bottom)-e/2),h=Math.max(h,b.top-Math.max(t,n.top)+e/2),h-=e/2):h>b.top?h=b.top:h<b.bottom-e&&(h=b.bottom-e)),g.x=isFinite(r)?r:-a.bb.left,g.y=isFinite(h)?h:-a.bb.top,null!==a.positionComputation&&(b=a.positionComputation(a,g),g.x=b.x,g.y=b.y),a.Jc.qc&&mo(a.Jc,a.ma,g),a.ma.h(g.x,g.y),Mt.free(g)}function er(a,b,t,e){for(void 0===t&&(t=null),void 0===e&&(e=null),pr(a),a=a.Ja.iteratorBackwards;a.next();){var n=a.value;if(n.visible&&!n.isTemporary&&null!==(n=n.Ub(b,t,e)))return n}return null}function nr(a,b,t){var e=a.Qd;return a.Qd=a.dh,a.dh=e,e.diagram=a,e.event=b,t?ur(a,b,e):(e.viewPoint=a.Qd.viewPoint,e.documentPoint=a.Qd.documentPoint),a=0,b.ctrlKey&&(a+=1),b.altKey&&(a+=2),b.shiftKey&&(a+=4),b.metaKey&&(a+=8),e.modifiers=a,e.button=b.button,void 0===b.buttons||U||(e.buttons=b.buttons),J&&0===b.button&&b.ctrlKey&&(e.button=2),e.down=!1,e.up=!1,e.clickCount=1,e.delta=0,e.handled=!1,e.bubbles=!1,e.timestamp=b.timeStamp,e.isMultiTouch=!1,e.targetDiagram=or(b),e.targetObject=null,e}function or(a){var b=a.target.B;if(!b){var t=a.path;t||"function"!=typeof a.composedPath||(t=a.composedPath()),t&&t[0]&&(b=t[0].B)}return b||null}function rr(a,b,t,e){var n=ar(a,b,!0,!1,!0,e);return ur(a,t,n),n.targetDiagram=or(b),n.targetObject=null,e||n.clone(a.Uf),n}function sr(a,b,t,e){var n;return e=ar(a,b,!1,!1,!1,e),null!==t?((n=w.document.elementFromPoint(t.clientX,t.clientY))&&n.B?(b=t,t=n.B):(b=void 0!==b.targetTouches?b.targetTouches[0]:b,t=a),e.targetDiagram=t,ur(a,b,e)):null!==a.Qd?(e.documentPoint=a.Qd.documentPoint,e.viewPoint=a.Qd.viewPoint,e.targetDiagram=a.Qd.targetDiagram):null!==a.Uf&&(e.documentPoint=a.Uf.documentPoint,e.viewPoint=a.Uf.viewPoint,e.targetDiagram=a.Uf.targetDiagram),e.targetObject=null,e}function ar(a,b,t,e,n,o){var g=a.Qd;a.Qd=a.dh,a.dh=g,g.diagram=a,g.clickCount=1;var r=g.delta=0;return b.ctrlKey&&(r+=1),b.altKey&&(r+=2),b.shiftKey&&(r+=4),b.metaKey&&(r+=8),g.modifiers=r,g.button=0,g.buttons=1,g.event=b,g.timestamp=b.timeStamp,a.Vm&&b instanceof w.PointerEvent&&"touch"!==b.pointerType&&(g.button=b.button,void 0===b.buttons||U||(g.buttons=b.buttons),J&&0===b.button&&b.ctrlKey&&(g.button=2)),g.down=t,g.up=e,g.handled=!1,g.bubbles=n,g.isMultiTouch=o,g}function lr(a,b){return!!a.bubbles||(void 0!==b.stopPropagation&&b.stopPropagation(),!1!==b.cancelable&&b.preventDefault(),b.cancelBubble=!0,!1)}function ur(a,b,t){var e=a.sa,n=a.wa,o=a.va,g=0,r=0;null!==e&&(e=e.getBoundingClientRect(),g=b.clientX-n/e.width*e.left,r=b.clientY-o/e.height*e.top),t.viewPoint.h(g,r),null!==a.kb?(b=Mt.allocAt(g,r),a.kb.Wd(b),t.documentPoint.assign(b),Mt.free(b)):t.documentPoint.h(g,r)}function cr(a,b,t,e){if(void 0!==b.targetTouches){if(2>b.targetTouches.length)return;b=b.targetTouches[t]}else{if(null===a.Kj[0])return;b=a.Kj[t]}null!==(t=a.sa)&&(t=t.getBoundingClientRect(),e.h(b.clientX-a.wa/t.width*t.left,b.clientY-a.va/t.height*t.top))}function fr(a,b,t){a.animationManager.defaultAnimation.isAnimating||a.Rb||!a.li||Sr(a)||(b&&pr(a),t&&Qo(a,!1))}function dr(a,b){if(!a.Bc&&(a.xe=!1,null!==a.La||a.Zl.u())){a.Bc=!0;var t=a.animationManager,e=a.ss;if(!t.isAnimating&&0!==e.length){for(var n=e.j,o=n.length,g=0;g<o;g++){var r=n[g];ma(r,!1),r.o()}e.clear()}0<(e=a.tu).count&&(e.each((function(a){a.uw()})),e.clear()),n=e=!1,t.isAnimating&&(n=!0,e=a.skipsUndoManager,a.skipsUndoManager=!0),t.qc||Ko(a),fr(a,!1,!1),null!==a.Fb&&(a.Fb.visible&&!a.Un&&(Br(a),a.Un=!0),!a.Fb.visible&&a.Un&&(a.Un=!1)),pr(a),o=!1,a.je&&!a.If||(a.je?qr(a,!a.pj):(a.ua("Initial Layout"),!1===t.isEnabled&&t.Xc(),qr(a,!1)),o=!0),a.pj=!1,pr(a),a.Ls||function(a){a.Bc||pr(a),Yr(a)}(a),fr(a,!0,!1),g=!1,o?(a.je||(g=a.je=!0,function(a){var b=a.ya;if(a.Xf!==xs)a.scale=_o(a,a.Xf);else if(a.Lg!==xs)a.scale=_o(a,a.Lg);else{var t=a.initialScale;isFinite(t)&&0<t&&(a.scale=t)}a.ya!==b&&(xr(a),fr(a,!0,!1)),Qo(a,!0),a.Ou.assign(a.ma),b=a.Ja.j,a.zd(b,b.length,a),a.R("InitialLayoutCompleted"),Br(a)}(a)),a.R("LayoutCompleted")):t.gl&&t.px&&(a.Xf!==xs?a.scale=_o(a,a.Xf):a.Lg!==xs?a.scale=_o(a,a.Lg):(t=a.initialScale,isFinite(t)&&0<t&&(a.scale=t)),Qo(a,!0)),pr(a),o&&g&&(a.Ua("Initial Layout"),a.skipsUndoManager||a.undoManager.clear(),S((function(){a.isModified=!1}),1)),a.hv(),b||a.bc(a.Db),n&&(a.skipsUndoManager=e),a.Bc=!1}}function pr(a){if((a.Bc||!a.animationManager.isTicking)&&0!==a.od.count){for(var b=0;23>b;b++){var t=a.od.iterator;if(null===t||0===a.od.count)break;a.od=new ct,a.uw(t,a.od)}a.nodes.each((function(a){a instanceof qu&&0!=(65536&a.P)!=!1&&(a.P=65536^a.P)}))}}function gr(a,b){for(var t=I(),e=I(),n=b.memberParts;n.next();){var o=n.value;o.isVisible()&&(o instanceof qu?(ya(o)||va(o)||wu(o))&&gr(a,o):o instanceof Wu?o.fromNode===b||o.toNode===b?e.push(o):t.push(o):(o.measure(1/0,1/0),o.arrange()))}for(a=t.length,n=0;n<a;n++)(o=t[n]).measure(1/0,1/0),o.arrange();for(R(t),b.measure(1/0,1/0),b.arrange(),a=e.length,b=0;b<a;b++)(t=e[b]).measure(1/0,1/0),t.arrange();R(e)}function yr(a,b,t,e,n,o,g,r,h,l){if(null!==a.La){null===a.sa&&N("No canvas specified"),void 0===g&&(g=null),void 0===r&&(r=null),void 0===h&&(h=!1),void 0===l&&(l=!1),kr(a),a.Db.sc(!0),wr(a),a.ni=!0;var c=a.ya;a.ya=n;var f=a.Ja.j,p=f.length;try{var d=new Wt(o.x,o.y,e.width/n,e.height/n),q=d.copy();q.cq(t),Br(a,q),pr(a),a.zd(f,p,a,d);var u=a.Sb;b.setTransform(1,0,0,1,0,0),b.scale(u,u),b.clearRect(0,0,e.width,e.height),null!==r&&""!==r&&(b.fillStyle=r,b.fillRect(0,0,e.width,e.height));var y=ie.alloc();if(y.reset(),y.translate(t.left,t.top),y.scale(n),0===o.x&&0===o.y||y.translate(-o.x,-o.y),b.setTransform(y.m11,y.m12,y.m21,y.m22,y.dx,y.dy),ie.free(y),mr(a,b),b.globalAlpha=a.qb,null!==g){var m=new ct,v=g.iterator;for(v.reset();v.next();){var x=v.value;!1===l&&"Grid"===x.layer.name||null===x||m.add(x)}var w=function(t){if(t.visible&&0!==t.qb&&(h||!t.isTemporary)){var e=t.Ca.j,n=e.length;if(0!==n){var o=zo(t,b),g=t.Yo;g.length=0;for(var r=a.scale,l=Wt.alloc(),c=0;c<n;c++){var f=e[c];m.contains(f)&&t.Pi(b,f,a,g,r,l)}Wt.free(l),b.globalAlpha=o}}}}else if(!h&&l){var k=a.grid.part,M=k.layer;w=function(t){t===M?k.bc(b,a):t.bc(b,a,h)}}else w=function(t){t.bc(b,a,h)};for(t=0;t<p;t++)w(f[t]);a.ni=!1,a.ji&&zs(a.ji,a)&&a.zr()}finally{a.ya=c,a.Db.sc(!0),wr(a),a.zd(f,p,a),Br(a)}}}function mr(a,b){null!==(a=a.cf)&&(void 0!==a.imageSmoothingEnabled&&b.ky(!!a.imageSmoothingEnabled),null!=(a=a.defaultFont)&&(b.font=a))}function vr(a,b){var t,e=a instanceof jh,n=a instanceof Vo;for(t in b){""===t&&N("Setting properties requires non-empty property names");var o=a,g=t;if(e||n){var r=t.indexOf(".");if(0<r){var h=t.substring(0,r);e?o=a.Xa(h):null==(o=a[h])&&(o=a.toolManager[h]),j(o)?g=t.substr(r+1):N("Unable to find object named: "+h+" in "+a.toString()+" when trying to set property: "+t)}}if("_"!==g[0]&&!V(o,g)){if(n&&"ModelChanged"===g){a.vx(b[g]);continue}if(n&&"Changed"===g){a.Dh(b[g]);continue}if(n&&V(a.toolManager,g))o=a.toolManager;else{if(n&&Hr(a,g)){a.Uj(g,b[g]);continue}if(a instanceof Bf&&"Changed"===g){a.Dh(b[g]);continue}N('Trying to set undefined property "'+g+'" on object: '+o.toString())}}o[g]=b[t],"_"===g[0]&&o instanceof _s&&o.sx(g)}}function xr(a){!1===a.li&&(a.li=!0)}function wr(a){!1===a.mi&&(a.mi=!0)}function kr(a){!1!==a.ll&&(a.ll=!1,Mr(a,a.wa,a.va))}function Mr(a,b,t){var e=a.Sb;a.sa.resize(b*e,t*e,b,t)&&(a.Ac=!0,a.Db.sc(!0))}function Sr(a){var b=a.sa;if(null===b)return!0;var t=a.La,e=a.wa,n=a.va,o=a.$u.copy();if(!o.u())return!0;var g=!1,r=a.Te?a.jb:0,h=a.ie?a.jb:0,l=t.clientWidth||e+r,c=t.clientHeight||n+h;if(l===e+r&&c===n+h||(a.Te=!1,a.ie=!1,h=r=0,a.wa=l,a.va=c,g=a.ll=!0),!(g||a.Te||a.ie||a.cl||a.dl))return!0;a.li=!1;var f=a.viewportBounds,p=a.documentBounds,d=0,q=0,u=0,y=0;t=f.width;var m=f.height,v=a.Fi;a.contentAlignment.eb()?(p.width>t&&(d=v.left,q=v.right),p.height>m&&(u=v.top,y=v.bottom)):(d=v.left,q=v.right,u=v.top,y=v.bottom),v=p.width+d+q;var x=p.height+u+y;d=p.x-d;var w=f.x;q=p.right+q;var k=f.right+r;u=p.y-u;var M=f.y;p=p.bottom+y,f=f.bottom+h;var S="1px",P="1px";if(l=v>l/(y=a.scale),c=x>c/y,a.scrollMode===Ts&&(l||c)&&(l&&a.hasHorizontalScrollbar&&a.allowHorizontalScroll&&(l=1,d+1<w&&(l=Math.max((w-d)*y+a.wa,l)),q>k+1&&(l=Math.max((q-k)*y+a.wa,l)),t+r+1<v&&(l=Math.max((v-t)*y+a.wa,l)),S=l.toString()+"px"),c&&a.hasVerticalScrollbar&&a.allowVerticalScroll&&(l=1,u+1<M&&(l=Math.max((M-u)*y+a.va,l)),p>f+1&&(l=Math.max((p-f)*y+a.va,l)),m+h+1<x&&(l=Math.max((x-m)*y+a.va,l)),P=l.toString()+"px")),c="1px"!==P,(l="1px"!==S)&&c||!l&&!c||(c&&(k-=a.jb),l&&(f-=a.jb),v<t+r||!a.hasHorizontalScrollbar||!a.allowHorizontalScroll||(r=1,d+1<w&&(r=Math.max((w-d)*y+a.wa,r)),q>k+1&&(r=Math.max((q-k)*y+a.wa,r)),t+1<v&&(r=Math.max((v-t)*y+a.wa,r)),S=r.toString()+"px"),l="1px"!==S,r=a.va,l!==a.ie&&(r=l?a.va-a.jb:a.va+a.jb),x<m+h||!a.hasVerticalScrollbar||!a.allowVerticalScroll||(h=1,u+1<M&&(h=Math.max((M-u)*y+r,h)),p>f+1&&(h=Math.max((p-f)*y+r,h)),m+1<x&&(h=Math.max((x-m)*y+r,h)),P=h.toString()+"px"),c="1px"!==P),a.vp&&l===a.ie&&c===a.Te)return e===a.wa&&n===a.va||a.Wc(),!1;if(l!==a.ie&&(a.va="1px"===S?a.va+a.jb:Math.max(a.va-a.jb,1),g=!0),a.ie=l,a.wp.style.width=S,c!==a.Te&&(a.wa="1px"===P?a.wa+a.jb:Math.max(a.wa-a.jb,1),g=!0,a.nl&&(h=Mt.alloc(),c?(b.style.left=a.jb+"px",a.position=h.h(a.ma.x+a.jb/a.scale,a.ma.y)):(b.style.left="0px",a.position=h.h(a.ma.x-a.jb/a.scale,a.ma.y)),Mt.free(h))),a.Te=c,a.wp.style.height=P,a.Bs=!0,g&&(a.ll=!0),h=(b=a.Es).scrollLeft,a.hasHorizontalScrollbar&&a.allowHorizontalScroll&&(t+1<v?h=(a.position.x-d)*y:d+1<w?h=b.scrollWidth-b.clientWidth:q>k+1&&(h=a.position.x*y)),a.nl)switch(a.zs){case"negative":h=-(b.scrollWidth-h-b.clientWidth);break;case"reverse":h=b.scrollWidth-h-b.clientWidth}return b.scrollLeft=h,a.hasVerticalScrollbar&&a.allowVerticalScroll&&(m+1<x?b.scrollTop=(a.position.y-u)*y:u+1<M?b.scrollTop=b.scrollHeight-b.clientHeight:p>f+1&&(b.scrollTop=a.position.y*y)),l=a.wa,c=a.va,b.style.width=l+(a.Te?a.jb:0)+"px",b.style.height=c+(a.ie?a.jb:0)+"px",e===l&&n===c&&!a.animationManager.qc||(a.Bq(o,a.viewportBounds,y,g),!1)}function Pr(a,b,t){var e=b.layer;null!==e&&e.diagram===a&&(b.isSelected=!1,b.isHighlighted=!1,b.C(2),t&&b.dk(),0<=(t=e.Fc(-1,b,!1))&&a.Ya(Oe,"parts",e,b,null,t,null),null!==(a=b.layerChanged)&&a(b,e,null))}function Nr(a,b,t,e,n,o){if(!b.contains(t)&&(void 0===o&&(o=!1),!e||o||t.canMove()||t.canCopy()))if(void 0===n&&(n=Tr(a)),t instanceof Au){if(b.add(t,a.td(n,t,t.location)),t instanceof qu)for(o=t.memberParts;o.next();)Nr(a,b,o.value,e,n,n.Mz);for(o=t.linksConnected;o.next();){var g=o.value;if(!b.contains(g)){var r=g.fromNode,h=g.toNode;null!==r&&b.contains(r)&&null!==h&&b.contains(h)&&Nr(a,b,g,e,n)}}if(n.dragsTree)for(t=t.wv();t.next();)Nr(a,b,t.value,e,n)}else if(t instanceof Wu)for(b.add(t,a.td(n,t)),t=t.labelNodes;t.next();)Nr(a,b,t.value,e,n);else t instanceof Lu||b.add(t,a.td(n,t,t.location))}function Cr(a,b,t,e,n){if(null!==b&&0!==b.count){var o=Mt.alloc(),g=Mt.alloc();g.assign(t),isNaN(g.x)&&(g.x=0),isNaN(g.y)&&(g.y=0),(t=a.Op)||Ar(a,b);for(var r=I(),h=I(),l=b.iterator,c=Mt.alloc();l.next();){var f=l.key,p=l.value;if(f.Wb()){var d=Dr(a,f,b);null!==d?r.push(new Gs(f,p,d)):n&&!f.canMove()||(d=p.point,o.assign(d),a.computeMove(f,o.add(g),e,c),f.location=c,void 0===p.shifted&&(p.shifted=new Mt),p.shifted.assign(c.$d(d)))}else l.key instanceof Wu&&h.push(l.la)}for(Mt.free(c),n=r.length,l=0;l<n;l++)f=r[l],o.assign(f.info.point),void 0===f.Cv.shifted&&(f.Cv.shifted=new Mt),f.node.location=o.add(f.Cv.shifted);for(n=Mt.alloc(),l=Mt.alloc(),f=h.length,p=0;p<f;p++){var q=h[p];if((d=q.key)instanceof Wu)if(d.suspendsRouting){d.oh=null,c=d.fromNode;var u=d.toNode;if(null!==a.draggedLink&&e.dragsLink)if(u=q.value.point,null===d.dragComputation)b.add(d,a.td(e,d,g)),$u(d,g.x-u.x,g.y-u.y);else{q=Mt.allocAt(0,0),(c=d.i(0))&&c.u()&&q.assign(c);var y=c=Mt.alloc().assign(q).add(g);e.isGridSnapEnabled&&(e.isGridSnapRealtime||a.lastInput.up)&&Lr(a,d,c,y=Mt.alloc(),e),c.assign(d.dragComputation(d,c,y)).$d(q),b.add(d,a.td(e,d,c)),$u(d,c.x-u.x,c.y-u.y),Mt.free(q),Mt.free(c),y!==c&&Mt.free(y)}else null!==c&&(n.assign(c.location),null!==(y=b.H(c))&&n.$d(y.point)),null!==u&&(l.assign(u.location),null!==(y=b.H(u))&&l.$d(y.point)),null!==c&&null!==u?n.Ma(l)?(c=q.value.point,(u=o).assign(n),u.$d(c),b.add(d,a.td(e,d,n)),$u(d,u.x,u.y)):(d.suspendsRouting=!1,d.Ta()):(q=q.value.point,c=null!==c?n:null!==u?l:g,b.add(d,a.td(e,d,c)),$u(d,c.x-q.x,c.y-q.y))}else null!==d.fromNode&&null!==d.toNode||(c=q.value.point,b.add(d,a.td(e,d,g)),$u(d,g.x-c.x,g.y-c.y))}Mt.free(o),Mt.free(g),Mt.free(n),Mt.free(l),R(r),R(h),t||(pr(a),jr(a,b))}}function Tr(a){var b=a.toolManager.findTool("Dragging");return null!==b?b.dragOptions:a.Qk}function Lr(a,b,t,e,n){if(void 0===n&&(n=Tr(a)),e.assign(t),null!==b){var o=a.grid;a=(b=n.gridSnapCellSize).width,b=b.height;var g=n.gridSnapOrigin,r=g.x;if(g=g.y,n=n.gridSnapCellSpot,null!==o){var h=o.gridCellSize;isNaN(a)&&(a=h.width),isNaN(b)&&(b=h.height),o=o.gridOrigin,isNaN(r)&&(r=o.x),isNaN(g)&&(g=o.y)}(o=Mt.allocAt(0,0)).xk(0,0,a,b,n),ne.mq(t.x,t.y,r+o.x,g+o.y,a,b,e),Mt.free(o)}}function Ar(a,b){if(null!==b)for(a.Op=!0,a=b.iterator;a.next();)(b=a.key)instanceof Wu&&(b.suspendsRouting=!0)}function jr(a,b){if(null!==b){for(b=b.iterator;b.next();){var t=b.key;t instanceof Wu&&(t.suspendsRouting=!1,ec(t)&&t.Ta())}a.Op=!1}}function Dr(a,b,t){if(null!==(b=b.containingGroup)){if(null!==(a=Dr(a,b,t)))return a;if(null!==(a=t.H(b)))return a}return null}function Fr(a,b,t){if(null!==b.diagram&&b.diagram!==a&&N("Cannot share a Layer with another Diagram: "+b+" of "+b.diagram),null===t?null!==b.diagram&&N("Cannot add an existing Layer to this Diagram again: "+b):(t.diagram!==a&&N("Existing Layer must be in this Diagram: "+t+" not in "+t.diagram),b===t&&N("Cannot move a Layer before or after itself: "+b)),b.diagram!==a){b=b.name,t=(a=a.Ja).count;for(var e=0;e<t;e++)a.L(e).name===b&&N("Cannot add Layer with the name '"+b+"'; a Layer with the same name is already present in this Diagram.")}}function Or(a,b,t){var e=a.animationManager;if(a.Rb||a.Bc)a.ya=t,e.$e&&e.Bd.add(e.B,"scale",b,a.ya);else if(a.Rb=!0,null===a.sa)a.ya=t;else{var n=a.viewportBounds.copy(),o=a.wa,g=a.va;n.width=a.wa/b,n.height=a.va/b;var r=a.zoomPoint.x,h=a.zoomPoint.y,l=a.contentAlignment;isNaN(r)&&(l.gd()?l.xf(Pi)?r=0:l.xf(Ni)&&(r=o-1):r=l.eb()?l.x*(o-1):o/2),isNaN(h)&&(l.gd()?l.xf(Si)?h=0:l.xf(Ci)&&(h=g-1):h=l.eb()?l.y*(g-1):g/2),null===a.scaleComputation||a.animationManager.isAnimating||(t=a.scaleComputation(a,t)),t<a.minScale&&(t=a.minScale),t>a.maxScale&&(t=a.maxScale),o=Mt.allocAt(a.ma.x+r/b-r/t,a.ma.y+h/b-h/t),a.position=o,Mt.free(o),a.ya=t,a.Bq(n,a.viewportBounds,b,!1),a.Rb=!1,Qo(a,!1),e.$e&&e.Bd.add(e.B,"scale",b,a.ya),a.M(),xr(a)}}function Br(a,b){void 0===b&&(b=null);var t=a.Fb;if(null!==t&&t.visible){for(var e=qt.alloc(),n=1,o=1,g=t.W.j,r=g.length,h=0;h<r;h++){var l=g[h],c=l.interval;2>c||(Bh(l.figure)?o=o*c/ne.Nx(o,c):n=n*c/ne.Nx(n,c))}if(g=t.gridCellSize,e.h(o*g.width,n*g.height),null!==b)n=b.width,o=b.height,a=b.x,g=b.y;else{if(b=Wt.alloc(),a=a.viewportBounds,b.h(a.x,a.y,a.width,a.height),!b.u())return void Wt.free(b);n=b.width,o=b.height,a=b.x,g=b.y,Wt.free(b)}t.width=n+2*e.width,t.height=o+2*e.height,b=Mt.alloc(),ne.mq(a,g,0,0,e.width,e.height,b),b.offset(-e.width,-e.height),qt.free(e),t.part.location=b,Mt.free(b)}}function Ir(a){var b=a.isModified;a.av!==b&&(a.av=b,a.R("Modified"))}function Rr(a,b){for(var t=(b=b.W.j).length,e=0;e<t;e++)Er(a,b[e])}function Er(a,b){if(b instanceof ql){var t=b.element;if(null!==t&&t instanceof HTMLImageElement){var e=b.Vg;if(null!==e&&(e.bl instanceof Event&&null!==b.zc&&b.zc(b,e.bl),!0===e.Pr&&(null!==b.lf&&b.lf(b,e.Pu),null!==b.diagram&&b.diagram.ss.add(b))),t=t.getAttribute("src"),null===(e=a.Ci.H(t)))(e=[]).push(b),a.Ci.add(t,e);else{for(a=0;a<e.length;a++)if(e[a]===b)return;e.push(b)}}}}function zr(a,b){if(b instanceof ql){var t=b.element;if(null!==t&&t instanceof HTMLImageElement){t=t.getAttribute("src");var e=a.Ci.H(t);if(null!==e)for(var n=0;n<e.length;n++)if(e[n]===b){e.splice(n,1),0===e.length&&(a.Ci.remove(t),Ul(t));break}}}}function Vr(a,b){a.ki=!1;var t=a.zn;t.w(b)||(b=b.G(),a.zn=b,Qo(a,!1),a.R("DocumentBoundsChanged",null,t.copy()),xr(a))}function Yr(a){a.ki&&Vr(a,a.computeBounds())}function Gr(a,b){for(var t=a.zh.iterator;t.next();)Xr(a,t.value,b);null!==a.layout&&(b?a.layout.isValidLayout=!1:a.layout.C())}function Xr(a,b,t){if(null!==b){for(var e=b.zl.iterator;e.next();)Xr(a,e.value,t);null!==b.layout&&(t?b.layout.isValidLayout=!1:b.layout.C())}}function qr(a,b){if(a.If&&!a.tr){var t=a.Z;a.Z=!0;var e=a.undoManager.transactionLevel,n=a.layout;try{0===e&&a.ua("Layout");var o=a.animationManager;1>=e&&!o.isAnimating&&!o.qc&&(b||uo(o,"Layout")),a.If=!1;for(var g=a.zh.iterator;g.next();)Ur(a,g.value,b,e);n.isValidLayout||(!b||n.isRealtime||null===n.isRealtime||0===e?(n.doLayout(a),pr(a),n.isValidLayout=!0):a.If=!0)}finally{0===e&&a.Ua("Layout"),a.If=!n.isValidLayout,a.Z=t}}}function Ur(a,b,t,e){if(null!==b){for(var n=b.zl.iterator;n.next();)Ur(a,n.value,t,e);null===(n=b.layout)||n.isValidLayout||(!t||n.isRealtime||0===e?(b.uk=!b.location.u(),n.doLayout(b),b.C(32),gr(a,b),n.isValidLayout=!0):a.If=!0)}}function Kr(a){function b(a){var b=a.toLowerCase(),n=new lt;t.add(a,n),t.add(b,n),e.add(a,a),e.add(b,a)}var t=new kt,e=new kt;b("InitialAnimationStarting"),b("AnimationStarting"),b("AnimationFinished"),b("BackgroundSingleClicked"),b("BackgroundDoubleClicked"),b("BackgroundContextClicked"),b("ClipboardChanged"),b("ClipboardPasted"),b("DocumentBoundsChanged"),b("ExternalObjectsDropped"),b("GainedFocus"),b("InitialLayoutCompleted"),b("LayoutCompleted"),b("LinkDrawn"),b("LinkRelinked"),b("LinkReshaped"),b("LostFocus"),b("Modified"),b("ObjectSingleClicked"),b("ObjectDoubleClicked"),b("ObjectContextClicked"),b("PartCreated"),b("PartResized"),b("PartRotated"),b("SelectionMoved"),b("SelectionCopied"),b("SelectionDeleting"),b("SelectionDeleted"),b("SelectionGrouped"),b("SelectionUngrouped"),b("ChangingSelection"),b("ChangedSelection"),b("SubGraphCollapsed"),b("SubGraphExpanded"),b("TextEdited"),b("TreeCollapsed"),b("TreeExpanded"),b("ViewportBoundsChanged"),b("InvalidateDraw"),a.wr=t,a.vr=e}function Hr(a,b){var t=a.vr.H(b);return null!==t?t:a.vr.H(b.toLowerCase())}function Wr(a,b){var t=a.wr.H(b);return null!==t||null!==(t=a.wr.H(b.toLowerCase()))?t:(N("Unknown DiagramEvent name: "+b),null)}function Jr(a){if(a.animationManager.isAnimating)return!1;var b=a.currentTool;return b!==a.toolManager.findTool("Dragging")||(!a.Op||b.isComplexRoutingRealtime)}function Zr(a,b,t,e){if(null===a.Gb&&(a.Gb=new Fc),a.Gb.st||a.Gb.group!==t||a.Gb.oy!==e){if(null===t){(b=a.computeOccupiedArea()).Vc(100,100),a.Gb.initialize(b),b=Wt.alloc();for(var n=a.nodes;n.next();){var o=n.value,g=o.layer;null!==g&&g.visible&&!g.isTemporary&&$r(a,o,e,b)}Wt.free(b)}else{for(0<t.memberParts.count&&((b=a.computePartsBounds(t.memberParts,!1)).Vc(20,20),a.Gb.initialize(b)),b=Wt.alloc(),n=t.memberParts;n.next();)(o=n.value)instanceof Au&&$r(a,o,e,b);Wt.free(b)}a.Gb.group=t,a.Gb.oy=e,a.Gb.st=!1}else b&&Rc(a.Gb);return a.Gb}function $r(a,b,t,e){if(b!==t)if(b.isVisible()&&b.avoidable&&!b.isLinkLabel){var n=b.getAvoidableRect(e),o=a.Gb.dm;t=a.Gb.cm,e=n.x+n.width,b=n.y+n.height;for(var g=n.x;g<e;g+=o){for(var r=n.y;r<b;r+=t)Ic(a.Gb,g,r);Ic(a.Gb,g,b)}for(n=n.y;n<b;n+=t)Ic(a.Gb,e,n);Ic(a.Gb,e,b)}else if(b instanceof qu)for(b=b.memberParts;b.next();)(n=b.value)instanceof Au&&$r(a,n,t,e)}function Qr(a,b){null!==a.Gb&&!a.Gb.st&&(void 0===b&&(b=null),null===b||b.avoidable&&!b.isLinkLabel)&&(a.Gb.st=!0)}function _r(a,b){var t=a.position,e=a.an;if(0>=e.top&&0>=e.left&&0>=e.right&&0>=e.bottom)return t;var n=a.viewportBounds,o=a.scale;n=Wt.allocAt(0,0,n.width*o,n.height*o);var g=Mt.allocAt(0,0);if(b.x>=n.x&&b.x<n.x+e.left){var r=Math.max(a.scrollHorizontalLineChange,1);r|=0,g.x-=r,b.x<n.x+e.left/2&&(g.x-=r),b.x<n.x+e.left/4&&(g.x-=4*r)}else b.x<=n.x+n.width&&b.x>n.x+n.width-e.right&&(r=Math.max(a.scrollHorizontalLineChange,1),r|=0,g.x+=r,b.x>n.x+n.width-e.right/2&&(g.x+=r),b.x>n.x+n.width-e.right/4&&(g.x+=4*r));return b.y>=n.y&&b.y<n.y+e.top?(a=Math.max(a.scrollVerticalLineChange,1),a|=0,g.y-=a,b.y<n.y+e.top/2&&(g.y-=a),b.y<n.y+e.top/4&&(g.y-=4*a)):b.y<=n.y+n.height&&b.y>n.y+n.height-e.bottom&&(a=Math.max(a.scrollVerticalLineChange,1),a|=0,g.y+=a,b.y>n.y+n.height-e.bottom/2&&(g.y+=a),b.y>n.y+n.height-e.bottom/4&&(g.y+=4*a)),g.Ma(jt)||(t=new Mt(t.x+g.x/o,t.y+g.y/o)),Wt.free(n),Mt.free(g),t}function ts(a,b,t){function e(){var a=+new Date;for(o=!0,g.reset();g.next();)if(!g.value[0].vl){o=!1;break}o||a-l>h?b(t,n,r):w.requestAnimationFrame(e)}for(var n=t.callback,o=!0,g=a.Ci.iterator;g.next();)if(!g.value[0].vl){o=!1;break}if("function"!=typeof n||o)return b(t,n,a);var r=a,h=t.callbackTimeout||300,l=+new Date;return w.requestAnimationFrame((function(){e()})),null}function is(a,b,t,e){if(a.animationManager.Xc(),a.Wc(),null===a.sa)return null;"object"!=typeof b&&N("properties argument must be an Object.");var n=b.size||null,o=b.scale||null;void 0!==b.scale&&isNaN(b.scale)&&(o="NaN");var g=b.maxSize;void 0===b.maxSize&&(g="SVG"===t?new qt(1/0,1/0):new qt(2e3,2e3));var r=b.position||null,h=b.parts||null,l=void 0===b.padding?1:b.padding,c=b.background||null,f=b.omitTemporary;void 0===f&&(f=!0);var p=b.document||document,d=b.elementFinished||null,q=b.showTemporary;void 0===q&&(q=!f),void 0===(b=b.showGrid)&&(b=q),null!==n&&isNaN(n.width)&&isNaN(n.height)&&(n=null),"number"==typeof l?l=new hi(l):l instanceof hi||N("MakeImage padding must be a Margin or a number."),l.left=Math.max(l.left,0),l.right=Math.max(l.right,0),l.top=Math.max(l.top,0),l.bottom=Math.max(l.bottom,0),a.Db.sc(!0);var u=(f=new Ra(null,p)).context;if(!(n||o||h||r))return f.width=a.wa+Math.ceil(l.left+l.right),f.height=a.va+Math.ceil(l.top+l.bottom),"SVG"===t?null===e?null:(e.resize(f.width,f.height,f.width,f.height),e.ownerDocument=p,e.jq=d,yr(a,e.context,l,new qt(f.width,f.height),a.ya,a.ma,h,c,q,b),e.context):(a.Xk=!1,yr(a,u,l,new qt(f.width,f.height),a.ya,a.ma,h,c,q,b),a.Xk=!0,f.context);var y=a.yn,m=a.documentBounds.copy();if(m.kw(a.bb),q)for(var v=a.Ja.j,x=v.length,w=0;w<x;w++){var k=v[w];if(k.visible&&k.isTemporary)for(var M=(k=k.Ca.j).length,S=0;S<M;S++){var P=k[S];P.isInDocumentBounds&&P.isVisible()&&((P=P.actualBounds).u()&&m.Hc(P))}}if(v=new Mt(m.x,m.y),null!==h){for(x=!0,(w=h.iterator).reset();w.next();)if((k=w.value)instanceof lu&&((null===(M=k.layer)||M.visible)&&(null===M||q||!M.isTemporary)&&k.isVisible()&&(k=k.actualBounds).u()))if(x){x=!1;var C=k.copy()}else C.Hc(k);x&&(C=new Wt(0,0,0,0)),m.width=C.width,m.height=C.height,v.x=C.x,v.y=C.y}return null!==r&&r.u()&&(v=r,o||(o=y)),C=r=0,null!==l&&(r=l.left+l.right,C=l.top+l.bottom),x=w=0,null!==n&&(w=n.width,x=n.height,isFinite(w)&&(w=Math.max(0,w-r)),isFinite(x)&&(x=Math.max(0,x-C))),null!==n&&null!==o?("NaN"===o&&(o=y),n.u()?(n=w,m=x):isNaN(x)?(n=w,m=m.height*o):(n=m.width*o,m=x)):null!==n?n.u()?(o=Math.min(w/m.width,x/m.height),n=w,m=x):isNaN(x)?(o=w/m.width,n=w,m=m.height*o):(o=x/m.height,n=m.width*o,m=x):null!==o?"NaN"===o&&g.u()?(o=Math.min((g.width-r)/m.width,(g.height-C)/m.height))>y?(o=y,n=m.width,m=m.height):(n=g.width,m=g.height):(n=m.width*o,m=m.height*o):(o=y,n=m.width,m=m.height),null!==l?(n+=r,m+=C):l=new hi(0),null!==g&&(y=g.width,g=g.height,isNaN(y)&&(y=2e3),isNaN(g)&&(g=2e3),isFinite(y)&&(n=Math.min(n,y)),isFinite(g)&&(m=Math.min(m,g))),f.width=Math.ceil(n),f.height=Math.ceil(m),"SVG"===t?null===e?null:(e.resize(f.width,f.height,f.width,f.height),e.ownerDocument=p,e.jq=d,yr(a,e.context,l,new qt(Math.ceil(n),Math.ceil(m)),o,v,h,c,q,b),e.context):(a.Xk=!1,yr(a,u,l,new qt(Math.ceil(n),Math.ceil(m)),o,v,h,c,q,b),a.Xk=!0,f.context)}Oo.className="AnimationTrigger",Oo.Default=Bo,Oo.Immediate=Io,Oo.Bundled=Ro,(n=Eo.prototype).clear=function(){this.Ca.clear(),this.Yo.length=0},n.Zd=function(a){this.B=a},n.toString=function(a){void 0===a&&(a=0);var b='Layer "'+this.name+'"';if(0>=a)return b;for(var t=0,e=0,n=0,o=0,g=0,r=this.Ca.iterator;r.next();){var h=r.value;h instanceof qu?n++:h instanceof Au?e++:h instanceof Wu?o++:h instanceof Lu?g++:t++}if(r="",0<t&&(r+=t+" Parts "),0<e&&(r+=e+" Nodes "),0<n&&(r+=n+" Groups "),0<o&&(r+=o+" Links "),0<g&&(r+=g+" Adornments "),1<a)for(a=this.Ca.iterator;a.next();)r+="\n    "+(t=a.value).toString(),null!==(e=t.data)&&gt(e)&&(r+=" #"+gt(e)),t instanceof Au?r+=" "+z(e):t instanceof Wu&&(r+=" "+z(t.fromNode)+" "+z(t.toNode));return b+" "+this.Ca.count+": "+r},n.Ub=function(a,b,t){if(void 0===b&&(b=null),void 0===t&&(t=null),!1===this.Bi)return null;var e=!1;null!==this.diagram&&this.diagram.viewportBounds.aa(a)&&(e=!0);for(var n=Mt.alloc(),o=this.Ca.j,g=o.length;g--;){var r=o[g];if((!0!==e||!1!==Su(r))&&r.isVisible()&&(n.assign(a),Ct(n,r.vd),null!==(r=r.Ub(n,b,t))&&(null!==b&&(r=b(r)),null!==r&&(null===t||t(r)))))return Mt.free(n),r}return Mt.free(n),null},n.Ti=function(a,b,t,e){if(void 0===b&&(b=null),void 0===t&&(t=null),e instanceof lt||e instanceof ct||(e=new ct),!1===this.Bi)return e;var n=!1;null!==this.diagram&&this.diagram.viewportBounds.aa(a)&&(n=!0);for(var o=Mt.alloc(),g=this.Ca.j,r=g.length;r--;){var h=g[r];if((!0!==n||!1!==Su(h))&&h.isVisible()){o.assign(a),Ct(o,h.vd);var l=h;h.Ti(o,b,t,e)&&(null!==b&&(l=b(l)),null===l||null!==t&&!t(l)||e.add(l))}}return Mt.free(o),e},n.uf=function(a,b,t,e,n){if(void 0===b&&(b=null),void 0===t&&(t=null),void 0===e&&(e=!1),n instanceof lt||n instanceof ct||(n=new ct),!1===this.Bi)return n;var o=!1;null!==this.diagram&&this.diagram.viewportBounds.Ae(a)&&(o=!0);for(var g=this.Ca.j,r=g.length;r--;){var h=g[r];if((!0!==o||!1!==Su(h))&&h.isVisible()){var l=h;h.uf(a,b,t,e,n)&&(null!==b&&(l=b(l)),null===l||null!==t&&!t(l)||n.add(l))}}return n},n.vv=function(a,b,t,e,n,o,g){if(!1===this.Bi)return n;for(var r=this.Ca.j,h=r.length;h--;){var l=r[h];if((!0!==g||!1!==Su(l))&&o(l)&&l.isVisible()){var c=l;l.uf(a,b,t,e,n)&&(null!==b&&(c=b(c)),null===c||null!==t&&!t(c)||n.add(c))}}return n},n.Ag=function(a,b,t,e,n,o){if(void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof lt||n instanceof ct)&&(o=n),n=!0),o instanceof lt||o instanceof ct||(o=new ct),!1===this.Bi)return o;var g=!1;null!==this.diagram&&this.diagram.viewportBounds.aa(a)&&(g=!0);for(var r=Mt.alloc(),h=Mt.alloc(),l=this.Ca.j,c=l.length;c--;){var f=l[c];if((!0!==g||!1!==Su(f))&&f.isVisible()){r.assign(a),Ct(r,f.vd),h.h(a.x+b,a.y),Ct(h,f.vd);var p=f;f.Ag(r,h,t,e,n,o)&&(null!==t&&(p=t(p)),null===p||null!==e&&!e(p)||o.add(p))}}return Mt.free(r),Mt.free(h),o},n.zd=function(a,b){if(this.visible){var t=void 0===b?a.viewportBounds:b,e=this.Ca.j,n=e.length;a=I(),b=I();for(var o=0;o<n;o++){var g=e[o];g.Xw=o,g instanceof Wu&&!1===g.ld||g instanceof Lu&&null!==g.adornedPart||(ii(g.actualBounds,t)?(g.zd(!0),a.push(g)):(g.zd(!1),null!==g.adornments&&0<g.adornments.count&&b.push(g)))}for(t=0;t<a.length;t++)for(uu(e=a[t]),e=e.adornments;e.next();)(n=e.value).measure(1/0,1/0),n.arrange(),n.zd(!0);for(t=0;t<b.length;t++)(e=b[t]).updateAdornments(),bu(e,!0);R(a),R(b)}},n.bc=function(a,b,t){if(this.visible&&0!==this.qb&&(void 0===t&&(t=!0),t||!this.isTemporary)){var e=(t=this.Ca.j).length;if(0!==e){var n=zo(this,a),o=this.Yo;o.length=0;for(var g=b.scale,r=Wt.alloc(),h=0;h<e;h++)this.Pi(a,t[h],b,o,g,r);Wt.free(r),a.globalAlpha=n}}},n.Pi=function(a,b,t,e,n,o){if(!(null!==e&&b instanceof Wu&&(b.isOrthogonal&&e.push(b),!1===b.ld))){var g=b.actualBounds;e=!1;var r=b.containingGroup;if(null!==r&&r.isClipping&&r.type!==jh.Spot){if(r.locationObject.lm(o),!o.Gc(g))return;e=!o.Ae(g)}e&&(a.save(),a.beginPath(),a.rect(o.x,o.y,o.width,o.height),a.clip()),g.width*n>t.Bo||g.height*n>t.Bo?b.bc(a,t):(n=b.actualBounds,o=b.naturalBounds,0===n.width||0===n.height||isNaN(n.x)||isNaN(n.y)||!b.isVisible()||(t=b.transform,null!==b.areaBackground&&(oa(b,a,b.areaBackground,!0,!0,o,n),a.fillRect(n.x,n.y,n.width,n.height)),null===b.areaBackground&&null===b.background&&(oa(b,a,"rgba(0,0,0,0.3)",!0,!1,o,n),a.fillRect(n.x,n.y,n.width,n.height)),null!==b.background&&(a.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),oa(b,a,b.background,!0,!1,o,n),a.fillRect(0,0,o.width/2,o.height/2),t.ut()||(b=1/(t.m11*t.m22-t.m12*t.m21),a.transform(t.m22*b,-t.m12*b,-t.m21*b,t.m11*b,b*(t.m21*t.dy-t.m22*t.dx),b*(t.m12*t.dx-t.m11*t.dy)))))),e&&(a.restore(),a.sc(!0))}},n.g=function(a,b,t,e,n){var o=this.diagram;null!==o&&o.Ya(De,a,this,b,t,e,n)},n.aj=function(a,b,t){var e=this.Ca;if(b.ui=this,a>=e.count)a=e.count;else if(e.L(a)===b)return-1;return e.Kb(a,b),b.qq(t),null!==(e=this.diagram)&&(t?e.M():e.aj(b)),li(this,a,b),a},n.Fc=function(a,b,t){if(!t&&b.layer!==this&&null!==b.layer)return b.layer.Fc(a,b,t);var e=this.Ca;if(0>a||a>=e.length){if(0>(a=e.indexOf(b)))return-1}else if(e.L(a)!==b&&0>(a=e.indexOf(b)))return-1;return b.rq(t),e.lb(a),null!==(e=this.diagram)&&(t?e.M():e.Fc(b)),b.ui=null,a},v.Object.defineProperties(Eo.prototype,{parts:{get:function(){return this.Ca.iterator}},partsBackwards:{get:function(){return this.Ca.iteratorBackwards}},diagram:{get:function(){return this.B}},name:{get:function(){return this.Qa},set:function(a){var b=this.Qa;if(b!==a){var t=this.diagram;if(null!==t)for(""===b&&N("Cannot rename default Layer to: "+a),t=t.layers;t.next();)t.value.name===a&&N("Layer.name is already present in this diagram: "+a);for(this.Qa=a,this.g("name",b,a),a=this.Ca.iterator;a.next();)a.value.layerName=this.Qa}}},opacity:{get:function(){return this.qb},set:function(a){var b=this.qb;b!==a&&((0>a||1<a)&&T(a,"0 <= value <= 1",Eo,"opacity"),this.qb=a,this.g("opacity",b,a),null!==(a=this.diagram)&&a.M())}},isTemporary:{get:function(){return this.v},set:function(a){var b=this.v;b!==a&&(this.v=a,this.g("isTemporary",b,a))}},visible:{get:function(){return this.I},set:function(a){var b=this.I;if(b!==a){for(this.I=a,this.g("visible",b,a),b=this.Ca.iterator;b.next();)b.value.Ob(a);null!==(a=this.diagram)&&a.M()}}},pickable:{get:function(){return this.Bi},set:function(a){var b=this.Bi;b!==a&&(this.Bi=a,this.g("pickable",b,a))}},isBoundsIncluded:{get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a,null!==this.diagram&&this.diagram.Na())}},allowCopy:{get:function(){return this.Rh},set:function(a){var b=this.Rh;b!==a&&(this.Rh=a,this.g("allowCopy",b,a))}},allowDelete:{get:function(){return this.Sh},set:function(a){var b=this.Sh;b!==a&&(this.Sh=a,this.g("allowDelete",b,a))}},allowTextEdit:{get:function(){return this.ai},set:function(a){var b=this.ai;b!==a&&(this.ai=a,this.g("allowTextEdit",b,a))}},allowGroup:{get:function(){return this.Th},set:function(a){var b=this.Th;b!==a&&(this.Th=a,this.g("allowGroup",b,a))}},allowUngroup:{get:function(){return this.bi},set:function(a){var b=this.bi;b!==a&&(this.bi=a,this.g("allowUngroup",b,a))}},allowLink:{get:function(){return this.Uh},set:function(a){var b=this.Uh;b!==a&&(this.Uh=a,this.g("allowLink",b,a))}},allowRelink:{get:function(){return this.Wh},set:function(a){var b=this.Wh;b!==a&&(this.Wh=a,this.g("allowRelink",b,a))}},allowMove:{get:function(){return this.Vh},set:function(a){var b=this.Vh;b!==a&&(this.Vh=a,this.g("allowMove",b,a))}},allowReshape:{get:function(){return this.Xh},set:function(a){var b=this.Xh;b!==a&&(this.Xh=a,this.g("allowReshape",b,a))}},allowResize:{get:function(){return this.Yh},set:function(a){var b=this.Yh;b!==a&&(this.Yh=a,this.g("allowResize",b,a))}},allowRotate:{get:function(){return this.Zh},set:function(a){var b=this.Zh;b!==a&&(this.Zh=a,this.g("allowRotate",b,a))}},allowSelect:{get:function(){return this.$h},set:function(a){var b=this.$h;b!==a&&(this.$h=a,this.g("allowSelect",b,a))}}}),Eo.prototype.findObjectsNear=Eo.prototype.Ag,Eo.prototype.findObjectsIn=Eo.prototype.uf,Eo.prototype.findObjectsAt=Eo.prototype.Ti,Eo.prototype.findObjectAt=Eo.prototype.Ub,Eo.className="Layer",Vo.prototype.clear=function(){this.animationManager.Xc(),this.model.clear(),ms=null,vs="",Yo(this,!1),this.Na(),Yr(this),this.M()},Vo.prototype.reset=function(){this.clear(),this.Rb=!0,this.Jc=new lo,this.Jc.Zd(this),this.jb=17,this.nl=this.Qu=!1,this.zs="default",this.Ja=new lt,this.jx=new kt,this.cf=null,this.bw(),this.vj=null,this.aw(),this.qb=1,this.ma=new Mt(NaN,NaN).freeze(),this.Ou=new Mt(NaN,NaN),this.yn=this.ya=1,this.Kr=new Mt(NaN,NaN).freeze(),this.Lr=NaN,this.ds=1e-4,this.bs=100,this.kb=new ie,this.$s=new Mt(NaN,NaN).freeze(),this.Fr=new Wt(NaN,NaN,NaN,NaN).freeze(),this.Fi=new hi(0,0,0,0).freeze(),this.Gi=Ts,this.Hs=!1,this.As=this.vs=null,this.Lg=xs,this.lj=zi,this.Xf=xs,this.Xn=zi,this.Mr=this.Jr=gi,this.Ac=!0,this.ll=!1,this.od=new ct,this.Sg=new kt,this.Xk=!0,this.Zm=250,this.jj=-1,this.an=new hi(16,16,16,16).freeze(),this.pj=this.xe=!1,this.sj=!0,this.Uf=new Te,this.Uf.diagram=this,this.Qd=new Te,this.Qd.diagram=this,this.dh=new Te,this.dh.diagram=this,this.pe=this.Mf=null,this.Pj=!1,this.vr=this.wr=null,this.Vm=w.PointerEvent&&(K||H||W)&&w.navigator&&!1!==w.navigator.msPointerEnabled,Kr(this),this.zh=new ct,this.Ur=!0,this.Vs=As,this.vu=!1,this.Xs=ks,this.pr=this.sr=this.Ts=null,this.xn=this.mr="auto",this.fg=this.gs=this.hg=this.ig=this.kg=this.Of=this.Sf=this.Nf=null,this.Ir=!1,this.Pf=this.ug=this.jg=this.gg=null,this.hs=!1,this.ts={},this.Kj=[null,null],this.gr=null,this.tr=this.Ls=this.Su=this.sg=!1,this.zu=!0,this.ni=this.Bc=!1,this.av=!0,this.Hd=-2,this.Ci=new kt,this.ss=new lt,this.Zf=!1,this.Sh=this.Rh=this.Uq=this.Mc=!0,this.Vq=!1,this.ar=this.Zq=this.$h=this.Zh=this.Yh=this.Xh=this.Vh=this.Wh=this.Uh=this.Yq=this.bi=this.Th=this.ai=this.Wq=!0,this.Yf=this.xu=!1,this.$q=this.Xq=this.dl=this.cl=!0,this.Gs=this.Cs=16,this.Bs=this.vp=!1,this.Ds=this.Fs=0,this.bb=new hi(5).freeze(),this.Ru=(new ct).freeze(),this.cs=999999999,this.su=(new ct).freeze(),this.mi=this.li=this.ki=!0,this.Te=this.ie=!1,this.ic=null,this.If=!0,this.je=!1,this.Yw=new ct,this.tu=new ct,this.Gb=null,this.Cl=1,this.Tu=0,this.Sd={scale:1,position:new Mt,bounds:new Wt,Kv:!1},this.$u=new Wt(NaN,NaN,NaN,NaN).freeze(),this.Zl=new qt(NaN,NaN).freeze(),this.zn=new Wt(NaN,NaN,NaN,NaN).freeze(),this.Vr=!1,this.qo=this.Vn=this.Ro=this.gu=this.fu=this.hu=this.ag=this.ah=this.Ze=null,Xo(this),this.Fb=null,this.Un=!1,this.mj=null,this.partManager=new vf,this.toolManager=new ze,this.toolManager.initializeStandardTools(),this.currentTool=this.defaultTool=this.toolManager,this.yr=null,this.Qk=new Xs,this.ns=this.ms=null,this.Op=!1,this.commandHandler=Go(),this.sg=!0,Ho(this),this.layout=new Zc,this.sg=!1,this.model=nd(),this.model.undoManager=new Ie,this.je=!1,this.sj=!0,this.xe=!1,this.Sb=1,this.uh=null,this.Bo=1,this.Io=0,this.Jo=[0,0,0,0,0],this.Ko=0,this.pd=1,this.Aj=0,this.lo=new Mt,this.Us=500,this.$m=new Mt,this.ke=!1,this.nh=this.Gl=this.mh=this.Fl=null,this.Pp=this.$n=!1,this.In=null,this.Jn=Bt,this.Rb=!1,this.M()},Vo.prototype.setRTL=function(a){null===(a=void 0===a?this.div:a)&&(a=w.document.body);var b=P("div");b.dir="rtl",b.style.cssText="font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll;",b.textContent="A",a.appendChild(b);var t="reverse";0<b.scrollLeft?t="default":(b.scrollLeft=1,0===b.scrollLeft&&(t="negative")),a.removeChild(b),this.zs=t},Vo.prototype.setScrollWidth=function(a){null===(a=void 0===a?this.div:a)&&(a=w.document.body);var b=0;if(ys){var t=gs;b=ps,null===t&&((t=gs=P("p")).style.width="100%",t.style.height="200px",t.style.boxSizing="content-box",(b=ps=P("div")).style.position="absolute",b.style.visibility="hidden",b.style.width="200px",b.style.height="150px",b.style.boxSizing="content-box",b.appendChild(t)),b.style.overflow="hidden",a.appendChild(b);var e=t.offsetWidth;b.style.overflow="scroll",e===(t=t.offsetWidth)&&(t=b.clientWidth),a.removeChild(b),0!==(b=e-t)||Z||(b=11)}this.jb=b,this.Qu=!0},Vo.prototype.cb=function(a){a.classType===Vo&&(this.autoScale=a)},Vo.prototype.toString=function(a){void 0===a&&(a=0);var b="";if(this.div&&this.div.id&&(b=this.div.id),b='Diagram "'+b+'"',0>=a)return b;for(var t=this.Ja.iterator;t.next();)b+="\n  "+t.value.toString(a-1);return b},Vo.prototype.addEventListener=function(a,b,t,e){a.addEventListener(b,t,e)},Vo.prototype.removeEventListener=function(a,b,t,e){a.removeEventListener(b,t,e)},Vo.prototype.computePixelRatio=function(){return null!==this.uh?this.uh:w.devicePixelRatio||1},Vo.prototype.doMouseMove=function(){this.currentTool.doMouseMove()},Vo.prototype.doMouseDown=function(){this.currentTool.doMouseDown()},Vo.prototype.doMouseUp=function(){this.currentTool.doMouseUp()},Vo.prototype.doMouseWheel=function(){this.currentTool.doMouseWheel()},Vo.prototype.doKeyDown=function(){this.currentTool.doKeyDown()},Vo.prototype.doKeyUp=function(){this.currentTool.doKeyUp()},Vo.prototype.doFocus=function(){this.focus()},Vo.prototype.focus=function(){if(this.sa)if(this.scrollsPageOnFocus)this.sa.focus();else{var a=w.scrollX||w.pageXOffset,b=w.scrollY||w.pageYOffset;this.sa.focus(),w.scrollTo(a,b)}},Vo.prototype.Sy=function(){this.B.R("GainedFocus")},Vo.prototype.Ry=function(){this.B.R("LostFocus")},Vo.prototype.Ex=function(a){if(null!==this.sa){this.vp=!0;var b=this.documentBounds,t=this.viewportBounds,e=this.Fi,n=b.x-e.left,o=b.y-e.top,g=b.width+e.left+e.right,r=b.height+e.top+e.bottom,h=b.right+e.right;e=b.bottom+e.bottom;var l=t.x;b=t.y;var c=t.width,f=t.height,p=t.right,d=t.bottom;t=this.scale;var q=a.scrollLeft;if(this.nl)switch(this.zs){case"negative":q=q+a.scrollWidth-a.clientWidth;break;case"reverse":q=a.scrollWidth-q-a.clientWidth}var u=q;c<g||f<r?(q=Mt.allocAt(this.position.x,this.position.y),this.allowHorizontalScroll&&this.Ds!==u&&(q.x=u/t+n,this.Ds=u),this.allowVerticalScroll&&this.Fs!==a.scrollTop&&(q.y=a.scrollTop/t+o,this.Fs=a.scrollTop),this.position=q,Mt.free(q),this.li=this.vp=!1):(q=Mt.alloc(),a.Ay&&this.allowHorizontalScroll&&(n<l&&(this.position=q.h(u+n,this.position.y)),h>p&&(this.position=q.h(-(this.Es.scrollWidth-this.wa)+u-this.wa/t+h,this.position.y))),a.By&&this.allowVerticalScroll&&(o<b&&(this.position=q.h(this.position.x,a.scrollTop+o)),e>d&&(this.position=q.h(this.position.x,-(this.Es.scrollHeight-this.va)+a.scrollTop-this.va/t+e))),Mt.free(q),wr(this),this.li=this.vp=!1,b=this.documentBounds,t=this.viewportBounds,h=b.right,p=t.right,e=b.bottom,d=t.bottom,n=b.x,l=t.x,o=b.y,b=t.y,c>=g&&n>=l&&h<=p&&(this.wp.style.width="1px"),f>=r&&o>=b&&e<=d&&(this.wp.style.height="1px"))}},Vo.prototype.computeBounds=function(){return 0<this.od.count&&pr(this),$o(this)},Vo.prototype.computePartsBounds=function(a,b){void 0===b&&(b=!1);var t=null;if(D(a))for(var e=0;e<a.length;e++){var n=a[e];!b&&n instanceof Wu||(n.yb(),null===t?t=n.actualBounds.copy():t.Hc(n.actualBounds))}else for(a=a.iterator;a.next();)e=a.value,!b&&e instanceof Wu||(e.yb(),null===t?t=e.actualBounds.copy():t.Hc(e.actualBounds));return null===t?new Wt(NaN,NaN,0,0):t},Vo.prototype.zoomToFit=function(){var a=this.Gi;this.Gi=Ts,this.scale=_o(this,bs),a!==Ts&&(Qo(this,!1),ir(this,this.documentBounds,this.wa/this.ya,this.va/this.ya,this.lj,!1)),this.Gi=a},(n=Vo.prototype).EA=function(a,b){void 0===b&&(b=bs);var t=a.width,e=a.height;if(!(0===t||0===e||isNaN(t)&&isNaN(e))){var n=1;if(b===bs||b===ws)if(isNaN(t))n=this.viewportBounds.height*this.scale/e;else if(isNaN(e))n=this.viewportBounds.width*this.scale/t;else{n=this.wa;var o=this.va;n=b===ws?o/e>n/t?(o-(this.ie?this.jb:0))/e:(n-(this.Te?this.jb:0))/t:Math.min(o/e,n/t)}this.scale=n,this.position=new Mt(a.x,a.y)}},n.My=function(a,b){Yr(this);var t=this.documentBounds,e=this.viewportBounds;this.position=new Mt(t.x+(a.x*t.width+a.offsetX)-(b.x*e.width-b.offsetX),t.y+(a.y*t.height+a.offsetY)-(b.y*e.height-b.offsetY))},n.Az=function(a){if(a instanceof _s){this.In=a;var b=Mt.alloc();this.Jn=this.Nq(a.ga(gi,b)),Mt.free(b)}else this.In=null,this.Jn=Bt},n.jm=function(a,b){if(void 0===b&&(b=!0),b){if((a=er(this,a,(function(a){return a.part}),(function(a){return a.canSelect()})))instanceof lu)return a}else if((a=er(this,a,(function(a){return a.part})))instanceof lu)return a;return null},n.Ub=function(a,b,t){void 0===b&&(b=null),void 0===t&&(t=null),pr(this);for(var e=this.Ja.iteratorBackwards;e.next();){var n=e.value;if(n.visible&&null!==(n=n.Ub(a,b,t)))return n}return null},n.nz=function(a,b,t){return void 0===b&&(b=!0),function(a,b,t,e,n){for(void 0===t&&(t=null),void 0===e&&(e=null),n instanceof lt||n instanceof ct||(n=new ct),pr(a),a=a.Ja.iteratorBackwards;a.next();){var o=a.value;o.visible&&!o.isTemporary&&o.Ti(b,t,e,n)}return n}(this,a,(function(a){return a.part}),b?function(a){return a instanceof lu&&a.canSelect()}:null,t)},n.Ti=function(a,b,t,e){void 0===b&&(b=null),void 0===t&&(t=null),e instanceof lt||e instanceof ct||(e=new ct),pr(this);for(var n=this.Ja.iteratorBackwards;n.next();){var o=n.value;o.visible&&o.Ti(a,b,t,e)}return e},n.Mx=function(a,b,t,e){return void 0===b&&(b=!1),void 0===t&&(t=!0),function(a,b,t,e,n){var o=null;for(void 0===o&&(o=null),void 0===t&&(t=null),void 0===e&&(e=!1),n instanceof lt||n instanceof ct||(n=new ct),pr(a),a=a.Ja.iteratorBackwards;a.next();){var g=a.value;g.visible&&!g.isTemporary&&g.uf(b,o,t,e,n)}return n}(this,a,(function(a){return a instanceof lu&&(!t||a.canSelect())}),b,e)},n.uf=function(a,b,t,e,n){void 0===b&&(b=null),void 0===t&&(t=null),void 0===e&&(e=!1),n instanceof lt||n instanceof ct||(n=new ct),pr(this);for(var o=this.Ja.iteratorBackwards;o.next();){var g=o.value;g.visible&&g.uf(a,b,t,e,n)}return n},n.vv=function(a,b,t,e,n,o){var g=new ct;pr(this);for(var r=this.Ja.iteratorBackwards;r.next();){var h=r.value;h.visible&&h.vv(a,b,t,e,g,n,o)}return g},n.oz=function(a,b,t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),function(a,b,t,e,n,o){var g=null;void 0===g&&(g=null),void 0===e&&(e=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof lt||n instanceof ct)&&(o=n),n=!0);for(o instanceof lt||o instanceof ct||(o=new ct),pr(a),a=a.Ja.iteratorBackwards;a.next();){var r=a.value;r.visible&&!r.isTemporary&&r.Ag(b,t,g,e,n,o)}return o}(this,a,b,(function(a){return a instanceof lu&&(!e||a.canSelect())}),t,n)},n.Ag=function(a,b,t,e,n,o){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof lt||n instanceof ct)&&(o=n),n=!0),o instanceof lt||o instanceof ct||(o=new ct),pr(this);for(var g=this.Ja.iteratorBackwards;g.next();){var r=g.value;r.visible&&r.Ag(a,b,t,e,n,o)}return o},Vo.prototype.acceptEvent=function(a){return nr(this,a,a instanceof MouseEvent)},Vo.prototype.Xz=function(a){var b=this.B;if(!this.B.isEnabled)return!1;var t=nr(b,a,!1);switch(t.key=String.fromCharCode(a.which),t.down=!0,a.which){case 8:t.key="Backspace";break;case 33:t.key="PageUp";break;case 34:t.key="PageDown";break;case 35:t.key="End";break;case 36:t.key="Home";break;case 37:t.key="Left";break;case 38:t.key="Up";break;case 39:t.key="Right";break;case 40:t.key="Down";break;case 45:t.key="Insert";break;case 46:t.key="Del";break;case 48:t.key="0";break;case 187:case 61:case 107:t.key="Add";break;case 189:case 173:case 109:t.key="Subtract";break;case 27:t.key="Esc"}return b.doKeyDown(),lr(t,a)},Vo.prototype.Yz=function(a){var b=this.B;if(!b.isEnabled)return!1;var t=nr(b,a,!1);switch(t.key=String.fromCharCode(a.which),t.up=!0,a.which){case 8:t.key="Backspace";break;case 33:t.key="PageUp";break;case 34:t.key="PageDown";break;case 35:t.key="End";break;case 36:t.key="Home";break;case 37:t.key="Left";break;case 38:t.key="Up";break;case 39:t.key="Right";break;case 40:t.key="Down";break;case 45:t.key="Insert";break;case 46:t.key="Del"}return b.doKeyUp(),lr(t,a)},Vo.prototype.dz=function(a){var b=this.B;if(!b.isEnabled)return!1;var t=nr(b,a,!0);return null!==b.mouseEnter&&b.mouseEnter(t),lr(t,a)},Vo.prototype.ez=function(a){var b=this.B;if(!b.isEnabled)return!1;var t=nr(b,a,!0);return null!==b.mouseLeave&&b.mouseLeave(t),lr(t,a)},Vo.prototype.getMouse=function(a){var b=this.sa;if(null===b)return new Mt(0,0);var t=b.getBoundingClientRect();return b=a.clientX-this.wa/t.width*t.left,a=a.clientY-this.va/t.height*t.top,null!==this.kb?Ct(new Mt(b,a),this.kb):new Mt(b,a)},(n=Vo.prototype).Na=function(){this.ki||(this.ki=!0,this.Pb(!0))},n.Fe=function(){this.Rb||this.Bc||(this.M(),xr(this),wr(this),this.Na(),this.Wc())},n.Wz=function(){return this.xe},n.Zy=function(a){void 0===a&&(a=null);var b=this.animationManager,t=b.isEnabled;b.Xc(),b.isEnabled=!1,dr(this),this.je=!1,b.isEnabled=t,null!==a&&S((function(){uo(b,"Model"),a()}),1)},n.Pb=function(a){if(void 0===a&&(a=!1),!0!==this.xe&&!(this.Rb||!1===a&&this.Bc)){this.xe=!0;var b=this;w.requestAnimationFrame((function(){b.xe&&b.Wc()}))}},n.Wc=function(){this.sj&&!this.xe||(this.sj&&(this.sj=!1),dr(this))},n.uw=function(a,b){for(a.reset();a.next();){var t=a.value;!t.Wb()||t instanceof qu||(t.bj()?(t.measure(1/0,1/0),t.arrange()):b.add(t))}for(a.reset();a.next();)(t=a.value)instanceof qu&&t.isVisible()&&gr(this,t);for(a.reset();a.next();)(t=a.value)instanceof Wu&&t.isVisible()&&(t.bj()?(t.measure(1/0,1/0),t.arrange()):b.add(t));for(a.reset();a.next();)(t=a.value)instanceof Lu&&t.isVisible()&&(t.bj()?(t.measure(1/0,1/0),t.arrange()):b.add(t))},n.zd=function(a,b,t,e){if(this.mi||this.animationManager.isAnimating)for(var n=0;n<b;n++)a[n].zd(t,e)},n.bc=function(a,b){if(void 0===b&&(b=null),null!==this.La){null===this.sa&&N("No canvas specified");var t=this.animationManager;if(!t.qc&&(!t.isAnimating||t.isTicking)){var e=new Date;if(kr(this),"0"!==this.La.style.opacity){var n=a!==this.Db,o=this.Ja.j,g=o.length,r=this;if(this.zd(o,g,r),n)a.sc(!0),wr(this);else if(!this.Ac&&null===b&&!t.isAnimating)return;g=this.ma;var h=this.ya,l=Math.round(g.x*h)/h,c=Math.round(g.y*h)/h;for((t=this.kb).reset(),1!==h&&t.scale(h),0===g.x&&0===g.y||t.translate(-l,-c),h=this.Sb,a.setTransform(1,0,0,1,0,0),a.scale(h,h),a.clearRect(0,0,this.wa,this.va),a.setTransform(1,0,0,1,0,0),a.scale(h,h),a.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),mr(this,a),a.globalAlpha=this.qb,l=null!==b?function(t){var e=b;if(t.visible&&0!==t.qb){var n=t.Ca.j,o=n.length;if(0!==o){var g=zo(t,a),h=t.Yo;h.length=0;for(var l=r.scale,c=Wt.alloc(),f=0;f<o;f++){var d=n[f];e.contains(d)||t.Pi(a,d,r,h,l,c)}Wt.free(c),a.globalAlpha=g}}}:function(b){b.bc(a,r)},g=o.length,c=0;c<g;c++)a.setTransform(1,0,0,1,0,0),a.scale(h,h),a.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),l(o[c]);if(this.ji&&zs(this.ji,this)&&this.zr(),n?(this.Db.sc(!0),wr(this)):this.Ac=this.mi=!1,n=+new Date-+e,null===this.uh){for((e=this.Jo)[this.Ko]=n,this.Ko=(this.Ko+1)%e.length,o=n=0;o<this.Jo.length;o++)n+=this.Jo[o];this.Io=n/e.length}}}}},n.Ce=function(a){return this.cf[a]},n.ly=function(a,b){"minDrawingLength"===a&&(this.Bo=b),this.cf[a]=b,this.Fe()},n.bw=function(){this.cf=new et,this.cf.drawShadows=!0,this.cf.textGreeking=!0,this.cf.viewportOptimizations=!(Z||K||H),this.cf.temporaryPixelRatio=!0,this.cf.pictureRatioOptimization=!0,this.Bo=this.cf.minDrawingLength=1},n.mm=function(a){return this.vj[a]},n.tA=function(a,b){this.vj[a]=b},n.aw=function(){this.vj=new et,this.vj.extraTouchArea=10,this.vj.extraTouchThreshold=10,this.vj.hasGestureZoom=!0},n.iw=function(a){vr(this,a)},n.hv=function(){if(0===this.undoManager.transactionLevel&&0!==this.Sg.count){for(;0<this.Sg.count;){var a=this.Sg;for(this.Sg=new kt,a=a.iterator;a.next();){var b=a.key;b.tq(a.value),b.cc()}}this.M()}},n.M=function(a){if(void 0===a&&(a=null),null===a)this.Ac=!0,this.Pb();else{var b=this.viewportBounds;null!==a&&a.u()&&b.Gc(a)&&(this.Ac=!0,this.Pb())}this.R("InvalidateDraw")},n.Sx=function(a,b){if(!0!==this.Ac){this.Ac=!0;var t=!0===this.Ce("temporaryPixelRatio");if(!0===this.Ce("viewportOptimizations")&&this.scrollMode!==Ls&&this.Fi.Ri(0,0,0,0)&&b.width===a.width&&b.height===a.height){var e=this.scale,n=Math.max(a.x,b.x),o=Math.max(a.y,b.y);if(e=Wt.allocAt(n,o,Math.max(0,Math.min(a.x+a.width,b.x+b.width)-n)*e,Math.max(0,Math.min(a.y+a.height,b.y+b.height)-o)*e),!this.Pp&&0<e.width&&0<e.height){if(!(this.Bc||(this.xe=!1,null===this.La||(this.Bc=!0,this.hv(),this.documentBounds.u()||Vr(this,this.computeBounds()),n=this.sa,null===n||n instanceof ja)))){var g=this.Sb;o=this.wa*g;var r=this.va*g,h=this.scale*g,l=Math.round(Math.round(b.x*h)-Math.round(a.x*h));b=Math.round(Math.round(b.y*h)-Math.round(a.y*h)),h=this.ku,a=this.Rw,h.width!==o&&(h.width=o),h.height!==r&&(h.height=r),a.clearRect(0,0,o,r),h=190*g;var c=70*g,f=Math.max(l,0),p=Math.max(b,0),d=Math.floor(o-f),q=Math.floor(r-p);a.drawImage(n.Ea,f,p,d,q,0,0,d,q),zs(this.ji,this)&&a.clearRect(0,0,h,c),n=I(),a=I(),q=Math.abs(l),d=Math.abs(b);var u=0===f?0:o-q;f=Mt.allocAt(u,0),q=Mt.allocAt(q+u,r),a.push(new Wt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y)));var y=this.kb;if(y.reset(),y.scale(g,g),1!==this.ya&&y.scale(this.ya),(0!==(g=this.ma).x||0!==g.y)&&isFinite(g.x)&&isFinite(g.y)&&y.translate(-g.x,-g.y),Ct(f,y),Ct(q,y),n.push(new Wt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y))),u=0===p?0:r-d,f.h(0,u),q.h(o,d+u),a.push(new Wt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y))),Ct(f,y),Ct(q,y),n.push(new Wt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y))),zs(this.ji,this)&&(o=0<l?0:-l,r=0<b?0:-b,f.h(o,r),q.h(h+o,c+r),a.push(new Wt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y))),Ct(f,y),Ct(q,y),n.push(new Wt(Math.min(f.x,q.x),Math.min(f.y,q.y),Math.abs(f.x-q.x),Math.abs(f.y-q.y)))),Mt.free(f),Mt.free(q),fr(this,!1,!0),null===this.La&&N("No div specified"),null===this.sa&&N("No canvas specified"),!this.animationManager.qc&&(o=this.Db,this.Ac)){for(kr(this),r=this.Sb,o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,this.wa*r,this.va*r),o.drawImage(this.ku.Ea,0<l?0:Math.round(-l),0<b?0:Math.round(-b)),l=this.ma,g=this.ya,h=Math.round(l.x*g)/g,c=Math.round(l.y*g)/g,(b=this.kb).reset(),1!==g&&b.scale(g),0===l.x&&0===l.y||b.translate(-h,-c),o.save(),o.beginPath(),l=a.length,g=0;g<l;g++)0!==(h=a[g]).width&&0!==h.height&&o.rect(Math.floor(h.x),Math.floor(h.y),Math.ceil(h.width),Math.ceil(h.height));for(o.clip(),o.setTransform(1,0,0,1,0,0),o.scale(r,r),o.transform(b.m11,b.m12,b.m21,b.m22,b.dx,b.dy),l=(b=this.Ja.j).length,this.zd(b,l,this),mr(this,o),o.globalAlpha=this.qb,r=0;r<l;r++)if(h=n,(g=b[r]).visible&&0!==g.qb){c=zo(g,o),(p=g.Yo).length=0,f=this.scale,d=Wt.alloc(),y=(q=g.Ca.j).length,u=h.length;for(var m=0;m<y;m++){var v=q[m],x=du(v,v.actualBounds);t:{for(var w=2/f,k=4/f,M=0;M<u;M++){var S=h[M];if(0!==S.width&&0!==S.height&&x.Fv(S.x-w,S.y-w,S.width+k,S.height+k)){x=!0;break t}}x=!1}x&&g.Pi(o,v,this,p,f,d)}Wt.free(d),o.globalAlpha=c}o.restore(),o.sc(!0),this.ji&&zs(this.ji,this)&&this.zr(),this.Ac=this.mi=!1,this.Ht()}R(n),R(a),this.Bc=!1}}else this.Wc();Wt.free(e),t&&(qo(this),this.Wc(),Uo(this,!0))}else t?(qo(this),this.Wc(),Uo(this,!0)):this.Wc()}},n.add=function(a){var b=a.diagram;if(b!==this&&(null!==b&&N("Cannot add part "+a.toString()+" to "+this.toString()+". It is already a part of "+b.toString()),null===(b=this.im(a.layerName))&&(b=this.im("")),null===b&&N('Cannot add a Part when unable find a Layer named "'+a.layerName+'" and there is no default Layer'),a.layer!==b)){var t=b.aj(99999999,a,a.diagram===this);0<=t&&this.Ya(Fe,"parts",b,null,a,null,t),b.isTemporary||this.Na(),a.C(1),null!==(t=a.layerChanged)&&t(a,null,b)}},n.aj=function(a){this.partManager.aj(a);var b=this;Rh(a,(function(a){Rr(b,a)})),(a instanceof Lu||a instanceof qu&&null!==a.placeholder)&&a.o(),null!==a.data&&Rh(a,(function(a){Mf(b.partManager,a)})),!0!==va(a)&&!0!==wu(a)||this.od.add(a),vu(a,!0,this),Nu(a)?(a.actualBounds.u()&&this.M(du(a,a.actualBounds)),this.Na()):a.isVisible()&&a.actualBounds.u()&&this.M(du(a,a.actualBounds)),this.Pb()},n.Fc=function(a){a.Yj(),this.partManager.Fc(a);var b=this;null!==a.data&&Rh(a,(function(a){Sf(b.partManager,a,b)})),this.od.remove(a),Nu(a)?(a.actualBounds.u()&&this.M(du(a,a.actualBounds)),this.Na()):a.isVisible()&&a.actualBounds.u()&&this.M(du(a,a.actualBounds)),this.Pb()},n.remove=function(a){Pr(this,a,!0)},n.Jt=function(a,b){if(D(a))for(var t=a.length,e=0;e<t;e++){var n=a[e];b&&!n.canDelete()||this.remove(n)}else for((t=new ct).addAll(a),a=t.iterator;a.next();)t=a.value,b&&!t.canDelete()||this.remove(t)},n.ck=function(a,b,t){return this.partManager.ck(a,b,t)},Vo.prototype.moveParts=function(a,b,t,e){if(void 0===e&&(e=Tr(this)),null!==this.toolManager){var n=new kt;if(null!==a)if(D(a))for(var o=0;o<a.length;o++)Nr(this,n,a[o],t,e);else for(a=a.iterator;a.next();)Nr(this,n,a.value,t,e);else{for(a=this.parts;a.next();)Nr(this,n,a.value,t,e);for(a=this.nodes;a.next();)Nr(this,n,a.value,t,e);for(a=this.links;a.next();)Nr(this,n,a.value,t,e)}Cr(this,n,b,e,t)}},Vo.prototype.computeMove=function(a,b,t,e){if(void 0===e&&(e=new Mt),e.assign(b),null===a)return e;var n=b,o=t.isGridSnapEnabled;o&&(t.isGridSnapRealtime||this.lastInput.up)&&Lr(this,a,b,n=Mt.alloc(),t),t=null!==a.dragComputation?a.dragComputation(a,b,n):n;var g=a.minLocation,r=g.x;isNaN(r)&&(r=o?Math.round(a.location.x):a.location.x),g=g.y,isNaN(g)&&(g=o?Math.round(a.location.y):a.location.y);var h=a.maxLocation,l=h.x;return isNaN(l)&&(l=o?Math.round(a.location.x):a.location.x),h=h.y,isNaN(h)&&(h=o?Math.round(a.location.y):a.location.y),e.h(Math.max(r,Math.min(t.x,l)),Math.max(g,Math.min(t.y,h))),n!==b&&Mt.free(n),e},(n=Vo.prototype).td=function(a,b,t){if(void 0===t)return new Ys(jt);var e=a.isGridSnapEnabled;return a.Nz||null===b.containingGroup||(e=!1),new Ys(e?new Mt(Math.round(t.x),Math.round(t.y)):t.copy())},n.$l=function(a){Fr(this,a,null),a.Zd(this);var b=this.Ja,t=b.count-1;if(!a.isTemporary)for(;0<=t&&b.L(t).isTemporary;)t--;b.Kb(t+1,a),null!==this.ac&&this.Ya(Fe,"layers",this,null,a,null,t+1),this.M(),this.Na()},n.tx=function(a,b){Fr(this,a,b),a.Zd(this);var t=this.Ja,e=t.indexOf(a);0<=e&&(t.remove(a),null!==this.ac&&this.Ya(Oe,"layers",this,a,null,e,null));var n,o=t.count;for(n=0;n<o;n++)if(t.L(n)===b){t.Kb(n,a);break}null!==this.ac&&this.Ya(Fe,"layers",this,null,a,null,n),this.M(),0>e&&this.Na()},n.Gy=function(a,b){Fr(this,a,b),a.Zd(this);var t=this.Ja,e=t.indexOf(a);0<=e&&(t.remove(a),null!==this.ac&&this.Ya(Oe,"layers",this,a,null,e,null));var n,o=t.count;for(n=0;n<o;n++)if(t.L(n)===b){t.Kb(n+1,a);break}null!==this.ac&&this.Ya(Fe,"layers",this,null,a,null,n+1),this.M(),0>e&&this.Na()},n.mA=function(a){if(a.diagram!==this&&N("Cannot remove a Layer from another Diagram: "+a+" of "+a.diagram),""!==a.name){var b=this.Ja,t=b.indexOf(a);if(b.remove(a)){for(b=a.Ca.copy().iterator;b.next();){var e=b.value,n=e.layerName;n!==a.name?e.layerName=n:e.layerName=""}null!==this.ac&&this.Ya(Oe,"layers",this,a,null,t,null),this.M(),this.Na()}}},n.im=function(a){for(var b=this.layers;b.next();){var t=b.value;if(t.name===a)return t}return null},n.vx=function(a){null===this.pe&&(this.pe=new lt),this.pe.add(a),this.model.Dh(a)},n.oA=function(a){null!==this.pe&&(this.pe.remove(a),0===this.pe.count&&(this.pe=null)),this.model.wk(a)},n.Dh=function(a){null===this.Mf&&(this.Mf=new lt),this.Mf.add(a)},n.wk=function(a){null!==this.Mf&&(this.Mf.remove(a),0===this.Mf.count&&(this.Mf=null))},n.bt=function(a){if(this.skipsUndoManager||this.model.skipsUndoManager||this.model.undoManager.Dv(a),a.change!==je&&(this.isModified=!0),null!==this.Mf)for(var b=this.Mf,t=b.length,e=0;e<t;e++)b.L(e)(a)},n.Ya=function(a,b,t,e,n,o,g){void 0===o&&(o=null),void 0===g&&(g=null);var r=new Ae;r.diagram=this,r.change=a,r.propertyName=b,r.object=t,r.oldValue=e,r.oldParam=o,r.newValue=n,r.newParam=g,this.bt(r)},n.g=function(a,b,t,e,n){this.Ya(De,a,this,b,t,e,n)},Vo.prototype.changeState=function(a,b){if(null!==a&&a.diagram===this){var t=this.skipsModelSourceBindings;try{this.skipsModelSourceBindings=!0;var e=a.change;if(e===De){var n=a.object;if(ad(n,a.propertyName,a.H(b)),n instanceof _s){var o=n.part;null!==o&&o.Lb()}this.isModified=!0}else if(e===Fe){var g=a.object,r=a.newParam,h=a.newValue;if(g instanceof jh){if("number"==typeof r&&h instanceof _s){b?g.Fc(r):g.Kb(r,h);var l=g.part;null!==l&&l.Lb()}else if("number"==typeof r&&h instanceof _h)if(b)h.isRow?g.Zv(r):g.Xv(r);else{var c=h.isRow?g.getRowDefinition(h.index):g.getColumnDefinition(h.index);c.et(h)}}else if(g instanceof Eo){var f=!0===a.oldParam;"number"==typeof r&&h instanceof lu&&(b?(h.isSelected=!1,h.isHighlighted=!1,h.Lb(),g.Fc(f?r:-1,h,f)):g.aj(r,h,f))}else g instanceof Vo?"number"==typeof r&&h instanceof Eo&&(b?this.Ja.lb(r):(h.Zd(this),this.Ja.Kb(r,h))):N("unknown ChangedEvent.Insert object: "+a.toString());this.isModified=!0}else if(e===Oe){var p=a.object,d=a.oldParam,q=a.oldValue;if(p instanceof jh)"number"==typeof d&&q instanceof _s?b?p.Kb(d,q):p.Fc(d):"number"==typeof d&&q instanceof _h&&(b?(c=q.isRow?p.getRowDefinition(q.index):p.getColumnDefinition(q.index)).et(q):q.isRow?p.Zv(d):p.Xv(d));else if(p instanceof Eo){var u=!0===a.newParam;"number"==typeof d&&q instanceof lu&&(b?0>p.Ca.indexOf(q)&&p.aj(d,q,u):(q.isSelected=!1,q.isHighlighted=!1,q.Lb(),p.Fc(u?d:-1,q,u)))}else p instanceof Vo?"number"==typeof d&&q instanceof Eo&&(b?(q.Zd(this),this.Ja.Kb(d,q)):this.Ja.lb(d)):N("unknown ChangedEvent.Remove object: "+a.toString());this.isModified=!0}else e!==je&&N("unknown ChangedEvent: "+a.toString())}finally{this.skipsModelSourceBindings=t}}},Vo.prototype.ua=function(a){return this.undoManager.ua(a)},Vo.prototype.Ua=function(a){return this.undoManager.Ua(a)},Vo.prototype.Bf=function(){return this.undoManager.Bf()},Vo.prototype.commit=function(a,b){void 0===b&&(b="");var t=this.skipsUndoManager;null===b&&(this.skipsUndoManager=!0,b=""),this.undoManager.ua(b);var e=!1;try{a(this),e=!0}finally{e?this.undoManager.Ua(b):this.undoManager.Bf(),this.skipsUndoManager=t}},Vo.prototype.updateAllTargetBindings=function(a){this.partManager.updateAllTargetBindings(a)},Vo.prototype.Pq=function(){this.partManager.Pq()},Vo.prototype.Bq=function(a,b,t,e){if(!a.w(b)){void 0===e&&(e=!1),e||xr(this),wr(this);var n=this.layout;null===n||!n.isViewportSized||this.autoScale!==xs||e||a.width===b.width&&a.height===b.height||n.C(),n=this.currentTool,!0===this.Yf&&n instanceof ze&&(this.lastInput.documentPoint=this.Qt(this.lastInput.viewPoint),Ve(n,this)),this.Rb||this.Sx(a,b),Br(this),this.Sd.scale=t,this.Sd.position.x=a.x,this.Sd.position.y=a.y,this.Sd.bounds.assign(a),this.Sd.Kv=e,this.R("ViewportBoundsChanged",this.Sd,a),this.isVirtualized&&this.links.each((function(a){a.isAvoiding&&a.actualBounds.Gc(b)&&a.Ta()}))}},Vo.prototype.clearSelection=function(a){void 0===a&&(a=!1);var b=this.selection;if(0!==b.count){a||this.R("ChangingSelection",b);for(var t=b.na(),e=t.length,n=0;n<e;n++)t[n].isSelected=!1;b.ea(),b.clear(),b.freeze(),a||this.R("ChangedSelection",b)}},Vo.prototype.select=function(a){null!==a&&a.layer.diagram===this&&(!a.isSelected||1<this.selection.count)&&(this.R("ChangingSelection",this.selection),this.clearSelection(!0),a.isSelected=!0,this.R("ChangedSelection",this.selection))},Vo.prototype.sA=function(a){if(this.R("ChangingSelection",this.selection),this.clearSelection(!0),D(a))for(var b=a.length,t=0;t<b;t++){var e=a[t];e instanceof lu||N("Diagram.selectCollection given something that is not a Part: "+e),e.isSelected=!0}else for(a=a.iterator;a.next();)(b=a.value)instanceof lu||N("Diagram.selectCollection given something that is not a Part: "+b),b.isSelected=!0;this.R("ChangedSelection",this.selection)},Vo.prototype.clearHighlighteds=function(){var a=this.highlighteds;if(0<a.count){for(var b=a.na(),t=b.length,e=0;e<t;e++)b[e].isHighlighted=!1;a.ea(),a.clear(),a.freeze()}},(n=Vo.prototype).Pz=function(a){null!==a&&a.layer.diagram===this&&(!a.isHighlighted||1<this.highlighteds.count)&&(this.clearHighlighteds(),a.isHighlighted=!0)},n.Qz=function(a){a=(new ct).addAll(a);for(var b=this.highlighteds.copy().Fq(a).iterator;b.next();)b.value.isHighlighted=!1;for(a=a.iterator;a.next();)(b=a.value)instanceof lu||N("Diagram.highlightCollection given something that is not a Part: "+b),b.isHighlighted=!0},n.scroll=function(a,b,t){void 0===t&&(t=1);var e="up"===b||"down"===b,n=0;if("pixel"===a)n=t;else if("line"===a)n=t*(e?this.scrollVerticalLineChange:this.scrollHorizontalLineChange);else if("page"===a)a=e?this.viewportBounds.height:this.viewportBounds.width,0!==(a*=this.scale)&&(n=t*Math.max(a-(e?this.scrollVerticalLineChange:this.scrollHorizontalLineChange),0));else{if("document"===a)return n=this.documentBounds,t=this.viewportBounds,e=Mt.alloc(),"up"===b?this.position=e.h(t.x,n.y):"left"===b?this.position=e.h(n.x,t.y):"down"===b?this.position=e.h(t.x,n.bottom-t.height):"right"===b&&(this.position=e.h(n.right-t.width,t.y)),void Mt.free(e);N("scrolling unit must be 'pixel', 'line', 'page', or 'document', not: "+a)}n/=this.scale,t=this.position.copy(),"up"===b?t.y=this.position.y-n:"down"===b?t.y=this.position.y+n:"left"===b?t.x=this.position.x-n:"right"===b?t.x=this.position.x+n:N("scrolling direction must be 'up', 'down', 'left', or 'right', not: "+b),this.position=t},n.dw=function(a){var b=this.viewportBounds;b.Ae(a)||((a=a.center).x-=b.width/2,a.y-=b.height/2,this.position=a)},n.ct=function(a){var b=this.viewportBounds;(a=a.center).x-=b.width/2,a.y-=b.height/2,this.position=a},n.Nq=function(a){var b=this.kb;b.reset(),1!==this.ya&&b.scale(this.ya);var t=this.ma;return(0!==t.x||0!==t.y)&&isFinite(t.x)&&isFinite(t.y)&&b.translate(-t.x,-t.y),a.copy().transform(this.kb)},n.BA=function(a){var b=this.kb,t=a.x,e=a.y,n=t+a.width,o=e+a.height,g=b.m11,r=b.m12,h=b.m21,l=b.m22,c=b.dx,f=b.dy,p=t*g+e*h+c;b=t*r+e*l+f;var d=n*g+e*h+c;return a=n*r+e*l+f,e=t*g+o*h+c,t=t*r+o*l+f,g=n*g+o*h+c,n=n*r+o*l+f,o=Math.min(p,d),p=Math.max(p,d),d=Math.min(b,a),b=Math.max(b,a),o=Math.min(o,e),p=Math.max(p,e),d=Math.min(d,t),b=Math.max(b,t),o=Math.min(o,g),p=Math.max(p,g),new Wt(o,d=Math.min(d,n),p-o,(b=Math.max(b,n))-d)},n.Qt=function(a){var b=this.kb;b.reset(),1!==this.ya&&b.scale(this.ya);var t=this.ma;return(0!==t.x||0!==t.y)&&isFinite(t.x)&&isFinite(t.y)&&b.translate(-t.x,-t.y),Ct(a.copy(),this.kb)},Vo.prototype.doModelChanged=function(a){if(a.model===this.model){var b=a.change,t=a.propertyName;if(b===je&&"S"===t[0])if("StartingFirstTransaction"===t){var e=this;(a=this.toolManager).mouseDownTools.each((function(a){a.diagram=e})),a.mouseMoveTools.each((function(a){a.diagram=e})),a.mouseUpTools.each((function(a){a.diagram=e})),this.Bc||this.je||(this.pj=!0,this.sj&&(this.xe=!0))}else"StartingUndo"===t||"StartingRedo"===t?((a=this.animationManager).defaultAnimation.isAnimating&&!this.skipsUndoManager&&a.Xc(),this.R("ChangingSelection",this.selection)):"StartedTransaction"===t&&((a=this.animationManager).defaultAnimation.isAnimating&&!this.skipsUndoManager&&a.Xc());else if(this.Z){this.Z=!1;try{if(""===a.modelChange&&b===je){"FinishedUndo"!==t&&"FinishedRedo"!==t||(this.R("ChangedSelection",this.selection),pr(this));var n=this.animationManager;"RolledBackTransaction"===t&&n.Xc(),this.pj=!0,this.Wc(),0!==this.undoManager.transactionLevel&&1!==this.undoManager.transactionLevel||fo(n),"CommittedTransaction"===t&&this.undoManager.Au&&(this.Hd=Math.min(this.Hd,this.undoManager.historyIndex-1));var o=a.isTransactionFinished;if(o&&(Ir(this),this.yt.clear(),function(a){for(a=a.Ck.iterator;a.next();)a.value.pl=!1}(this.animationManager)),!this.hs&&o){this.hs=!0;var g=this;S((function(){g.currentTool.standardMouseOver(),g.hs=!1}),10)}}}finally{this.Z=!0}}}},Vo.prototype.yd=function(){this.partManager.yd()},Vo.prototype.Tj=function(a,b){this.Jc.Tj(a,b)},Vo.prototype.Vj=function(a,b){this.Jc.Vj(a,b)},Vo.prototype.findPartForKey=function(a){return this.partManager.findPartForKey(a)},Vo.prototype.Jb=function(a){return this.partManager.Jb(a)},Vo.prototype.findLinkForKey=function(a){return this.partManager.findLinkForKey(a)},(n=Vo.prototype).wc=function(a){return this.partManager.wc(a)},n.Si=function(a){return this.partManager.Si(a)},n.vc=function(a){return this.partManager.vc(a)},n.kt=function(a){for(var b=[],t=0;t<arguments.length;++t)b[t]=arguments[t];return this.partManager.kt.apply(this.partManager,b instanceof Array?b:h(r(b)))},n.jt=function(a){for(var b=[],t=0;t<arguments.length;++t)b[t]=arguments[t];return this.partManager.jt.apply(this.partManager,b instanceof Array?b:h(r(b)))},n.sz=function(){for(var a=new ct,b=this.nodes;b.next();){var t=b.value;t.isTopLevel&&a.add(t)}for(b=this.links;b.next();)(t=b.value).isTopLevel&&a.add(t);return a.iterator},n.rz=function(){return this.zh.iterator},n.aA=function(a){pr(this),a&&Gr(this,!0),this.pj=!0,dr(this)},n.zz=function(){for(var a=new lt,b=this.nodes;b.next();){var t=b.value;t.isTopLevel&&null===t.Vi()&&a.add(t)}return a.iterator},n.Uj=function(a,b){null!==(a=Wr(this,a))&&a.add(b)},n.ym=function(a,b){null!==(a=Wr(this,a))&&a.remove(b)},n.R=function(a,b,t){var e=Wr(this,a),n=new Le;if(n.diagram=this,null!==(a=Hr(this,a))&&(n.name=a),void 0!==b&&(n.subject=b),void 0!==t&&(n.parameter=t),1===(b=e.length))e.L(0)(n);else if(0!==b)for(e=e.na(),t=0;t<b;t++)(0,e[t])(n)},n.lk=function(a,b){return void 0===b&&(b=null),Zr(this,!1,null,b).lk(a.x,a.y,a.width,a.height)},Vo.prototype.computeOccupiedArea=function(){return this.isVirtualized?this.viewportBounds.copy():this.ki?$o(this):this.documentBounds.copy()},(n=Vo.prototype).gt=function(a){this.$m.assign(a),_r(this,this.$m).Ma(this.position)?this.Cf():function t(a){-1===a.jj&&(a.jj=S((function(){if(-1!==a.jj&&(a.Cf(),null!==a.lastInput.event)){var b=_r(a,a.$m);b.Ma(a.position)||(a.position=b,a.lastInput.documentPoint=a.Qt(a.$m),a.doMouseMove(),a.ki=!0,Vr(a,a.documentBounds.copy().Hc(a.computeBounds())),a.Ac=!0,a.Wc(),t(a))}}),a.Zm))}(this)},n.Cf=function(){-1!==this.jj&&(w.clearTimeout(this.jj),this.jj=-1)},n.At=function(){return null},n.Lv=function(){return null},n.Ky=function(a,b){this.jx.add(a,b)},n.cA=function(a){return ys?(void 0===a&&(a=new et),a.returnType="Image",this.Ux(a)):null},n.Ux=function(a){return void 0===a&&(a=new et),ts(this,this.dA,a)},n.dA=function(a,b,t){var e=is(t,a,"canvas",null);if(null===e)return null;var n=null;if(null!==(t=e.V.canvas))switch(n=a.returnType,n=void 0===n?"string":n.toLowerCase(),n){case"imagedata":n=e.getImageData(0,0,t.width,t.height);break;case"image":(e=(a.document||document).createElement("img")).src=t.toDataURL(a.type,a.details),n=e;break;case"blob":return"function"!=typeof b&&N('Error: Diagram.makeImageData called with "returnType: toBlob", but no required "callback" function property defined.'),"function"==typeof t.toBlob?(t.toBlob(b,a.type,a.details),"toBlob"):"function"==typeof t.msToBlob?(b(t.msToBlob()),"msToBlob"):(b(null),null);default:n=t.toDataURL(a.type,a.details)}return"function"==typeof b?(b(n),null):n},v.Object.defineProperties(Vo.prototype,{div:{get:function(){return this.La},set:function(a){if(this.La!==a){Q=[];var b=this.La;null!==b?(b.B=void 0,b.innerHTML="",null!==this.sa&&(b=this.sa.Ea,this.removeEventListener(b,"touchstart",this.pw,!1),this.removeEventListener(b,"touchmove",this.ow,!1),this.removeEventListener(b,"touchend",this.nw,!1),this.sa.Fx()),null!==(b=this.toolManager)&&(b.mouseDownTools.each((function(a){a.cancelWaitAfter()})),b.mouseMoveTools.each((function(a){a.cancelWaitAfter()})),b.mouseUpTools.each((function(a){a.cancelWaitAfter()}))),b.cancelWaitAfter(),this.currentTool.doCancel(),this.Db=this.sa=null,this.removeEventListener(w,"resize",this.vw,!1),this.removeEventListener(w,"mousemove",this.qk,!0),this.removeEventListener(w,"mousedown",this.pk,!0),this.removeEventListener(w,"mouseup",this.sk,!0),this.removeEventListener(w,"wheel",this.tk,!0),this.removeEventListener(w,"mouseout",this.rk,!0),fs===this&&(fs=null)):this.je=!1,this.La=null,null!==a&&((b=a.B)&&(b.div=null),Vs(this,a),this.Fe())}}},xx:{get:function(){return this.Io}},kk:{get:function(){return this.je}},draggedLink:{get:function(){return this.yr},set:function(a){this.yr!==a&&(this.yr=a,null!==a&&(this.ms=a.fromPort,this.ns=a.toPort))}},Xx:{get:function(){return this.ms},set:function(a){this.ms=a}},Yx:{get:function(){return this.ns},set:function(a){this.ns=a}},animationManager:{get:function(){return this.Jc}},undoManager:{get:function(){return this.ac.undoManager}},skipsUndoManager:{get:function(){return this.sg},set:function(a){this.sg=a,this.ac.skipsUndoManager=a}},delaysLayout:{get:function(){return this.tr},set:function(a){this.tr=a}},opacity:{get:function(){return this.qb},set:function(a){var b=this.qb;b!==a&&((0>a||1<a)&&T(a,"0 <= value <= 1",Vo,"opacity"),this.qb=a,this.g("opacity",b,a),this.M())}},validCycle:{get:function(){return this.Xs},set:function(a){var b=this.Xs;b!==a&&(this.Xs=a,this.g("validCycle",b,a))}},layers:{get:function(){return this.Ja.iterator}},isModelReadOnly:{get:function(){var a=this.ac;return null!==a&&a.isReadOnly},set:function(a){var b=this.ac;null!==b&&(b.isReadOnly=a)}},isReadOnly:{get:function(){return this.Zf},set:function(a){var b=this.Zf;b!==a&&(this.Zf=a,this.g("isReadOnly",b,a))}},isEnabled:{get:function(){return this.Mc},set:function(a){var b=this.Mc;b!==a&&(this.Mc=a,this.g("isEnabled",b,a))}},allowClipboard:{get:function(){return this.Uq},set:function(a){var b=this.Uq;b!==a&&(this.Uq=a,this.g("allowClipboard",b,a))}},allowCopy:{get:function(){return this.Rh},set:function(a){var b=this.Rh;b!==a&&(this.Rh=a,this.g("allowCopy",b,a))}},allowDelete:{get:function(){return this.Sh},set:function(a){var b=this.Sh;b!==a&&(this.Sh=a,this.g("allowDelete",b,a))}},allowDragOut:{get:function(){return this.Vq},set:function(a){var b=this.Vq;b!==a&&(this.Vq=a,this.g("allowDragOut",b,a))}},allowDrop:{get:function(){return this.Wq},set:function(a){var b=this.Wq;b!==a&&(this.Wq=a,this.g("allowDrop",b,a))}},allowTextEdit:{get:function(){return this.ai},set:function(a){var b=this.ai;b!==a&&(this.ai=a,this.g("allowTextEdit",b,a))}},allowGroup:{get:function(){return this.Th},set:function(a){var b=this.Th;b!==a&&(this.Th=a,this.g("allowGroup",b,a))}},allowUngroup:{get:function(){return this.bi},set:function(a){var b=this.bi;b!==a&&(this.bi=a,this.g("allowUngroup",b,a))}},allowInsert:{get:function(){return this.Yq},set:function(a){var b=this.Yq;b!==a&&(this.Yq=a,this.g("allowInsert",b,a))}},allowLink:{get:function(){return this.Uh},set:function(a){var b=this.Uh;b!==a&&(this.Uh=a,this.g("allowLink",b,a))}},allowRelink:{get:function(){return this.Wh},set:function(a){var b=this.Wh;b!==a&&(this.Wh=a,this.g("allowRelink",b,a))}},allowMove:{get:function(){return this.Vh},set:function(a){var b=this.Vh;b!==a&&(this.Vh=a,this.g("allowMove",b,a))}},allowReshape:{get:function(){return this.Xh},set:function(a){var b=this.Xh;b!==a&&(this.Xh=a,this.g("allowReshape",b,a))}},allowResize:{get:function(){return this.Yh},set:function(a){var b=this.Yh;b!==a&&(this.Yh=a,this.g("allowResize",b,a))}},allowRotate:{get:function(){return this.Zh},set:function(a){var b=this.Zh;b!==a&&(this.Zh=a,this.g("allowRotate",b,a))}},allowSelect:{get:function(){return this.$h},set:function(a){var b=this.$h;b!==a&&(this.$h=a,this.g("allowSelect",b,a))}},allowUndo:{get:function(){return this.Zq},set:function(a){var b=this.Zq;b!==a&&(this.Zq=a,this.g("allowUndo",b,a))}},allowZoom:{get:function(){return this.ar},set:function(a){var b=this.ar;b!==a&&(this.ar=a,this.g("allowZoom",b,a))}},hasVerticalScrollbar:{get:function(){return this.dl},set:function(a){var b=this.dl;b!==a&&(this.dl=a,xr(this),this.M(),this.g("hasVerticalScrollbar",b,a),Qo(this,!1))}},hasHorizontalScrollbar:{get:function(){return this.cl},set:function(a){var b=this.cl;b!==a&&(this.cl=a,xr(this),this.M(),this.g("hasHorizontalScrollbar",b,a),Qo(this,!1))}},allowHorizontalScroll:{get:function(){return this.Xq},set:function(a){var b=this.Xq;b!==a&&(this.Xq=a,this.g("allowHorizontalScroll",b,a),Qo(this,!1))}},allowVerticalScroll:{get:function(){return this.$q},set:function(a){var b=this.$q;b!==a&&(this.$q=a,this.g("allowVerticalScroll",b,a),Qo(this,!1))}},scrollHorizontalLineChange:{get:function(){return this.Cs},set:function(a){var b=this.Cs;b!==a&&(0>a&&T(a,">= 0",Vo,"scrollHorizontalLineChange"),this.Cs=a,this.g("scrollHorizontalLineChange",b,a))}},scrollVerticalLineChange:{get:function(){return this.Gs},set:function(a){var b=this.Gs;b!==a&&(0>a&&T(a,">= 0",Vo,"scrollVerticalLineChange"),this.Gs=a,this.g("scrollVerticalLineChange",b,a))}},lastInput:{get:function(){return this.dh},set:function(a){this.dh=a}},firstInput:{get:function(){return this.Uf},set:function(a){this.Uf=a}},currentCursor:{get:function(){return this.mr},set:function(a){if(""===a&&(a=this.xn),this.mr!==a){var b=this.sa,t=this.La;if(null!==b){this.mr=a;var e=b.style.cursor;b.style.cursor=a,t.style.cursor=a,b.style.cursor===e&&(b.style.cursor="-webkit-"+a,t.style.cursor="-webkit-"+a,b.style.cursor===e&&(b.style.cursor="-moz-"+a,t.style.cursor="-moz-"+a,b.style.cursor===e&&(b.style.cursor=a,t.style.cursor=a)))}}}},defaultCursor:{get:function(){return this.xn},set:function(a){""===a&&(a="auto");var b=this.xn;b!==a&&(this.xn=a,this.g("defaultCursor",b,a))}},click:{get:function(){return this.Nf},set:function(a){var b=this.Nf;b!==a&&(this.Nf=a,this.g("click",b,a))}},doubleClick:{get:function(){return this.Sf},set:function(a){var b=this.Sf;b!==a&&(this.Sf=a,this.g("doubleClick",b,a))}},contextClick:{get:function(){return this.Of},set:function(a){var b=this.Of;b!==a&&(this.Of=a,this.g("contextClick",b,a))}},mouseOver:{get:function(){return this.kg},set:function(a){var b=this.kg;b!==a&&(this.kg=a,this.g("mouseOver",b,a))}},mouseHover:{get:function(){return this.ig},set:function(a){var b=this.ig;b!==a&&(this.ig=a,this.g("mouseHover",b,a))}},mouseHold:{get:function(){return this.hg},set:function(a){var b=this.hg;b!==a&&(this.hg=a,this.g("mouseHold",b,a))}},mouseDragOver:{get:function(){return this.gs},set:function(a){var b=this.gs;b!==a&&(this.gs=a,this.g("mouseDragOver",b,a))}},mouseDrop:{get:function(){return this.fg},set:function(a){var b=this.fg;b!==a&&(this.fg=a,this.g("mouseDrop",b,a))}},handlesDragDropForTopLevelParts:{get:function(){return this.Ir},set:function(a){var b=this.Ir;b!==a&&(this.Ir=a,this.g("handlesDragDropForTopLevelParts",b,a))}},mouseEnter:{get:function(){return this.gg},set:function(a){var b=this.gg;b!==a&&(this.gg=a,this.g("mouseEnter",b,a))}},mouseLeave:{get:function(){return this.jg},set:function(a){var b=this.jg;b!==a&&(this.jg=a,this.g("mouseLeave",b,a))}},toolTip:{get:function(){return this.ug},set:function(a){var b=this.ug;b!==a&&(this.ug=a,this.g("toolTip",b,a))}},contextMenu:{get:function(){return this.Pf},set:function(a){var b=this.Pf;b!==a&&(this.Pf=a,this.g("contextMenu",b,a))}},commandHandler:{get:function(){return this.gr},set:function(a){this.gr!==a&&(this.gr=a,a.Zd(this))}},toolManager:{get:function(){return this.Ts},set:function(a){this.Ts!==a&&(this.Ts=a,a.diagram=this)}},defaultTool:{get:function(){return this.sr},set:function(a){var b=this.sr;b!==a&&(this.sr=a,a.diagram=this,this.currentTool===b&&(this.currentTool=a))}},currentTool:{get:function(){return this.pr},set:function(a){var b=this.pr;null!==b&&(b.isActive&&b.doDeactivate(),b.cancelWaitAfter(),b.doStop()),null===a&&(a=this.defaultTool),null!==a&&(this.pr=a,a.diagram=this,a.doStart())}},selection:{get:function(){return this.Ru}},maxSelectionCount:{get:function(){return this.cs},set:function(a){var b=this.cs;if(b!==a)if(0<=a&&!isNaN(a)){if(this.cs=a,this.g("maxSelectionCount",b,a),!this.undoManager.isUndoingRedoing&&0<(a=this.selection.count-a)){this.R("ChangingSelection",this.selection),b=this.selection.na();for(var t=0;t<a;t++)b[t].isSelected=!1;this.R("ChangedSelection",this.selection)}}else T(a,">= 0",Vo,"maxSelectionCount")}},nodeSelectionAdornmentTemplate:{get:function(){return this.Ro},set:function(a){var b=this.Ro;b!==a&&(this.Ro=a,this.g("nodeSelectionAdornmentTemplate",b,a))}},groupSelectionAdornmentTemplate:{get:function(){return this.Vn},set:function(a){var b=this.Vn;b!==a&&(this.Vn=a,this.g("groupSelectionAdornmentTemplate",b,a))}},linkSelectionAdornmentTemplate:{get:function(){return this.qo},set:function(a){var b=this.qo;b!==a&&(this.qo=a,this.g("linkSelectionAdornmentTemplate",b,a))}},highlighteds:{get:function(){return this.su}},isModified:{get:function(){var a=this.undoManager;return a.isEnabled?null!==a.currentTransaction||this.$n&&this.Hd!==a.historyIndex:this.$n},set:function(a){if(this.$n!==a){this.$n=a;var b=this.undoManager;!a&&b.isEnabled&&(this.Hd=b.historyIndex),a||Ir(this)}}},model:{get:function(){return this.ac},set:function(a){var b=this.ac;if(b!==a){this.currentTool.doCancel(),null!==b&&b.undoManager!==a.undoManager&&b.undoManager.isInTransaction&&N("Do not replace a Diagram.model while a transaction is in progress."),this.animationManager.Xc(!0);var t=Yo(this,!0);this.je=!1,this.sj=!0,this.Hd=-2,this.xe=!1;var e=this.Bc;this.Bc=!0,uo(this.animationManager,"Model"),null!==b&&(null!==this.pe&&this.pe.each((function(a){b.wk(a)})),b.wk(this.Ic)),this.ac=a,this.partManager=function(a){return null!==(a=ds.get(a))?new a:new vf}(this.ac.constructor.type);for(var n=0;n<t.length;n++)this.add(t[n]);a.Dh(this.kd),this.partManager.addAllModeledParts(),a.wk(this.kd),a.Dh(this.Ic),null!==this.pe&&this.pe.each((function(b){a.Dh(b)})),this.Bc=e,this.Rb||this.M(),null!==b&&a.undoManager.copyProperties(b.undoManager)}}},Z:{get:function(){return this.zu},set:function(a){this.zu=a}},yt:{get:function(){return this.Yw}},skipsModelSourceBindings:{get:function(){return this.Su},set:function(a){this.Su=a}},Pt:{get:function(){return this.Ls},set:function(a){this.Ls=a}},nodeTemplate:{get:function(){return this.Ze.H("")},set:function(a){var b=this.Ze.H("");b!==a&&(this.Ze.add("",a),this.g("nodeTemplate",b,a),this.undoManager.isUndoingRedoing||this.yd())}},nodeTemplateMap:{get:function(){return this.Ze},set:function(a){var b=this.Ze;b!==a&&(this.Ze=a,this.g("nodeTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.yd())}},groupTemplate:{get:function(){return this.ah.H("")},set:function(a){var b=this.ah.H("");b!==a&&(this.ah.add("",a),this.g("groupTemplate",b,a),this.undoManager.isUndoingRedoing||this.yd())}},groupTemplateMap:{get:function(){return this.ah},set:function(a){var b=this.ah;b!==a&&(this.ah=a,this.g("groupTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.yd())}},linkTemplate:{get:function(){return this.ag.H("")},set:function(a){var b=this.ag.H("");b!==a&&(this.ag.add("",a),this.g("linkTemplate",b,a),this.undoManager.isUndoingRedoing||this.yd())}},linkTemplateMap:{get:function(){return this.ag},set:function(a){var b=this.ag;b!==a&&(this.ag=a,this.g("linkTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.yd())}},isMouseCaptured:{get:function(){return this.xu},set:function(a){var b=this.sa;null!==b&&((b=b.Ea)instanceof SVGElement||(a?(this.lastInput.bubbles=!1,this.Vm?(this.removeEventListener(b,"pointermove",this.um,!1),this.removeEventListener(b,"pointerdown",this.tm,!1),this.removeEventListener(b,"pointerup",this.wm,!1),this.removeEventListener(b,"pointerout",this.vm,!1),this.addEventListener(w,"pointermove",this.um,!0),this.addEventListener(w,"pointerdown",this.tm,!0),this.addEventListener(w,"pointerup",this.wm,!0),this.addEventListener(w,"pointerout",this.vm,!0)):(this.removeEventListener(b,"mousemove",this.qk,!1),this.removeEventListener(b,"mousedown",this.pk,!1),this.removeEventListener(b,"mouseup",this.sk,!1),this.removeEventListener(b,"mouseout",this.rk,!1),this.addEventListener(w,"mousemove",this.qk,!0),this.addEventListener(w,"mousedown",this.pk,!0),this.addEventListener(w,"mouseup",this.sk,!0),this.addEventListener(w,"mouseout",this.rk,!0)),this.removeEventListener(b,"wheel",this.tk,!1),this.addEventListener(w,"wheel",this.tk,!0),this.addEventListener(w,"selectstart",this.preventDefault,!1)):(this.Vm?(this.removeEventListener(w,"pointermove",this.um,!0),this.removeEventListener(w,"pointerdown",this.tm,!0),this.removeEventListener(w,"pointerup",this.wm,!0),this.removeEventListener(w,"pointerout",this.vm,!0),this.addEventListener(b,"pointermove",this.um,!1),this.addEventListener(b,"pointerdown",this.tm,!1),this.addEventListener(b,"pointerup",this.wm,!1),this.addEventListener(b,"pointerout",this.vm,!1)):(this.removeEventListener(w,"mousemove",this.qk,!0),this.removeEventListener(w,"mousedown",this.pk,!0),this.removeEventListener(w,"mouseup",this.sk,!0),this.removeEventListener(w,"mouseout",this.rk,!0),this.addEventListener(b,"mousemove",this.qk,!1),this.addEventListener(b,"mousedown",this.pk,!1),this.addEventListener(b,"mouseup",this.sk,!1),this.addEventListener(b,"mouseout",this.rk,!1)),this.removeEventListener(w,"wheel",this.tk,!0),this.removeEventListener(w,"selectstart",this.preventDefault,!1),this.addEventListener(b,"wheel",this.tk,!1)),this.xu=a))}},position:{get:function(){return this.ma},set:function(a){var b=Mt.alloc().assign(this.ma);if(!b.w(a)){var t=this.viewportBounds.copy();this.ma.assign(a),mo(this.animationManager,b,this.ma),this.Rb||null===this.sa&&!this.Zl.u()||(this.Rb=!0,a=this.scale,ir(this,this.zn,this.wa/a,this.va/a,this.lj,!1),this.Rb=!1),this.Rb||this.Bq(t,this.viewportBounds,this.ya,!1)}Mt.free(b)}},initialPosition:{get:function(){return this.Kr},set:function(a){this.Kr.w(a)||(this.Kr=a.G())}},initialScale:{get:function(){return this.Lr},set:function(a){this.Lr!==a&&(this.Lr=a)}},grid:{get:function(){return null===this.Fb&&Wo(this),this.Fb},set:function(a){var b=this.Fb;if(b!==a){null===b&&(Wo(this),b=this.Fb),a.type!==jh.Grid&&N("Diagram.grid must be a Panel of type Panel.Grid");var t=b.panel;null!==t&&t.remove(b),this.Fb=a,a.name="GRID",null!==t&&t.add(a),Br(this),this.M(),this.g("grid",b,a)}}},viewportBounds:{get:function(){var a=this.$u,b=this.ma,t=this.ya;return null===this.sa?(this.Zl.u()&&a.h(b.x,b.y,this.wa/t,this.va/t),a):(a.h(b.x,b.y,Math.max(this.wa,0)/t,Math.max(this.va,0)/t),a)}},viewSize:{get:function(){return this.Zl},set:function(a){var b=this.viewSize;b.w(a)||(this.Zl=a=a.G(),this.wa=a.width,this.va=a.height,this.Na(),this.g("viewSize",b,a))}},fixedBounds:{get:function(){return this.Fr},set:function(a){var b=this.Fr;b.w(a)||(-1/0!==a.width&&1/0!==a.height&&-1/0!==a.height||N("fixedBounds width/height must not be Infinity"),this.Fr=a=a.G(),this.Na(),this.g("fixedBounds",b,a))}},scrollMargin:{get:function(){return this.Fi},set:function(a){"number"==typeof a&&(a=new hi(a));var b=this.Fi;b.w(a)||(this.Fi=a=a.G(),this.g("scrollMargin",b,a),this.Fe())}},scrollMode:{get:function(){return this.Gi},set:function(a){var b=this.Gi;b!==a&&(this.Gi=a,a===Ts&&Qo(this,!1),this.g("scrollMode",b,a),this.M())}},scrollsPageOnFocus:{get:function(){return this.Hs},set:function(a){var b=this.Hs;b!==a&&(this.Hs=a,this.g("scrollsPageOnFocus",b,a))}},positionComputation:{get:function(){return this.vs},set:function(a){var b=this.vs;b!==a&&(this.vs=a,Qo(this,!1),this.g("positionComputation",b,a))}},scaleComputation:{get:function(){return this.As},set:function(a){var b=this.As;b!==a&&(this.As=a,Or(this,this.scale,this.scale),this.g("scaleComputation",b,a))}},documentBounds:{get:function(){return this.zn}},isVirtualized:{get:function(){return this.Vr},set:function(a){var b=this.Vr;b!==a&&(this.Vr=a,this.g("isVirtualized",b,a))}},scale:{get:function(){return this.ya},set:function(a){var b=this.ya;b!==a&&Or(this,b,a)}},defaultScale:{get:function(){return this.yn},set:function(a){this.yn=a}},autoScale:{get:function(){return this.Lg},set:function(a){var b=this.Lg;b!==a&&(this.Lg=a,this.g("autoScale",b,a),a!==xs&&Qo(this,!1))}},initialAutoScale:{get:function(){return this.Xf},set:function(a){var b=this.Xf;b!==a&&(this.Xf=a,this.g("initialAutoScale",b,a))}},initialViewportSpot:{get:function(){return this.Mr},set:function(a){var b=this.Mr;b!==a&&(a.eb()||N("initialViewportSpot must be a specific Spot: "+a),this.Mr=a,this.g("initialViewportSpot",b,a))}},initialDocumentSpot:{get:function(){return this.Jr},set:function(a){var b=this.Jr;b!==a&&(a.eb()||N("initialViewportSpot must be a specific Spot: "+a),this.Jr=a,this.g("initialDocumentSpot",b,a))}},minScale:{get:function(){return this.ds},set:function(a){var b=this.ds;b!==a&&(0<a?(this.ds=a,this.g("minScale",b,a),a>this.scale&&(this.scale=a)):T(a,"> 0",Vo,"minScale"))}},maxScale:{get:function(){return this.bs},set:function(a){var b=this.bs;b!==a&&(0<a?(this.bs=a,this.g("maxScale",b,a),a<this.scale&&(this.scale=a)):T(a,"> 0",Vo,"maxScale"))}},zoomPoint:{get:function(){return this.$s},set:function(a){this.$s.w(a)||(this.$s=a=a.G())}},contentAlignment:{get:function(){return this.lj},set:function(a){var b=this.lj;b.w(a)||(this.lj=a=a.G(),this.g("contentAlignment",b,a),Qo(this,!1))}},initialContentAlignment:{get:function(){return this.Xn},set:function(a){var b=this.Xn;b.w(a)||(this.Xn=a=a.G(),this.g("initialContentAlignment",b,a))}},padding:{get:function(){return this.bb},set:function(a){"number"==typeof a&&(a=new hi(a));var b=this.bb;b.w(a)||(this.bb=a=a.G(),this.Na(),this.g("padding",b,a))}},partManager:{get:function(){return this.Ia},set:function(a){var b=this.Ia;b!==a&&(null!==a.diagram&&N("Cannot share PartManagers between Diagrams: "+a.toString()),null!==b&&b.Zd(null),this.Ia=a,a.Zd(this))}},nodes:{get:function(){return this.partManager.nodes.iterator}},links:{get:function(){return this.partManager.links.iterator}},parts:{get:function(){return this.partManager.parts.iterator}},layout:{get:function(){return this.ic},set:function(a){var b=this.ic;b!==a&&(this.ic=a,a.diagram=this,a.group=null,this.If=!0,this.g("layout",b,a),this.Pb())}},isTreePathToChildren:{get:function(){return this.Ur},set:function(a){var b=this.Ur;if(b!==a&&(this.Ur=a,this.g("isTreePathToChildren",b,a),!this.undoManager.isUndoingRedoing))for(a=this.nodes;a.next();)Ru(a.value)}},treeCollapsePolicy:{get:function(){return this.Vs},set:function(a){var b=this.Vs;b!==a&&(a!==As&&a!==js&&a!==Ds&&N("Unknown Diagram.treeCollapsePolicy: "+a),this.Vs=a,this.g("treeCollapsePolicy",b,a))}},De:{get:function(){return this.vu},set:function(a){this.vu=a}},autoScrollInterval:{get:function(){return this.Zm},set:function(a){var b=this.Zm;b!==a&&(this.Zm=a,this.g("autoScrollInterval",b,a))}},autoScrollRegion:{get:function(){return this.an},set:function(a){"number"==typeof a&&(a=new hi(a));var b=this.an;b.w(a)||(this.an=a=a.G(),this.Na(),this.g("autoScrollRegion",b,a))}}}),v.Object.defineProperties(Vo,{licenseKey:{get:function(){return Fs.Xb()},set:function(a){Fs.add(a)}},version:{get:function(){return Os}}}),Vo.prototype.makeImageData=Vo.prototype.Ux,Vo.prototype.makeImage=Vo.prototype.cA,Vo.prototype.addRenderer=Vo.prototype.Ky,Vo.prototype.makeSVG=Vo.prototype.Lv,Vo.prototype.makeSvg=Vo.prototype.At,Vo.prototype.stopAutoScroll=Vo.prototype.Cf,Vo.prototype.doAutoScroll=Vo.prototype.gt,Vo.prototype.isUnoccupied=Vo.prototype.lk,Vo.prototype.raiseDiagramEvent=Vo.prototype.R,Vo.prototype.removeDiagramListener=Vo.prototype.ym,Vo.prototype.addDiagramListener=Vo.prototype.Uj,Vo.prototype.findTreeRoots=Vo.prototype.zz,Vo.prototype.layoutDiagram=Vo.prototype.aA,Vo.prototype.findTopLevelGroups=Vo.prototype.rz,Vo.prototype.findTopLevelNodesAndLinks=Vo.prototype.sz,Vo.prototype.findLinksByExample=Vo.prototype.jt,Vo.prototype.findNodesByExample=Vo.prototype.kt,Vo.prototype.findLinkForData=Vo.prototype.vc,Vo.prototype.findNodeForData=Vo.prototype.Si,Vo.prototype.findPartForData=Vo.prototype.wc,Vo.prototype.findLinkForKey=Vo.prototype.findLinkForKey,Vo.prototype.findNodeForKey=Vo.prototype.Jb,Vo.prototype.findPartForKey=Vo.prototype.findPartForKey,Vo.prototype.rebuildParts=Vo.prototype.yd,Vo.prototype.transformViewToDoc=Vo.prototype.Qt,Vo.prototype.transformRectDocToView=Vo.prototype.BA,Vo.prototype.transformDocToView=Vo.prototype.Nq,Vo.prototype.centerRect=Vo.prototype.ct,Vo.prototype.scrollToRect=Vo.prototype.dw,Vo.prototype.scroll=Vo.prototype.scroll,Vo.prototype.highlightCollection=Vo.prototype.Qz,Vo.prototype.highlight=Vo.prototype.Pz,Vo.prototype.selectCollection=Vo.prototype.sA,Vo.prototype.select=Vo.prototype.select,Vo.prototype.updateAllRelationshipsFromData=Vo.prototype.Pq,Vo.prototype.updateAllTargetBindings=Vo.prototype.updateAllTargetBindings,Vo.prototype.commit=Vo.prototype.commit,Vo.prototype.rollbackTransaction=Vo.prototype.Bf,Vo.prototype.commitTransaction=Vo.prototype.Ua,Vo.prototype.startTransaction=Vo.prototype.ua,Vo.prototype.raiseChanged=Vo.prototype.g,Vo.prototype.raiseChangedEvent=Vo.prototype.Ya,Vo.prototype.removeChangedListener=Vo.prototype.wk,Vo.prototype.addChangedListener=Vo.prototype.Dh,Vo.prototype.removeModelChangedListener=Vo.prototype.oA,Vo.prototype.addModelChangedListener=Vo.prototype.vx,Vo.prototype.findLayer=Vo.prototype.im,Vo.prototype.removeLayer=Vo.prototype.mA,Vo.prototype.addLayerAfter=Vo.prototype.Gy,Vo.prototype.addLayerBefore=Vo.prototype.tx,Vo.prototype.addLayer=Vo.prototype.$l,Vo.prototype.moveParts=Vo.prototype.moveParts,Vo.prototype.copyParts=Vo.prototype.ck,Vo.prototype.removeParts=Vo.prototype.Jt,Vo.prototype.remove=Vo.prototype.remove,Vo.prototype.add=Vo.prototype.add,Vo.prototype.clearDelayedGeometries=Vo.prototype.hv,Vo.prototype.setProperties=Vo.prototype.iw,Vo.prototype.resetInputOptions=Vo.prototype.aw,Vo.prototype.setInputOption=Vo.prototype.tA,Vo.prototype.getInputOption=Vo.prototype.mm,Vo.prototype.resetRenderingHints=Vo.prototype.bw,Vo.prototype.setRenderingHint=Vo.prototype.ly,Vo.prototype.getRenderingHint=Vo.prototype.Ce,Vo.prototype.maybeUpdate=Vo.prototype.Wc,Vo.prototype.requestUpdate=Vo.prototype.Pb,Vo.prototype.delayInitialization=Vo.prototype.Zy,Vo.prototype.isUpdateRequested=Vo.prototype.Wz,Vo.prototype.redraw=Vo.prototype.Fe,Vo.prototype.invalidateDocumentBounds=Vo.prototype.Na,Vo.prototype.findObjectsNear=Vo.prototype.Ag,Vo.prototype.findPartsNear=Vo.prototype.oz,Vo.prototype.findObjectsIn=Vo.prototype.uf,Vo.prototype.findPartsIn=Vo.prototype.Mx,Vo.prototype.findObjectsAt=Vo.prototype.Ti,Vo.prototype.findPartsAt=Vo.prototype.nz,Vo.prototype.findObjectAt=Vo.prototype.Ub,Vo.prototype.findPartAt=Vo.prototype.jm,Vo.prototype.focusObject=Vo.prototype.Az,Vo.prototype.alignDocument=Vo.prototype.My,Vo.prototype.zoomToRect=Vo.prototype.EA,Vo.prototype.zoomToFit=Vo.prototype.zoomToFit,Vo.prototype.diagramScroll=Vo.prototype.Ex,Vo.prototype.focus=Vo.prototype.focus,Vo.prototype.reset=Vo.prototype.reset,Vo.useDOM=function(a){ys=!!a&&void 0!==w.document},Vo.isUsingDOM=function(){return ys};var es,ns,os,rs,ss,as,hs,ls,us,cs,fs=null,ds=new kt,ps=null,gs=null,ys=void 0!==w.document,ms=null,vs="",xs=new _(Vo,"None",0),bs=new _(Vo,"Uniform",1),ws=new _(Vo,"UniformToFill",2),ks=new _(Vo,"CycleAll",10),Ms=new _(Vo,"CycleNotDirected",11),Ss=new _(Vo,"CycleNotDirectedFast",12),Ps=new _(Vo,"CycleNotUndirected",13),Ns=new _(Vo,"CycleDestinationTree",14),Cs=new _(Vo,"CycleSourceTree",15),Ts=new _(Vo,"DocumentScroll",1),Ls=new _(Vo,"InfiniteScroll",2),As=new _(Vo,"TreeParentCollapsed",21),js=new _(Vo,"AllParentsCollapsed",22),Ds=new _(Vo,"AnyParentsCollapsed",23),Fs=new lt,Os="2.1.15",Bs=null,Is=!1;function Rs(){if(ys){var a=w.document.createElement("canvas"),b=a.getContext("2d"),t=X("7ca11abfd022028846");b[t]=X("398c3597c01238");for(var e=["5da73c80a36455d5038e4972187c3cae51fd22",k.Dx+"4ae6247590da4bb21c324ba3a84e385776",ie.xF+"fb236cdfda5de14c134ba1a95a2d4c7cc6f93c1387",ne.za],n=1;5>n;n++)b[X("7ca11abfd7330390")](X(e[n-1]),10,15*n);for(b[t]=X("39f046ebb36e4b"),t=1;5>t;t++)b[X("7ca11abfd7330390")](X(e[t-1]),10,15*t);Bs=a}}function Es(){this.Cy=null,this.l="zz@orderNum","63ad05bbe23a1786468a4c741b6d2"===this._tk?this.Qe=this.l=!0:this.Qe=null}function zs(a,b){if(b.Db.setTransform(b.Sb,0,0,b.Sb,0,0),null===a.Qe){b="f";var t=w[X("76a715b2f73f148a")][X("72ba13b5")];if(a.Qe=!0,ys){var e=Vo[X("76a115b6ed251eaf4692")];if(e)for(var n=Fs.iterator;n.next()&&!(6>(e=X(e=n.value).split(X("39e9"))).length);){var o=X(e[1]).split(".");if("7da71ca0"!==e[4])break;var g=X(k[X("6cae19")]).split(".");if(o[0]>g[0]||o[0]===g[0]&&o[1]>=g[1]){for(o=t[X("76ad18b4f73e")],g=t[X("73a612b6fb191d")](X("35e7"))+2;g<o;g++)b+=t[g];if(0>(o=b[X("73a612b6fb191d")](X(e[2])))&&X(e[2])!==X("7da71ca0ad381e90")&&(o=b[X("73a612b6fb191d")](X("76a715b2ef3e149757"))),0>o&&(o=b[X("73a612b6fb191d")](X("76a715b2ef3e149757"))),0>o&&(o=t[X("73a612b6fb191d")](X("7baa19a6f76c1988428554"))),a.Qe=!(0<=o&&o<b[X("73a612b6fb191d")](X("35"))||-1===b[X("73a612b6fb191d")](X("35"))),!a.Qe)break;if("#"!==(o=X(e[2]))[0])break;g=w.document.createElement("div");for(var r=e[0].replace(/[A-Za-z]/g,"");4>r.length;)r+="9";if(r=r.substr(r.length-4),e="",e+=["gsh","gsf"][parseInt(r.substr(0,1),10)%2],e+=["Header","Background","Display","Feedback"][parseInt(r.substr(0,1),10)%4],g[X("79a417a0f0181a8946")]=e,w.document[X("78a712aa")]){if(w.document[X("78a712aa")][X("7bb806b6ed32388c4a875b")](g),r=w.getComputedStyle(g).getPropertyValue(X("78a704b7e62456904c9b12701b6532a8")),w.document[X("78a712aa")][X("68ad1bbcf533388c4a875b")](g),!r)break;if(-1!==r.indexOf(parseInt(o[1]+o[2],16))&&-1!==r.indexOf(parseInt(o[3]+o[4],16))){a.Qe=!1;break}if(U||K||H||W)for(e="."+e,o=0;o<document.styleSheets.length;o++)for(var h in g=document.styleSheets[o].rules||document.styleSheets[o].cssRules)if(e===g[h].selectorText){a.Qe=!1;break}}else a.Qe=null,a.Qe=!1}}else{for(h=t[X("76ad18b4f73e")],n=t[X("73a612b6fb191d")](X("35e7"))+2;n<h;n++)b+=t[n];t=b[X("73a612b6fb191d")](X("7da71ca0ad381e90")),a.Qe=!(0<=t&&t<b[X("73a612b6fb191d")](X("35")))}}}return 0<a.Qe&&a!==a.Cy}function Vs(a,b){if(ys){null!=b||N("Diagram setup requires an argument DIV."),null!==a.La&&N("Diagram has already completed setup."),"string"==typeof b?a.La=w.document.getElementById(b):b instanceof HTMLDivElement?a.La=b:N("No DIV or DIV id supplied: "+b),null===a.La&&N("Invalid DIV id; could not get element with id: "+b),void 0!==a.La.B&&N("Invalid div id; div already has a Diagram associated with it."),"static"===w.getComputedStyle(a.La,null).position&&(a.La.style.position="relative"),a.La.style["-webkit-tap-highlight-color"]="rgba(255, 255, 255, 0)",a.La.style["-ms-touch-action"]="none",a.La.innerHTML="",a.La.B=a;var t=a.Pp?new ja(a):new Ra(a);if(void 0!==t.style&&(t.style.position="absolute",t.style.top="0px",t.style.left="0px","rtl"===w.getComputedStyle(a.La,null).getPropertyValue("direction")&&(a.nl=!0),t.style.zIndex="2",t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.MozUserSelect="none"),a.sa=t,a.Db=t.context,b=a.Db,a.Sb=a.computePixelRatio(),a.wa=a.La.clientWidth||1,a.va=a.La.clientHeight||1,Mr(a,a.wa,a.va),a.zr=b.V[X("7eba17a4ca3b1a8346")][X("78a118b7")](b.V,Bs,4,4),a.La.insertBefore(t.Ea,a.La.firstChild),(t=new Ra(null)).width=1,t.height=1,a.ku=t,a.Rw=t.context,ys){t=P("div");var e=P("div");t.style.position="absolute",t.style.overflow="auto",t.style.width=a.wa+"px",t.style.height=a.va+"px",t.style.zIndex="1",e.style.position="absolute",e.style.width="1px",e.style.height="1px",a.La.appendChild(t),t.appendChild(e),t.onscroll=Jo,t.onmousedown=Zo,t.ontouchstart=Zo,t.B=a,t.Ay=!0,t.By=!0,a.Es=t,a.wp=e}a.Ht=M((function(){a.uh=null,a.M()}),300),a.vw=M((function(){Ko(a)}),250),a.preventDefault=function(a){return a.preventDefault(),!1},a.qk=function(b){if(a.isEnabled){a.Yf=!0;var t=nr(a,b,!0);a.doMouseMove(),a.currentTool.isBeyondDragSize()&&(a.pd=0),lr(t,b)}},a.pk=function(b){if(a.isEnabled)if(a.Yf=!0,a.ke)b.preventDefault();else{var t=nr(a,b,!0);t.down=!0,t.clickCount=b.detail,(K||H)&&(b.timeStamp-a.Aj<a.Us&&!a.currentTool.isBeyondDragSize()?a.pd++:a.pd=1,a.Aj=b.timeStamp,t.clickCount=a.pd),t.clone(a.firstInput),a.doMouseDown(),1===b.button?b.preventDefault():lr(t,b)}},a.sk=function(b){if(a.isEnabled)if(a.ke&&2===b.button)b.preventDefault();else if(a.ke&&0===b.button&&(a.ke=!1),a.Pj)b.preventDefault();else{a.Yf=!0;var t=nr(a,b,!0);t.up=!0,t.clickCount=b.detail,(K||H)&&(t.clickCount=a.pd),t.bubbles=b.bubbles,t.targetDiagram=or(b),a.doMouseUp(),a.Cf(),lr(t,b)}},a.tk=function(b){if(a.isEnabled){var t=nr(a,b,!0);t.bubbles=!0;var e=0,n=0;t.delta=0,void 0!==b.deltaX?(0!==b.deltaX&&(e=0<b.deltaX?1:-1),0!==b.deltaY&&(n=0<b.deltaY?1:-1),t.delta=Math.abs(b.deltaX)>Math.abs(b.deltaY)?-e:-n):void 0!==b.wheelDeltaX?(0!==b.wheelDeltaX&&(e=0<b.wheelDeltaX?-1:1),0!==b.wheelDeltaY&&(n=0<b.wheelDeltaY?-1:1),t.delta=Math.abs(b.wheelDeltaX)>Math.abs(b.wheelDeltaY)?-e:-n):void 0!==b.wheelDelta&&0!==b.wheelDelta&&(t.delta=0<b.wheelDelta?1:-1),a.doMouseWheel(),lr(t,b)}},a.rk=function(b){a.isEnabled&&(a.Yf=!1,nr(a,b,!0),(b=a.currentTool).cancelWaitAfter(),b.standardMouseOver())},a.pw=function(b){if(a.isEnabled){a.Pj=!1,a.ke=!0;var t=rr(a,b,b.targetTouches[0],1<b.touches.length),e=null;if(0<b.targetTouches.length?e=b.targetTouches[0]:0<b.changedTouches.length&&(e=b.changedTouches[0]),null!==e){var n=e.screenX;e=e.screenY;var o=a.lo;b.timeStamp-a.Aj<a.Us&&!(25<Math.abs(o.x-n)||25<Math.abs(o.y-e))?a.pd++:a.pd=1,t.clickCount=a.pd,a.Aj=b.timeStamp,a.lo.h(n,e)}a.doMouseDown(),lr(t,b)}},a.ow=function(b){if(a.isEnabled){var t=null;0<b.targetTouches.length?t=b.targetTouches[0]:0<b.changedTouches.length&&(t=b.changedTouches[0]),t=sr(a,b,t,1<b.touches.length),a.doMouseMove(),lr(t,b)}},a.nw=function(b){if(a.isEnabled)if(a.Pj)b.preventDefault();else if(!(1<b.touches.length)){var t=null,e=null;0<b.targetTouches.length?e=b.targetTouches[0]:0<b.changedTouches.length&&(e=b.changedTouches[0]);var n=ar(a,b,!1,!0,!1,!1);null!==e&&(null!==(t=w.document.elementFromPoint(e.clientX,e.clientY))&&t.B instanceof Vo&&t.B!==a&&ur(t.B,e,n),ur(a,e,n),n.clickCount=a.pd),null===t?n.targetDiagram=or(b):t.B?n.targetDiagram=t.B:n.targetDiagram=null,n.targetObject=null,a.doMouseUp(),lr(n,b),a.ke=!1}},a.tm=function(b){if(a.isEnabled){a.Yf=!0;var t=a.ts;void 0===t[b.pointerId]&&(t[b.pointerId]=b);var e=!1;if(null!==(t=a.Kj)[0]&&t[0].pointerId===b.pointerId)t[0]=b;else if(null!==t[1]&&t[1].pointerId===b.pointerId)t[1]=b,e=!0;else if(null===t[0])t[0]=b;else{if(null!==t[1])return void b.preventDefault();t[1]=b,e=!0}"touch"!==b.pointerType&&"pen"!==b.pointerType||(a.Pj=!1,a.ke=!0),t=rr(a,b,b,e),e=a.lo;var n="touch"===b.pointerType||"pen"===b.pointerType?25:10;b.timeStamp-a.Aj<a.Us&&!(Math.abs(e.x-b.screenX)>n||Math.abs(e.y-b.screenY)>n)?a.pd++:a.pd=1,t.clickCount=a.pd,a.Aj=b.timeStamp,a.lo.Fg(b.screenX,b.screenY),a.doMouseDown(),1===b.button?b.preventDefault():lr(t,b)}},a.um=function(b){if(a.isEnabled){a.Yf=!0;var t=a.Kj;if(null!==t[0]&&t[0].pointerId===b.pointerId)t[0]=b;else{if(null!==t[1]&&t[1].pointerId===b.pointerId)return void(t[1]=b);if(null!==t[0])return;t[0]=b}t[0].pointerId===b.pointerId&&((t=sr(a,b,b,null!==t[1])).targetDiagram=or(b),a.doMouseMove(),lr(t,b))}},a.wm=function(b){if(a.isEnabled){a.Yf=!0;var t="touch"===b.pointerType||"pen"===b.pointerType,e=a.ts;if(t&&a.Pj)delete e[b.pointerId],b.preventDefault();else if(null!==(e=a.Kj)[0]&&e[0].pointerId===b.pointerId){e[0]=null,e=ar(a,b,!1,!0,!0,!1);var n=w.document.elementFromPoint(b.clientX,b.clientY);null!==n&&n.B instanceof Vo&&n.B!==a&&ur(n.B,b,e),ur(a,b,e),e.clickCount=a.pd,null===n?e.targetDiagram=or(b):n.B?e.targetDiagram=n.B:e.targetDiagram=null,e.targetObject=null,a.doMouseUp(),lr(e,b),t&&(a.ke=!1)}else null!==e[1]&&e[1].pointerId===b.pointerId&&(e[1]=null)}},a.vm=function(b){if(a.isEnabled){a.Yf=!1;var t=a.ts;t[b.pointerId]&&delete t[b.pointerId],null!==(t=a.Kj)[0]&&t[0].pointerId===b.pointerId&&(t[0]=null),null!==t[1]&&t[1].pointerId===b.pointerId&&(t[1]=null),"touch"!==b.pointerType&&"pen"!==b.pointerType&&((b=a.currentTool).cancelWaitAfter(),b.standardMouseOver())}},b.sc(!0),function(a){var b=a.sa.Ea;b instanceof HTMLCanvasElement&&(a.Vm?(a.addEventListener(b,"pointerdown",a.tm,!1),a.addEventListener(b,"pointermove",a.um,!1),a.addEventListener(b,"pointerup",a.wm,!1),a.addEventListener(b,"pointerout",a.vm,!1)):(a.addEventListener(b,"touchstart",a.pw,!1),a.addEventListener(b,"touchmove",a.ow,!1),a.addEventListener(b,"touchend",a.nw,!1),a.addEventListener(b,"mousemove",a.qk,!1),a.addEventListener(b,"mousedown",a.pk,!1),a.addEventListener(b,"mouseup",a.sk,!1),a.addEventListener(b,"mouseout",a.rk,!1)),a.addEventListener(b,"mouseenter",a.dz,!1),a.addEventListener(b,"mouseleave",a.ez,!1),a.addEventListener(b,"wheel",a.tk,!1),a.addEventListener(b,"keydown",a.Xz,!1),a.addEventListener(b,"keyup",a.Yz,!1),a.addEventListener(b,"blur",a.Ry,!1),a.addEventListener(b,"focus",a.Sy,!1),a.addEventListener(b,"selectstart",(function(a){return a.preventDefault(),!1}),!1),a.addEventListener(b,"contextmenu",(function(a){return a.preventDefault(),!1}),!1),a.addEventListener(b,"gesturestart",(function(b){a.toolManager.gestureBehavior!==Ke&&(a.toolManager.gestureBehavior===Ue?b.preventDefault():a.ke&&a.lastInput.handled||(b.preventDefault(),a.Cl=a.scale,a.currentTool.doCancel()))}),!1),a.addEventListener(b,"gesturechange",(function(b){if(a.toolManager.gestureBehavior!==Ke)if(a.toolManager.gestureBehavior===Ue)b.preventDefault();else if(!a.ke||!a.lastInput.handled){b.preventDefault();var t=b.scale;if(null!==a.Cl){var e=a.sa.getBoundingClientRect();if(b=new Mt(b.pageX-window.scrollX-a.wa/e.width*e.left,b.pageY-window.scrollY-a.va/e.height*e.top),t=a.Cl*t,e=a.commandHandler,t!==a.scale&&e.canResetZoom(t)){var n=a.zoomPoint;a.zoomPoint=b,e.resetZoom(t),a.zoomPoint=n}}}}),!1),a.addEventListener(w,"resize",a.vw,!1))}(a)}}function Ys(a){this.l=void 0===a?new Mt:a,this.v=new Mt}function Gs(a,b,t){this.node=a,this.info=b,this.Cv=t}function Xs(){this.reset()}function qs(a){1<arguments.length&&N("Palette constructor can only take one optional argument, the DIV HTML element or its id."),Vo.call(this,a),Us(this)}function Us(a){a.allowDragOut=!0,a.allowMove=!1,a.isReadOnly=!0,a.contentAlignment=yi,a.layout=new hf}function Ks(a){1<arguments.length&&N("Overview constructor can only take one optional argument, the DIV HTML element or its id."),Vo.call(this,a);var b=this;this.animationManager.isEnabled=!1,this.Rb=!0,this.Ha=null,this.dl=this.cl=!1,this.v=this.I=!0,this.Za=0,this.Y=!1,this.Ml=null,this.ly("drawShadows",!1);var t=new lu,e=new rl;e.stroke="magenta",e.strokeWidth=2,e.fill="transparent",e.name="BOXSHAPE",t.selectable=!0,t.selectionAdorned=!1,t.selectionObjectName="BOXSHAPE",t.locationObjectName="BOXSHAPE",t.resizeObjectName="BOXSHAPE",t.cursor="move",t.add(e),this.l=t,this.allowDelete=this.allowCopy=!1,this.allowSelect=!0,this.autoScrollRegion=new hi(0,0,0,0),this.ma.h(0,0),this.toolManager.Va("Dragging",new Zs,this.toolManager.mouseMoveTools),this.click=function(){var a=b.observed;if(null!==a){var t=a.viewportBounds,e=b.lastInput.documentPoint;a.position=new Mt(e.x-t.width/2,e.y-t.height/2)}},this.Je=function(){b.Na(),Js(b)},this.Ef=function(){null!==b.observed&&(b.Na(),b.M())},this.Oh=function(){1>b.updateDelay?b.M():b.Y||(b.Y=!0,setTimeout((function(){b.Y=!1,Hs(b),b.M()}),b.updateDelay))},this.Yc=function(){null!==b.observed&&Js(b)},this.autoScale=bs,this.Rb=!1}function Hs(a){var b=a.sa,t=a.Db;if(null!==b&&null!==t){if(kr(a),null===a.Ml){var e=new Ra(null);e.width=b.width,e.height=b.height,a.Ml=e}try{a.sa=a.Ml,a.Db=a.sa.context,a.Db.sc(!0),a.Db.setTransform(1,0,0,1,0,0),a.Db.clearRect(0,0,a.sa.width,a.sa.height),Ws(a)}finally{a.sa=b,a.Db=t}}}function Ws(a){var b=a.observed;if(null!==b){var t=a.drawsTemporaryLayers,e=a.drawsGrid&&t,n=b.grid;e&&null!==n&&n.visible&&!isNaN(n.width)&&!isNaN(n.height)&&(Br(b,n=Wt.alloc().assign(a.viewportBounds).Hc(b.viewportBounds)),Wt.free(n),pr(b));var o=a.kb;o.reset(),1!==a.scale&&o.scale(a.scale),0===a.position.x&&0===a.position.y||o.translate(-a.position.x,-a.position.y),(n=a.Db).scale(a.Sb,a.Sb),n.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),o=(b=b.Ja.j).length;for(var g=0;g<o;g++){var r=b[g],h=a;if(r.visible&&0!==r.opacity){var l=r.diagram.grid.part;if(!t&&r.isTemporary)e&&l.layer===r&&(r=zo(r,n),l.bc(n,h),n.globalAlpha=r);else{for(var c=zo(r,n),f=h.scale,p=Wt.alloc(),d=r.Ca.j,q=d.length,u=0;u<q;u++){var y=d[u];(e||y!==l)&&r.Pi(n,y,h,null,f,p)}Wt.free(p),n.globalAlpha=c}}}}}function Js(a){var b=a.box;if(null!==b){var t=a.observed;if(null!==t){a.Ac=!0,t=t.viewportBounds;var e=b.selectionObject,n=qt.alloc();n.h(t.width,t.height),e.desiredSize=n,qt.free(n),a=2/a.scale,e instanceof rl&&(e.strokeWidth=a),b.location=new Mt(t.x-a/2,t.y-a/2),b.isSelected=!0}}}function Zs(){He.call(this),this.l=null}function $s(){ft(this),this.B=fs,this.Za=this.I=this.v=!0,this.Y=this.Ha=this.kd=this.Ia=!1,this.yi=this.l=null,this.Yc=1.05,this.Bu=NaN,this.Ww=null,this.cv=NaN,this.bv=ri,this.pg=null,this.Ic=200}function Qs(a){var b=I();for(a=a.iterator;a.next();){var t=a.value;t instanceof Wu||b.push(t)}a=new ct,t=b.length;for(var e=0;e<t;e++){for(var n=b[e],o=!0,g=0;g<t;g++)if(n.Xd(b[g])){o=!1;break}o&&a.add(n)}return R(b),a}function _s(){ft(this),this.F=4225027,this.qb=1,this.ng=null,this.Qa="",this.dc=this.gb=null,this.ma=new Mt(NaN,NaN).freeze(),this.Lc=Gt,this.eg=It,this.dg=Yt,this.kb=new ie,this.Qh=new ie,this.bg=new ie,this.ya=this.Wk=1,this.Yb=0,this.we=rs,this.fh=fi,this.nc=new Wt(NaN,NaN,NaN,NaN).freeze(),this.ub=new Wt(NaN,NaN,NaN,NaN).freeze(),this.oc=new Wt(0,0,NaN,NaN).freeze(),this.O=this.cp=this.ep=null,this.Fk=this.vb=zi,this.pp=0,this.qp=1,this.Og=0,this.gn=1,this.Kp=null,this.xp=-1/0,this.Hl=0,this.Il=jt,this.Jl=mc,this.fi="",this.$a=this.N=null,this.Jk=-1,this.Ll=this.md=this.ei=this.Pl=null,this.ws=ns,this.sp=this.Kg=this.Jj=null}function dl(a){null===a.N&&(a.N=new Ta)}function ta(a,b,t){var e=a.Ui();if(null!==e)for(var n=a.$a.iterator;n.next();){var o=n.value,g=null;if(null!==o.sourceName){if(null===(g=cd(o,e,a)))continue;o.Qq(a,g,t,null)}else if(o.isToModel){var r=b.diagram;null===r||r.skipsModelSourceBindings||o.Qq(a,r.model.modelData,t,e)}else{if(null===(r=e.data))continue;var h=b.diagram;null===h||h.skipsModelSourceBindings||o.Qq(a,r,t,e)}g===a&&(null!==(r=e.it(o.gj))&&o.tw(r,g,t))}}function ia(a,b,t,e,n){var o=a.nc,g=a.bg;g.reset(),sa(a,g,b,t,e,n),a.bg=g,o.h(b,t,e,n),g.ut()||g.qw(o)}function ea(a,b,t,e){return!1!==a.pickable&&(e.multiply(a.transform),t?a.Gc(b,e):a.Gh(b,e))}function ol(a,b,t,e,n){if(a.ub.h(b,t,e,n),!a.desiredSize.u()){var o=a.nc;b=(t=a.fh).right+t.left;var g=t.top+t.bottom;switch(t=o.width+b,o=o.height+g,e+=b,n+=g,b=ha(a,!0),t===e&&o===n&&(b=ns),b){case ns:(t>e||o>n)&&(ma(a,!0),a.measure(t>e?e:t,o>n?n:o,0,0));break;case es:ma(a,!0),a.measure(e,n,0,0);break;case ss:ma(a,!0),a.measure(e,o,0,0);break;case as:ma(a,!0),a.measure(t,n,0,0)}}}function na(a,b,t){var e=a.ub,n=a.oc;null!==a.dc&&(oa(a,b,a.dc,!0,!0,n,e),a.dc instanceof Ya&&a.dc.type===nh?(b.beginPath(),b.rect(e.x,e.y,e.width,e.height),b.Vd(a.dc)):b.fillRect(e.x,e.y,e.width,e.height)),null!==a.gb&&(oa(a,b,a.gb,!0,!1,n,e),a.gb instanceof Ya&&a.gb.type===nh?(b.beginPath(),b.rect(e.x,e.y,e.width,e.height),b.Vd(a.gb)):b.fillRect(e.x,e.y,e.width,e.height)),a.Qi(b,t)}function oa(a,b,t,e,n,o,g){if(null!==t){var r=1,h=1;if("string"==typeof t)e?b.fillStyle=t:b.strokeStyle=t;else if(t.type===ih)e?b.fillStyle=t.color:b.strokeStyle=t.color;else{if(r=o.width,h=o.height,n&&(r=g.width,h=g.height),(o=b instanceof Ea)&&t.de&&(t.type===oh||t.Mk===r&&t.bu===h))var l=t.de;else{var c=0,f=0,p=0,d=0,q=0,u=0;if(u=q=0,n&&(q=g.x,u=g.y),c=t.start.x*r+t.start.offsetX,f=t.start.y*h+t.start.offsetY,p=t.end.x*r+t.end.offsetX,d=t.end.y*h+t.end.offsetY,c+=q,p+=q,f+=u,d+=u,t.type===eh)l=b.createLinearGradient(c,f,p,d);else if(t.type===nh)u=isNaN(t.endRadius)?Math.max(r,h)/2:t.endRadius,isNaN(t.startRadius)?(q=0,u=Math.max(r,h)/2):q=t.startRadius,l=b.createRadialGradient(c,f,q,p,d,u);else if(t.type===oh)try{l=b.createPattern(t.pattern,"repeat")}catch(t){l=null}if(t.type!==oh&&null!==(n=t.colorStops))for(n=n.iterator;n.next();)l.addColorStop(n.key,n.value);if(o&&(t.de=l,null!==l&&(t.Mk=r,t.bu=h),null===l&&t.type===oh&&-1!==t.Mk)){t.Mk=-1;var y=a.diagram;null!==y&&-1===t.Mk&&S((function(){y.Fe()}),600)}}e?b.fillStyle=l:b.strokeStyle=l}}}function ra(a){if(0!=(2048&a.F)==!0){var b=a.kb;if(b.reset(),!a.ub.u()||!a.nc.u())return void pa(a,!1);if(b.translate(a.ub.x-a.nc.x,a.ub.y-a.nc.y),1!==a.scale||0!==a.angle){var t=a.naturalBounds;sa(a,b,t.x,t.y,t.width,t.height)}pa(a,!1),ga(a,!0)}0!=(4096&a.F)==!0&&(null===(b=a.panel)?(a.Qh.set(a.kb),a.Wk=a.scale,ga(a,!1)):null!==b.vd&&((t=a.Qh).reset(),b.ae()?t.multiply(b.Qh):null!==b.panel&&t.multiply(b.panel.Qh),t.multiply(a.kb),a.Wk=a.scale*b.Wk,ga(a,!1)))}function sa(a,b,t,e,n,o){if(1!==a.scale&&b.scale(a.scale),0!==a.Yb){var g=xi;a.yf()&&a.locationSpot.eb()&&(g=a.locationSpot);var r=Mt.alloc();if(a instanceof lu&&a.locationObject!==a)for(e=(t=a.locationObject).naturalBounds,r.xk(e.x,e.y,e.width,e.height,g),t.bg.ra(r),r.offset(-t.measuredBounds.x,-t.measuredBounds.y),g=t.panel;null!==g&&g!==a;)g.bg.ra(r),r.offset(-g.measuredBounds.x,-g.measuredBounds.y),g=g.panel;else r.xk(t,e,n,o,g);b.rotate(a.Yb,r.x,r.y),Mt.free(r)}}function aa(a){if(!1===va(a)){var b=a.panel;null!==b?b.o():a.yf()&&(null!==(b=a.diagram)&&(b.od.add(a),a instanceof Au&&a.fd(),b.Pb())),xa(a,!0)}}function ha(a,b){var t=a.stretch,e=a.panel;return null!==e&&e.type===jh.Table?la(a,e.getRowDefinition(a.row),e.getColumnDefinition(a.column),b):null!==e&&e.type===jh.Auto&&e.zb()===a?ua(a,es,b):t===rs?null!==e?e.type===jh.Spot&&e.zb()===a?ua(a,es,b):ua(a,(t=e.defaultStretch)===rs?ns:t,b):ua(a,ns,b):ua(a,t,b)}function la(a,b,t,e){var n=a.stretch;if(n!==rs)return ua(a,n,e);var o=n=null;switch(b.stretch){case as:o=!0;break;case es:o=!0}switch(t.stretch){case ss:n=!0;break;case es:n=!0}return b=a.panel.defaultStretch,null===n&&(n=b===ss||b===es),null===o&&(o=b===as||b===es),ua(a,!0===n&&!0===o?es:!0===n?ss:!0===o?as:ns,e)}function ua(a,b,t){if(t)return b;if(b===ns)return ns;if((t=a.desiredSize).u())return ns;if(a=a.angle,!isNaN(t.width))if(90!==a&&270!==a){if(b===ss)return ns;if(b===es)return as}else{if(b===as)return ns;if(b===es)return ss}if(!isNaN(t.height))if(90!==a&&270!==a){if(b===as)return ns;if(b===es)return ss}else{if(b===ss)return ns;if(b===es)return as}return b}function ca(a,b){a.F=b?512|a.F:-513&a.F}function fa(a){return 0!=(1024&a.F)}function da(a,b){a.F=b?1024|a.F:-1025&a.F}function pa(a,b){a.F=b?2048|a.F:-2049&a.F}function ga(a,b){a.F=b?4096|a.F:-4097&a.F}function ya(a){return 0!=(8192&a.F)}function ma(a,b){a.F=b?8192|a.F:-8193&a.F}function va(a){return 0!=(16384&a.F)}function xa(a,b){a.F=b?16384|a.F:-16385&a.F}function ba(a){var b=a.part;if(b instanceof Au&&(null!==a.portId||a===b.port)){var t=b.diagram;null===t||t.undoManager.isUndoingRedoing||Fu(b,a)}}function wa(a){var b=a.diagram;null===b||b.undoManager.isUndoingRedoing||(a instanceof jh?a instanceof Au?a.fd():a.Km(a,(function(a){ba(a)})):ba(a))}function ka(a,b){b.bd=a,null===a.Kg&&(a.Kg=new kt),a.Kg.add(b.propertyName,b)}function Ma(a,b){for(var t=1;t<arguments.length;++t);t=arguments;var e=null,n=null;if("function"==typeof a)n=a;else if("string"==typeof a){var o=Ca.H(a);"function"==typeof o?j(e=o(t=F(arguments)))||N('GraphObject.make invoked object builder "'+a+'", but it did not return an Object'):n=w.go[a]}if(null===e&&(null!=n&&n.constructor||N("GraphObject.make requires a class function or GoJS class name or name of an object builder, not: "+a),e=new n),n=1,e instanceof Vo&&1<t.length){o=e;var g=t[1];("string"==typeof g||g instanceof HTMLDivElement)&&(Vs(o,g),n++)}for(;n<t.length;n++)void 0===(o=t[n])?N("Undefined value at argument "+n+" for object being constructed by GraphObject.make: "+e):Sa(e,o);return e}function Sa(a,b){if("string"==typeof b)if(a instanceof ml)a.text=b;else if(a instanceof rl)a.figure=b;else if(a instanceof ql)a.source=b;else if(a instanceof jh)null!==(b=Qh.H(b))&&(a.type=b);else if(a instanceof Ya){var t=tt(Ya,b);null!==t?a.type=t:N("Unknown Brush type as an argument to GraphObject.make: "+b)}else a instanceof oe?null!==(b=tt(oe,b))&&(a.type=b):a instanceof xe&&(null!==(b=tt(xe,b))&&(a.type=b));else if(b instanceof _s)a instanceof jh||N("A GraphObject can only be added to a Panel, not to: "+a),a.add(b);else if(b instanceof _h){var e;b.isRow&&"function"==typeof a.getRowDefinition?e=a.getRowDefinition(b.index):b.isRow||"function"!=typeof a.getColumnDefinition||(e=a.getColumnDefinition(b.index)),e instanceof _h?e.et(b):N("A RowColumnDefinition can only be added to an object that implements getRowDefinition/getColumnDefinition, not to: "+a)}else if(b instanceof _)"function"==typeof a.cb&&a.cb(b);else if(b instanceof yh)a.type=b;else if(b instanceof ud)a instanceof _s||a instanceof _h?a.bind(b):N("A Binding can only be applied to a GraphObject or RowColumnDefinition, not to: "+a);else if(b instanceof Oo)a instanceof _s?ka(a,b):N("An AnimationTrigger can only be applied to a GraphObject, not to: "+a);else if(b instanceof ve)a instanceof oe?a.figures.add(b):N("A PathFigure can only be added to a Geometry, not to: "+a);else if(b instanceof xe)a instanceof ve?a.segments.add(b):N("A PathSegment can only be added to a PathFigure, not to: "+a);else if(b instanceof Zc)a instanceof Vo||a instanceof qu?a.layout=b:N("A Layout can only be assigned to a Diagram or a Group, not to: "+a);else if(Array.isArray(b))for(t=0;t<b.length;t++)Sa(a,b[t]);else if("object"==typeof b&&null!==b)if(a instanceof Ya){for(var n in t=new et,b)e=parseFloat(n),isNaN(e)?t[n]=b[n]:a.addColorStop(e,b[n]);vr(a,t)}else if(a instanceof _h){for(t in void 0!==b.row?((null==(n=b.row)||1/0===n||isNaN(n)||0>n)&&N("Must specify non-negative integer row for RowColumnDefinition "+b+", not: "+n),a.isRow=!0,a.index=n):void 0!==b.column&&((null==(n=b.column)||1/0===n||isNaN(n)||0>n)&&N("Must specify non-negative integer column for RowColumnDefinition "+b+", not: "+n),a.isRow=!1,a.index=n),n=new et,b)"row"!==t&&"column"!==t&&(n[t]=b[t]);vr(a,n)}else vr(a,b);else N('Unknown initializer "'+b+'" for object being constructed by GraphObject.make: '+a)}function Pa(a,b){Ca.add(a,b)}function Na(a,b,t){void 0===t&&(t=null);var e=a[1];if("function"==typeof t?t(e):"string"==typeof e)return a.splice(1,1),e;if(void 0===b)throw Error("no "+("function"==typeof t?"satisfactory":"string")+" argument for GraphObject builder "+a[0]);return b}Vo.className="Diagram",Vo.fromDiv=function(a){var b=a;return"string"==typeof a&&(b=w.document.getElementById(a)),b instanceof HTMLDivElement&&b.B instanceof Vo?b.B:null},Vo.inherit=function(a,b){function t(){}if(Object.getPrototypeOf(a).prototype)throw Error("Used go.Diagram.inherit defining already defined class \n"+a);t.prototype=b.prototype,a.prototype=new t,a.prototype.constructor=a},Vo.None=xs,Vo.Uniform=bs,Vo.UniformToFill=ws,Vo.CycleAll=ks,Vo.CycleNotDirected=Ms,Vo.CycleNotDirectedFast=Ss,Vo.CycleNotUndirected=Ps,Vo.CycleDestinationTree=Ns,Vo.CycleSourceTree=Cs,Vo.DocumentScroll=Ts,Vo.InfiniteScroll=Ls,Vo.TreeParentCollapsed=As,Vo.AllParentsCollapsed=js,Vo.AnyParentsCollapsed=Ds,Es.className="DiagramHelper",v.Object.defineProperties(Ys.prototype,{point:{get:function(){return this.l},set:function(a){this.l=a}},shifted:{get:function(){return this.v},set:function(a){this.v=a}}}),Ys.className="DraggingInfo",Gs.className="DraggingNodeInfoPair",Xs.prototype.reset=function(){this.isGridSnapEnabled=!1,this.isGridSnapRealtime=!0,this.gridSnapCellSize=new qt(NaN,NaN).freeze(),this.gridSnapCellSpot=gi,this.gridSnapOrigin=new Mt(NaN,NaN).freeze(),this.Nz=this.dragsTree=this.dragsLink=!1,this.Mz=!0},m(qs,Vo),qs.prototype.reset=function(){Vo.prototype.reset.call(this),Us(this)},qs.className="Palette",m(Ks,Vo),Ks.prototype.computePixelRatio=function(){return 1},Ks.prototype.bc=function(){if(null===this.La&&N("No div specified"),null===this.sa&&N("No canvas specified"),!(this.sa instanceof ja)&&(uu(this.box),this.Ac)){var a=this.observed;if(null!==a&&!a.animationManager.isAnimating){kr(this);var b=this.sa;(a=this.Db).sc(!0),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,b.width,b.height),1>this.updateDelay?Ws(this):null!==this.Ml&&(a.drawImage(this.Ml.Ea,0,0),(b=this.kb).reset(),1!==this.scale&&b.scale(this.scale),0===this.position.x&&0===this.position.y||b.translate(-this.position.x,-this.position.y),a.scale(this.Sb,this.Sb),a.transform(b.m11,b.m12,b.m21,b.m22,b.dx,b.dy));for(var t=(b=this.Ja.j).length,e=0;e<t;e++)b[e].bc(a,this);this.Ac=this.mi=!1}}},Ks.prototype.computeBounds=function(){var a=this.observed;if(null===a)return ri;var b=a.documentBounds.copy();return b.Hc(a.viewportBounds),b},Ks.prototype.Sx=function(){!0!==this.Ac&&(this.Ac=!0,this.Pb())},Ks.prototype.Bq=function(a,b,t,e){this.Rb||(wr(this),this.M(),xr(this),this.Na(),Js(this),this.Sd.scale=t,this.Sd.position.x=a.x,this.Sd.position.y=a.y,this.Sd.bounds.assign(a),this.Sd.Kv=e,this.R("ViewportBoundsChanged",this.Sd,a))},v.Object.defineProperties(Ks.prototype,{observed:{get:function(){return this.Ha},set:function(a){var b=this.Ha;if(a instanceof Ks&&N("Overview.observed Diagram may not be an Overview itself: "+a),b!==a){if(null!==b&&(this.remove(this.box),b.ym("ViewportBoundsChanged",this.Je),b.ym("DocumentBoundsChanged",this.Ef),b.ym("InvalidateDraw",this.Oh),b.ym("AnimationFinished",this.Yc)),this.Ha=a,null!==a&&(a.Uj("ViewportBoundsChanged",this.Je),a.Uj("DocumentBoundsChanged",this.Ef),a.Uj("InvalidateDraw",this.Oh),a.Uj("AnimationFinished",this.Yc),this.add(this.box),Js(this)),this.Na(),null===a){this.Ml=null;var t=this.sa,e=this.Db;t&&e&&(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height))}else Hs(this),Js(this),this.M();this.g("observed",b,a)}}},box:{get:function(){return this.l},set:function(a){var b=this.l;b!==a&&(this.l=a,this.remove(b),this.add(this.l),Js(this),this.g("box",b,a))}},drawsTemporaryLayers:{get:function(){return this.I},set:function(a){this.I!==a&&(this.I=a,this.Fe())}},drawsGrid:{get:function(){return this.v},set:function(a){this.v!==a&&(this.v=a,this.Fe())}},updateDelay:{get:function(){return this.Za},set:function(a){0>a&&(a=0),this.Za!==a&&(this.Za=a)}}}),Ks.className="Overview",m(Zs,He),Zs.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(null===a||!a.allowMove||!a.allowSelect)return!1;var b=a.observed;if(null===b)return!1;var t=a.lastInput;return!(!t.left||a.currentTool!==this&&(!this.isBeyondDragSize()||t.isTouchEvent&&t.timestamp-a.firstInput.timestamp<this.delay))&&(null===this.findDraggablePart()&&(t=b.viewportBounds,this.l=new Mt(t.width/2,t.height/2),a=a.firstInput.documentPoint,b.position=new Mt(a.x-this.l.x,a.y-this.l.y)),!0)},Zs.prototype.doActivate=function(){this.l=null,He.prototype.doActivate.call(this)},Zs.prototype.doUpdateCursor=function(){var a=this.diagram,b=a.box;null!==b&&b.cursor&&(a.currentCursor=b.cursor)},Zs.prototype.moveParts=function(){var a=this.diagram,b=a.observed;if(null!==b){var t=a.box;if(null!==t){if(null===this.l){var e=a.firstInput.documentPoint;t=t.location,this.l=new Mt(e.x-t.x,e.y-t.y)}a=a.lastInput.documentPoint,b.position=new Mt(a.x-this.l.x,a.y-this.l.y)}}},Zs.className="OverviewDraggingTool",$s.prototype.toString=function(){return"CommandHandler"},$s.prototype.Zd=function(a){this.B=a},$s.prototype.doKeyDown=function(){var a=this.diagram,b=a.lastInput,t=J?b.meta:b.control,e=b.shift,n=b.alt,o=b.key;!t||"C"!==o&&"Insert"!==o?t&&"X"===o||e&&"Del"===o?this.canCutSelection()&&this.cutSelection():t&&"V"===o||e&&"Insert"===o?this.canPasteSelection()&&this.pasteSelection():t&&"Y"===o||n&&e&&"Backspace"===o?this.canRedo()&&this.redo():t&&"Z"===o||n&&"Backspace"===o?this.canUndo()&&this.undo():"Del"===o||"Backspace"===o?this.canDeleteSelection()&&this.deleteSelection():t&&"A"===o?this.canSelectAll()&&this.selectAll():"Esc"===o?this.canStopCommand()&&this.stopCommand():"Up"===o?a.allowVerticalScroll&&(t?a.scroll("pixel","up"):a.scroll("line","up")):"Down"===o?a.allowVerticalScroll&&(t?a.scroll("pixel","down"):a.scroll("line","down")):"Left"===o?a.allowHorizontalScroll&&(t?a.scroll("pixel","left"):a.scroll("line","left")):"Right"===o?a.allowHorizontalScroll&&(t?a.scroll("pixel","right"):a.scroll("line","right")):"PageUp"===o?e&&a.allowHorizontalScroll?a.scroll("page","left"):a.allowVerticalScroll&&a.scroll("page","up"):"PageDown"===o?e&&a.allowHorizontalScroll?a.scroll("page","right"):a.allowVerticalScroll&&a.scroll("page","down"):"Home"===o?t&&a.allowVerticalScroll?a.scroll("document","up"):!t&&a.allowHorizontalScroll&&a.scroll("document","left"):"End"===o?t&&a.allowVerticalScroll?a.scroll("document","down"):!t&&a.allowHorizontalScroll&&a.scroll("document","right"):" "===o?this.canScrollToPart()&&this.scrollToPart():"Subtract"===o?this.canDecreaseZoom()&&this.decreaseZoom():"Add"===o?this.canIncreaseZoom()&&this.increaseZoom():t&&"0"===o?this.canResetZoom()&&this.resetZoom():e&&"Z"===o?this.canZoomToFit()&&this.zoomToFit():t&&!e&&"G"===o?this.canGroupSelection()&&this.groupSelection():t&&e&&"G"===o?this.canUngroupSelection()&&this.ungroupSelection():b.event&&113===b.event.which?this.canEditTextBlock()&&this.editTextBlock():b.event&&93===b.event.which?this.canShowContextMenu()&&this.showContextMenu():b.bubbles=!0:this.canCopySelection()&&this.copySelection()},$s.prototype.doKeyUp=function(){this.diagram.lastInput.bubbles=!0},$s.prototype.stopCommand=function(){var a=this.diagram,b=a.currentTool;b instanceof ze&&a.allowSelect&&a.clearSelection(),null!==b&&b.doCancel()},$s.prototype.canStopCommand=function(){return!0},$s.prototype.selectAll=function(){var a=this.diagram;a.M();try{a.currentCursor="wait",a.R("ChangingSelection",a.selection);for(var b=a.parts;b.next();)b.value.isSelected=!0;for(var t=a.nodes;t.next();)t.value.isSelected=!0;for(var e=a.links;e.next();)e.value.isSelected=!0}finally{a.R("ChangedSelection",a.selection),a.currentCursor=""}},$s.prototype.canSelectAll=function(){return this.diagram.allowSelect},$s.prototype.deleteSelection=function(){var a=this.diagram;try{a.currentCursor="wait",a.R("ChangingSelection",a.selection),a.ua("Delete"),a.R("SelectionDeleting",a.selection);for(var b=new ct,t=a.selection.iterator;t.next();)Cu(b,t.value,!0,this.deletesTree?1/0:0,!!this.deletesConnectedLinks&&null,(function(a){return a.canDelete()}));a.Jt(b,!0),a.R("SelectionDeleted",b)}finally{a.Ua("Delete"),a.R("ChangedSelection",a.selection),a.currentCursor=""}},$s.prototype.canDeleteSelection=function(){var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowDelete||0===a.selection.count)},$s.prototype.copySelection=function(){var a=this.diagram,b=new ct;for(a=a.selection.iterator;a.next();)Cu(b,a.value,!0,this.copiesTree?1/0:0,this.copiesConnectedLinks,(function(a){return a.canCopy()}));this.copyToClipboard(b)},$s.prototype.canCopySelection=function(){var a=this.diagram;return!(!a.allowCopy||!a.allowClipboard||0===a.selection.count)},$s.prototype.cutSelection=function(){this.copySelection(),this.deleteSelection()},$s.prototype.canCutSelection=function(){var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowCopy||!a.allowDelete||!a.allowClipboard||0===a.selection.count)},$s.prototype.copyToClipboard=function(a){var b=this.diagram,t=null;if(null===a)ms=null,vs="";else{t=b.model;var e=!1,n=!1,o=null;try{t.qm()&&(e=t.bk,t.bk=this.copiesParentKey),t.ik()&&(n=t.ak,t.ak=this.copiesGroupKey),o=b.ck(a,null,!0)}finally{t.qm()&&(t.bk=e),t.ik()&&(t.ak=n),(t=new lt).addAll(o),ms=t,vs=b.model.dataFormat}}b.R("ClipboardChanged",t)},$s.prototype.pasteFromClipboard=function(){var a=new ct,b=ms;if(null===b)return a;var t=this.diagram;if(vs!==t.model.dataFormat)return a;var e=t.model,n=!1,o=!1,g=null;try{e.qm()&&(n=e.bk,e.bk=this.copiesParentKey),e.ik()&&(o=e.ak,e.ak=this.copiesGroupKey),g=t.ck(b,t,!1)}finally{for(e.qm()&&(e.bk=n),e.ik()&&(e.ak=o),b=g.iterator;b.next();)t=b.value,e=b.key,t.location.u()||(e.location.u()?t.location=e.location:!t.position.u()&&e.position.u()&&(t.position=e.position)),a.add(t)}return a},$s.prototype.pasteSelection=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.currentCursor="wait",b.R("ChangingSelection",b.selection),b.ua("Paste");var t=this.pasteFromClipboard();0<t.count&&b.clearSelection(!0);for(var e=t.iterator;e.next();)e.value.isSelected=!0;if(null!==a){var n=b.computePartsBounds(b.selection);if(n.u())Cr(b,this.computeEffectiveCollection(b.selection,b.Qk),new Mt(a.x-n.centerX,a.y-n.centerY),b.Qk,!1)}b.R("ClipboardPasted",t)}finally{b.Ua("Paste"),b.R("ChangedSelection",b.selection),b.currentCursor=""}},$s.prototype.canPasteSelection=function(){var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.allowClipboard||null===ms||0===ms.count||vs!==a.model.dataFormat)},$s.prototype.undo=function(){this.diagram.undoManager.undo()},$s.prototype.canUndo=function(){var a=this.diagram;return!a.isReadOnly&&!a.isModelReadOnly&&(a.allowUndo&&a.undoManager.canUndo())},$s.prototype.redo=function(){this.diagram.undoManager.redo()},$s.prototype.canRedo=function(){var a=this.diagram;return!a.isReadOnly&&!a.isModelReadOnly&&(a.allowUndo&&a.undoManager.canRedo())},$s.prototype.decreaseZoom=function(a){void 0===a&&(a=1/this.zoomFactor);var b=this.diagram;b.autoScale===xs&&((a=b.scale*a)<b.minScale||a>b.maxScale||(b.scale=a))},$s.prototype.canDecreaseZoom=function(a){void 0===a&&(a=1/this.zoomFactor);var b=this.diagram;return b.autoScale===xs&&(!((a=b.scale*a)<b.minScale||a>b.maxScale)&&b.allowZoom)},$s.prototype.increaseZoom=function(a){void 0===a&&(a=this.zoomFactor);var b=this.diagram;b.autoScale===xs&&((a=b.scale*a)<b.minScale||a>b.maxScale||(b.scale=a))},$s.prototype.canIncreaseZoom=function(a){void 0===a&&(a=this.zoomFactor);var b=this.diagram;return b.autoScale===xs&&(!((a=b.scale*a)<b.minScale||a>b.maxScale)&&b.allowZoom)},$s.prototype.resetZoom=function(a){void 0===a&&(a=this.defaultScale);var b=this.diagram;a<b.minScale||a>b.maxScale||(b.scale=a)},$s.prototype.canResetZoom=function(a){void 0===a&&(a=this.defaultScale);var b=this.diagram;return!(a<b.minScale||a>b.maxScale)&&b.allowZoom},$s.prototype.zoomToFit=function(){var a=this.diagram,b=a.animationManager;b.Xc(),a.Fe();var t=a.position,e=a.scale;uo(b,"Zoom To Fit"),e===this.cv&&!isNaN(this.Bu)&&a.documentBounds.w(this.bv)?(a.scale=this.Bu,a.position=this.Ww,this.cv=NaN,this.bv=ri):(this.Bu=e,this.Ww=t.copy(),a.zoomToFit(),this.cv=a.scale,this.bv=a.documentBounds.copy()),fo(b)},$s.prototype.canZoomToFit=function(){return this.diagram.allowZoom},$s.prototype.scrollToPart=function(a){void 0===a&&(a=null);var b=this.diagram;if(Yr(b),null===a){try{null!==this.pg&&(this.pg.next()?a=this.pg.value:this.pg=null)}catch(t){this.pg=null}null===a&&(0<b.highlighteds.count?this.pg=b.highlighteds.iterator:0<b.selection.count&&(this.pg=b.selection.iterator),null!==this.pg&&this.pg.next()&&(a=this.pg.value))}if(null!==a){var t=b.animationManager;uo(t,"Scroll To Part");var e=this.scrollToPartPause;if(0<e){var n=function t(a,b,e){if(b.isVisible())return e;if(b instanceof Lu)t(a,b.adornedPart,e);else if(b instanceof Wu){var n=b.fromNode;null!==n&&t(a,n,e),null!==(b=b.toNode)&&t(a,b,e)}else b instanceof Au&&(null!==(n=b.labeledLink)&&t(a,n,e),null!==(n=b.Bg())&&(n.isTreeExpanded||n.wasTreeExpanded||e.push(n),t(a,n,e))),null!==(b=b.containingGroup)&&(b.isSubGraphExpanded||b.wasSubGraphExpanded||e.push(b),t(a,b,e));return e}(this,a,[a]);if(1===n.length)b.ua(),b.ct(a.actualBounds),b.Ua("Scroll To Part");else{var o=function(){b.ua();for(var a=n.pop();0<n.length&&a instanceof Au&&a.isTreeExpanded&&(!(a instanceof qu)||a.isSubGraphExpanded);)a=n.pop();0<n.length?(a instanceof lu&&b.dw(a.actualBounds),a instanceof Au&&!a.isTreeExpanded&&(a.isTreeExpanded=!0),a instanceof qu&&!a.isSubGraphExpanded&&(a.isSubGraphExpanded=!0)):(a instanceof lu&&b.ct(a.actualBounds),b.ym("LayoutCompleted",g)),b.Ua("Scroll To Part")},g=function(){S(o,(t.isEnabled?t.duration:0)+e)};b.Uj("LayoutCompleted",g),o()}}else{var r=b.position.copy();b.ct(a.actualBounds),r.Ma(b.position)&&t.Xc()}}},$s.prototype.canScrollToPart=function(a){return void 0===a&&(a=null),(null===a||a instanceof lu)&&((0!==(a=this.diagram).selection.count||0!==a.highlighteds.count)&&(a.allowHorizontalScroll&&a.allowVerticalScroll))},$s.prototype.collapseTree=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.ua("Collapse Tree"),uo(b.animationManager,"Collapse Tree");var t=new lt;if(null!==a&&a.isTreeExpanded)a.collapseTree(),t.add(a);else if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof Au&&n.isTreeExpanded&&(n.collapseTree(),t.add(n))}b.R("TreeCollapsed",t)}finally{b.Ua("Collapse Tree")}},$s.prototype.canCollapseTree=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a){if(!(a instanceof Au&&a.isTreeExpanded))return!1;if(0<a.nq().count)return!0}else for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof Au&&b.isTreeExpanded&&0<b.nq().count)return!0;return!1},$s.prototype.expandTree=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.ua("Expand Tree"),uo(b.animationManager,"Expand Tree");var t=new lt;if(null===a||a.isTreeExpanded){if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof Au&&!n.isTreeExpanded&&(n.expandTree(),t.add(n))}}else a.expandTree(),t.add(a);b.R("TreeExpanded",t)}finally{b.Ua("Expand Tree")}},$s.prototype.canExpandTree=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a){if(!(a instanceof Au)||a.isTreeExpanded)return!1;if(0<a.nq().count)return!0}else for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof Au&&!b.isTreeExpanded&&0<b.nq().count)return!0;return!1},$s.prototype.groupSelection=function(){var a=this.diagram,b=a.model;if(b.jk()){var t=this.archetypeGroupData;if(null!==t){var e=null;try{a.currentCursor="wait",a.R("ChangingSelection",a.selection),a.ua("Group");for(var n=new lt,o=a.selection.iterator;o.next();){var g=o.value;g.Wb()&&g.canGroup()&&n.add(g)}for(var r=new lt,h=n.iterator;h.next();){var l=h.value;o=!1;for(var c=n.iterator;c.next();)if(l.Xd(c.value)){o=!0;break}o||r.add(l)}if(0<r.count){var f=r.first().containingGroup;if(null!==f)for(;null!==f;){n=!1;for(var p=r.iterator;p.next();)if(!p.value.Xd(f)){n=!0;break}if(!n)break;f=f.containingGroup}if(t instanceof qu)qh(t),null!==(e=t.copy())&&a.add(e);else if(b.Iv(t)){var d=b.copyNodeData(t);j(d)&&(b.qf(d),e=a.Si(d))}if(null!==e){null!==f&&this.isValidMember(f,e)&&(e.containingGroup=f);for(var q=r.iterator;q.next();){var u=q.value;this.isValidMember(e,u)&&(u.containingGroup=e)}a.clearSelection(!0),e.isSelected=!0}}a.R("SelectionGrouped",e)}finally{a.Ua("Group"),a.R("ChangedSelection",a.selection),a.currentCursor=""}}}},$s.prototype.canGroupSelection=function(){var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.allowGroup||!a.model.jk()||null===this.archetypeGroupData)return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.Wb()&&b.canGroup())return!0}return!1},$s.prototype.isValidMember=function(a,b){if(null===b||a===b||b instanceof Wu)return!1;if(null!==a){if(a===b||a.Xd(b))return!1;var t=a.memberValidation;if(null!==t&&!t(a,b)||null===a.data&&null!==b.data||null!==a.data&&null===b.data)return!1}return null===(t=this.memberValidation)||t(a,b)},$s.prototype.ungroupSelection=function(a){void 0===a&&(a=null);var b=this.diagram,t=b.model;if(t.jk())try{b.currentCursor="wait",b.R("ChangingSelection",b.selection),b.ua("Ungroup");var e=new lt;if(null!==a)e.add(a);else for(var n=b.selection.iterator;n.next();){var o=n.value;o instanceof qu&&o.canUngroup()&&e.add(o)}var g=new lt;if(0<e.count){b.clearSelection(!0);for(var r=e.iterator;r.next();){var h=r.value;h.expandSubGraph();var l=h.containingGroup,c=null!==l&&null!==l.data?t.ja(l.data):void 0;g.addAll(h.memberParts);for(var f=g.iterator;f.next();){var p=f.value;if(p.isSelected=!0,!(p instanceof Wu)){var d=p.data;null!==d?t.Mt(d,c):p.containingGroup=l}}b.remove(h)}}b.R("SelectionUngrouped",e,g)}finally{b.Ua("Ungroup"),b.R("ChangedSelection",b.selection),b.currentCursor=""}},$s.prototype.canUngroupSelection=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly||b.isModelReadOnly||!b.allowDelete||!b.allowUngroup||!b.model.jk())return!1;if(null!==a){if(!(a instanceof qu))return!1;if(a.canUngroup())return!0}else for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof qu&&b.canUngroup())return!0;return!1},$s.prototype.addTopLevelParts=function(a,b){var t=!0;for(a=Qs(a).iterator;a.next();){var e=a.value;null!==e.containingGroup&&(!b||this.isValidMember(null,e)?e.containingGroup=null:t=!1)}return t},$s.prototype.collapseSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.ua("Collapse SubGraph"),uo(b.animationManager,"Collapse SubGraph");var t=new lt;if(null!==a&&a.isSubGraphExpanded)a.collapseSubGraph(),t.add(a);else if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof qu&&n.isSubGraphExpanded&&(n.collapseSubGraph(),t.add(n))}b.R("SubGraphCollapsed",t)}finally{b.Ua("Collapse SubGraph")}},$s.prototype.canCollapseSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a)return!!(a instanceof qu&&a.isSubGraphExpanded);for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof qu&&b.isSubGraphExpanded)return!0;return!1},$s.prototype.expandSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.ua("Expand SubGraph"),uo(b.animationManager,"Expand SubGraph");var t=new lt;if(null===a||a.isSubGraphExpanded){if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof qu&&!n.isSubGraphExpanded&&(n.expandSubGraph(),t.add(n))}}else a.expandSubGraph(),t.add(a);b.R("SubGraphExpanded",t)}finally{b.Ua("Expand SubGraph")}},$s.prototype.canExpandSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a)return a instanceof qu&&!a.isSubGraphExpanded;for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof qu&&!b.isSubGraphExpanded)return!0;return!1},$s.prototype.editTextBlock=function(a){void 0===a&&(a=null);var b=this.diagram,t=b.toolManager.findTool("TextEditing");if(null!==t){if(null===a){a=null;for(var e=b.selection.iterator;e.next();){var n=e.value;if(n.canEdit()){a=n;break}}if(null===a)return;a=a.hm((function(a){return a instanceof ml&&a.editable}))}null!==a&&(b.currentTool=null,t.textBlock=a,b.currentTool=t)}},$s.prototype.canEditTextBlock=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly||b.isModelReadOnly||!b.allowTextEdit||null===b.toolManager.findTool("TextEditing"))return!1;if(null!==a){if(!(a instanceof ml))return!1;if(null!==(a=a.part)&&a.canEdit())return!0}else for(b=b.selection.iterator;b.next();)if((a=b.value).canEdit()&&null!==(a=a.hm((function(a){return a instanceof ml&&a.editable}))))return!0;return!1},$s.prototype.showContextMenu=function(a){var b=this.diagram,t=b.toolManager.findTool("ContextMenu");if(null!==t&&(void 0===a&&(a=0<b.selection.count?b.selection.first():b),null!==(a=t.findObjectWithContextMenu(a)))){var e=b.lastInput,n=null;a instanceof _s?n=a.ga(xi):b.viewportBounds.aa(e.documentPoint)||(n=new Mt((n=b.viewportBounds).x+n.width/2,n.y+n.height/2)),null!==n&&(e.viewPoint=b.Nq(n),e.documentPoint=n,e.left=!1,e.right=!0,e.up=!0),b.currentTool=t,Gn(t,!1,a)}},$s.prototype.canShowContextMenu=function(a){var b=this.diagram,t=b.toolManager.findTool("ContextMenu");return null!==t&&(void 0===a&&(a=0<b.selection.count?b.selection.first():b),null!==t.findObjectWithContextMenu(a))},$s.prototype.computeEffectiveCollection=function(a,b){var t=this.diagram,e=t.toolManager.findTool("Dragging"),n=t.currentTool===e;if(void 0===b&&(b=n?e.dragOptions:t.Qk),e=new kt,null===a)return e;for(var o=a.iterator;o.next();)Nr(t,e,o.value,n,b);if(null!==t.draggedLink&&b.dragsLink)return e;for(o=a.iterator;o.next();)(a=o.value)instanceof Wu&&(null===(b=a.fromNode)||e.contains(b)?null===(b=a.toNode)||e.contains(b)||e.remove(a):e.remove(a));return e},v.Object.defineProperties($s.prototype,{diagram:{get:function(){return this.B}},copiesClipboardData:{get:function(){return this.v},set:function(a){this.v=a}},copiesConnectedLinks:{get:function(){return this.I},set:function(a){this.I=a}},deletesConnectedLinks:{get:function(){return this.Za},set:function(a){this.Za=a}},copiesTree:{get:function(){return this.Ia},set:function(a){this.Ia=a}},deletesTree:{get:function(){return this.kd},set:function(a){this.kd=a}},copiesParentKey:{get:function(){return this.Ha},set:function(a){this.Ha=a}},copiesGroupKey:{get:function(){return this.Y},set:function(a){this.Y=a}},archetypeGroupData:{get:function(){return this.l},set:function(a){this.l=a}},memberValidation:{get:function(){return this.yi},set:function(a){this.yi=a}},defaultScale:{get:function(){return this.diagram.defaultScale},set:function(a){this.diagram.defaultScale=a}},zoomFactor:{get:function(){return this.Yc},set:function(a){1<a||N("zoomFactor must be larger than 1.0, not: "+a),this.Yc=a}},scrollToPartPause:{get:function(){return this.Ic},set:function(a){this.Ic=a}}}),$s.className="CommandHandler",Go=function(){return new $s},_s.prototype.cloneProtected=function(a){a.F=6144|this.F,a.qb=this.qb,a.Qa=this.Qa,a.gb=this.gb,a.dc=this.dc,a.Kg=this.Kg,a.ma.assign(this.ma),a.Lc=this.Lc.G(),a.eg=this.eg.G(),a.dg=this.dg.G(),a.bg=this.bg.copy(),a.ya=this.ya,a.Yb=this.Yb,a.we=this.we,a.fh=this.fh.G(),a.nc.assign(this.nc),a.ub.assign(this.ub),a.oc.assign(this.oc),a.cp=this.cp,null!==this.O&&(a.O=this.O.copy()),a.vb=this.vb.G(),a.Fk=this.Fk.G(),a.pp=this.pp,a.qp=this.qp,a.Og=this.Og,a.gn=this.gn,a.Kp=this.Kp,a.xp=this.xp,a.Hl=this.Hl,a.Il=this.Il.G(),a.Jl=this.Jl,a.fi=this.fi,null!==this.N&&(a.N=this.N.copy()),a.$a=this.$a,a.Jk=this.Jk,null!==this.ei&&(a.ei=F(this.ei)),null!==this.md&&(a.md=this.md.copy()),a.Ll=this.Ll},_s.prototype.sx=function(a){var b=this.ei;if(D(b)){for(var t=0;t<b.length;t++)if(b[t]===a)return}else this.ei=b=[];b.push(a)},_s.prototype.tf=function(a){a.ep=null,a.Jj=null,a.o()},_s.prototype.clone=function(){var a=new this.constructor;if(this.cloneProtected(a),null!==this.ei)for(var b=0;b<this.ei.length;b++){var t=this.ei[b];a[t]=this[t]}return a},_s.prototype.copy=function(){return this.clone()},(n=_s.prototype).cb=function(a){a.classType===Wu?0===a.name.indexOf("Orient")?this.segmentOrientation=a:N("Unknown Link enum value for GraphObject.segmentOrientation property: "+a):a.classType===_s&&(this.stretch=a)},n.toString=function(){return E(this.constructor)+"#"+gt(this)},n.Ec=function(){if(null===this.O){var a=new Jc;a.Yg=pi,a.yh=pi,a.Wg=10,a.wh=10,a.Xg=0,a.xh=0,this.O=a}},n.Ya=function(a,b,t,e,n,o,g){var r=this.part;if(null!==r&&(r.vk(a,b,t,e,n,o,g),t===this&&a===De&&fa(this)&&ta(this,r,b),o=this.diagram,null===this.Kg||null===o||!o.kk||o.undoManager.isUndoingRedoing||o.currentTool!==o.toolManager||o.animationManager.bn||(null===(a=this.Kg.get(b))||o.animationManager.isTicking||(null===this.sp&&(this.sp=new kt),g=0===o.undoManager.transactionLevel,a.startCondition===Io?g=!0:a.startCondition===Ro&&(g=!1),g?(function(a,b){null!==(a=a.Hk)&&(a.duration&&(b.duration=a.duration),a.finished&&(b.finished=a.finished),a.easing&&(b.easing=a.easing))}(a,o=new Po),null!==(g=this.sp.get(a))&&g.stop(),this.sp.add(a,o),o.Yu=this,o.nx=a,o.add(this,b,e,n),o.start()):(co(o.animationManager,"Trigger"),o.animationManager.defaultAnimation.add(this,b,e,n)))),this instanceof jh&&t===r&&0!=(16777216&r.F)&&null!==r.data))for(e=(t=this.W.j).length,n=0;n<e;n++)(r=t[n])instanceof jh&&Rh(r,(function(a){null!==a.data&&0!=(16777216&a.F)&&a.Ba(b)}))},n.it=function(a){return this.Jk===a?this:null},n.g=function(a,b,t){this.Ya(De,a,this,b,t)},n.Lx=function(a,b,t){if(!1===this.pickable)return!1;var e=this.naturalBounds;return b=a.Be(b),t?Tt(a.x,a.y,0,0,0,e.height)<=b||Tt(a.x,a.y,0,e.height,e.width,e.height)<=b||Tt(a.x,a.y,e.width,e.height,e.width,0)<=b||Tt(a.x,a.y,e.width,0,0,0)<=b:a.dd(0,0)<=b&&a.dd(0,e.height)<=b&&a.dd(e.width,0)<=b&&a.dd(e.width,e.height)<=b},n.ae=function(){return!0},n.aa=function(a){var b=Mt.alloc();b.assign(a),this.transform.ra(b);var t=this.actualBounds;if(!t.u())return Mt.free(b),!1;var e=this.diagram;if(null!==e&&e.ke){var n=e.mm("extraTouchThreshold"),o=e.mm("extraTouchArea"),g=o/2,r=this.naturalBounds,h=1/(e=this.vf()*e.scale);if(r.width*e<n&&r.height*e<n)return a=ni(t.x-g*h,t.y-g*h,t.width+o*h,t.height+o*h,b.x,b.y),Mt.free(b),a}return n=!1,(this instanceof Lu||this instanceof rl?ni(t.x-5,t.y-5,t.width+10,t.height+10,b.x,b.y):t.aa(b))&&(n=!(this.md&&!this.md.aa(b))&&(!(null===this.dc||!t.aa(b))||(!(null===this.gb||!this.oc.aa(a))||this.Hh(a)))),Mt.free(b),n},n.Hh=function(a){var b=this.naturalBounds;return ni(0,0,b.width,b.height,a.x,a.y)},n.Ae=function(a){if(0===this.angle)return this.actualBounds.Ae(a);var b=this.naturalBounds;b=Wt.allocAt(0,0,b.width,b.height);var t=this.transform,e=!1,n=Mt.allocAt(a.x,a.y);return b.aa(t.Wd(n))&&(n.h(a.x,a.bottom),b.aa(t.Wd(n))&&(n.h(a.right,a.bottom),b.aa(t.Wd(n))&&(n.h(a.right,a.y),b.aa(t.Wd(n))&&(e=!0)))),Mt.free(n),Wt.free(b),e},n.Gh=function(a,b){if(void 0===b)return a.Ae(this.actualBounds);var t=this.naturalBounds,e=!1,n=Mt.allocAt(0,0);return a.aa(b.ra(n))&&(n.h(0,t.height),a.aa(b.ra(n))&&(n.h(t.width,t.height),a.aa(b.ra(n))&&(n.h(t.width,0),a.aa(b.ra(n))&&(e=!0)))),Mt.free(n),e},n.Gc=function(a,b){if(void 0===b&&(b=this.transform,0===this.angle))return a.Gc(this.actualBounds);var t=this.naturalBounds,e=Mt.allocAt(0,0),n=Mt.allocAt(0,t.height),o=Mt.allocAt(t.width,t.height),g=Mt.allocAt(t.width,0),r=!1;if(a.aa(b.ra(e))||a.aa(b.ra(n))||a.aa(b.ra(o))||a.aa(b.ra(g)))r=!0;else{t=Wt.allocAt(0,0,t.width,t.height);var h=Mt.allocAt(a.x,a.y);t.aa(b.Wd(h))?r=!0:(h.h(a.x,a.bottom),t.aa(b.Wd(h))?r=!0:(h.h(a.right,a.bottom),t.aa(b.Wd(h))?r=!0:(h.h(a.right,a.y),t.aa(b.Wd(h))&&(r=!0)))),Mt.free(h),Wt.free(t),!r&&(ne.rt(a,e,n)||ne.rt(a,n,o)||ne.rt(a,o,g)||ne.rt(a,g,e))&&(r=!0)}return Mt.free(e),Mt.free(n),Mt.free(o),Mt.free(g),r},n.ga=function(a,b){if(void 0===b&&(b=new Mt),a instanceof Zi){var t=this.naturalBounds;b.h(a.x*t.width+a.offsetX,a.y*t.height+a.offsetY)}else b.set(a);return this.vd.ra(b),b},n.lm=function(a){void 0===a&&(a=new Wt);var b=this.naturalBounds,t=this.vd,e=Mt.allocAt(0,0).transform(t);return a.h(e.x,e.y,0,0),e.h(b.width,0).transform(t),ei(a,e.x,e.y,0,0),e.h(b.width,b.height).transform(t),ei(a,e.x,e.y,0,0),e.h(0,b.height).transform(t),ei(a,e.x,e.y,0,0),Mt.free(e),a},n.Xi=function(){var a=this.vd;return 1===a.m11&&0===a.m12?a=0:0>(a=180*Math.atan2(a.m12,a.m11)/Math.PI)&&(a+=360),a},n.vf=function(){if(0!=(4096&this.F)==!1)return this.Wk;var a=this.ya;return null!==this.panel?a*this.panel.vf():a},n.ot=function(a,b){return void 0===b&&(b=new Mt),b.assign(a),this.vd.Wd(b),b},n.Uc=function(a,b,t){return this.hk(a.x,a.y,b.x,b.y,t)},n.hk=function(a,b,t,e,n){var o=this.transform,g=1/(o.m11*o.m22-o.m12*o.m21),r=o.m22*g,h=-o.m12*g,l=-o.m21*g,c=o.m11*g,f=g*(o.m21*o.dy-o.m22*o.dx),p=g*(o.m12*o.dx-o.m11*o.dy);return null!==this.areaBackground?(o=this.actualBounds,ne.Uc(o.left,o.top,o.right,o.bottom,a,b,t,e,n)):(g=a*r+b*l+f,a=a*h+b*c+p,b=t*r+e*l+f,t=t*h+e*c+p,n.h(0,0),e=this.naturalBounds,t=ne.Uc(0,0,e.width,e.height,g,a,b,t,n),n.transform(o),t)},_s.prototype.measure=function(a,b,t,e){if(!1!==ya(this)){var n=this.fh,o=n.right+n.left;n=n.top+n.bottom,a=Math.max(a-o,0),b=Math.max(b-n,0),t=Math.max((t||0)-o,0),e=Math.max((e||0)-n,0),o=this.angle,n=this.desiredSize;var g=0;this instanceof rl&&(g=this.strokeWidth),90===o||270===o?(a=isFinite(n.height)?n.height+g:a,b=isFinite(n.width)?n.width+g:b):(a=isFinite(n.width)?n.width+g:a,b=isFinite(n.height)?n.height+g:b),n=t||0,g=e||0;var r=this instanceof jh;switch(ha(this,!0)){case ns:g=n=0,r&&(b=a=1/0);break;case es:isFinite(a)&&a>t&&(n=a),isFinite(b)&&b>e&&(g=b);break;case ss:isFinite(a)&&a>t&&(n=a),g=0,r&&(b=1/0);break;case as:isFinite(b)&&b>e&&(g=b),n=0,r&&(a=1/0)}r=this.maxSize;var h=this.minSize;n>r.width&&h.width<r.width&&(n=r.width),g>r.height&&h.height<r.height&&(g=r.height),t=Math.max(n/this.scale,h.width),e=Math.max(g/this.scale,h.height),r.width<t&&(t=Math.min(h.width,t)),r.height<e&&(e=Math.min(h.height,e)),a=Math.min(r.width,a),b=Math.min(r.height,b),a=Math.max(t,a),b=Math.max(e,b),90!==o&&270!==o||(o=a,a=b,b=o,o=t,t=e,e=o),this.nc.ea(),this.sm(a,b,t,e),this.nc.freeze(),this.nc.u()||N("Non-real measuredBounds has been set. Object "+this+", measuredBounds: "+this.nc.toString()),ma(this,!1)}},_s.prototype.sm=function(){},_s.prototype.yf=function(){return!1},_s.prototype.arrange=function(a,b,t,e,n){this.ml();var o=Wt.alloc();o.assign(this.ub),this.ub.ea(),!1===va(this)?this.ub.h(a,b,t,e):this.Fh(a,b,t,e),this.ub.freeze(),this.md=void 0===n?null:n,t=!1,void 0!==n?t=!0:(null===(n=this.panel)||n.type!==jh.TableRow&&n.type!==jh.TableColumn||(n=n.panel),null!==n&&(n=n.oc,e=this.measuredBounds,null!==this.areaBackground&&(e=this.ub),t=b+e.height,e=a+e.width,t=!(0<=a+.05&&e<=n.width+.05&&0<=b+.05&&t<=n.height+.05),this instanceof ml&&(a=this.naturalBounds,this.$r>a.height||this.pb>a.width))&&(t=!0)),this.F=t?256|this.F:-257&this.F,this.ub.u()||N("Non-real actualBounds has been set. Object "+this+", actualBounds: "+this.ub.toString()),this.Et(o,this.ub),xa(this,!1),Wt.free(o)},(n=_s.prototype).Fh=function(){},n.Et=function(a,b){var t=this.part;null!==t&&null!==t.diagram&&(t.selectionObject!==this&&t.resizeObject!==this&&t.rotateObject!==this||Mu(t,!0),this.M(),Qt(a,b)||(t.Jh(),this.To(t)))},n.To=function(a){null!==this.portId&&(Mu(a,!0),a instanceof Au&&Fu(a,this))},n.bc=function(a,b){if(this.visible){var t=this instanceof jh&&(this.type===jh.TableRow||this.type===jh.TableColumn),e=this.ub;if(t||0!==e.width&&0!==e.height&&!isNaN(e.x)&&!isNaN(e.y)){var n=this.opacity;if(0!==n){var o=1;if(1!==n&&(o=a.globalAlpha,a.globalAlpha=o*n),!this.Gx(a,b))if(t)na(this,a,b);else{this instanceof Wu&&this.nk(!1),t=this.transform;var g=this.panel;0!=(4096&this.F)==!0&&ra(this);var r=this.part,h=!1,l=0;if(r&&b.Ce("drawShadows")&&(h=r.isShadowed)){var c=r.shadowOffset;l=Math.max(c.y,c.x)*b.scale*b.Sb}if(!(c=b.ni||!this.yf())){var f,d=this.naturalBounds,p=(c=this.Qh).m11,y=c.m21,q=c.dx,u=c.m12,m=c.m22,v=c.dy,x=f=0;c=f*p+x*y+q;var w=f*u+x*m+v,k=(f=d.width+l)*p+(x=0)*y+q;f=f*u+x*m+v,x=Math.min(c,k);var M=Math.min(w,f),S=Math.max(c+0,k)-x,P=Math.max(w+0,f)-M;c=x,w=M,k=(f=d.width+l)*p+(x=d.height+l)*y+q,f=f*u+x*m+v,x=Math.min(c,k),M=Math.min(w,f),S=Math.max(c+S,k)-x,P=Math.max(w+P,f)-M,c=x,w=M,k=(f=0)*p+(x=d.height+l)*y+q,f=f*u+x*m+v,x=Math.min(c,k),M=Math.min(w,f),S=Math.max(c+S,k)-x,P=Math.max(w+P,f)-M,c=x,w=M,d=(l=b.viewportBounds).x,p=l.y,c=!(c>l.width+d||d>S+c||w>l.height+p||p>P+w)}if(c){if(c=0!=(256&this.F),a.clipInsteadOfFill&&(c=!1),this instanceof ml&&(a.font=this.font),c){if(w=g.ae()?g.naturalBounds:g.actualBounds,null!==this.md?(S=(d=this.md).x,P=d.y,l=d.width,d=d.height):(S=Math.max(e.x,w.x),P=Math.max(e.y,w.y),l=Math.min(e.right,w.right)-S,d=Math.min(e.bottom,w.bottom)-P),S>e.width+e.x||e.x>w.width+w.x)return void(1!==n&&(a.globalAlpha=o));a.save(),a.beginPath(),a.rect(S,P,l,d),a.clip()}if(this.yf()){if(!r.isVisible())return void(1!==n&&(a.globalAlpha=o));h&&(w=r.shadowOffset,a.jw(w.x*b.scale*b.Sb,w.y*b.scale*b.Sb,r.shadowBlur),Ia(a),a.shadowColor=r.shadowColor)}!0===this.shadowVisible?Ia(a):!1===this.shadowVisible&&ul(a),r=this.naturalBounds,null!==this.dc&&(oa(this,a,this.dc,!0,!0,r,e),this.dc instanceof Ya&&this.dc.type===nh?(a.beginPath(),a.rect(e.x,e.y,e.width,e.height),a.Vd(this.dc)):a.fillRect(e.x,e.y,e.width,e.height)),a.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),h&&(null!==g&&0!=(512&g.F)||null!==g&&(g.type===jh.Auto||g.type===jh.Spot)&&g.zb()!==this)&&null===this.shadowVisible&&ul(a),null!==this.gb&&(S=w=0,P=(l=this.naturalBounds).width,l=l.height,d=0,this instanceof rl&&(w=(l=this.ka.bounds).x,S=l.y,P=l.width,l=l.height,d=this.strokeWidth),oa(this,a,this.gb,!0,!1,r,e),this.gb instanceof Ya&&this.gb.type===nh?(a.beginPath(),a.rect(w-d/2,S-d/2,P+d,l+d),a.Vd(this.gb)):a.fillRect(w-d/2,S-d/2,P+d,l+d)),h&&(null!==this.gb||null!==this.dc||null!==g&&0!=(512&g.F)||null!==g&&(g.type===jh.Auto||g.type===jh.Spot)&&g.zb()!==this)?(ca(this,!0),null===this.shadowVisible&&ul(a)):ca(this,!1),this.Qi(a,b),h&&0!=(512&this.F)==!0&&Ia(a),this.yf()&&h&&ul(a),c?(a.restore(),this instanceof jh?a.sc(!0):a.sc(!1)):t.ut()||(b=1/(t.m11*t.m22-t.m12*t.m21),a.transform(t.m22*b,-t.m12*b,-t.m21*b,t.m11*b,b*(t.m21*t.dy-t.m22*t.dx),b*(t.m12*t.dx-t.m11*t.dy)))}}1!==n&&(a.globalAlpha=o)}}}},n.Gx=function(){return!1},n.Qi=function(){},n.Dg=function(a){if(a instanceof jh)t:{if(this!==a&&null!==a)for(var b=this.panel;null!==b;){if(b===a){a=!0;break t}b=b.panel}a=!1}else a=!1;return a},n.zf=function(){if(!this.visible)return!1;var a=this.panel;return null===a||a.zf()},n.Eg=function(){for(var a=this instanceof jh?this:this.panel;null!==a&&a.isEnabled;)a=a.panel;return null===a},n.o=function(a){if(void 0===a&&(a=!1),!0!==ya(this)){ma(this,!0),xa(this,!0);var b=this.panel;null===b||a||b.o()}},n.om=function(){!0!==ya(this)&&(ma(this,!0),xa(this,!0))},n.ml=function(){0!=(2048&this.F)==!1&&(pa(this,!0),ga(this,!0))},n.Gv=function(){ga(this,!0)},n.M=function(){var a=this.part;null!==a&&a.M()},n.cj=function(a){this.ng=a},n.Ot=function(){},n.hw=function(a){return this.ma.assign(a),aa(this),!0},n.Kq=function(a,b){this.ma.x===a&&this.ma.y===b||(this.ma.h(a,b),this.ml())},n.bind=function(a){a.bd=this;var b=this.Ui();null!==b&&Xh(b)&&N("Cannot add a Binding to a template that has already been copied: "+a),null===this.$a&&(this.$a=new lt),this.$a.add(a)},n.Ui=function(){for(var a=this instanceof jh?this:this.panel;null!==a;){if(null!==a.ci)return a;a=a.panel}return null},n.iw=function(a){vr(this,a)},v.Object.defineProperties(_s.prototype,{shadowVisible:{get:function(){return this.Ll},set:function(a){var b=this.Ll;b!==a&&(this.Ll=a,this.M(),this.g("shadowVisible",b,a))}},enabledChanged:{get:function(){return null!==this.N?this.N.En:null},set:function(a){dl(this);var b=this.N.En;b!==a&&(this.N.En=a,this.g("enabledChanged",b,a))}},segmentOrientation:{get:function(){return this.Jl},set:function(a){var b=this.Jl;b!==a&&(this.Jl=a,this.o(),this.g("segmentOrientation",b,a),a===mc&&(this.angle=0))}},segmentIndex:{get:function(){return this.xp},set:function(a){a=Math.round(a);var b=this.xp;b!==a&&(this.xp=a,this.o(),this.g("segmentIndex",b,a))}},segmentFraction:{get:function(){return this.Hl},set:function(a){isNaN(a)||0>a?a=0:1<a&&(a=1);var b=this.Hl;b!==a&&(this.Hl=a,this.o(),this.g("segmentFraction",b,a))}},segmentOffset:{get:function(){return this.Il},set:function(a){var b=this.Il;b.w(a)||(this.Il=a=a.G(),this.o(),this.g("segmentOffset",b,a))}},stretch:{get:function(){return this.we},set:function(a){var b=this.we;b!==a&&(this.we=a,this.o(),this.g("stretch",b,a))}},name:{get:function(){return this.Qa},set:function(a){var b=this.Qa;b!==a&&(this.Qa=a,null!==this.part&&(this.part.Fj=null),this.g("name",b,a))}},opacity:{get:function(){return this.qb},set:function(a){var b=this.qb;b!==a&&((0>a||1<a)&&T(a,"0 <= value <= 1",_s,"opacity"),this.qb=a,this.g("opacity",b,a),a=this.diagram,b=this.part,null!==a&&null!==b&&a.M(du(b,b.actualBounds)))}},visible:{get:function(){return 0!=(1&this.F)},set:function(a){var b=0!=(1&this.F);b!==a&&(this.F^=1,this.g("visible",b,a),null!==(b=this.panel)?b.o():this.yf()&&this.Ob(a),this.M(),wa(this))}},pickable:{get:function(){return 0!=(2&this.F)},set:function(a){var b=0!=(2&this.F);b!==a&&(this.F^=2,this.g("pickable",b,a))}},fromLinkableDuplicates:{get:function(){return 0!=(4&this.F)},set:function(a){var b=0!=(4&this.F);b!==a&&(this.F^=4,this.g("fromLinkableDuplicates",b,a))}},fromLinkableSelfNode:{get:function(){return 0!=(8&this.F)},set:function(a){var b=0!=(8&this.F);b!==a&&(this.F^=8,this.g("fromLinkableSelfNode",b,a))}},toLinkableDuplicates:{get:function(){return 0!=(16&this.F)},set:function(a){var b=0!=(16&this.F);b!==a&&(this.F^=16,this.g("toLinkableDuplicates",b,a))}},toLinkableSelfNode:{get:function(){return 0!=(32&this.F)},set:function(a){var b=0!=(32&this.F);b!==a&&(this.F^=32,this.g("toLinkableSelfNode",b,a))}},isPanelMain:{get:function(){return 0!=(64&this.F)},set:function(a){var b=0!=(64&this.F);b!==a&&(this.F^=64,this.o(),this.g("isPanelMain",b,a))}},isActionable:{get:function(){return 0!=(128&this.F)},set:function(a){var b=0!=(128&this.F);b!==a&&(this.F^=128,this.g("isActionable",b,a))}},areaBackground:{get:function(){return this.dc},set:function(a){var b=this.dc;b!==a&&(null!==a&&_a(a,"GraphObject.areaBackground"),a instanceof Ya&&a.freeze(),this.dc=a,this.M(),this.g("areaBackground",b,a))}},background:{get:function(){return this.gb},set:function(a){var b=this.gb;b!==a&&(null!==a&&_a(a,"GraphObject.background"),a instanceof Ya&&a.freeze(),this.gb=a,this.M(),this.g("background",b,a))}},part:{get:function(){if(this.yf())return this;if(null!==this.Jj)return this.Jj;var a;for(a=this.panel;a;){if(a instanceof lu)return this.Jj=a;a=a.panel}return null}},svg:{get:function(){return this.Pp},set:function(a){this.Pp=a}},panel:{get:function(){return this.ng}},layer:{get:function(){var a=this.part;return null!==a?a.layer:null}},diagram:{get:function(){var a=this.part;return null!==a?a.diagram:null}},position:{get:function(){return this.ma},set:function(a){var b=a.x,t=a.y,e=this.ma,n=e.x,o=e.y;(n===b||isNaN(n)&&isNaN(b))&&(o===t||isNaN(o)&&isNaN(t))?this.Ot():(a=a.copy(),this.hw(a,e)&&this.g("position",e.copy(),a))}},actualBounds:{get:function(){return this.ub}},scale:{get:function(){return this.ya},set:function(a){var b=this.ya;b!==a&&(0>=a&&N("GraphObject.scale for "+this+" must be greater than zero, not: "+a),this.ya=a,this.o(),this.g("scale",b,a))}},angle:{get:function(){return this.Yb},set:function(a){var b=this.Yb;b!==a&&(0>(a%=360)&&(a+=360),b!==a&&(this.Yb=a,wa(this),this.o(),this.g("angle",b,a)))}},desiredSize:{get:function(){return this.Lc},set:function(a){var b=a.width,t=a.height,e=this.Lc,n=e.width,o=e.height;(n===b||isNaN(n)&&isNaN(b))&&(o===t||isNaN(o)&&isNaN(t))||(this.Lc=a=a.G(),this.o(),this instanceof rl&&this.cc(),this.g("desiredSize",e,a),fa(this)&&(null!==(a=this.part)&&(ta(this,a,"width"),ta(this,a,"height"))))}},width:{get:function(){return this.Lc.width},set:function(a){var b=this.Lc.width;b===a||isNaN(b)&&isNaN(a)||(b=this.Lc,this.Lc=a=new qt(a,this.Lc.height).freeze(),this.o(),this instanceof rl&&this.cc(),this.g("desiredSize",b,a),fa(this)&&(null!==(a=this.part)&&ta(this,a,"width")))}},height:{get:function(){return this.Lc.height},set:function(a){var b=this.Lc.height;b===a||isNaN(b)&&isNaN(a)||(b=this.Lc,this.Lc=a=new qt(this.Lc.width,a).freeze(),this.o(),this instanceof rl&&this.cc(),this.g("desiredSize",b,a),fa(this)&&(null!==(a=this.part)&&ta(this,a,"height")))}},minSize:{get:function(){return this.eg},set:function(a){var b=this.eg;b.w(a)||(a=a.copy(),isNaN(a.width)&&(a.width=0),isNaN(a.height)&&(a.height=0),a.freeze(),this.eg=a,this.o(),this.g("minSize",b,a))}},maxSize:{get:function(){return this.dg},set:function(a){var b=this.dg;b.w(a)||(a=a.copy(),isNaN(a.width)&&(a.width=1/0),isNaN(a.height)&&(a.height=1/0),a.freeze(),this.dg=a,this.o(),this.g("maxSize",b,a))}},measuredBounds:{get:function(){return this.nc}},naturalBounds:{get:function(){return this.oc}},margin:{get:function(){return this.fh},set:function(a){"number"==typeof a&&(a=new hi(a));var b=this.fh;b.w(a)||(this.fh=a=a.G(),this.o(),this.g("margin",b,a))}},transform:{get:function(){return 0!=(2048&this.F)==!0&&ra(this),this.kb}},vd:{get:function(){return 0!=(4096&this.F)==!0&&ra(this),this.Qh}},alignment:{get:function(){return this.vb},set:function(a){var b=this.vb;b.w(a)||(a.jc()&&!a.Mb()&&N("GraphObject.alignment for "+this+" must be a real Spot or Spot.Default, not: "+a),this.vb=a=a.G(),aa(this),this.g("alignment",b,a))}},column:{get:function(){return this.Og},set:function(a){a=Math.round(a);var b=this.Og;b!==a&&(0>a&&T(a,">= 0",_s,"column"),this.Og=a,this.o(),this.g("column",b,a))}},columnSpan:{get:function(){return this.gn},set:function(a){a=Math.round(a);var b=this.gn;b!==a&&(1>a&&T(a,">= 1",_s,"columnSpan"),this.gn=a,this.o(),this.g("columnSpan",b,a))}},row:{get:function(){return this.pp},set:function(a){a=Math.round(a);var b=this.pp;b!==a&&(0>a&&T(a,">= 0",_s,"row"),this.pp=a,this.o(),this.g("row",b,a))}},rowSpan:{get:function(){return this.qp},set:function(a){a=Math.round(a);var b=this.qp;b!==a&&(1>a&&T(a,">= 1",_s,"rowSpan"),this.qp=a,this.o(),this.g("rowSpan",b,a))}},spanAllocation:{get:function(){return this.Kp},set:function(a){var b=this.Kp;b!==a&&(this.Kp=a,this.o(),this.g("spanAllocation",b,a))}},alignmentFocus:{get:function(){return this.Fk},set:function(a){var b=this.Fk;b.w(a)||(this.Fk=a=a.G(),this.o(),this.g("alignmentFocus",b,a))}},portId:{get:function(){return this.cp},set:function(a){var b=this.cp;if(b!==a){var t=this.part;null===t||t instanceof Au||(N("Cannot set portID on a Link: "+a),t=null),null!==b&&null!==t&&Vu(t,this),this.cp=a,null!==a&&null!==t&&(t.Ih=!0,zu(t,this)),this.g("portId",b,a)}}},toSpot:{get:function(){return null!==this.O?this.O.yh:pi},set:function(a){this.Ec();var b=this.O.yh;b.w(a)||(a=a.G(),this.O.yh=a,this.g("toSpot",b,a),ba(this))}},toEndSegmentLength:{get:function(){return null!==this.O?this.O.wh:10},set:function(a){this.Ec();var b=this.O.wh;b!==a&&(0>a&&T(a,">= 0",_s,"toEndSegmentLength"),this.O.wh=a,this.g("toEndSegmentLength",b,a),ba(this))}},toShortLength:{get:function(){return null!==this.O?this.O.xh:0},set:function(a){this.Ec();var b=this.O.xh;b!==a&&(this.O.xh=a,this.g("toShortLength",b,a),ba(this))}},toLinkable:{get:function(){return null!==this.O?this.O.Tp:null},set:function(a){this.Ec();var b=this.O.Tp;b!==a&&(this.O.Tp=a,this.g("toLinkable",b,a))}},toMaxLinks:{get:function(){return null!==this.O?this.O.Up:1/0},set:function(a){this.Ec();var b=this.O.Up;b!==a&&(0>a&&T(a,">= 0",_s,"toMaxLinks"),this.O.Up=a,this.g("toMaxLinks",b,a))}},fromSpot:{get:function(){return null!==this.O?this.O.Yg:pi},set:function(a){this.Ec();var b=this.O.Yg;b.w(a)||(a=a.G(),this.O.Yg=a,this.g("fromSpot",b,a),ba(this))}},fromEndSegmentLength:{get:function(){return null!==this.O?this.O.Wg:10},set:function(a){this.Ec();var b=this.O.Wg;b!==a&&(0>a&&T(a,">= 0",_s,"fromEndSegmentLength"),this.O.Wg=a,this.g("fromEndSegmentLength",b,a),ba(this))}},fromShortLength:{get:function(){return null!==this.O?this.O.Xg:0},set:function(a){this.Ec();var b=this.O.Xg;b!==a&&(this.O.Xg=a,this.g("fromShortLength",b,a),ba(this))}},fromLinkable:{get:function(){return null!==this.O?this.O.Kn:null},set:function(a){this.Ec();var b=this.O.Kn;b!==a&&(this.O.Kn=a,this.g("fromLinkable",b,a))}},fromMaxLinks:{get:function(){return null!==this.O?this.O.Ln:1/0},set:function(a){this.Ec();var b=this.O.Ln;b!==a&&(0>a&&T(a,">= 0",_s,"fromMaxLinks"),this.O.Ln=a,this.g("fromMaxLinks",b,a))}},cursor:{get:function(){return this.fi},set:function(a){var b=this.fi;b!==a&&(this.fi=a,this.g("cursor",b,a))}},click:{get:function(){return null!==this.N?this.N.Nf:null},set:function(a){dl(this);var b=this.N.Nf;b!==a&&(this.N.Nf=a,this.g("click",b,a))}},doubleClick:{get:function(){return null!==this.N?this.N.Sf:null},set:function(a){dl(this);var b=this.N.Sf;b!==a&&(this.N.Sf=a,this.g("doubleClick",b,a))}},contextClick:{get:function(){return null!==this.N?this.N.Of:null},set:function(a){dl(this);var b=this.N.Of;b!==a&&(this.N.Of=a,this.g("contextClick",b,a))}},mouseEnter:{get:function(){return null!==this.N?this.N.gg:null},set:function(a){dl(this);var b=this.N.gg;b!==a&&(this.N.gg=a,this.g("mouseEnter",b,a))}},mouseLeave:{get:function(){return null!==this.N?this.N.jg:null},set:function(a){dl(this);var b=this.N.jg;b!==a&&(this.N.jg=a,this.g("mouseLeave",b,a))}},mouseOver:{get:function(){return null!==this.N?this.N.kg:null},set:function(a){dl(this);var b=this.N.kg;b!==a&&(this.N.kg=a,this.g("mouseOver",b,a))}},mouseHover:{get:function(){return null!==this.N?this.N.ig:null},set:function(a){dl(this);var b=this.N.ig;b!==a&&(this.N.ig=a,this.g("mouseHover",b,a))}},mouseHold:{get:function(){return null!==this.N?this.N.hg:null},set:function(a){dl(this);var b=this.N.hg;b!==a&&(this.N.hg=a,this.g("mouseHold",b,a))}},mouseDragEnter:{get:function(){return null!==this.N?this.N.Fo:null},set:function(a){dl(this);var b=this.N.Fo;b!==a&&(this.N.Fo=a,this.g("mouseDragEnter",b,a))}},mouseDragLeave:{get:function(){return null!==this.N?this.N.Go:null},set:function(a){dl(this);var b=this.N.Go;b!==a&&(this.N.Go=a,this.g("mouseDragLeave",b,a))}},mouseDrop:{get:function(){return null!==this.N?this.N.fg:null},set:function(a){dl(this);var b=this.N.fg;b!==a&&(this.N.fg=a,this.g("mouseDrop",b,a))}},actionDown:{get:function(){return null!==this.N?this.N.Pm:null},set:function(a){dl(this);var b=this.N.Pm;b!==a&&(this.N.Pm=a,this.g("actionDown",b,a))}},actionMove:{get:function(){return null!==this.N?this.N.Qm:null},set:function(a){dl(this);var b=this.N.Qm;b!==a&&(this.N.Qm=a,this.g("actionMove",b,a))}},actionUp:{get:function(){return null!==this.N?this.N.Rm:null},set:function(a){dl(this);var b=this.N.Rm;b!==a&&(this.N.Rm=a,this.g("actionUp",b,a))}},actionCancel:{get:function(){return null!==this.N?this.N.Om:null},set:function(a){dl(this);var b=this.N.Om;b!==a&&(this.N.Om=a,this.g("actionCancel",b,a))}},toolTip:{get:function(){return null!==this.N?this.N.ug:null},set:function(a){dl(this);var b=this.N.ug;b!==a&&(this.N.ug=a,this.g("toolTip",b,a))}},contextMenu:{get:function(){return null!==this.N?this.N.Pf:null},set:function(a){dl(this);var b=this.N.Pf;b!==a&&(this.N.Pf=a,this.g("contextMenu",b,a))}}}),_s.prototype.setProperties=_s.prototype.iw,_s.prototype.findTemplateBinder=_s.prototype.Ui,_s.prototype.bind=_s.prototype.bind,_s.prototype.isEnabledObject=_s.prototype.Eg,_s.prototype.isVisibleObject=_s.prototype.zf,_s.prototype.isContainedBy=_s.prototype.Dg,_s.prototype.getNearestIntersectionPoint=_s.prototype.Uc,_s.prototype.getLocalPoint=_s.prototype.ot,_s.prototype.getDocumentScale=_s.prototype.vf,_s.prototype.getDocumentAngle=_s.prototype.Xi,_s.prototype.getDocumentBounds=_s.prototype.lm,_s.prototype.getDocumentPoint=_s.prototype.ga,_s.prototype.intersectsRect=_s.prototype.Gc,_s.prototype.containedInRect=_s.prototype.Gh,_s.prototype.containsRect=_s.prototype.Ae,_s.prototype.containsPoint=_s.prototype.aa,_s.prototype.raiseChanged=_s.prototype.g,_s.prototype.raiseChangedEvent=_s.prototype.Ya,_s.prototype.addCopyProperty=_s.prototype.sx;var Ca=null;function Ta(){this.En=this.Pf=this.ug=this.Om=this.Rm=this.Qm=this.Pm=this.fg=this.Go=this.Fo=this.hg=this.ig=this.kg=this.jg=this.gg=this.Of=this.Sf=this.Nf=null}function La(){this.Ka=[1,0,0,1,0,0]}function Aa(a){this.type=a,this.r2=this.y2=this.x2=this.r1=this.y1=this.x1=0,this.zx=[],this.pattern=null}function ja(a,b){this.ownerDocument=a=void 0===b?w.document:b,this.hA="http://www.w3.org/2000/svg",void 0!==a&&(this.Ea=this.tb("svg",{width:"1px",height:"1px",viewBox:"0 0 1 1"}),this.Ea.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg"),this.Ea.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink")),this.jq=null,this.context=new Da(this)}function Da(a){this.yk=a,this.svg=a.Ea,this.stack=[],this.xc=[],this.fillStyle="#000000",this.font="10px sans-serif",this.globalAlpha=1,this.lineCap="butt",this.lineDashOffset=0,this.lineJoin="miter",this.lineWidth=1,this.miterLimit=10,this.shadowBlur=0,this.shadowColor="rgba(0, 0, 0, 0)",this.shadowOffsetY=this.shadowOffsetX=0,this.strokeStyle="#000000",this.textAlign="start",this.clipInsteadOfFill=!1,this.ef=this.Gp=this.Fp=0,this.uq=null,this.path=[],this.wu=!1,this.rh=null,this.sh=0,this.Ud=new La,Ba(this,1,0,0,1,0,0);var b=yt++,t=this.tb("clipPath",{id:"mainClip"+b});t.appendChild(this.tb("rect",{x:0,y:0,width:a.width,height:a.height})),this.Du=t,this.yk.Ea.appendChild(t),this.xc[0].setAttributeNS(null,"clip-path","url(#mainClip"+b+")"),this.jA={}}function Fa(a,b,t,e,n){1!==a.globalAlpha&&(t.opacity=a.globalAlpha),"fill"===b?(a.fillStyle instanceof Aa?t.fill=Oa(a,a.fillStyle):/^rgba\(/.test(a.fillStyle)?(a=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(a.fillStyle),t.fill="rgb("+a[1]+","+a[2]+","+a[3]+")",t["fill-opacity"]=a[4]):t.fill=a.fillStyle,t.stroke="none"):"stroke"===b&&(t.fill="none",a.strokeStyle instanceof Aa?t.stroke=Oa(a,a.strokeStyle):/^rgba\(/.test(a.strokeStyle)?(b=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(a.strokeStyle),t.stroke="rgb("+b[1]+","+b[2]+","+b[3]+")",t["stroke-opacity"]=b[4]):t.stroke=a.strokeStyle,t["stroke-width"]=a.lineWidth,t["stroke-linecap"]=a.lineCap,t["stroke-linejoin"]=a.lineJoin,t["stroke-miterlimit"]=a.miterLimit),e="matrix("+(e=e.Ka)[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")",void 0!==n&&(e+=n),t.transform=e}function Oa(a,b){var t="GRAD"+yt++;if("linear"===b.type)var e=a.tb("linearGradient",{x1:b.x1,x2:b.x2,y1:b.y1,y2:b.y2,id:t,gradientUnits:"userSpaceOnUse"});else{if("radial"!==b.type)throw Error("invalid gradient");e=a.tb("radialGradient",{x1:b.x1,x2:b.x2,y1:b.y1,y2:b.y2,r1:b.r1,r2:b.r2,id:t})}var n=b.zx;b=n.length;for(var o=[],g=0;g<b;g++){var r=n[g],h=r.color;r={offset:r.offset,"stop-color":h},/^rgba\(/.test(h)&&(h=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(h),r["stop-color"]="rgb("+h[1]+","+h[2]+","+h[3]+")",r["stop-opacity"]=h[4]),o.push(r)}for(o.sort((function(a,b){return a.offset>b.offset?1:-1})),n=0;n<b;n++)e.appendChild(a.tb("stop",o[n]));return a.svg.appendChild(e),"url(#"+t+")"}function Ba(a,b,t,e,n,o,g){var r=new La;r.Ka=[b,t,e,n,o,g],Fa(a,"g",b={},r),r=a.addElement("g",b),a.xc.push(r)}function ul(a){a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0}function Ia(a){a.shadowOffsetX=a.Fp,a.shadowOffsetY=a.Gp,a.shadowBlur=a.ef}function Ra(a,b){this.ownerDocument=b=void 0===b?w.document:b,this.jq=null,(b=b.createElement("canvas")).tabIndex=0,this.Ea=b,this.Ea.innerHTML="This text is displayed if your browser does not support the Canvas HTML element.",this.context=new Ea(b),b.B=a}function Ea(a){a.getContext&&a.getContext("2d")||N("Browser does not support HTML Canvas Element"),this.V=a.getContext("2d"),this.Zt=this.au=this.$t="",this.fn=!1,this.ef=this.Gp=this.Fp=0}_s.className="GraphObject",Ca=new kt,Pa("Button",(function(){function a(a,b){return null!==a.diagram.Ub(a.documentPoint,(function(a){for(;null!==a.panel&&!a.isActionable;)a=a.panel;return a}),(function(a){return a===b}))}var b=Ma(jh,jh.Auto,{isActionable:!0,enabledChanged:function(a,b){if(a instanceof jh){var t=a.Xa("ButtonBorder");null!==t&&(t.fill=b?a._buttonFillNormal:a._buttonFillDisabled)}},cursor:"pointer",_buttonFillNormal:"#F5F5F5",_buttonStrokeNormal:"#BDBDBD",_buttonFillOver:"#E0E0E0",_buttonStrokeOver:"#9E9E9E",_buttonFillPressed:"#BDBDBD",_buttonStrokePressed:"#9E9E9E",_buttonFillDisabled:"#E5E5E5"},Ma(rl,{name:"ButtonBorder",figure:"RoundedRectangle",spot1:new Zi(0,0,2.76142374915397,2.761423749153969),spot2:new Zi(1,1,-2.76142374915397,-2.761423749153969),parameter1:2,parameter2:2,fill:"#F5F5F5",stroke:"#BDBDBD"}));return b.mouseEnter=function(a,b){if(b.Eg()&&b instanceof jh&&(a=b.Xa("ButtonBorder"))instanceof rl){var t=b._buttonFillOver;b._buttonFillNormal=a.fill,a.fill=t,t=b._buttonStrokeOver,b._buttonStrokeNormal=a.stroke,a.stroke=t}},b.mouseLeave=function(a,b){b.Eg()&&b instanceof jh&&((a=b.Xa("ButtonBorder"))instanceof rl&&(a.fill=b._buttonFillNormal,a.stroke=b._buttonStrokeNormal))},b.actionDown=function(a,b){if(b.Eg()&&b instanceof jh&&null!==b._buttonFillPressed&&0===a.button){var t=b.Xa("ButtonBorder");if(t instanceof rl){var e=(a=a.diagram).skipsUndoManager;a.skipsUndoManager=!0;var g=b._buttonFillPressed;b._buttonFillOver=t.fill,t.fill=g,g=b._buttonStrokePressed,b._buttonStrokeOver=t.stroke,t.stroke=g,a.skipsUndoManager=e}}},b.actionUp=function(b,t){if(t.Eg()&&t instanceof jh&&null!==t._buttonFillPressed&&0===b.button){var e=t.Xa("ButtonBorder");if(e instanceof rl){var n=b.diagram,g=n.skipsUndoManager;n.skipsUndoManager=!0,a(b,t)?(e.fill=t._buttonFillOver,e.stroke=t._buttonStrokeOver):(e.fill=t._buttonFillNormal,e.stroke=t._buttonStrokeNormal),n.skipsUndoManager=g}}},b.actionCancel=function(b,t){if(t.Eg()&&t instanceof jh&&null!==t._buttonFillPressed){var e=t.Xa("ButtonBorder");if(e instanceof rl){var n=b.diagram,g=n.skipsUndoManager;n.skipsUndoManager=!0,a(b,t)?(e.fill=t._buttonFillOver,e.stroke=t._buttonStrokeOver):(e.fill=t._buttonFillNormal,e.stroke=t._buttonStrokeNormal),n.skipsUndoManager=g}}},b.actionMove=function(b,t){if(t.Eg()&&t instanceof jh&&null!==t._buttonFillPressed){var e=b.diagram;if(0===e.firstInput.button&&(e.currentTool.standardMouseOver(),a(b,t)&&(b=t.Xa("ButtonBorder"))instanceof rl)){var n=e.skipsUndoManager;e.skipsUndoManager=!0;var g=t._buttonFillPressed;b.fill!==g&&(b.fill=g),g=t._buttonStrokePressed,b.stroke!==g&&(b.stroke=g),e.skipsUndoManager=n}}},b})),Pa("TreeExpanderButton",(function(){var a=Ma("Button",{_treeExpandedFigure:"MinusLine",_treeCollapsedFigure:"PlusLine"},Ma(rl,{name:"ButtonIcon",figure:"MinusLine",stroke:"#424242",strokeWidth:2,desiredSize:zt},new ud("figure","isTreeExpanded",(function(a,t){return t=t.panel,a?t._treeExpandedFigure:t._treeCollapsedFigure})).Aq()),{visible:!1},new ud("visible","isTreeLeaf",(function(a){return!a})).Aq());return a.click=function(a,t){if((t=t.part)instanceof Lu&&(t=t.adornedPart),t instanceof Au){var b=t.diagram;if(null!==b){if(b=b.commandHandler,t.isTreeExpanded){if(!b.canCollapseTree(t))return}else if(!b.canExpandTree(t))return;a.handled=!0,t.isTreeExpanded?b.collapseTree(t):b.expandTree(t)}}},a})),Pa("SubGraphExpanderButton",(function(){var a=Ma("Button",{_subGraphExpandedFigure:"MinusLine",_subGraphCollapsedFigure:"PlusLine"},Ma(rl,{name:"ButtonIcon",figure:"MinusLine",stroke:"#424242",strokeWidth:2,desiredSize:zt},new ud("figure","isSubGraphExpanded",(function(a,t){return t=t.panel,a?t._subGraphExpandedFigure:t._subGraphCollapsedFigure})).Aq()));return a.click=function(a,t){if((t=t.part)instanceof Lu&&(t=t.adornedPart),t instanceof qu){var b=t.diagram;if(null!==b){if(b=b.commandHandler,t.isSubGraphExpanded){if(!b.canCollapseSubGraph(t))return}else if(!b.canExpandSubGraph(t))return;a.handled=!0,t.isSubGraphExpanded?b.collapseSubGraph(t):b.expandSubGraph(t)}}},a})),Pa("ToolTip",(function(){return Ma(Lu,jh.Auto,{isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new Mt(0,3),shadowBlur:5},Ma(rl,{name:"Border",figure:"RoundedRectangle",parameter1:1,parameter2:1,fill:"#F5F5F5",stroke:"#F0F0F0",spot1:new Zi(0,0,4,6),spot2:new Zi(1,1,-4,-4)}))})),Pa("ContextMenu",(function(){return Ma(Lu,jh.Vertical,{background:"#F5F5F5",isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new Mt(0,3),shadowBlur:5},new ud("background","",(function(a){return null!==a.adornedPart&&null!==a.placeholder?null:"#F5F5F5"})))})),Pa("ContextMenuButton",(function(){var a=Ma("Button");a.stretch=ss;var b=a.Xa("ButtonBorder");return b instanceof rl&&(b.figure="Rectangle",b.strokeWidth=0,b.spot1=new Zi(0,0,2,3),b.spot2=new Zi(1,1,-2,-2)),a})),Pa("PanelExpanderButton",(function(a){var b=Na(a,"COLLAPSIBLE"),t=Ma("Button",{_buttonExpandedFigure:"M0 0 M0 6 L4 2 8 6 M8 8",_buttonCollapsedFigure:"M0 0 M0 2 L4 6 8 2 M8 8",_buttonFillNormal:"rgba(0, 0, 0, 0)",_buttonStrokeNormal:null,_buttonFillOver:"rgba(0, 0, 0, .2)",_buttonStrokeOver:null,_buttonFillPressed:"rgba(0, 0, 0, .4)",_buttonStrokePressed:null},Ma(rl,{name:"ButtonIcon",strokeWidth:2},new ud("geometryString","visible",(function(a){return a?t._buttonExpandedFigure:t._buttonCollapsedFigure})).Aq(b)));return(a=t.Xa("ButtonBorder"))instanceof rl&&(a.stroke=null,a.fill="rgba(0, 0, 0, 0)"),t.click=function(a,t){var e=t.diagram;if(null!==e&&!e.isReadOnly){var n=t.Ui();null===n&&(n=t.part),null!==n&&(null!==(t=n.Xa(b))&&(a.handled=!0,e.ua("Collapse/Expand Panel"),t.visible=!t.visible,e.Ua("Collapse/Expand Panel")))}},t})),Pa("CheckBoxButton",(function(a){var b=Na(a);return(a=Ma("Button",{desiredSize:new qt(14,14)},Ma(rl,{name:"ButtonIcon",geometryString:"M0 0 M0 8.85 L4.9 13.75 16.2 2.45 M16.2 16.2",strokeWidth:2,stretch:es,geometryStretch:os,visible:!1},""!==b?new ud("visible",b).Vx():[]))).click=function(a,t){if(t instanceof jh){var e=a.diagram;if(!(null===e||e.isReadOnly||""!==b&&e.model.isReadOnly)){a.handled=!0;var n=t.Xa("ButtonIcon");e.ua("checkbox"),n.visible=!n.visible,"function"==typeof t._doClick&&t._doClick(a,t),e.Ua("checkbox")}}},a})),Pa("CheckBox",(function(a){a=Ma("CheckBoxButton",a=Na(a),{name:"Button",isActionable:!1,margin:new hi(0,1,0,0)});var b=Ma(jh,"Horizontal",a,{isActionable:!0,cursor:a.cursor,margin:1,_buttonFillNormal:a._buttonFillNormal,_buttonStrokeNormal:a._buttonStrokeNormal,_buttonFillOver:a._buttonFillOver,_buttonStrokeOver:a._buttonStrokeOver,_buttonFillPressed:a._buttonFillPressed,_buttonStrokePressed:a._buttonStrokePressed,_buttonFillDisabled:a._buttonFillDisabled,mouseEnter:a.mouseEnter,mouseLeave:a.mouseLeave,actionDown:a.actionDown,actionUp:a.actionUp,actionCancel:a.actionCancel,actionMove:a.actionMove,click:a.click,_buttonClick:a.click});return a.mouseEnter=null,a.mouseLeave=null,a.actionDown=null,a.actionUp=null,a.actionCancel=null,a.actionMove=null,a.click=null,b})),_s.None=ns=new _(_s,"None",0),_s.Default=rs=new _(_s,"Default",0),_s.Vertical=as=new _(_s,"Vertical",4),_s.Horizontal=ss=new _(_s,"Horizontal",5),_s.Fill=es=new _(_s,"Fill",3),_s.Uniform=os=new _(_s,"Uniform",1),_s.UniformToFill=hs=new _(_s,"UniformToFill",2),_s.FlipVertical=ls=new _(_s,"FlipVertical",1),_s.FlipHorizontal=us=new _(_s,"FlipHorizontal",2),_s.FlipBoth=cs=new _(_s,"FlipBoth",3),_s.make=Ma,_s.getBuilders=function(){var b,a=new kt;for(b in Ca)if(b!==b.toLowerCase()){var t=Ca.H(b);"function"==typeof t&&a.add(b,t)}return a.freeze(),a},_s.defineBuilder=Pa,_s.takeBuilderArgument=Na,Ta.prototype.copy=function(){var a=new Ta;return a.Nf=this.Nf,a.Sf=this.Sf,a.Of=this.Of,a.gg=this.gg,a.jg=this.jg,a.kg=this.kg,a.ig=this.ig,a.hg=this.hg,a.Fo=this.Fo,a.Go=this.Go,a.fg=this.fg,a.Pm=this.Pm,a.Qm=this.Qm,a.Rm=this.Rm,a.Om=this.Om,a.ug=this.ug,a.Pf=this.Pf,a.En=this.En,a},Ta.className="GraphObjectEventHandlers",La.prototype.copy=function(){var a=new La;return a.Ka[0]=this.Ka[0],a.Ka[1]=this.Ka[1],a.Ka[2]=this.Ka[2],a.Ka[3]=this.Ka[3],a.Ka[4]=this.Ka[4],a.Ka[5]=this.Ka[5],a},La.prototype.translate=function(a,b){this.Ka[4]+=this.Ka[0]*a+this.Ka[2]*b,this.Ka[5]+=this.Ka[1]*a+this.Ka[3]*b},La.prototype.scale=function(a,b){this.Ka[0]*=a,this.Ka[1]*=a,this.Ka[2]*=b,this.Ka[3]*=b},La.className="STransform",Aa.prototype.addColorStop=function(a,b){this.zx.push({offset:a,color:b})},Aa.className="SGradient",ja.prototype.resize=function(a,b,t,e){return(this.width!==a||this.height!==b)&&(this.style.width=t+"px",this.style.height=e+"px",this.Ea.setAttributeNS(null,"width",t+"px"),this.Ea.setAttributeNS(null,"height",e+"px"),this.Ea.setAttributeNS(null,"viewBox","0 0 "+t+" "+e),this.context.Du.firstElementChild.setAttributeNS(null,"width",t+"px"),this.context.Du.firstElementChild.setAttributeNS(null,"height",e+"px"),!0)},ja.prototype.tb=function(a,b,t){if(a=this.ownerDocument.createElementNS(this.hA,a),j(b))for(var e in b)a.setAttributeNS("href"===e?"http://www.w3.org/1999/xlink":"",e,b[e]);return void 0!==t&&(a.textContent=t),a},ja.prototype.getBoundingClientRect=function(){return this.Ea.getBoundingClientRect()},ja.prototype.focus=function(){this.Ea.focus()},ja.prototype.Fx=function(){this.ownerDocument=null},v.Object.defineProperties(ja.prototype,{width:{get:function(){return this.Ea.width.baseVal.value},set:function(a){this.Ea.width=a}},height:{get:function(){return this.Ea.height.baseVal.value},set:function(a){this.Ea.height=a}},style:{get:function(){return this.Ea.style}}}),ja.className="SVGSurface",(n=Da.prototype).reset=function(){this.stack=[],this.xc=[],this.fillStyle="#000000",this.font="10px sans-serif",this.globalAlpha=1,this.lineCap="butt",this.lineDashOffset=0,this.lineJoin="miter",this.lineWidth=1,this.miterLimit=10,this.shadowBlur=0,this.shadowColor="rgba(0, 0, 0, 0)",this.shadowOffsetY=this.shadowOffsetX=0,this.strokeStyle="#000000",this.textAlign="start",this.clipInsteadOfFill=!1,this.ef=this.Gp=this.Fp=0,this.uq=null,this.path=[],this.Ud=new La,Ba(this,1,0,0,1,0,0);var a=yt++,b=this.tb("clipPath",{id:"mainClip"+a});b.appendChild(this.tb("rect",{x:0,y:0,width:this.yk.width,height:this.yk.height})),this.Du=b,this.yk.Ea.appendChild(b),this.xc[0].setAttributeNS(null,"clip-path","url(#mainClip"+a+")")},n.arc=function(a,b,t,e,n,o,g,r){var h=2*Math.PI,l=h-1e-6,c=t*Math.cos(e),f=t*Math.sin(e),p=a+c,d=b+f,q=o?0:1;e=o?e-n:n-e,(1e-6<Math.abs(g-p)||1e-6<Math.abs(r-d))&&this.path.push(["L",p,+d]),0>e&&(e=e%h+h),e>l?(this.path.push(["A",t,t,0,1,q,a-c,b-f]),this.path.push(["A",t,t,0,1,q,p,d])):1e-6<e&&this.path.push(["A",t,t,0,+(e>=Math.PI),q,a+t*Math.cos(n),b+t*Math.sin(n)])},n.beginPath=function(){this.path=[]},n.bezierCurveTo=function(a,b,t,e,n,o){this.path.push(["C",a,b,t,e,n,o])},n.clearRect=function(){},n.clip=function(){this.addPath("clipPath",this.path,this.Ud),this.addPath("clipPath",this.path,new La)},n.closePath=function(){this.path.push(["z"])},n.createLinearGradient=function(a,b,t,e){var n=new Aa("linear");return n.x1=a,n.y1=b,n.x2=t,n.y2=e,n},n.createPattern=function(a){var b="";a instanceof HTMLCanvasElement&&(b=a.toDataURL()),a instanceof HTMLImageElement&&(b=a.getAttribute("src"));var t=this.jA;if(t[b])return"url(#"+t[b]+")";var e="PATTERN"+yt++,n={x:0,y:0,width:a.width,height:a.height,href:b};return(a=this.tb("pattern",{width:a.width,height:a.height,id:e,patternUnits:"userSpaceOnUse"})).appendChild(this.tb("image",n)),this.svg.appendChild(a),t[b]=e,"url(#"+e+")"},n.createRadialGradient=function(a,b,t,e,n,o){var g=new Aa("radial");return g.x1=a,g.y1=b,g.r1=t,g.x2=e,g.y2=n,g.r2=o,g},n.drawImage=function(a,b,t,e,n,o,g,r,h){var l="";a instanceof HTMLCanvasElement&&(l=a.toDataURL()),a instanceof HTMLImageElement&&(l=a.getAttribute("src"));var c=a instanceof HTMLImageElement?a.naturalWidth:a.width,f=a instanceof HTMLImageElement?a.naturalHeight:a.height;void 0===e&&(o=b,g=t,r=e=c,h=n=f),e=e||0,n=n||0,o=o||0,g=g||0,r=r||0,h=h||0,l={x:0,y:0,width:c||e,height:f||n,href:l,preserveAspectRatio:"xMidYMid slice"},ne.$(e,r)&&ne.$(n,h)||(l.preserveAspectRatio="none"),a="",h/=n,0===o&&0===g||(a+=" translate("+o+", "+g+")"),1===(r/=e)&&1===h||(a+=" scale("+r+", "+h+")"),0===b&&0===t||(a+=" translate("+-b+", "+-t+")"),0===b&&0===t&&e===c&&n===f||(o="CLIP"+yt++,(g=this.tb("clipPath",{id:o})).appendChild(this.tb("rect",{x:b,y:t,width:e,height:n})),this.svg.appendChild(g),l["clip-path"]="url(#"+o+")"),Fa(this,"image",l,this.Ud,a),this.addElement("image",l)},n.fill=function(){this.addPath("fill",this.path,this.Ud)},n.Vd=function(){this.clipInsteadOfFill?this.clip():this.fill()},n.fillRect=function(a,b,t,e){Fa(this,"fill",a={x:(a=[a,b,t,e])[0],y:a[1],width:a[2],height:a[3]},this.Ud),this.addElement("rect",a)},n.fillText=function(a,b,t){a=[a,b,t],"left"===(b=this.textAlign)?b="start":"right"===b?b="end":"center"===b&&(b="middle"),Fa(this,"fill",b={x:a[1],y:a[2],style:"font: "+this.font,"text-anchor":b},this.Ud),this.addElement("text",b,a[0])},n.lineTo=function(a,b){this.path.push(["L",a,b])},n.moveTo=function(a,b){this.path.push(["M",a,b])},n.quadraticCurveTo=function(a,b,t,e){this.path.push(["Q",a,b,t,e])},n.rect=function(a,b,t,e){this.path.push(["M",a,b],["L",a+t,b],["L",a+t,b+e],["L",a,b+e],["z"])},n.restore=function(){this.Ud=this.stack.pop(),this.path=this.stack.pop();var a=this.stack.pop();this.fillStyle=a.fillStyle,this.font=a.font,this.globalAlpha=a.globalAlpha,this.lineCap=a.lineCap,this.lineDashOffset=a.lineDashOffset,this.lineJoin=a.lineJoin,this.lineWidth=a.lineWidth,this.miterLimit=a.miterLimit,this.shadowBlur=a.shadowBlur,this.shadowColor=a.shadowColor,this.shadowOffsetX=a.shadowOffsetX,this.shadowOffsetY=a.shadowOffsetY,this.strokeStyle=a.strokeStyle,this.textAlign=a.textAlign},n.save=function(){this.stack.push({fillStyle:this.fillStyle,font:this.font,globalAlpha:this.globalAlpha,lineCap:this.lineCap,lineDashOffset:this.lineDashOffset,lineJoin:this.lineJoin,lineWidth:this.lineWidth,miterLimit:this.miterLimit,shadowBlur:this.shadowBlur,shadowColor:this.shadowColor,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY,strokeStyle:this.strokeStyle,textAlign:this.textAlign});for(var a=[],b=0;b<this.path.length;b++)a.push(this.path[b]);this.stack.push(a),this.stack.push(this.Ud.copy())},n.setTransform=function(a,b,t,e,n,o){1===a&&0===b&&0===t&&1===e&&0===n&&0===o||Ba(this,a,b,t,e,n,o)},n.scale=function(a,b){this.Ud.scale(a,b)},n.translate=function(a,b){this.Ud.translate(a,b)},n.transform=function(){},n.stroke=function(){this.addPath("stroke",this.path,this.Ud)},n.fj=function(){this.clipInsteadOfFill||this.stroke()},n.tb=function(a,b,t){return this.yk.tb(a,b,t)},n.addElement=function(a,b,t){return a=this.tb(a,b,t),0<this.xc.length?this.xc[this.xc.length-1].appendChild(a):this.svg.appendChild(a),this.uq=a},n.addPath=function(a,b,t){for(var e=[],n=0;n<b.length;n++){var o=F(b[n]),g=[o.shift()];if("A"===g[0])g.push(o.shift()+","+o.shift(),o.shift(),o.shift()+","+o.shift(),o.shift()+","+o.shift());else for(;o.length;)g.push(o.shift()+","+o.shift());e.push(g.join(" "))}b={d:e.join(" ")},"stroke"===a&&this.wu&&(b["stroke-dasharray"]=this.rh.toString(),b["stroke-dashoffset"]=this.sh),Fa(this,a,b,t),"clipPath"===a?(a="CLIP"+yt++,(t=this.tb("clipPath",{id:a})).appendChild(this.tb("path",b)),this.svg.appendChild(t),0<this.xc.length&&this.xc[this.xc.length-1].setAttributeNS(null,"clip-path","url(#"+a+")")):this.addElement("path",b)},n.Lq=function(){if(0!==this.shadowOffsetX||0!==this.shadowOffsetY||0!==this.shadowBlur){var a="SHADOW"+yt++,b=this.addElement("filter",{id:a,x:"-100%",y:"-100%",width:"300%",height:"300%"},null),t=this.tb("feGaussianBlur",{in:"SourceAlpha",result:"blur",KA:this.shadowBlur/2}),e=this.tb("feFlood",{in:"blur",result:"flood","flood-color":this.shadowColor}),n=this.tb("feComposite",{in:"flood",in2:"blur",operator:"in",result:"comp"}),o=this.tb("feOffset",{in:"comp",result:"offsetBlur",dx:this.shadowOffsetX,dy:this.shadowOffsetY}),g=this.tb("feMerge",{});g.appendChild(this.tb("feMergeNode",{in:"offsetBlur"})),g.appendChild(this.tb("feMergeNode",{in:"SourceGraphic"})),b.appendChild(t),b.appendChild(e),b.appendChild(n),b.appendChild(o),b.appendChild(g),0<this.xc.length&&this.xc[this.xc.length-1].setAttributeNS(null,"filter","url(#"+a+")")}},n.jw=function(a,b,t){this.Fp=a,this.Gp=b,this.ef=t},n.ht=function(a,b){this.wu=!0,this.rh=a,this.sh=b},n.ft=function(){this.wu=!1},n.sc=function(){},n.ky=function(){},Da.prototype.rotate=function(){},Da.prototype.getImageData=function(){return null},Da.prototype.measureText=function(){return null},Da.className="SVGContext",Vo.prototype.At=function(a){var b=new ja(this,w.document);void 0===a&&(a=new et);var t=this;return ts(this,(function(a,e){return a=null!==(a=is(t,a,"SVG",b))?a.svg:null,"function"==typeof e?(e(a),null):a}),a)},Vo.prototype.makeSvg=Vo.prototype.At,Vo.prototype.Lv=function(a){return this.At(a)},Vo.prototype.makeSVG=Vo.prototype.Lv,_s.prototype.Gx=function(a,b){if(!(a instanceof Da))return!1;if(!this.visible)return!0;var t=null,e=a.uq;if(this instanceof jh&&(this.type===jh.TableRow||this.type===jh.TableColumn))return na(this,a,b),!0;var n=this.ub;if(0===n.width||0===n.height||isNaN(n.x)||isNaN(n.y))return!0;var o=this.transform,g=this.panel;0!=(4096&this.F)==!0&&ra(this);var r=0!=(256&this.F),h=!1;if(this instanceof ml&&(a.font=this.font),r){if(h=g.ae()?g.naturalBounds:g.actualBounds,null!==this.md){var l=this.md,c=l.x,f=l.y,p=l.width;l=l.height}else c=Math.max(n.x,h.x),f=Math.max(n.y,h.y),p=Math.min(n.right,h.right)-c,l=Math.min(n.bottom,h.bottom)-f;if(c>n.width+n.x||n.x>h.width+h.x||f>n.height+n.y||n.y>h.height+h.y)return!0;h=!0,Ba(a,1,0,0,1,0,0),a.save(),a.beginPath(),a.rect(c,f,p,l),a.clip()}if(this.yf()&&!this.isVisible())return!0;if(a.Ud.Ka=[1,0,0,1,0,0],(this instanceof ml&&1<this.lineCount||this instanceof rl&&1<this.geometry.figures.length)&&Ba(a,1,0,0,1,0,0),c=!1,this.yf()&&this.isShadowed&&b.Ce("drawShadows")&&(f=this.shadowOffset,a.jw(f.x*b.scale*b.Sb,f.y*b.scale*b.Sb,this.shadowBlur),Ia(a),a.shadowColor=this.shadowColor),f=!1,this.part&&b.Ce("drawShadows")&&(f=this.part.isShadowed),!0===this.shadowVisible?(Ia(a),!1===c&&f&&(Ba(a,1,0,0,1,0,0),a.Lq(),c=!0)):!1===this.shadowVisible&&ul(a),p=this.naturalBounds,null!==this.areaBackground&&(oa(this,a,this.areaBackground,!0,!0,p,n),!1===c&&f&&(Ba(a,1,0,0,1,0,0),a.Lq(),c=!0),this.areaBackground instanceof Ya&&this.areaBackground.type===nh?(a.beginPath(),a.rect(n.x,n.y,n.width,n.height),a.Vd(this.areaBackground)):a.fillRect(n.x,n.y,n.width,n.height)),this instanceof jh?Ba(a,o.m11,o.m12,o.m21,o.m22,o.dx,o.dy):a.Ud.Ka=[o.m11,o.m12,o.m21,o.m22,o.dx,o.dy],null!==this.background){!1===c&&f&&(Ba(a,1,0,0,1,0,0),a.Lq(),c=!0);var d=this.naturalBounds;l=o=0;var q=d.width;d=d.height;var u=0;this instanceof rl&&(o=(d=this.geometry.bounds).x,l=d.y,q=d.width,d=d.height,u=this.strokeWidth),oa(this,a,this.background,!0,!1,p,n),this.background instanceof Ya&&this.background.type===nh?(a.beginPath(),a.rect(o-u/2,l-u/2,q+u,d+u),a.Vd(this.background)):a.fillRect(o-u/2,l-u/2,q+u,d+u)}return f&&(null!==this.background||null!==this.areaBackground||null!==g&&0!=(512&g.F)||null!==g&&(g.type===jh.Auto||g.type===jh.Spot)&&g.zb()!==this)?(ca(this,!0),null===this.shadowVisible&&ul(a)):ca(this,!1),this.Qi(a,b),f&&0!=(512&this.F)==!0&&Ia(a),this.yf()&&f&&ul(a),r&&(a.restore(),h&&a.xc.pop()),this instanceof jh&&(t=a.xc.pop()),!0===c&&a.xc.pop(),(this instanceof ml&&1<this.lineCount||this instanceof rl&&1<this.geometry.figures.length)&&(t=a.xc.pop()),null!==a.yk.jq&&(null===t&&(e===a.uq?(Ba(a,1,0,0,1,0,0),t=a.xc.pop()):t=a.uq),a.yk.jq(this,t)),this.svg=t,!0},Ra.prototype.resize=function(a,b,t,e){return(this.width!==a||this.height!==b)&&(this.width=a,this.height=b,this.style.width=t+"px",this.style.height=e+"px",!0)},Ra.prototype.toDataURL=function(a,b){return this.Ea.toDataURL(a,b)},Ra.prototype.getBoundingClientRect=function(){return this.Ea.getBoundingClientRect()},Ra.prototype.focus=function(){this.Ea.focus()},Ra.prototype.Fx=function(){this.ownerDocument=this.Ea.B=null},v.Object.defineProperties(Ra.prototype,{width:{get:function(){return this.Ea.width},set:function(a){this.Ea.width=a}},height:{get:function(){return this.Ea.height},set:function(a){this.Ea.height=a}},style:{get:function(){return this.Ea.style}}}),Ra.className="CanvasSurface",(n=Ea.prototype).ky=function(a){this.V.imageSmoothingEnabled=a},n.arc=function(a,b,t,e,n,o){this.V.arc(a,b,t,e,n,o)},n.beginPath=function(){this.V.beginPath()},n.bezierCurveTo=function(a,b,t,e,n,o){this.V.bezierCurveTo(a,b,t,e,n,o)},n.clearRect=function(a,b,t,e){this.V.clearRect(a,b,t,e)},n.clip=function(){this.V.clip()},n.closePath=function(){this.V.closePath()},n.createLinearGradient=function(a,b,t,e){return this.V.createLinearGradient(a,b,t,e)},n.createPattern=function(a,b){return this.V.createPattern(a,b)},n.createRadialGradient=function(a,b,t,e,n,o){return this.V.createRadialGradient(a,b,t,e,n,o)},n.drawImage=function(a,b,t,e,n,o,g,r,h){void 0===e?this.V.drawImage(a,b,t):this.V.drawImage(a,b,t,e,n,o,g,r,h)},n.fill=function(){this.V.fill()},n.fillRect=function(a,b,t,e){this.V.fillRect(a,b,t,e)},n.fillText=function(a,b,t){this.V.fillText(a,b,t)},n.getImageData=function(a,b,t,e){return this.V.getImageData(a,b,t,e)},n.lineTo=function(a,b){this.V.lineTo(a,b)},n.measureText=function(a){return this.V.measureText(a)},n.moveTo=function(a,b){this.V.moveTo(a,b)},n.quadraticCurveTo=function(a,b,t,e){this.V.quadraticCurveTo(a,b,t,e)},n.rect=function(a,b,t,e){this.V.rect(a,b,t,e)},n.restore=function(){this.V.restore()},Ea.prototype.rotate=function(a){this.V.rotate(a)},(n=Ea.prototype).save=function(){this.V.save()},n.setTransform=function(a,b,t,e,n,o){this.V.setTransform(a,b,t,e,n,o)},n.scale=function(a,b){this.V.scale(a,b)},n.stroke=function(){this.V.stroke()},n.transform=function(a,b,t,e,n,o){1===a&&0===b&&0===t&&1===e&&0===n&&0===o||this.V.transform(a,b,t,e,n,o)},n.translate=function(a,b){this.V.translate(a,b)},n.Vd=function(a){if(a instanceof Ya&&a.type===nh){var b=a.Mk;(a=a.bu)>b?(this.scale(b/a,1),this.translate((a-b)/2,0)):b>a&&(this.scale(1,a/b),this.translate(0,(b-a)/2)),this.fn?this.clip():this.fill(),a>b?(this.translate(-(a-b)/2,0),this.scale(1/(b/a),1)):b>a&&(this.translate(0,-(b-a)/2),this.scale(1,1/(a/b)))}else this.fn?this.clip():this.fill()},n.fj=function(){this.fn||this.stroke()},n.jw=function(a,b,t){this.Fp=a,this.Gp=b,this.ef=t},n.ht=function(a,b){var t=this.V;void 0!==t.setLineDash&&(t.setLineDash(a),t.lineDashOffset=b)},n.ft=function(){var a=this.V;void 0!==a.setLineDash&&(a.setLineDash(za),a.lineDashOffset=0)},n.sc=function(a){a&&(this.$t=""),this.Zt=this.au=""},v.Object.defineProperties(Ea.prototype,{fillStyle:{get:function(){return this.V.fillStyle},set:function(a){this.Zt!==a&&(this.Zt=this.V.fillStyle=a)}},font:{get:function(){return this.V.font},set:function(a){this.$t!==a&&(this.$t=this.V.font=a)}},globalAlpha:{get:function(){return this.V.globalAlpha},set:function(a){this.V.globalAlpha=a}},lineCap:{get:function(){return this.V.lineCap},set:function(a){this.V.lineCap=a}},lineDashOffset:{get:function(){return this.V.lineDashOffset},set:function(a){this.V.lineDashOffset=a}},lineJoin:{get:function(){return this.V.lineJoin},set:function(a){this.V.lineJoin=a}},lineWidth:{get:function(){return this.V.lineWidth},set:function(a){this.V.lineWidth=a}},miterLimit:{get:function(){return this.V.miterLimit},set:function(a){this.V.miterLimit=a}},shadowBlur:{get:function(){return this.V.shadowBlur},set:function(a){this.V.shadowBlur=a}},shadowColor:{get:function(){return this.V.shadowColor},set:function(a){this.V.shadowColor=a}},shadowOffsetX:{get:function(){return this.V.shadowOffsetX},set:function(a){this.V.shadowOffsetX=a}},shadowOffsetY:{get:function(){return this.V.shadowOffsetY},set:function(a){this.V.shadowOffsetY=a}},strokeStyle:{get:function(){return this.V.strokeStyle},set:function(a){this.au!==a&&(this.au=this.V.strokeStyle=a)}},textAlign:{get:function(){return this.V.textAlign},set:function(a){this.V.textAlign=a}},imageSmoothingEnabled:{get:function(){return this.V.imageSmoothingEnabled},set:function(a){this.V.imageSmoothingEnabled=a}},clipInsteadOfFill:{get:function(){return this.fn},set:function(a){this.fn=a}}});var za=Object.freeze([]);function Va(){this.Y=this.v=this.I=this.l=0}function Ya(a){gh||(em(),gh=!0),ft(this),this.s=!1,void 0===a?(this.pa=ih,this.Lk="black"):"string"==typeof a?(this.pa=ih,this.Lk=a):(this.pa=a,this.Lk="black"),(a=this.pa)===eh?(this.ud=yi,this.Yk=ki):this.Yk=this.ud=a===nh?xi:pi,this.Os=0,this.Br=NaN,this.de=this.rs=this.ce=null,this.bu=this.Mk=0}function Ga(a,b,t){return b=void 0===b||"number"!=typeof b?.2:b,t=void 0===t?rh:t,Ha(a),Ka(b,t)}function Xa(a,b,t){return b=void 0===b||"number"!=typeof b?.2:b,t=void 0===t?rh:t,Ha(a),Ka(-b,t)}function qa(a,b,t){Ha(a),a=ch.l;var e=ch.I,n=ch.v,o=ch.Y;return Ha(b),void 0===t&&(t=.5),"rgba("+Math.round((ch.l-a)*t+a)+", "+Math.round((ch.I-e)*t+e)+", "+Math.round((ch.v-n)*t+n)+", "+Math.round((ch.Y-o)*t+o)+")"}function Ua(a){return null===a?null:a instanceof Ya?a.Tx():(Ha(a),128>(299*ch.l+587*ch.I+114*ch.v)/1e3)}function Ka(a,b){switch(b){case rh:b=100*Ja(ch.l);var t=100*Ja(ch.I),e=100*Ja(ch.v);return dh.l=.4124564*b+.3575761*t+.1804375*e,dh.I=.2126729*b+.7151522*t+.072175*e,dh.v=.0193339*b+.119192*t+.9503041*e,dh.Y=ch.Y,b=$a(dh.l/lh[0]),t=$a(dh.I/lh[1]),e=$a(dh.v/lh[2]),ph.l=116*t-16,ph.I=500*(b-t),ph.v=200*(t-e),ph.Y=dh.Y,ph.l=Math.min(100,Math.max(0,ph.l+100*a)),b=(a=(ph.l+16)/116)-ph.v/200,dh.l=lh[0]*Qa(ph.I/500+a),dh.I=lh[1]*(ph.l>hh*ah?Math.pow(a,3):ph.l/hh),dh.v=lh[2]*Qa(b),dh.Y=ph.Y,a=-.969266*dh.l+1.8760108*dh.I+.041556*dh.v,b=.0556434*dh.l+-.2040259*dh.I+1.0572252*dh.v,ch.l=255*Za((3.2404542*dh.l+-1.5371385*dh.I+-.4985314*dh.v)/100),ch.I=255*Za(a/100),ch.v=255*Za(b/100),ch.Y=dh.Y,ch.l=Math.round(ch.l),255<ch.l?ch.l=255:0>ch.l&&(ch.l=0),ch.I=Math.round(ch.I),255<ch.I?ch.I=255:0>ch.I&&(ch.I=0),ch.v=Math.round(ch.v),255<ch.v?ch.v=255:0>ch.v&&(ch.v=0),"rgba("+ch.l+", "+ch.I+", "+ch.v+", "+ch.Y+")";case sh:return Wa(),fh.v=Math.min(100,Math.max(0,fh.v+100*a)),"hsla("+fh.l+", "+fh.I+"%, "+fh.v+"%, "+fh.Y+")";default:return N("Unknown color space: "+b),"rgba(0, 0, 0, 1)"}}function Ha(a){gh||(em(),gh=!0);var b=uh;if(null!==b){b.clearRect(0,0,1,1),b.fillStyle="#000000";var t=b.fillStyle;b.fillStyle=a,b.fillStyle!==t?(b.fillRect(0,0,1,1),a=b.getImageData(0,0,1,1).data,ch.l=a[0],ch.I=a[1],ch.v=a[2],ch.Y=a[3]/255):(b.fillStyle="#FFFFFF",b.fillStyle=a,ch.l=0,ch.I=0,ch.v=0,ch.Y=1)}}function Wa(){var a=ch.l/255,b=ch.I/255,t=ch.v/255,e=Math.max(a,b,t),n=Math.min(a,b,t),o=e-n;if(n=(e+n)/2,0===o)var g=a=0;else{switch(e){case a:g=(b-t)/o%6;break;case b:g=(t-a)/o+2;break;case t:g=(a-b)/o+4}0>(g*=60)&&(g+=360),a=o/(1-Math.abs(2*n-1))}fh.l=Math.round(g),fh.I=Math.round(100*a),fh.v=Math.round(100*n),fh.Y=ch.Y}function Ja(a){return.04045>=(a/=255)?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Za(a){return.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055}function $a(a){return a>ah?Math.pow(a,1/3):(hh*a+16)/116}function Qa(a){var b=a*a*a;return b>ah?b:(116*a-16)/hh}function _a(a,b){"string"!=typeof a&&(a instanceof Ya||N("Value for "+b+" must be a color string or a Brush, not "+a))}function em(){uh=ys?new Ra(null).context:null}Ea.className="CanvasSurfaceContext",Va.className="ColorNumbers",Ya.prototype.copy=function(){var a=new Ya;return a.pa=this.pa,a.Lk=this.Lk,a.ud=this.ud.G(),a.Yk=this.Yk.G(),a.Os=this.Os,a.Br=this.Br,null!==this.ce&&(a.ce=this.ce.copy()),a.rs=this.rs,a},(n=Ya.prototype).freeze=function(){return this.s=!0,null!==this.ce&&this.ce.freeze(),this},n.ea=function(){return Object.isFrozen(this)&&N("cannot thaw constant: "+this),this.s=!1,null!==this.ce&&this.ce.ea(),this},n.cb=function(a){a.classType===Ya&&(this.type=a)},n.toString=function(){var a="Brush(";if(this.type===ih)a+=this.color;else if(a=this.type===eh?a+"Linear ":this.type===nh?a+"Radial ":this.type===oh?a+"Pattern ":a+"(unknown) ",a+=this.start+" "+this.end,null!==this.colorStops)for(var b=this.colorStops.iterator;b.next();)a+=" "+b.key+":"+b.value;return a+")"},n.addColorStop=function(a,b){return this.s&&C(this),("number"!=typeof a||!isFinite(a)||1<a||0>a)&&T(a,"0 <= loc <= 1",Ya,"addColorStop:loc"),null===this.ce&&(this.ce=new kt),this.ce.add(a,b),this.pa===ih&&(this.type=eh),this.de=null,this},n.bA=function(a,b){if(this.s&&C(this),a=void 0===a||"number"!=typeof a?.2:a,b=void 0===b?rh:b,this.type===ih)Ha(this.color),this.color=Ka(a,b);else if((this.type===eh||this.type===nh)&&null!==this.colorStops)for(var t=this.colorStops.iterator;t.next();)Ha(t.value),this.addColorStop(t.key,Ka(a,b));return this},n.Yy=function(a,b){if(this.s&&C(this),a=void 0===a||"number"!=typeof a?.2:a,b=void 0===b?rh:b,this.type===ih)Ha(this.color),this.color=Ka(-a,b);else if((this.type===eh||this.type===nh)&&null!==this.colorStops)for(var t=this.colorStops.iterator;t.next();)Ha(t.value),this.addColorStop(t.key,Ka(-a,b));return this},n.Tx=function(){if(this.type===ih)return Ua(this.color);if((this.type===eh||this.type===nh)&&null!==this.colorStops){var a=this.colorStops;if(this.type===nh)return Ua(a.first().value);if(null!==a.get(.5))return Ua(a.get(.5));if(2===a.count)return Ua(qa((a=a.na())[0].value,a[1].value));for(var b=a.iterator,t=-1,e=-1,n=1,o=1;b.next();){var g=b.key,r=Math.abs(.5-b.key);n>o&&r<n?(t=g,n=r):o>=n&&r<o&&(e=g,o=r)}return t>e&&(o=t,t=e,e=o,o=n),n=e-t,Ua(qa(a.get(t),a.get(e),1-o/n))}return!1},v.Object.defineProperties(Ya.prototype,{type:{get:function(){return this.pa},set:function(a){this.s&&C(this,a),this.pa=a,this.start.jc()&&(a===eh?this.start=yi:a===nh&&(this.start=xi)),this.end.jc()&&(a===eh?this.end=ki:a===nh&&(this.end=xi)),this.de=null}},color:{get:function(){return this.Lk},set:function(a){this.s&&C(this,a),this.Lk=a,this.de=null}},start:{get:function(){return this.ud},set:function(a){this.s&&C(this,a),this.ud=a.G(),this.de=null}},end:{get:function(){return this.Yk},set:function(a){this.s&&C(this,a),this.Yk=a.G(),this.de=null}},startRadius:{get:function(){return this.Os},set:function(a){this.s&&C(this,a),0>a&&T(a,">= zero",Ya,"startRadius"),this.Os=a,this.de=null}},endRadius:{get:function(){return this.Br},set:function(a){this.s&&C(this,a),0>a&&T(a,">= zero",Ya,"endRadius"),this.Br=a,this.de=null}},colorStops:{get:function(){return this.ce},set:function(a){this.s&&C(this,a),this.ce=a,this.de=null}},pattern:{get:function(){return this.rs},set:function(a){this.s&&C(this,a),this.rs=a,this.de=null}}}),Ya.prototype.isDark=Ya.prototype.Tx,Ya.prototype.darkenBy=Ya.prototype.Yy,Ya.prototype.lightenBy=Ya.prototype.bA,Ya.prototype.addColorStop=Ya.prototype.addColorStop;var ih,eh,nh,oh,rh,sh,ah=216/24389,hh=24389/27,lh=[95.047,100,108.883],uh=null,ch=new Va,fh=new Va,dh=new Va,ph=new Va,gh=!1;function yh(){this.name="Base"}function mh(){this.name="Base",this.name="Position"}function vh(){this.name="Base",this.name="Horizontal"}function xh(){this.name="Base",this.name="Vertical"}function bh(){this.name="Base",this.name="Spot"}function wh(){this.name="Base",this.name="Auto"}function kh(){this.name="Base",this.name="Table"}function Mh(){this.name="Base",this.name="TableRow"}function Sh(){this.name="Base",this.name="TableColumn"}function Ph(){this.name="Base",this.name="Viewbox"}function Nh(){this.name="Base",this.name="Grid"}function Ch(a,b,t){if(0>b)return 0==a%b;if(0!=a%b)return!1;b=t.length;for(var e=0;e<b;e++)if(0==a%t[e])return!1;return!0}function Th(){this.name="Base",this.name="Link"}function Lh(a,b,t,e){if(!1!==ya(e)){var n=e.strokeWidth;0===n&&a instanceof Lu&&a.type===jh.Link&&a.adornedObject instanceof rl&&(n=a.adornedObject.strokeWidth),n*=e.ya,a instanceof Wu&&null!==a.ka?ia(e,(a=a.ka.bounds).x-n/2,a.y-n/2,a.width+n,a.height+n):a instanceof Lu&&null!==a.adornedPart.ka?ia(e,(a=a.adornedPart.ka.bounds).x-n/2,a.y-n/2,a.width+n,a.height+n):ia(e,-n/2,-n/2,b+n,t+n),ma(e,!1)}}function Ah(){this.name="Base",this.name="Graduated"}function jh(a){_s.call(this),this.pa=void 0===a?jh.Position:a,null===this.pa&&N("Panel type not specified or PanelLayout not loaded: "+a),this.W=new lt,this.bb=fi,this.pa===jh.Grid&&(this.isAtomic=!0),this.un=zi,this.Qf=rs,this.pa===jh.Table&&Dh(this),this.Yp=os,this.Sn=Vt,this.Tn=jt,this.Pn=0,this.On=100,this.Rn=10,this.Qn=0,this.ci=this.hb=this.$g=this.Zg=this.uj=null,this.io=NaN,this.me=this.si=null,this.ql="category",this.Kd=null,this.vg=new Wt(NaN,NaN,NaN,NaN),this.vh=this.rp=this.Hi=null,this.Jg=""}function Dh(a){a.nj=fi,a.Rg=1,a.ii=null,a.hi=null,a.Qg=1,a.Pg=null,a.gi=null,a.rb=[],a.mb=[],a.Mj=nl,a.kj=nl,a.Ki=0,a.vi=0}function Fh(a,b,t,e){for(var n=e.length,o=a.actualBounds,g=a.naturalBounds,r=!0,h=0;h<n;h++){var l=e[h];if(void 0!==l)if(r)r=!1;else if(0!==l.actual){if(t){if(l.position>o.height)continue}else if(l.position>o.width)continue;var c=l.separatorStrokeWidth;isNaN(c)&&(c=t?a.Rg:a.Qg);var f=l.separatorStroke;if(null===f&&(f=t?a.ii:a.Pg),0!==c&&null!==f){oa(a,b,f,!1,!1,g,o),f=!1;var p=l.separatorDashArray;null===p&&(p=t?a.hi:a.gi),null!==p&&(f=!0,b.ht(p,0)),b.beginPath(),p=l.position+c,t?p>o.height&&(c-=p-o.height):p>o.width&&(c-=p-o.width),l=l.position+c/2,b.lineWidth=c,c=a.bb,t?(l+=c.top,p=o.width-c.right,b.moveTo(c.left,l),b.lineTo(p,l)):(l+=c.left,p=o.height-c.bottom,b.moveTo(l,c.top),b.lineTo(l,p)),b.stroke(),f&&b.ft()}}}}function Oh(a,b,t,e,n){for(var o=e.length,g=a.actualBounds,r=a.naturalBounds,h=0;h<o;h++){var l=e[h];if(void 0!==l&&null!==l.background&&l.coversSeparators!==n&&0!==l.actual){var c=t?g.height:g.width;if(!(l.position>c)){var f=l.uc(),p=l.separatorStrokeWidth;isNaN(p)&&(p=t?a.Rg:a.Qg);var d=l.separatorStroke;null===d&&(d=t?a.ii:a.Pg),null===d&&(p=0),f-=p,(p=l.position+p)+(f+=l.actual)>c&&(f=c-p),0>=f||(c=a.bb,oa(a,b,l.background,!0,!1,r,g),t?b.fillRect(c.left,p+c.top,g.width-(c.left+c.right),f):b.fillRect(p+c.left,c.top,f,g.height-(c.top+c.bottom)))}}}}function Bh(a){return"LineV"===a||"BarV"===a}function Ih(a){return null!==a.part?a.part.locationObject:null}function Rh(a,b){!function t(a,b,e){e(b);for(var n=(b=b.W.j).length,o=0;o<n;o++){var r=b[o];r instanceof jh&&t(a,r,e)}}(a,a,b)}function Eh(a,b){!function t(a,b,e){if(e(b),b instanceof jh)for(var n=(b=b.W.j).length,o=0;o<n;o++)t(a,b[o],e)}(a,a,b)}function zh(a,b,t,e){for(var n=a.W.j,o=n.length;o--;){var g=n[o];if(g.visible){var r=g.actualBounds,h=a.naturalBounds;r.x>h.width||r.y>h.height||0>r.x+r.width||0>r.y+r.height||(g instanceof jh&&zh(g,b,t,e),null!==b&&(g=b(g)),null===g||null!==t&&!t(g)||e.add(g))}}}function Vh(a){var b=null;return a instanceof rl&&((b=a.spot1)===zi&&(b=null),null!==(a=a.geometry)&&null===b&&(b=a.spot1)),null===b&&(b=gi),b}function Yh(a){var b=null;return a instanceof rl&&((b=a.spot2)===zi&&(b=null),null!==(a=a.geometry)&&null===b&&(b=a.spot2)),null===b&&(b=Mi),b}function Gh(a,b){a.F=b?16777216|a.F:-16777217&a.F}function Xh(a){return null!==(a=a.ci)&&a.s}function qh(a){var b=a.ci;if(null===b)null!==a.data&&N("Template cannot have .data be non-null: "+a),a.ci=b=new lt;else if(b.s)return;var t=new lt;Gh(a,!1),a.Km(a,(function(a,e){var n=e.$a;if(null!==n)for(da(e,!1),n=n.iterator;n.next();){var o=n.value;o.mode===pd&&da(e,!0);var g=o.sourceName;null!==g&&("/"===g&&Gh(a,!0),null!==(g=cd(o,a,e))&&(t.add(g),null===g.Pl&&(g.Pl=new lt),g.Pl.add(o))),b.add(o)}if(e instanceof jh&&e.type===jh.Table){if(0<e.rb.length)for(n=(a=e.rb).length,o=0;o<n;o++)if(void 0!==(g=a[o])&&null!==g.$a)for(var r=g.$a.iterator;r.next();){var h=r.value;h.bd=g,h.Qp=2,h.Vl=g.index,b.add(h)}if(0<e.mb.length)for(a=(e=e.mb).length,n=0;n<a;n++)if(void 0!==(o=e[n])&&null!==o.$a)for(g=o.$a.iterator;g.next();)(r=g.value).bd=o,r.Qp=1,r.Vl=o.index,b.add(r)}}));for(var e=t.iterator;e.next();){var n=e.value;if(null!==n.Pl){da(n,!0);for(var o=n.Pl.iterator;o.next();){var g=o.value;null===n.$a&&(n.$a=new lt),n.$a.add(g)}}n.Pl=null}for(e=b.iterator;e.next();)if(null!==(o=(n=e.value).bd)){n.bd=null;var r=n.targetProperty,h=r.indexOf(".");0<h&&o instanceof jh&&(g=r.substring(0,h),r=r.substr(h+1),null!==(h=o.Xa(g))?(o=h,n.targetProperty=r):L('Warning: unable to find GraphObject named "'+g+'" for Binding: '+n.toString())),o instanceof _h?(g=gt(o.panel),n.gj=void 0===g?-1:g,o.panel.Jk=n.gj):o instanceof _s?(g=gt(o),n.gj=void 0===g?-1:g,o.Jk=n.gj):N("Unknown type of binding target: "+o)}b.freeze(),a instanceof lu&&a.Wb()&&a.yb()}function Uh(a){if(a.type===jh.Spot||a.type===jh.Auto)return Math.min(a.W.length,1);if(a.type===jh.Link){for(var b=(a=a.W).length,t=0;t<b;t++){var e=a.L(t);if(!(e instanceof rl&&e.isPanelMain))break}return t}return a.type===jh.Table&&0<a.W.length&&((a=a.W.L(0)).isPanelMain&&a instanceof jh&&(a.type===jh.TableRow||a.type===jh.TableColumn))?1:0}function Kh(a,b,t){if(!(null==b||0>t)){var e=function(a,b){if(null===b)return"";if("function"==typeof(a=a.ql))a=a(b);else{if("string"!=typeof a||"object"!=typeof b)return"";if(""===a)return"";a=sd(b,a)}return void 0===a?"":"string"==typeof a?a:(N("Panel.getCategoryForItemData found a non-string category for "+b+": "+a),"")}(a,b),n=a.itemTemplateMap,o=null;null!==n&&(o=n.H(e)),null===o&&(Zh||(Zh=!0,L('No item template Panel found for category "'+e+'" on '+a),L("  Using default item template."),e=new jh,(n=new ml).bind(new ud("text","",z)),e.add(n),$h=e),o=$h),null!==(e=o)&&(qh(e),0!=(16777216&(e=e.copy()).F)&&(null!==(n=a.Ui())&&Gh(n,!0)),"object"==typeof b&&(null===a.Kd&&(a.Kd=new kt),a.Kd.add(b,e)),n=t+Uh(a),a.Kb(n,e),e.hb=b,Hh(a,n,t),e.hb=null,e.data=b)}}function Hh(a,b,t){for(a=a.W;b<a.length;){var e=a.L(b);if(e instanceof jh){var n=b,o=t;e.type===jh.TableRow?e.row=n:e.type===jh.TableColumn&&(e.column=n),e.itemIndex=o}b++,t++}}function Wh(a,b,t){var e=b.enabledChanged;if(null!==e&&e(b,t),b instanceof jh){e=(b=b.W.j).length;for(var n=0;n<e;n++){var o=b[n];t&&o instanceof jh&&!o.isEnabled||Wh(a,o,t)}}}function Jh(a,b){Qh.add(a,b)}Ya.className="Brush",Ya.Solid=ih=new _(Ya,"Solid",0),Ya.Linear=eh=new _(Ya,"Linear",1),Ya.Radial=nh=new _(Ya,"Radial",2),Ya.Pattern=oh=new _(Ya,"Pattern",4),Ya.Lab=rh=new _(Ya,"Lab",5),Ya.HSL=sh=new _(Ya,"HSL",6),Ya.randomColor=function(a,b){void 0===a&&(a=128),void 0===b&&(b=Math.max(a,255));var t=Math.abs(b-a);b=Math.floor(a+Math.random()*t).toString(16);var e=Math.floor(a+Math.random()*t).toString(16);return a=Math.floor(a+Math.random()*t).toString(16),2>b.length&&(b="0"+b),2>e.length&&(e="0"+e),2>a.length&&(a="0"+a),"#"+b+e+a},Ya.isValidColor=function(a){if("black"===a)return!0;if(""===a)return!1;gh||(em(),gh=!0);var b=uh;if(null===b)return!0;b.fillStyle="#000000";var t=b.fillStyle;return b.fillStyle=a,b.fillStyle!==t||(b.fillStyle="#FFFFFF",t=b.fillStyle,b.fillStyle=a,b.fillStyle!==t)},Ya.lighten=function(a){return Ga(a)},Ya.lightenBy=Ga,Ya.darken=function(a){return Xa(a)},Ya.darkenBy=Xa,Ya.mix=qa,Ya.isDark=Ua,yh.prototype.measure=function(){},yh.prototype.eA=function(a,b,t,e,n){a.measure(b,t,e,n)},yh.prototype.arrange=function(){},yh.prototype.Oy=function(a,b,t,e,n,o){a.arrange(b,t,e,n,o)},yh.prototype.bc=function(){},v.Object.defineProperties(yh.prototype,{classType:{get:function(){return jh}}}),yh.prototype.arrangeElement=yh.prototype.Oy,yh.prototype.measureElement=yh.prototype.eA,yh.className="PanelLayout",m(mh,yh),mh.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length;a=Ih(a);for(var h=0;h<r;h++){var l=e[h];if(l.visible||l===a){var c=l.margin,f=c.right+c.left;c=c.top+c.bottom,l.measure(b,t,o,g);var p=l.measuredBounds;f=Math.max(p.width+f,0),c=Math.max(p.height+c,0),p=l.position.x;var d=l.position.y;isFinite(p)||(p=0),isFinite(d)||(d=0),l instanceof rl&&l.isGeometryPositioned&&(p-=l=l.strokeWidth/2,d-=l),ei(n,p,d,f,c)}}},mh.prototype.arrange=function(a,b,t){var e=b.length,n=a.padding;for(a=t.x-n.left,t=t.y-n.top,n=0;n<e;n++){var o=b[n],g=o.measuredBounds,r=o.margin,h=o.position.x,l=o.position.y;if(h=isNaN(h)?-a:h-a,l=isNaN(l)?-t:l-t,o instanceof rl&&o.isGeometryPositioned){var c=o.strokeWidth/2;h-=c,l-=c}o.visible&&o.arrange(h+r.left,l+r.top,g.width,g.height)}},m(vh,yh),vh.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length;b=I(),o=Ih(a);for(var h=0;h<r;h++){var l=e[h];if(l.visible||l===o){var c=ha(l,!1);if(c!==ns&&c!==ss)b.push(l);else{l.measure(1/0,t,0,g),c=l.margin,l=l.measuredBounds;var f=Math.max(l.height+c.top+c.bottom,0);n.width+=Math.max(l.width+c.right+c.left,0),n.height=Math.max(n.height,f)}}}for(e=b.length,a.desiredSize.height?t=Math.min(a.desiredSize.height,a.maxSize.height):0!==n.height&&(t=Math.min(n.height,a.maxSize.height)),a=0;a<e;a++)((h=b[a]).visible||h===o)&&(r=(c=h.margin).right+c.left,c=c.top+c.bottom,h.measure(1/0,t,0,g),h=h.measuredBounds,c=Math.max(h.height+c,0),n.width+=Math.max(h.width+r,0),n.height=Math.max(n.height,c));R(b)},vh.prototype.arrange=function(a,b,t){for(var e=b.length,n=a.padding,o=n.top,g=a.isOpposite,r=g?t.width:n.left,h=0;h<e;h++){var l=o,c=b[h];if(c.visible){var f=c.measuredBounds,p=c.margin,d=p.top+p.bottom,q=o+n.bottom,u=f.height,y=ha(c,!1);(isNaN(c.desiredSize.height)&&y===es||y===as)&&(u=Math.max(t.height-d-q,0)),d=u+d+q,(q=c.alignment).Mb()&&(q=a.defaultAlignment),q.eb()||(q=xi),g&&(r-=f.width+p.left+p.right),c.arrange(r+q.offsetX+p.left,l+q.offsetY+p.top+(t.height*q.y-d*q.y),f.width,u),g||(r+=f.width+p.left+p.right)}}},m(xh,yh),xh.prototype.measure=function(a,b,t,e,n,o){var g=e.length;t=I();for(var r=Ih(a),h=0;h<g;h++){var l=e[h];if(l.visible||l===r){var c=ha(l,!1);if(c!==ns&&c!==as)t.push(l);else{var f=l.margin;c=f.right+f.left,f=f.top+f.bottom,l.measure(b,1/0,o,0),l=l.measuredBounds,Jt(n,Math.max(n.width,Math.max(l.width+c,0)),n.height+Math.max(l.height+f,0))}}}if(0!==(e=t.length)){for(a.desiredSize.width?b=Math.min(a.desiredSize.width,a.maxSize.width):0!==n.width&&(b=Math.min(n.width,a.maxSize.width)),a=0;a<e;a++)((h=t[a]).visible||h===r)&&(g=(l=h.margin).right+l.left,l=l.top+l.bottom,h.measure(b,1/0,o,0),h=h.measuredBounds,l=Math.max(h.height+l,0),n.width=Math.max(n.width,Math.max(h.width+g,0)),n.height+=l);R(t)}},xh.prototype.arrange=function(a,b,t){for(var e=b.length,n=a.padding,o=n.left,g=a.isOpposite,r=g?t.height:n.top,h=0;h<e;h++){var l=o,c=b[h];if(c.visible){var f=c.measuredBounds,p=c.margin,d=p.left+p.right,q=o+n.right,u=f.width,y=ha(c,!1);(isNaN(c.desiredSize.width)&&y===es||y===ss)&&(u=Math.max(t.width-d-q,0)),d=u+d+q,(q=c.alignment).Mb()&&(q=a.defaultAlignment),q.eb()||(q=xi),g&&(r-=f.height+p.bottom+p.top),c.arrange(l+q.offsetX+p.left+(t.width*q.x-d*q.x),r+q.offsetY+p.top,u,f.height),g||(r+=f.height+p.bottom+p.top)}}},m(bh,yh),bh.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length,h=a.zb(),l=h.margin,c=l.right+l.left,f=l.top+l.bottom;h.measure(b,t,o,g);var p=h.measuredBounds;o=p.width,g=p.height;for(var d=Math.max(o+c,0),q=Math.max(g+f,0),u=a.isClipping,y=Wt.allocAt(-l.left,-l.top,d,q),m=!0,v=Ih(a),x=0;x<r;x++){var w=e[x];if(w!==h&&(w.visible||w===v)){switch(d=(l=w.margin).right+l.left,q=l.top+l.bottom,p=ha(w,!1)){case es:b=o,t=g;break;case ss:b=o;break;case as:t=g}w.measure(b,t,0,0),p=w.measuredBounds,d=Math.max(p.width+d,0),q=Math.max(p.height+q,0);var k=w.alignment;k.Mb()&&(k=a.defaultAlignment),k.eb()||(k=xi);var M=w.alignmentFocus;M.Mb()&&(M=xi);var S=null;if(w instanceof jh&&""!==w.Jg&&(w.arrange(0,0,p.width,p.height),(S=w.Xa(w.Jg))===w&&(S=null)),null!==S){for(l=S.naturalBounds,p=S.margin,l=Mt.allocAt(M.x*l.width-M.offsetX-p.left,M.y*l.height-M.offsetY-p.top);S!==w;)S.transform.ra(l),S=S.panel;w=k.x*o+k.offsetX-l.x,p=k.y*g+k.offsetY-l.y,Mt.free(l)}else w=k.x*o+k.offsetX-(M.x*p.width+M.offsetX)-l.left,p=k.y*g+k.offsetY-(M.y*p.height+M.offsetY)-l.top;m?(m=!1,n.h(w,p,d,q)):ei(n,w,p,d,q)}}switch(m?n.assign(y):u?n.Ev(y.x,y.y,y.width,y.height):ei(n,y.x,y.y,y.width,y.height),Wt.free(y),(p=h.stretch)===rs&&(p=ha(h,!1)),p){case ns:return;case es:if(!isFinite(b)&&!isFinite(t))return;break;case ss:if(!isFinite(b))return;break;case as:if(!isFinite(t))return}for(o=(p=h.measuredBounds).width,g=p.height,d=Math.max(o+c,0),q=Math.max(g+f,0),l=h.margin,y=Wt.allocAt(-l.left,-l.top,d,q),b=0;b<r;b++)(t=e[b])===h||!t.visible&&t!==v||(d=(l=t.margin).right+l.left,q=l.top+l.bottom,p=t.measuredBounds,d=Math.max(p.width+d,0),q=Math.max(p.height+q,0),(c=t.alignment).Mb()&&(c=a.defaultAlignment),c.eb()||(c=xi),(t=t.alignmentFocus).Mb()&&(t=xi),m?(m=!1,n.h(c.x*o+c.offsetX-(t.x*p.width+t.offsetX)-l.left,c.y*g+c.offsetY-(t.y*p.height+t.offsetY)-l.top,d,q)):ei(n,c.x*o+c.offsetX-(t.x*p.width+t.offsetX)-l.left,c.y*g+c.offsetY-(t.y*p.height+t.offsetY)-l.top,d,q));m?n.assign(y):u?n.Ev(y.x,y.y,y.width,y.height):ei(n,y.x,y.y,y.width,y.height),Wt.free(y)},bh.prototype.arrange=function(a,b,t){var e=b.length,n=a.zb(),o=n.measuredBounds,g=o.width;o=o.height;var r=a.padding,h=r.left;r=r.top;var l=h-t.x,c=r-t.y;n.arrange(l,c,g,o);for(var f=0;f<e;f++){var p=b[f];if(p!==n){var d=p.measuredBounds,q=d.width;d=d.height,(c=p.alignment).Mb()&&(c=a.defaultAlignment),c.eb()||(c=xi);var u=p.alignmentFocus;if(u.Mb()&&(u=xi),l=null,p instanceof jh&&""!==p.Jg&&((l=p.Xa(p.Jg))===p&&(l=null)),null!==l){var y=l.naturalBounds;for(u=Mt.allocAt(u.x*y.width-u.offsetX,u.y*y.height-u.offsetY);l!==p;)l.transform.ra(u),l=l.panel;l=c.x*g+c.offsetX-u.x,c=c.y*o+c.offsetY-u.y,Mt.free(u)}else l=c.x*g+c.offsetX-(u.x*q+u.offsetX),c=c.y*o+c.offsetY-(u.y*d+u.offsetY);l-=t.x,c-=t.y,p.visible&&p.arrange(h+l,r+c,q,d)}}},m(wh,yh),wh.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length,h=a.zb(),l=h.margin,c=b,f=t,p=l.right+l.left,d=l.top+l.bottom;h.measure(b,t,o,g),l=h.measuredBounds;var q=0,u=null;h instanceof rl&&(q=(u=h).strokeWidth*u.scale);var y=Math.max(l.width+p,0);l=Math.max(l.height+d,0);var m=Vh(h),v=m.x*y+m.offsetX;m=m.y*l+m.offsetY;var x=Yh(h),w=x.x*y+x.offsetX;for(x=x.y*l+x.offsetY,isFinite(b)&&(c=Math.max(Math.abs(v-w)-q,0)),isFinite(t)&&(f=Math.max(Math.abs(m-x)-q,0)),(q=qt.alloc()).h(0,0),a=Ih(a),x=0;x<r;x++)(m=e[x])===h||!m.visible&&m!==a||(y=(l=m.margin).right+l.left,v=l.top+l.bottom,m.measure(c,f,0,0),l=m.measuredBounds,y=Math.max(l.width+y,0),l=Math.max(l.height+v,0),q.h(Math.max(y,q.width),Math.max(l,q.height)));if(1===r)n.width=y,n.height=l,qt.free(q);else{switch(m=Vh(h),r=e=0,(x=Yh(h)).x!==m.x&&x.y!==m.y&&(e=q.width/Math.abs(x.x-m.x),r=q.height/Math.abs(x.y-m.y)),qt.free(q),q=0,null!==u&&(q=u.strokeWidth*u.scale,al(u)===os&&(e=r=Math.max(e,r))),e+=Math.abs(m.offsetX)+Math.abs(x.offsetX)+q,r+=Math.abs(m.offsetY)+Math.abs(x.offsetY)+q,(u=h.stretch)===rs&&(u=ha(h,!1)),u){case ns:g=o=0;break;case es:isFinite(b)&&(e=b),isFinite(t)&&(r=t);break;case ss:isFinite(b)&&(e=b),g=0;break;case as:o=0,isFinite(t)&&(r=t)}h.om(),h.measure(e,r,o,g),n.width=h.measuredBounds.width+p,n.height=h.measuredBounds.height+d}},wh.prototype.arrange=function(a,b){var t=b.length,e=a.zb(),n=e.measuredBounds,o=Wt.alloc();o.h(0,0,1,1);var g=e.margin,r=g.left;g=g.top;var h=a.padding,l=h.left;h=h.top,e.arrange(l+r,h+g,n.width,n.height);var c=Vh(e),f=Yh(e),p=c.y*n.height+c.offsetY,d=f.x*n.width+f.offsetX;for(f=f.y*n.height+f.offsetY,o.x=c.x*n.width+c.offsetX,o.y=p,ei(o,d,f,0,0),o.x+=r+l,o.y+=g+h,n=0;n<t;n++)(r=b[n])!==e&&(l=r.measuredBounds,g=r.margin,h=Math.max(l.width+g.right+g.left,0),c=Math.max(l.height+g.top+g.bottom,0),(p=r.alignment).Mb()&&(p=a.defaultAlignment),p.eb()||(p=xi),h=o.width*p.x+p.offsetX-h*p.x+g.left+o.x,g=o.height*p.y+p.offsetY-c*p.y+g.top+o.y,r.visible&&(ni(o.x,o.y,o.width,o.height,h,g,l.width,l.height)?r.arrange(h,g,l.width,l.height):r.arrange(h,g,l.width,l.height,new Wt(o.x,o.y,o.width,o.height))));Wt.free(o)},m(kh,yh),kh.prototype.measure=function(a,b,t,e,n,o,g){for(var r=e.length,h=I(),l=I(),c=0;c<r;c++){var f=e[c],p=f instanceof jh?f:null;if(null===p||p.type!==jh.TableRow&&p.type!==jh.TableColumn||!f.visible)h.push(f);else{l.push(p);for(var d=p.W.j,q=d.length,u=0;u<q;u++){var y=d[u];p.type===jh.TableRow?y.row=f.row:p.type===jh.TableColumn&&(y.column=f.column),h.push(y)}}}0===(r=h.length)&&(a.getRowDefinition(0),a.getColumnDefinition(0));for(var m=[],v=0;v<r;v++){var x=h[v];ma(x,!0),xa(x,!0),m[x.row]||(m[x.row]=[]),m[x.row][x.column]||(m[x.row][x.column]=[]),m[x.row][x.column].push(x)}R(h);var w=I(),k=I(),M=I(),S={count:0},P={count:0},N=b,C=t,T=a.rb;r=T.length;for(var L=0;L<r;L++){var A=T[L];void 0!==A&&(A.actual=0)}r=(T=a.mb).length;for(var j=0;j<r;j++)void 0!==(A=T[j])&&(A.actual=0);for(var D=m.length,F=0,O=0;O<D;O++)m[O]&&(F=Math.max(F,m[O].length));var B=Math.min(a.topIndex,D-1),E=Math.min(a.leftIndex,F-1),z=0;D=m.length;for(var V=Ih(a),Y=0;Y<D;Y++)if(m[Y]){F=m[Y].length;for(var G=a.getRowDefinition(Y),X=G.actual=0;X<F;X++)if(m[Y][X]){var U=a.getColumnDefinition(X);void 0===w[X]&&(U.actual=0,w[X]=!0);for(var K=m[Y][X],H=K.length,W=0;W<H;W++){var J=K[W];if(J.visible||J===V){var Z=1<J.rowSpan||1<J.columnSpan;Z&&(Y<B||X<E||k.push(J));var $=J.margin,Q=$.right+$.left,_=$.top+$.bottom,tt=la(J,G,U,!1),it=J.desiredSize,et=!isNaN(it.height),nt=!isNaN(it.width)&&et;if(Z||tt===ns||nt||Y<B||X<E||(void 0!==S[X]||tt!==es&&tt!==ss||(S[X]=-1,S.count++),void 0!==P[Y]||tt!==es&&tt!==as||(P[Y]=-1,P.count++),M.push(J)),J.measure(1/0,1/0,0,0),!(Y<B||X<E)){var ot=J.measuredBounds,st=Math.max(ot.width+Q,0),at=Math.max(ot.height+_,0);if(1===J.rowSpan&&(tt===ns||tt===ss)){var ht=(A=a.getRowDefinition(Y)).uc();(z=Math.max(at-A.actual,0))+ht>C&&(z=Math.max(C-ht,0));var lt=0===A.actual;A.actual=A.actual+z,C=Math.max(C-(z+(lt?ht:0)),0)}if(1===J.columnSpan&&(tt===ns||tt===as)){var ut=(A=a.getColumnDefinition(X)).uc();(z=Math.max(st-A.actual,0))+ut>N&&(z=Math.max(N-ut,0));var ct=0===A.actual;A.actual=A.actual+z,N=Math.max(N-(z+(ct?ut:0)),0)}Z&&J.om()}}}}}R(w);var ft=0,pt=0;r=a.columnCount;for(var gt=0;gt<r;gt++){var yt=a.mb[gt];void 0!==yt&&(ft+=yt.ha,0!==yt.ha&&(ft+=yt.uc()))}r=a.rowCount;for(var mt=0;mt<r;mt++){var vt=a.rb[mt];void 0!==vt&&(pt+=vt.ha,0!==vt.ha&&(pt+=vt.uc()))}N=Math.max(b-ft,0);var xt=C=Math.max(t-pt,0),bt=N;r=M.length;for(var wt=0;wt<r;wt++){var kt=M[wt],Mt=a.getRowDefinition(kt.row),St=a.getColumnDefinition(kt.column),Pt=kt.measuredBounds,Nt=kt.margin,Ct=Nt.right+Nt.left,Tt=Nt.top+Nt.bottom;S[kt.column]=0===St.actual&&void 0!==S[kt.column]?Math.max(Pt.width+Ct,S[kt.column]):null,P[kt.row]=0===Mt.actual&&void 0!==P[kt.row]?Math.max(Pt.height+Tt,P[kt.row]):null}var Lt,At=0,jt=0;for(Lt in P)"count"!==Lt&&(At+=P[Lt]);for(Lt in S)"count"!==Lt&&(jt+=S[Lt]);for(var Dt=qt.alloc(),Ft=0;Ft<r;Ft++){var Ot=M[Ft];if(Ot.visible||Ot===V){var Bt=a.getRowDefinition(Ot.row),It=a.getColumnDefinition(Ot.column),Rt=0;isFinite(It.width)?Rt=It.width:(Rt=isFinite(N)&&null!==S[Ot.column]?0===jt?It.actual+N:S[Ot.column]/jt*bt:null!==S[Ot.column]?N:It.actual||N,Rt=Math.max(0,Rt-It.uc()));var Et=0;switch(isFinite(Bt.height)?Et=Bt.height:(Et=isFinite(C)&&null!==P[Ot.row]?0===At?Bt.actual+C:P[Ot.row]/At*xt:null!==P[Ot.row]?C:Bt.actual||C,Et=Math.max(0,Et-Bt.uc())),Dt.h(Math.max(It.minimum,Math.min(Rt,It.maximum)),Math.max(Bt.minimum,Math.min(Et,Bt.maximum))),tt=la(Ot,Bt,It,!1)){case ss:Dt.height=Math.max(Dt.height,Bt.actual+C);break;case as:Dt.width=Math.max(Dt.width,It.actual+N)}var zt=Ot.margin,Vt=zt.right+zt.left,Yt=zt.top+zt.bottom;Ot.om(),Ot.measure(Dt.width,Dt.height,It.minimum,Bt.minimum);var Gt=Ot.measuredBounds,Xt=Math.max(Gt.width+Vt,0),Ut=Math.max(Gt.height+Yt,0);isFinite(N)&&(Xt=Math.min(Xt,Dt.width)),isFinite(C)&&(Ut=Math.min(Ut,Dt.height));var Kt=0;Kt=Bt.actual,Bt.actual=Math.max(Bt.actual,Ut),z=Bt.actual-Kt,C=Math.max(C-z,0),Kt=It.actual,It.actual=Math.max(It.actual,Xt),z=It.actual-Kt,N=Math.max(N-z,0)}}R(M);var Ht=qt.alloc(),Wt=I(),Jt=I();if(0!==(r=k.length))for(var Zt=0;Zt<D;Zt++)if(m[Zt]){F=m[Zt].length;var $t=a.getRowDefinition(Zt);Wt[Zt]=$t.actual;for(var Qt=0;Qt<F;Qt++)if(m[Zt][Qt]){var _t=a.getColumnDefinition(Qt);Jt[Qt]=_t.actual}}for(var ti=0;ti<r;ti++){var ii=k[ti];if(ii.visible||ii===V){var ei=a.getRowDefinition(ii.row),ni=a.getColumnDefinition(ii.column);switch(Dt.h(Math.max(ni.minimum,Math.min(b,ni.maximum)),Math.max(ei.minimum,Math.min(t,ei.maximum))),tt=la(ii,ei,ni,!1)){case es:0!==Jt[ni.index]&&(Dt.width=Math.min(Dt.width,Jt[ni.index])),0!==Wt[ei.index]&&(Dt.height=Math.min(Dt.height,Wt[ei.index]));break;case ss:0!==Jt[ni.index]&&(Dt.width=Math.min(Dt.width,Jt[ni.index]));break;case as:0!==Wt[ei.index]&&(Dt.height=Math.min(Dt.height,Wt[ei.index]))}isFinite(ni.width)&&(Dt.width=ni.width),isFinite(ei.height)&&(Dt.height=ei.height),Ht.h(0,0);for(var oi=1;oi<ii.rowSpan&&!(ii.row+oi>=a.rowCount);oi++)A=a.getRowDefinition(ii.row+oi),z=0,z=tt===es||tt===as?Math.max(A.minimum,0===Wt[ii.row+oi]?A.maximum:Math.min(Wt[ii.row+oi],A.maximum)):Math.max(A.minimum,isNaN(A.Pc)?A.maximum:Math.min(A.Pc,A.maximum)),Ht.height+=z;for(var ri=1;ri<ii.columnSpan&&!(ii.column+ri>=a.columnCount);ri++)A=a.getColumnDefinition(ii.column+ri),z=0,z=tt===es||tt===ss?Math.max(A.minimum,0===Jt[ii.column+ri]?A.maximum:Math.min(Jt[ii.column+ri],A.maximum)):Math.max(A.minimum,isNaN(A.Pc)?A.maximum:Math.min(A.Pc,A.maximum)),Ht.width+=z;Dt.width+=Ht.width,Dt.height+=Ht.height;var si=ii.margin,ai=si.right+si.left,hi=si.top+si.bottom;ii.measure(Dt.width,Dt.height,o,g);for(var ui=ii.measuredBounds,ci=Math.max(ui.width+ai,0),fi=Math.max(ui.height+hi,0),di=0,pi=0;pi<ii.rowSpan&&!(ii.row+pi>=a.rowCount);pi++)di+=(A=a.getRowDefinition(ii.row+pi)).total||0;if(di<fi){var gi=fi-di,yi=fi-di;if(null!==ii.spanAllocation)for(var mi=ii.spanAllocation,vi=0;vi<ii.rowSpan&&!(0>=gi)&&!(ii.row+vi>=a.rowCount);vi++){var xi=(A=a.getRowDefinition(ii.row+vi)).ha||0,bi=mi(ii,A,yi);A.actual=Math.min(A.maximum,xi+bi),A.ha!==xi&&(gi-=A.ha-xi)}for(;0<gi;){var th=A.ha||0;if(isNaN(A.height)&&A.maximum>th&&(A.actual=Math.min(A.maximum,th+gi),A.ha!==th&&(gi-=A.ha-th)),0===A.index)break;A=a.getRowDefinition(A.index-1)}}for(var wi=0,ki=0;ki<ii.columnSpan&&!(ii.column+ki>=a.columnCount);ki++)wi+=(A=a.getColumnDefinition(ii.column+ki)).total||0;if(wi<ci){var Mi=ci-wi,Si=ci-wi;if(null!==ii.spanAllocation)for(var Pi=ii.spanAllocation,Ni=0;Ni<ii.columnSpan&&!(0>=Mi)&&!(ii.column+Ni>=a.columnCount);Ni++){var Ci=(A=a.getColumnDefinition(ii.column+Ni)).ha||0,Ti=Pi(ii,A,Si);A.actual=Math.min(A.maximum,Ci+Ti),A.ha!==Ci&&(Mi-=A.ha-Ci)}for(;0<Mi;){var Li=A.ha||0;if(isNaN(A.width)&&A.maximum>Li&&(A.actual=Math.min(A.maximum,Li+Mi),A.ha!==Li&&(Mi-=A.ha-Li)),0===A.index)break;A=a.getColumnDefinition(A.index-1)}}}}R(k),qt.free(Ht),qt.free(Dt),void 0!==Wt&&R(Wt),void 0!==Jt&&R(Jt);var Ai=0,ji=0,Di=a.desiredSize,Fi=a.maxSize;tt=ha(a,!0);var Oi=pt=ft=0,Bi=0;r=a.columnCount;for(var Ii=0;Ii<r;Ii++)void 0!==a.mb[Ii]&&(A=a.getColumnDefinition(Ii),isFinite(A.width)?(Oi+=A.width,Oi+=A.uc()):tl(A)===el?(Oi+=A.ha,Oi+=A.uc()):0!==A.ha&&(ft+=A.ha,ft+=A.uc()));Ai=isFinite(Di.width)?Math.min(Di.width,Fi.width):tt!==ns&&isFinite(b)?b:ft,Ai=Math.max(Ai,a.minSize.width),Ai=Math.max(Ai-Oi,0);for(var Ri=0===ft?1:Math.max(Ai/ft,1),Ei=0;Ei<r;Ei++)void 0!==a.mb[Ei]&&(A=a.getColumnDefinition(Ei),isFinite(A.width)||tl(A)===el||(A.actual=A.ha*Ri),A.position=n.width,0!==A.ha&&(n.width+=A.ha,n.width+=A.uc()));r=a.rowCount;for(var zi=0;zi<r;zi++)void 0!==a.rb[zi]&&(A=a.getRowDefinition(zi),isFinite(A.height)?(Bi+=A.height,Bi+=A.uc()):tl(A)===el?(Bi+=A.ha,Bi+=A.uc()):0!==A.ha&&(pt+=A.ha,0!==A.ha&&(pt+=A.uc())));ji=isFinite(Di.height)?Math.min(Di.height,Fi.height):tt!==ns&&isFinite(t)?t:pt,ji=Math.max(ji,a.minSize.height),ji=Math.max(ji-Bi,0);for(var Vi=0===pt?1:Math.max(ji/pt,1),Yi=0;Yi<r;Yi++)void 0!==a.rb[Yi]&&(A=a.getRowDefinition(Yi),isFinite(A.height)||tl(A)===el||(A.actual=A.ha*Vi),A.position=n.height,0!==A.ha&&(n.height+=A.ha,0!==A.ha&&(n.height+=A.uc())));r=l.length;for(var Gi=0;Gi<r;Gi++){var Xi=l[Gi],qi=0,Ui=0;Xi.type===jh.TableRow?(qi=n.width,Ui=(A=a.getRowDefinition(Xi.row)).actual):(qi=(A=a.getColumnDefinition(Xi.column)).actual,Ui=n.height),Xi.measuredBounds.h(0,0,qi,Ui),ma(Xi,!1),m[Xi.row]||(m[Xi.row]=[]),m[Xi.row][Xi.column]||(m[Xi.row][Xi.column]=[]),m[Xi.row][Xi.column].push(Xi)}R(l),a.rp=m},kh.prototype.arrange=function(a,b,t){var e=b.length,n=a.padding,o=n.left;n=n.top;for(var r,h,g=a.rp,l=g.length,c=0,f=0;f<l;f++)g[f]&&(c=Math.max(c,g[f].length));for(f=Math.min(a.topIndex,l-1);f!==l&&(void 0===a.rb[f]||0===a.rb[f].ha);)f++;for(f=Math.min(f,l-1),f=-a.rb[f].position,r=Math.min(a.leftIndex,c-1);r!==c&&(void 0===a.mb[r]||0===a.mb[r].ha);)r++;r=Math.min(r,c-1);for(var p=-a.mb[r].position,d=qt.alloc(),q=0;q<l;q++)if(g[q]){c=g[q].length;var u=a.getRowDefinition(q);h=u.position+f+n,0!==u.ha&&(h+=u.jv());for(var y=0;y<c;y++)if(g[q][y]){var m=a.getColumnDefinition(y);r=m.position+p+o,0!==m.ha&&(r+=m.jv());for(var v=g[q][y],x=v.length,w=0;w<x;w++){var k=v[w],M=k.measuredBounds,S=k instanceof jh?k:null;if(null===S||S.type!==jh.TableRow&&S.type!==jh.TableColumn){d.h(0,0);for(var P=1;P<k.rowSpan&&!(q+P>=a.rowCount);P++)S=a.getRowDefinition(q+P),d.height+=S.total;for(P=1;P<k.columnSpan&&!(y+P>=a.columnCount);P++)S=a.getColumnDefinition(y+P),d.width+=S.total;var N=m.ha+d.width,C=u.ha+d.height;P=r,S=h;var T=N,L=C,A=r,j=h,D=N,F=C;r+N>t.width&&(D=Math.max(t.width-r,0)),h+C>t.height&&(F=Math.max(t.height-h,0));var O=k.alignment;if(O.Mb()){(O=a.defaultAlignment).eb()||(O=xi);var B=O.x,I=O.y,R=O.offsetX;O=O.offsetY;var E=m.alignment,z=u.alignment;E.eb()&&(B=E.x,R=E.offsetX),z.eb()&&(I=z.y,O=z.offsetY)}else B=O.x,I=O.y,R=O.offsetX,O=O.offsetY;(isNaN(B)||isNaN(I))&&(I=B=.5,O=R=0),E=M.width,z=M.height;var V=k.margin,Y=V.left+V.right,G=V.top+V.bottom,X=la(k,u,m,!1);!isNaN(k.desiredSize.width)||X!==es&&X!==ss||(E=Math.max(N-Y,0)),!isNaN(k.desiredSize.height)||X!==es&&X!==as||(z=Math.max(C-G,0)),N=k.maxSize,C=k.minSize,E=Math.min(N.width,E),z=Math.min(N.height,z),E=Math.max(C.width,E),N=(z=Math.max(C.height,z))+G,P+=T*B-(E+Y)*B+R+V.left,S+=L*I-N*I+O+V.top,k.visible&&(ni(A,j,D,F,P,S,M.width,M.height)?k.arrange(P,S,E,z):k.arrange(P,S,E,z,new Wt(A,j,D,F)))}else k.ml(),k.actualBounds.ea(),T=k.actualBounds,P=Wt.allocAt(T.x,T.y,T.width,T.height),T.x=S.type===jh.TableRow?o:r,T.y=S.type===jh.TableColumn?n:h,T.width=M.width,T.height=M.height,k.actualBounds.freeze(),xa(k,!1),Qt(P,T)||null!==(M=k.part)&&(M.Jh(),k.To(M)),Wt.free(P)}}}for(qt.free(d),a=0;a<e;a++)null===(o=(t=b[a])instanceof jh?t:null)||o.type!==jh.TableRow&&o.type!==jh.TableColumn||(o=t.actualBounds,t.naturalBounds.ea(),t.naturalBounds.h(0,0,o.width,o.height),t.naturalBounds.freeze())},m(Mh,yh),Mh.prototype.measure=function(){},Mh.prototype.arrange=function(){},m(Sh,yh),Sh.prototype.measure=function(){},Sh.prototype.arrange=function(){},m(Ph,yh),Ph.prototype.measure=function(a,b,t,e,n,o,g){1<e.length&&N("Viewbox Panel cannot contain more than one GraphObject."),(e=e[0]).ya=1,e.om(),e.measure(1/0,1/0,o,g);var r=e.measuredBounds,h=e.margin,l=h.right+h.left;if(h=h.top+h.bottom,isFinite(b)||isFinite(t)){var c=e.scale,f=r.width;r=r.height;var p=Math.max(b-l,0),d=Math.max(t-h,0),q=1;a.viewboxStretch===os?0!==f&&0!==r&&(q=Math.min(p/f,d/r)):0!==f&&0!==r&&(q=Math.max(p/f,d/r)),0===q&&(q=1e-4),e.ya*=q,c!==e.scale&&(ma(e,!0),e.measure(1/0,1/0,o,g))}r=e.measuredBounds,n.width=isFinite(b)?b:Math.max(r.width+l,0),n.height=isFinite(t)?t:Math.max(r.height+h,0)},Ph.prototype.arrange=function(a,b,t){var e=(b=b[0]).measuredBounds,n=b.margin,o=Math.max(e.width+(n.right+n.left),0);n=Math.max(e.height+(n.top+n.bottom),0);var g=b.alignment;g.Mb()&&(g=a.defaultAlignment),g.eb()||(g=xi),b.arrange(t.width*g.x-o*g.x+g.offsetX,t.height*g.y-n*g.y+g.offsetY,e.width,e.height)},m(Nh,yh),Nh.prototype.measure=function(){},Nh.prototype.arrange=function(){},Nh.prototype.bc=function(a,b,t){0>=(t=a.vf()*t.scale)&&(t=1);var e=a.gridCellSize,n=e.width;e=e.height;var o=a.naturalBounds,g=a.actualBounds,r=o.width,h=o.height,l=Math.ceil(r/n),c=Math.ceil(h/e),f=a.gridOrigin;b.save(),b.beginPath(),b.rect(0,0,r,h),b.clip();for(var p=[],d=a.W.j,q=d.length,u=0;u<q;u++){var y=d[u],m=[];if(p.push(m),y.visible){var v=y.interval;if(!(0>v)){y=Bh(y.figure);for(var x=0;x<q;x++)if(x!==u){var w=d[x];w.visible&&Bh(w.figure)===y&&((w=w.interval)>v&&m.push(w))}}}}for(q=(d=a.W.j).length,u=0;u<q;u++){var k=d[u];if(k.visible&&(m=k.interval,!(2>n*Math.abs(m)*t))){if(y=1,1!==(v=k.opacity)){if(0===v)continue;y=b.globalAlpha,b.globalAlpha=y*v}x=p[u],w=!1;var M=k.strokeDashArray;if(null!==M&&(w=!0,b.ht(M,k.strokeDashOffset)),"LineV"===k.figure&&null!==k.stroke&&0<k.strokeWidth){for(b.lineWidth=k.strokeWidth,oa(a,b,k.stroke,!1,!1,o,g),b.beginPath(),M=k=Math.floor(-f.x/n);M<=k+l;M++){var S=M*n+f.x;0<=S&&S<=r&&Ch(M,m,x)&&(b.moveTo(S,0),b.lineTo(S,h))}b.stroke()}else if("LineH"===k.figure&&null!==k.stroke&&0<k.strokeWidth){for(b.lineWidth=k.strokeWidth,oa(a,b,k.stroke,!1,!1,o,g),b.beginPath(),M=k=Math.floor(-f.y/e);M<=k+c;M++)0<=(S=M*e+f.y)&&S<=h&&Ch(M,m,x)&&(b.moveTo(0,S),b.lineTo(r,S));b.stroke()}else if("BarV"===k.figure&&null!==k.fill)for(oa(a,b,k.fill,!0,!1,o,g),k=k.width,isNaN(k)&&(k=n),S=M=Math.floor(-f.x/n);S<=M+l;S++){var P=S*n+f.x;0<=P&&P<=r&&Ch(S,m,x)&&b.fillRect(P,0,k,h)}else if("BarH"===k.figure&&null!==k.fill)for(oa(a,b,k.fill,!0,!1,o,g),k=k.height,isNaN(k)&&(k=e),S=M=Math.floor(-f.y/e);S<=M+c;S++)0<=(P=S*e+f.y)&&P<=h&&Ch(S,m,x)&&b.fillRect(0,P,r,k);w&&b.ft(),1!==v&&(b.globalAlpha=y)}}b.restore(),b.sc(!1)},m(Th,yh),Th.prototype.measure=function(a,b,t,e,n){if(t=e.length,a instanceof Lu||a instanceof Wu){var o=null,g=null,r=null;if(a instanceof Wu&&(g=o=a),a instanceof Lu&&(o=(r=a).adornedPart),o instanceof Wu){var h=o;if(0===t)Jt(a.naturalBounds,0,0),a.measuredBounds.h(0,0,0,0);else{var l=a instanceof Lu?null:o.path,c=o.routeBounds;(b=a.vg).h(0,0,c.width,c.height);var f=h.points;o=o.pointsCount,null!==r?r.nk(!1):null!==g&&g.nk(!1);var p=c.width,d=c.height;a.location.h(c.x,c.y),a.l.length=0,null!==l&&(Lh(a,p,d,l),r=l.measuredBounds,b.Hc(r),a.l.push(r)),r=ie.alloc();for(var q=Mt.alloc(),u=Mt.alloc(),y=0;y<t;y++){var m=e[y];if(m!==l)if(m.isPanelMain&&m instanceof rl){Lh(a,p,d,m);var v=m.measuredBounds;b.Hc(v),a.l.push(v)}else if(2>o)m.measure(1/0,1/0,0,0),v=m.measuredBounds,b.Hc(v),a.l.push(v);else{var x=m.segmentIndex,w=m.segmentFraction,k=m.alignmentFocus;k.jc()&&(k=xi);var M=m.segmentOrientation,S=m.segmentOffset;if(isNaN(x)){var P=h.ka;v=I(),P.Av(w,v);var N=Mt.allocAt(v[0],v[1]);if(N.add(h.i(0)),P.type===ge||(P=P.figures.first()),N.offset(-P.startX,-P.startY),P=v[2],M!==mc){var C=h.computeAngle(m,M,P);m.Yb=C}C=N.x-c.x;var T=N.y-c.y;Mt.free(N),R(v)}else if(x<-o||x>=o)T=h.midPoint,P=h.midAngle,M!==mc&&(C=h.computeAngle(m,M,P),m.Yb=C),C=T.x-c.x,T=T.y-c.y;else{if(C=0,0<=x?(T=f.L(x),v=x<o-1?f.L(x+1):T):(C=o+x,T=f.L(C),v=0<C?f.L(C-1):T),T.Ma(v)){0<=x?(P=0<x?f.L(x-1):T,C=x<o-2?f.L(x+2):v):(P=C<o-1?f.L(C+1):T,C=1<C?f.L(C-2):v),N=P.Be(T);var L=v.Be(C);P=N>L+10?0<=x?P.Sa(T):T.Sa(P):L>N+10?0<=x?v.Sa(C):C.Sa(v):0<=x?P.Sa(C):C.Sa(P)}else P=0<=x?T.Sa(v):v.Sa(T);M!==mc&&(C=h.computeAngle(m,M,P),m.Yb=C),C=T.x+(v.x-T.x)*w-c.x,T=T.y+(v.y-T.y)*w-c.y}m.measure(1/0,1/0,0,0),v=m.measuredBounds,N=m.naturalBounds;var A=0;m instanceof rl&&(A=m.strokeWidth),L=N.width+A;var j=N.height+A;r.reset(),r.translate(-v.x,-v.y),r.scale(m.scale,m.scale),r.rotate(M===mc?m.angle:P,L/2,j/2),M!==Pc&&M!==Lc||r.rotate(90,L/2,j/2),M!==Nc&&M!==Ac||r.rotate(-90,L/2,j/2),M===jc&&(45<P&&135>P||225<P&&315>P)&&r.rotate(-P,L/2,j/2),N=new Wt(0,0,L,j),q.dj(N,k),r.ra(q),k=-q.x+A/2*m.scale,m=-q.y+A/2*m.scale,u.assign(S),A=isNaN(S.x);var D=isNaN(S.y);if(A||D){L=L/2+3,j=j/2+3;var F=45<=P&&135>=P,O=225<=P&&315>=P;M===mc&&(F||O)?(u.x=D?L:S.y,u.y=A?j:S.x,F?0<=x||isNaN(x)&&.5>w||!A||(u.y=-j):O&&((0<=x||isNaN(x)&&.5>w)&&A&&(u.y=-j),D&&(u.x=-L))):(A&&(u.x=0<=x||isNaN(x)&&.5>w?L:-L),D&&(u.y=-j),u.rotate(P))}else u.rotate(P);C+=u.x,T+=u.y,N.set(v),N.h(C+k,T+m,v.width,v.height),a.l.push(N),b.Hc(N)}}if(null!==g)for(e=g.labelNodes;e.next();)e.value.measure(1/0,1/0);a.vg=b,(a=a.location).h(a.x+b.x,a.y+b.y),Jt(n,b.width||0,b.height||0),ie.free(r),Mt.free(q),Mt.free(u)}}}},Th.prototype.arrange=function(a,b){var t=b.length;if(a instanceof Lu||a instanceof Wu){var e=null,n=null,o=null;a instanceof Wu&&(n=e=a),a instanceof Lu&&(e=(o=a).adornedPart);var g=a instanceof Lu?null:e.path;if(0!==a.l.length){var r=a.l,h=0;if(null!==g&&h<a.l.length){var l=r[h];h++,g.arrange(l.x-a.vg.x,l.y-a.vg.y,l.width,l.height)}for(l=0;l<t;l++){var c=b[l];if(c!==g&&h<a.l.length){var f=r[h];h++,c.arrange(f.x-a.vg.x,f.y-a.vg.y,f.width,f.height)}}}if(2<=(t=(b=e.points).count)&&a instanceof Wu)for(e=a.labelNodes;e.next();){var p=a;r=(g=e.value).segmentIndex,h=g.segmentFraction;var d=g.alignmentFocus;if(l=g.segmentOrientation,c=g.segmentOffset,isNaN(r)){f=p.ka;var q=I();f.Av(h,q);var u=Mt.allocAt(q[0],q[1]);u.add(p.i(0)),f.type===ge||(f=f.figures.first()),u.offset(-f.startX,-f.startY),f=q[2],l!==mc&&(p=p.computeAngle(g,l,f),g.angle=p),p=u.x;var y=u.y;Mt.free(u),R(q)}else if(r<-t||r>=t)y=p.midPoint,f=p.midAngle,l!==mc&&(p=p.computeAngle(g,l,f),g.angle=p),p=y.x,y=y.y;else{if(u=0,0<=r?(q=b.j[r],y=r<t-1?b.j[r+1]:q):(u=t+r,q=b.j[u],y=0<u?b.j[u-1]:q),q.Ma(y)){0<=r?(f=0<r?b.j[r-1]:q,u=r<t-2?b.j[r+2]:y):(f=u<t-1?b.j[u+1]:q,u=1<u?b.j[u-2]:y);var m=f.Be(q),v=y.Be(u);f=m>v+10?0<=r?f.Sa(q):q.Sa(f):v>m+10?0<=r?y.Sa(u):u.Sa(y):0<=r?f.Sa(u):u.Sa(f)}else f=0<=r?q.Sa(y):y.Sa(q);l!==mc&&(p=p.computeAngle(g,l,f),g.angle=p),p=q.x+(y.x-q.x)*h,y=q.y+(y.y-q.y)*h}if(d.wt())g.location=new Mt(p,y);else{d.jc()&&(d=xi),(q=ie.alloc()).reset(),q.scale(g.scale,g.scale),q.rotate(g.angle,0,0);var x=g.naturalBounds;u=Wt.allocAt(0,0,x.width,x.height),(m=Mt.alloc()).dj(u,d),q.ra(m),d=-m.x,v=-m.y;var w=x.width,k=x.height;(x=Mt.alloc()).assign(c);var M=isNaN(c.x),S=isNaN(c.y);if(M||S){w=w/2+3,k=k/2+3;var P=45<=f&&135>=f,N=225<=f&&315>=f;l===mc&&(P||N)?(x.x=S?w:c.y,x.y=M?k:c.x,P?0<=r||isNaN(r)&&.5>h||!M||(x.y=-k):N&&((0<=r||isNaN(r)&&.5>h)&&M&&(x.y=-k),S&&(x.x=-w))):(M&&(x.x=0<=r||isNaN(r)&&.5>h?w:-w),S&&(x.y=-k),x.rotate(f))}else x.rotate(f);p+=x.x,y+=x.y,q.qw(u),d+=u.x,v+=u.y,r=Mt.allocAt(p+d,y+v),g.move(r),Mt.free(r),Mt.free(x),Mt.free(m),Wt.free(u),ie.free(q)}}null!==o?o.nk(!1):null!==n&&n.nk(!1)}},m(Ah,yh),Ah.prototype.measure=function(a,b,t,e,n,o,g){var r=a.zb();a.Zg=[];var h=r.margin,l=h.right+h.left,c=h.top+h.bottom;r.measure(b,t,o,g);var f=r.measuredBounds,p=new Wt(-h.left,-h.top,Math.max(f.width+l,0),Math.max(f.height+c,0));a.Zg.push(p),n.assign(p);for(var d=r.geometry,q=r.strokeWidth,u=d.flattenedSegments,y=d.flattenedLengths,m=d.flattenedTotalLength,v=u.length,x=0,w=0,k=I(),M=0;M<v;M++){var S=u[M],P=[];w=x=0;for(var N=S.length,C=0;C<N;C+=2){var T=S[C],L=S[C+1];if(0!==C){var A=180*Math.atan2(L-w,T-x)/Math.PI;0>A&&(A+=360),P.push(A)}x=T,w=L}k.push(P)}if(null===a.$g){for(var j=[],D=a.W.j,F=D.length,O=0;O<F;O++){var B=D[O],E=[];if(j.push(E),B.visible){var z=B.interval;if(!(0>z))for(var V=0;V<F;V++)if(V!==O){var Y=D[V];if(Y.visible&&B.constructor===Y.constructor){var G=Y.interval;G>z&&E.push(G)}}}}a.$g=j}var X=a.$g,U=a.W.j,K=U.length,H=0,W=0,J=m;a.uj=[];for(var Z,$=0;$<K;$++){var Q=U[$];if(Z=[],Q.visible&&Q!==r){var _=Math.abs(Q.interval),tt=a.graduatedTickUnit;if(!(2>tt*_*m/a.graduatedRange)){var it=y[0][0],et=0,nt=0;W=m*Q.graduatedStart-1e-4,J=m*Q.graduatedEnd+1e-4;var ot=tt*_,st=a.graduatedTickBase;if(st<a.graduatedMin){var at=(a.graduatedMin-st)/ot;st+=(at=0==at%1?at:Math.floor(at+1))*ot}else st>a.graduatedMin+ot&&(st-=Math.floor((st-a.graduatedMin)/ot)*ot);for(var ht=X[$];st<=a.graduatedMax;){t:{for(var lt=ht.length,ut=0;ut<lt;ut++)if(ne.$((st-a.graduatedTickBase)%(ht[ut]*a.graduatedTickUnit),0)){var ct=!1;break t}ct=!0}if(ct&&(null===Q.graduatedSkip||!Q.graduatedSkip(st))&&((H=(st-a.graduatedMin)*m/a.graduatedRange)>m&&(H=m),W<=H&&H<=J)){for(var ft=k[et][nt],pt=y[et][nt];et<y.length;){for(;H>it&&nt<y[et].length-1;)nt++,ft=k[et][nt],it+=pt=y[et][nt];if(H<=it)break;nt=0,ft=k[++et][nt],it+=pt=y[et][nt]}var gt=u[et],yt=gt[2*nt],mt=gt[2*nt+1],vt=(H-(it-pt))/pt,xt=new Mt(yt+(gt[2*nt+2]-yt)*vt+q/2-d.bounds.x,mt+(gt[2*nt+3]-mt)*vt+q/2-d.bounds.y);xt.scale(r.scale,r.scale);var bt=ft,wt=k[et];if(1e-4>vt?0<nt?bt=wt[nt-1]:ne.$(gt[0],gt[gt.length-2])&&ne.$(gt[1],gt[gt.length-1])&&(bt=wt[wt.length-1]):.9999<vt&&(nt+1<wt.length?bt=wt[nt+1]:ne.$(gt[0],gt[gt.length-2])&&ne.$(gt[1],gt[gt.length-1])&&(bt=wt[0])),ft!==bt&&(180<Math.abs(ft-bt)&&(ft<bt?ft+=360:bt+=360),ft=(ft+bt)/2%360),Q instanceof ml){var kt="";null!==Q.graduatedFunction?kt=null!=(kt=Q.graduatedFunction(st))?kt.toString():"":kt=(+st.toFixed(2)).toString(),""!==kt&&Z.push({xm:xt,angle:ft,text:kt})}else Z.push({xm:xt,angle:ft})}st+=ot}}}a.uj.push(Z)}R(k);var St=a.uj;if(null!==St)for(var Pt=e.length,Nt=0;Nt<Pt;Nt++){var Ct=e[Nt],Tt=St[Nt];if(Ct.visible&&Ct!==r&&0!==Tt.length){if(Ct instanceof rl){var Lt=a,At=n,jt=Ct.alignmentFocus;jt.jc()&&(jt=yi);var Dt=Ct.angle;Ct.Yb=0,Ct.measure(1/0,1/0,0,0),Ct.Yb=Dt;var Ft=Ct.measuredBounds,Ot=Ft.width,Bt=Ft.height,It=Wt.allocAt(0,0,Ot,Bt),Rt=Mt.alloc();Rt.dj(It,jt),Wt.free(It);for(var Et=-Rt.x,zt=-Rt.y,Vt=new Wt,Yt=Tt.length,Gt=0;Gt<Yt;Gt++)for(var Xt=Tt[Gt],qt=Xt.xm.x,Ut=Xt.xm.y,Kt=Xt.angle,Ht=0;4>Ht;Ht++){switch(Ht){case 0:Rt.h(Et,zt);break;case 1:Rt.h(Et+Ot,zt);break;case 2:Rt.h(Et,zt+Bt);break;case 3:Rt.h(Et+Ot,zt+Bt)}Rt.rotate(Kt+Ct.angle),Rt.offset(qt,Ut),0===Gt&&0===Ht?Vt.h(Rt.x,Rt.y,0,0):Vt.Ie(Rt),Rt.offset(-qt,-Ut),Rt.rotate(-Kt-Ct.angle)}Mt.free(Rt),null!==Lt.Zg&&Lt.Zg.push(Vt),ei(At,Vt.x,Vt.y,Vt.width,Vt.height)}else if(Ct instanceof ml){var Jt=a,Zt=n;null===Jt.vh&&(Jt.vh=new ml);var $t=Jt.vh;vl($t,Ct);var Qt=Ct.alignmentFocus;Qt.jc()&&(Qt=yi);for(var _t=Ct.segmentOrientation,ti=Ct.segmentOffset,ii=new Wt,ni=0,oi=0,ri=0,si=0,ai=0,hi=Tt.length,ui=0;ui<hi;ui++){var ci=Tt[ui];ni=ci.xm.x,oi=ci.xm.y,ri=ci.angle,ai=si=Ct.angle,_t!==mc&&(ai=_t===Sc||_t===Tc?ri+Ct.angle:ri,si=Wu.computeAngle(_t,ai)),$t.Yb=si,$t.text=ci.text||"",$t.measure(1/0,1/0,0,0);var fi=$t.measuredBounds,di=$t.naturalBounds,pi=di.width,gi=di.height,mi=ie.alloc();mi.reset(),mi.translate(-fi.x,-fi.y),mi.scale($t.scale,$t.scale),mi.rotate(ai,pi/2,gi/2),_t!==Pc&&_t!==Lc||mi.rotate(90,pi/2,gi/2),_t!==Nc&&_t!==Ac||mi.rotate(-90,pi/2,gi/2),_t===jc&&(45<ri&&135>ri||225<ri&&315>ri)&&mi.rotate(-ri,pi/2,gi/2);var vi=Wt.allocAt(0,0,pi,gi),xi=Mt.alloc();xi.dj(vi,Qt),mi.ra(xi);var bi=-xi.x,wi=-xi.y,ki=Mt.alloc();ki.assign(ti),isNaN(ki.x)&&(ki.x=pi/2+3),isNaN(ki.y)&&(ki.y=-(gi/2+3)),ki.rotate(ri);var Mi=new Wt(ni+=ki.x+bi,oi+=ki.y+wi,fi.width,fi.height),th=new Wt(fi.x,fi.y,fi.width,fi.height),Si=new Wt(di.x,di.y,di.width,di.height);ci.Zz=si,ci.lineCount=$t.lineCount,ci.lines=[$t.pb,$t.ti,$t.he,$t.ue,$t.Qb,$t.fb,$t.fe],ci.actualBounds=Mi,ci.measuredBounds=th,ci.naturalBounds=Si,0===ui?ii.assign(Mi):ii.Hc(Mi),Mt.free(ki),Mt.free(xi),Wt.free(vi),ie.free(mi)}null!==Jt.Zg&&Jt.Zg.push(ii),ei(Zt,ii.x,ii.y,ii.width,ii.height)}ma(Ct,!1)}}},Ah.prototype.arrange=function(a,b,t){if(null!==a.Zg){var e=a.zb(),n=a.uj;if(null!==n){var o=a.Zg,g=0,r=o[g];g++,null!==e&&e.arrange(r.x-t.x,r.y-t.y,r.width,r.height);for(var h=b.length,l=0;l<h;l++){var c=b[l];r=n[l],c.visible&&c!==e&&0!==r.length&&(r=o[g],g++,c.arrange(r.x-t.x,r.y-t.y,r.width,r.height))}a.Zg=null}}},Ah.prototype.bc=function(a,b,t){var e=t.ni;t.ni=!0;var n=a.naturalBounds,o=n.width;n=n.height,b.save(),b.beginPath(),b.rect(-1,-1,o+1,n+1),b.clip(),(o=a.zb()).bc(b,t),0>=(n=a.vf()*t.scale)&&(n=1);for(var g=o.actualBounds,r=a.W.j,h=a.uj,l=r.length,c=0;c<l;c++){var f=r[c],p=h[c],d=p.length;if(f.visible&&f!==o&&0!==p.length)if(f instanceof rl){if(!(2>a.graduatedTickUnit*f.interval*o.geometry.flattenedTotalLength/a.graduatedRange*n)){var q=f.measuredBounds,u=f.strokeWidth*f.scale,y=f.alignmentFocus;y.jc()&&(y=yi);for(var m=0;m<d;m++){var v=p[m].xm,x=p[m].angle,w=y,k=f.kb;k.reset(),k.translate(v.x+g.x,v.y+g.y),k.rotate(x+f.angle,0,0),k.translate(-q.width*w.x+w.offsetX+u/2,-q.height*w.y+w.offsetY+u/2),k.scale(f.scale,f.scale),pa(f,!1),f.Qh.set(f.kb),f.Wk=f.scale,ga(f,!1),f.bc(b,t),f.kb.reset()}}}else if(f instanceof ml)for(null===a.vh&&(a.vh=new ml),vl(q=a.vh,f),f=0;f<d;f++)(u=p[f]).actualBounds&&u.measuredBounds&&u.naturalBounds&&(q.Tb=u.text||"",q.Yb=u.Zz||0,q.Nc=u.lineCount||0,void 0!==(y=u.lines)&&(q.pb=y[0],q.ti=y[1],q.he=y[2],q.ue=y[3],q.Qb=y[4],q.fb=y[5],q.fe=y[6]),u.naturalBounds&&(q.oc=u.naturalBounds),u.actualBounds&&(y=u.actualBounds,q.arrange(y.x,y.y,y.width,y.height)),y=u.actualBounds,q.arrange(y.x,y.y,y.width,y.height),m=u.measuredBounds,u=u.naturalBounds,(v=q.kb).reset(),v.translate(y.x+g.x,y.y+g.y),v.translate(-m.x,-m.y),sa(q,v,u.x,u.y,u.width,u.height),pa(q,!1),q.Qh.set(q.kb),q.Wk=q.scale,ga(q,!1),q.bc(b,t))}t.ni=e,b.restore(),b.sc(!0)},m(jh,_s),jh.prototype.cloneProtected=function(a){if(_s.prototype.cloneProtected.call(this,a),a.pa=this.pa,a.bb=this.bb.G(),a.un=this.un.G(),a.Qf=this.Qf,a.pa===jh.Table){a.nj=this.nj.G(),a.Rg=this.Rg,a.ii=this.ii,a.hi=this.hi,a.Qg=this.Qg,a.Pg=this.Pg,a.gi=this.gi;var b=[];if(0<this.rb.length)for(var t=this.rb,e=t.length,n=0;n<e;n++)if(void 0!==t[n]){var o=t[n].copy();o.cj(a),b[n]=o}if(a.rb=b,b=[],0<this.mb.length)for(e=(t=this.mb).length,n=0;n<e;n++)void 0!==t[n]&&((o=t[n].copy()).cj(a),b[n]=o);a.mb=b,a.Mj=this.Mj,a.kj=this.kj,a.Ki=this.Ki,a.vi=this.vi}a.Yp=this.Yp,a.Sn=this.Sn.G(),a.Tn=this.Tn.G(),a.Pn=this.Pn,a.On=this.On,a.Rn=this.Rn,a.Qn=this.Qn,a.uj=this.uj,a.$g=this.$g,a.hb=this.hb,a.ci=this.ci,a.io=this.io,a.si=this.si,a.me=this.me,a.ql=this.ql,a.vg.assign(this.vg),a.Jg=this.Jg,null!==this.rp&&(a.rp=this.rp)},jh.prototype.tf=function(a){_s.prototype.tf.call(this,a),a.W=this.W;for(var b=a.W.j,t=b.length,e=0;e<t;e++)b[e].ng=a;a.Hi=null},jh.prototype.copy=function(){var a=_s.prototype.copy.call(this);if(null!==a){for(var b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e].copy();n.cj(a),n.Jj=null;var o=a.W,g=o.count;if(o.Kb(g,n),null!==(o=a.part)){o.Fj=null,null!==n.portId&&o instanceof Au&&(o.Ih=!0);var r=a.diagram;null!==r&&r.undoManager.isUndoingRedoing||o.Ya(Fe,"elements",a,null,n,null,g)}}return a}return null},(n=jh.prototype).toString=function(){return"Panel("+this.type+")#"+gt(this)},n.To=function(a){_s.prototype.To.call(this,a);for(var b=this.W.j,t=b.length,e=0;e<t;e++)b[e].To(a)},n.Qi=function(a,b){if(this.pa===jh.Grid)this.pa.bc(this,a,b);else if(this.pa===jh.Graduated)this.pa.bc(this,a,b);else{this.pa===jh.Table&&(a.lineCap="butt",Oh(this,a,!0,this.rb,!0),Oh(this,a,!1,this.mb,!0),Fh(this,a,!0,this.rb),Fh(this,a,!1,this.mb),Oh(this,a,!0,this.rb,!1),Oh(this,a,!1,this.mb,!1));var t=this.isClipping&&this.pa===jh.Spot;t&&a.save();for(var e=this.zb(),n=this.W.j,o=n.length,g=0;g<o;g++){var r=n[g];t&&r===e&&(a.clipInsteadOfFill=!0),r.bc(a,b),t&&r===e&&(a.clipInsteadOfFill=!1)}t&&(a.restore(),a.sc(!0))}},n.hk=function(a,b,t,e,n){var o=this.ae(),g=this.transform,r=1/(g.m11*g.m22-g.m12*g.m21),h=g.m22*r,l=-g.m12*r,c=-g.m21*r,f=g.m11*r,p=r*(g.m21*g.dy-g.m22*g.dx),d=r*(g.m12*g.dx-g.m11*g.dy);if(null!==this.areaBackground)return g=this.actualBounds,ne.Uc(g.left,g.top,g.right,g.bottom,a,b,t,e,n);if(null!==this.background)return o=a*h+b*c+p,r=a*l+b*f+d,a=t*h+e*c+p,h=t*l+e*f+d,n.h(0,0),t=this.naturalBounds,o=ne.Uc(0,0,t.width,t.height,o,r,a,h,n),n.transform(g),o;o||(h=1,c=l=0,f=1,d=p=0),r=a*h+b*c+p,a=a*l+b*f+d,h=t*h+e*c+p,t=t*l+e*f+d,n.h(h,t),e=(h-r)*(h-r)+(t-a)*(t-a),l=!1,d=(f=this.W.j).length,c=Mt.alloc(),p=null,b=1/0;var q=null,u=this.isClipping&&this.pa===jh.Spot;u&&(q=Mt.alloc(),(l=(p=this.zb()).hk(r,a,h,t,q))&&(b=(r-q.x)*(r-q.x)+(a-q.y)*(a-q.y)));for(var y=0;y<d;y++){var m=f[y];m.visible&&m!==p&&m.hk(r,a,h,t,c)&&(l=!0,(m=(r-c.x)*(r-c.x)+(a-c.y)*(a-c.y))<e&&(e=m,n.set(c)))}return u&&(b>e&&n.set(q),Mt.free(q)),Mt.free(c),o&&n.transform(g),l},n.o=function(a){if(!0!==ya(this)){_s.prototype.o.call(this,a),a=null,this.pa!==jh.Auto&&this.pa!==jh.Link||(a=this.zb());for(var b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e];if((n===a||n.isPanelMain)&&n.o(!0),!n.desiredSize.u()){var o=ha(n,!1);(n instanceof Hu||n instanceof jh||n instanceof ml||o!==ns)&&n.o(!0)}}}},n.om=function(){if(!1===ya(this)){ma(this,!0),xa(this,!0);for(var a=this.W.j,b=a.length,t=0;t<b;t++)a[t].om()}},n.ml=function(){if(0!=(2048&this.F)==!1){pa(this,!0),ga(this,!0);for(var a=this.W.j,b=a.length,t=0;t<b;t++)a[t].Gv()}},n.Gv=function(){ga(this,!0);for(var a=this.W.j,b=a.length,t=0;t<b;t++)a[t].Gv()},n.sm=function(a,b,t,e){var n=this.vg;n.h(0,0,0,0);var o=this.desiredSize,g=this.minSize;void 0===t&&(t=g.width,e=g.height),t=Math.max(t,g.width),e=Math.max(e,g.height);var r=this.maxSize;isNaN(o.width)||(a=Math.min(o.width,r.width)),isNaN(o.height)||(b=Math.min(o.height,r.height)),a=Math.max(t,a),b=Math.max(e,b);var h=this.bb;a=Math.max(a-h.left-h.right,0),b=Math.max(b-h.top-h.bottom,0);var l=this.W.j;0!==l.length&&this.pa.measure(this,a,b,l,n,t,e),a=n.width+h.left+h.right,h=n.height+h.top+h.bottom,isFinite(o.width)&&(a=o.width),isFinite(o.height)&&(h=o.height),a=Math.min(r.width,a),h=Math.min(r.height,h),a=Math.max(g.width,a),h=Math.max(g.height,h),Jt(n,a=Math.max(t,a),h=Math.max(e,h)),Jt(this.naturalBounds,a,h),ia(this,0,0,a,h)},n.zb=function(){if(null===this.Hi){var a=this.W.j,b=a.length;if(0===b)return null;for(var t=0;t<b;t++){var e=a[t];if(!0===e.isPanelMain)return this.Hi=e}this.Hi=a[0]}return this.Hi},n.Fh=function(a,b,t,e){var n=this.W.j;if(this.actualBounds.h(a,b,t,e),0!==n.length){if(!this.desiredSize.u()){a=ha(this,!0);var o=this.measuredBounds;b=o.width,o=o.height;var g=this.fh,r=g.left+g.right;switch(g=g.top+g.bottom,b===t&&o===e&&(a=ns),a){case ns:(b>t||o>e)&&(this.o(),this.measure(b>t?t:b,o>e?e:o,0,0));break;case es:this.o(!0),this.measure(t+r,e+g,0,0);break;case ss:this.o(!0),this.measure(t+r,o+g,0,0);break;case as:this.o(!0),this.measure(b+r,e+g,0,0)}}this.pa.arrange(this,n,this.vg)}},n.Hh=function(a){var b=this.naturalBounds,t=Ih(this);if(ni(0,0,b.width,b.height,a.x,a.y)){for(var e=(b=this.W.j).length,n=Mt.allocAt(0,0);e--;){var o=b[e];if((o.visible||o===t)&&(Ct(n.set(a),o.transform),o.aa(n)))return Mt.free(n),!0}return Mt.free(n),null!==this.gb||null!==this.dc}return!1},n.it=function(a){if(this.Jk===a)return this;for(var b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e].it(a);if(null!==n)return n}return null},n.Km=function(a,b){if(b(this,a),a instanceof jh)for(var t=(a=a.W.j).length,e=0;e<t;e++)this.Km(a[e],b)},n.hm=function(a){return function t(a,b,e){if(e(b))return b;if(b instanceof jh)for(var n=(b=b.W.j).length,o=0;o<n;o++){var r=t(a,b[o],e);if(null!==r)return r}return null}(this,this,a)},n.Xa=function(a){if(this.name===a)return this;var b=this.W.j,t=b.length;null===this.si&&null===this.me||(t=Uh(this));for(var e=0;e<t;e++){var n=b[e];if(n instanceof jh){var o=n.Xa(a);if(null!==o)return o}if(n.name===a)return n}return null},n.ae=function(){return!(this.type===jh.TableRow||this.type===jh.TableColumn)},n.Ub=function(a,b,t){if(!1===this.pickable)return null;if(void 0===b&&(b=null),void 0===t&&(t=null),va(this))return null;var e=this.naturalBounds,n=1/this.vf(),o=this.ae(),g=o?a:Ct(Mt.allocAt(a.x,a.y),this.transform),r=this.diagram,h=10,l=5;if(null!==r&&(l=(h=r.mm("extraTouchArea"))/2),ni(-l*n,-l*n,e.width+h*n,e.height+h*n,g.x,g.y)){if(!this.isAtomic){var c=(n=this.W.j).length;if(r=Mt.alloc(),l=(h=this.isClipping&&this.pa===jh.Spot)?this.zb():null,h&&(l.ae()?Ct(r.set(a),l.transform):r.set(a),!l.aa(r)))return Mt.free(r),o||Mt.free(g),null;for(var f=Ih(this);c--;){var p=n[c];if((p.visible||p===f)&&(p.ae()?Ct(r.set(a),p.transform):r.set(a),!h||p!==l)){var d=null;if(p instanceof jh?d=p.Ub(r,b,t):!0===p.pickable&&p.aa(r)&&(d=p),null!==d&&(null!==b&&(d=b(d)),null!==d&&(null===t||t(d))))return Mt.free(r),o||Mt.free(g),d}}Mt.free(r)}return null===this.background&&null===this.areaBackground?(o||Mt.free(g),null):(a=ni(0,0,e.width,e.height,g.x,g.y)?this:null,o||Mt.free(g),a)}return o||Mt.free(g),null},n.Ti=function(a,b,t,e){if(!1===this.pickable)return!1;void 0===b&&(b=null),void 0===t&&(t=null);var n=this.naturalBounds,o=this.ae(),g=o?a:Ct(Mt.allocAt(a.x,a.y),this.transform);if(n=ni(0,0,n.width,n.height,g.x,g.y),this.type===jh.TableRow||this.type===jh.TableColumn||n){if(!this.isAtomic){for(var r=this.W.j,h=r.length,l=Mt.alloc(),c=Ih(this);h--;){var f=r[h];if(f.visible||f===c){f.ae()?Ct(l.set(a),f.transform):l.set(a);var p=f;(null!==(f=f instanceof jh?f:null)?f.Ti(l,b,t,e):p.aa(l))&&!1!==p.pickable&&(null!==b&&(p=b(p)),null===p||null!==t&&!t(p)||e.add(p))}}Mt.free(l)}return o||Mt.free(g),n&&(null!==this.background||null!==this.areaBackground)}return o||Mt.free(g),!1},n.uf=function(a,b,t,e,n,o){if(!1===this.pickable)return!1;void 0===b&&(b=null),void 0===t&&(t=null);var g=o;if(void 0===o&&(g=ie.alloc()).reset(),g.multiply(this.transform),this.Gh(a,g))return zh(this,b,t,n),void 0===o&&ie.free(g),!0;if(this.Gc(a,g)){if(!this.isAtomic)for(var r=Ih(this),h=this.W.j,l=h.length;l--;){var c=h[l];if(c.visible||c===r){var f=c.actualBounds,p=this.naturalBounds;f.x>p.width||f.y>p.height||0>f.x+f.width||0>f.y+f.height||(f=c,c=c instanceof jh?c:null,(p=ie.alloc()).set(g),(null!==c?c.uf(a,b,t,e,n,p):ea(f,a,e,p))&&(null!==b&&(f=b(f)),null===f||null!==t&&!t(f)||n.add(f)),ie.free(p))}}return void 0===o&&ie.free(g),e}return void 0===o&&ie.free(g),!1},n.Ag=function(a,b,t,e,n,o){if(!1===this.pickable)return!1;void 0===t&&(t=null),void 0===e&&(e=null);var g=this.naturalBounds,r=this.ae(),h=r?a:Ct(Mt.allocAt(a.x,a.y),this.transform),l=r?b:Ct(Mt.allocAt(b.x,b.y),this.transform),c=h.Be(l),f=0<h.x&&h.x<g.width&&0<h.y&&h.y<g.height||Tt(h.x,h.y,0,0,0,g.height)<=c||Tt(h.x,h.y,0,g.height,g.width,g.height)<=c||Tt(h.x,h.y,g.width,g.height,g.width,0)<=c||Tt(h.x,h.y,g.width,0,0,0)<=c;if(g=h.dd(0,0)<=c&&h.dd(0,g.height)<=c&&h.dd(g.width,0)<=c&&h.dd(g.width,g.height)<=c,r||(Mt.free(h),Mt.free(l)),f){if(!this.isAtomic){h=Mt.alloc(),l=Mt.alloc(),c=Ih(this);for(var p=this.W.j,d=p.length;d--;){var q=p[d];if(q.visible||q===c){var u=q.actualBounds,y=this.naturalBounds;r&&(u.x>y.width||u.y>y.height||0>u.x+u.width||0>u.y+u.height)||(q.ae()?(u=q.transform,Ct(h.set(a),u),Ct(l.set(b),u)):(h.set(a),l.set(b)),u=q,(null!==(q=q instanceof jh?q:null)?q.Ag(h,l,t,e,n,o):u.Lx(h,l,n))&&(null!==t&&(u=t(u)),null===u||null!==e&&!e(u)||o.add(u)))}}Mt.free(h),Mt.free(l)}return n?f:g}return!1},n.add=function(a){this.Kb(this.W.count,a)},n.L=function(a){return this.W.L(a)},n.Kb=function(a,b){b instanceof lu&&N("Cannot add a Part to a Panel: "+b+"; use a Panel instead"),(this===b||this.Dg(b))&&(this===b&&N("Cannot make a Panel contain itself: "+this.toString()),N("Cannot make a Panel indirectly contain itself: "+this.toString()+" already contains "+b.toString()));var t=b.panel;if(null!==t&&t!==this&&N("Cannot add a GraphObject that already belongs to another Panel to this Panel: "+b.toString()+", already contained by "+t.toString()+", cannot be shared by this Panel: "+this.toString()),this.pa!==jh.Grid||b instanceof rl||N("Can only add Shapes to a Grid Panel, not: "+b),this.pa!==jh.Graduated||b instanceof rl||b instanceof ml||N("Can only add Shapes or TextBlocks to a Graduated Panel, not: "+b),b.cj(this),b.Jj=null,null!==this.itemArray){var e=b.data;null!==e&&"object"==typeof e&&(null===this.Kd&&(this.Kd=new kt),this.Kd.add(e,b))}var n=this.W;if(e=-1,t===this){for(var o=-1,g=this.W.j,r=g.length,h=0;h<r;h++)if(g[h]===b){o=h;break}if(-1!==o){if(o===a||o+1>=n.count&&a>=n.count)return;n.lb(o),e=o}else N("element "+b.toString()+" has panel "+t.toString()+" but is not contained by it.")}(0>a||a>n.count)&&(a=n.count),n.Kb(a,b),(0===a||b.isPanelMain)&&(this.Hi=null),ya(this)||this.o(),b.o(!1),(null!==b.portId||b instanceof jh&&!0===b.Ih)&&(this.Ih=!0),this.$g=null,null!==(t=this.part)&&(t.Fj=null,t.gh=NaN,this.Ih&&t instanceof Au&&(t.Ih=!0),t.Ih&&t instanceof Au&&(t.rc=null),null!==(n=this.diagram)&&n.undoManager.isUndoingRedoing||(-1!==e&&t.Ya(Oe,"elements",this,b,null,e,null),t.Ya(Fe,"elements",this,null,b,null,a),this.Eg()||Wh(this,b,!1)))},n.remove=function(a){for(var b=this.W.j,t=b.length,e=-1,n=0;n<t;n++)if(b[n]===a){e=n;break}-1!==e&&this.Fc(e,!0)},n.lb=function(a){0<=a&&this.Fc(a,!0)},n.Fc=function(a,b){var t=this.W,e=t.L(a);if(e.Jj=null,e.cj(null),null!==this.Kd){var n=e.data;"object"==typeof n&&this.Kd.remove(n)}t.lb(a),ma(this,!1),this.o(),this.Hi===e&&(this.Hi=null),this.$g=null;var o=this.part;null!==o&&(o.Fj=null,o.gh=NaN,o.Lb(),o instanceof Au&&(e instanceof jh?e.Km(e,(function(a,t){Vu(o,t,b)})):Vu(o,e,b)),null!==(t=this.diagram)&&t.undoManager.isUndoingRedoing||o.Ya(Oe,"elements",this,e,null,a,null))},jh.prototype.getRowDefinition=function(a){0>a&&T(a,">= 0",jh,"getRowDefinition:idx"),a=Math.round(a);var b=this.rb;if(void 0===b)return null;if(void 0===b[a]){var t=new _h;t.cj(this),t.isRow=!0,t.index=a,b[a]=t}return b[a]},jh.prototype.Zv=function(a){0>a&&T(a,">= 0",jh,"removeRowDefinition:idx"),a=Math.round(a);var b=this.rb;void 0!==b&&(this.Ya(Oe,"coldefs",this,b[a],null,a,null),b[a]&&delete b[a],this.o())},jh.prototype.getColumnDefinition=function(a){0>a&&T(a,">= 0",jh,"getColumnDefinition:idx"),a=Math.round(a);var b=this.mb;if(void 0===b)return null;if(void 0===b[a]){var t=new _h;t.cj(this),t.isRow=!1,t.index=a,b[a]=t}return b[a]},(n=jh.prototype).Xv=function(a){0>a&&T(a,">= 0",jh,"removeColumnDefinition:idx"),a=Math.round(a);var b=this.mb;void 0!==b&&(this.Ya(Oe,"coldefs",this,b[a],null,a,null),b[a]&&delete b[a],this.o())},n.pz=function(a){if(0>a||this.type!==jh.Table)return-1;for(var b=0,t=this.rb,e=t.length,n=this.Ki;n<e;n++){var o=t[n];if(void 0!==o&&a<(b+=o.total))break}return n},n.hz=function(a){if(0>a||this.type!==jh.Table)return-1;for(var b=0,t=this.mb,e=t.length,n=this.vi;n<e;n++){var o=t[n];if(void 0!==o&&a<(b+=o.total))break}return n},n.Kz=function(a,b){if(void 0===b&&(b=new Mt(NaN,NaN)),this.type!==jh.Graduated)return b.h(NaN,NaN),b;a=Math.min(Math.max(a,this.graduatedMin),this.graduatedMax);var t=this.zb();return t.geometry.zv((a-this.graduatedMin)/this.graduatedRange,b),t.transform.ra(b)},n.Lz=function(a){if(this.type!==jh.Graduated)return NaN;var b=this.zb();return b.transform.Wd(a),b.geometry.Px(a)*this.graduatedRange+this.graduatedMin},n.Wy=function(){var a=this.copy();return Eh(a,(function(a){a instanceof jh&&(a.ci=null,a.hb=null);var b=a.$a;null!==b&&(a.$a=null,b.each((function(b){a.bind(b.copy())}))),null!==(b=a.Kg)&&(a.Kg=null,b.each((function(b){ka(a,b.value.copy())})))})),a},n.Ba=function(a){var b=this.ci;if(null!==b)for(void 0===a&&(a=""),b=b.iterator;b.next();){var t=b.value,e=t.sourceProperty;if((""===a||""===e||e===a)&&(e=t.targetProperty,null!==t.converter||""!==e)){e=this.data;var n=t.sourceName;if(null!==n)e=""===n||"/"===n||"."===n||".."===n?this:this.Xa(n);else{var o=this.diagram;null!==o&&t.isToModel&&(e=o.model.modelData)}if(null!==e){o=this;var g=t.gj;if(-1!==g){if(null===(o=this.it(g)))continue}else null!==t.bd&&(o=t.bd);if("/"===n?e=o.part:"."===n?e=o:".."===n&&(e=o.panel),0!==(n=t.Qp)){if(!(o instanceof jh))continue;1===n?o=o.getColumnDefinition(t.Vl):2===n&&(o=o.getRowDefinition(t.Vl))}void 0!==o&&t.tw(o,e)}}}},n.Gt=function(){for(var a=Uh(this);this.W.length>a;)this.Fc(this.W.length-1,!1);if(null!==(a=this.itemArray))for(var b=a.length,t=0;t<b;t++)Kh(this,a[t],t)},n.Kx=function(a){return null==a||null===this.Kd?null:this.Kd.H(a)},v.Object.defineProperties(jh.prototype,{type:{get:function(){return this.pa},set:function(a){var b=this.pa;b!==a&&(this.pa=a,this.pa===jh.Grid?this.isAtomic=!0:this.pa===jh.Table&&Dh(this),this.o(),this.g("type",b,a))}},elements:{get:function(){return this.W.iterator}},naturalBounds:{get:function(){return this.oc}},padding:{get:function(){return this.bb},set:function(a){"number"==typeof a?(0>a&&T(a,">= 0",jh,"padding"),a=new hi(a)):(0>a.left&&T(a.left,">= 0",jh,"padding:value.left"),0>a.right&&T(a.right,">= 0",jh,"padding:value.right"),0>a.top&&T(a.top,">= 0",jh,"padding:value.top"),0>a.bottom&&T(a.bottom,">= 0",jh,"padding:value.bottom"));var b=this.bb;b.w(a)||(this.bb=a=a.G(),this.o(),this.g("padding",b,a))}},defaultAlignment:{get:function(){return this.un},set:function(a){var b=this.un;b.w(a)||(this.un=a=a.G(),this.o(),this.g("defaultAlignment",b,a))}},defaultStretch:{get:function(){return this.Qf},set:function(a){var b=this.Qf;b!==a&&(this.Qf=a,this.o(),this.g("defaultStretch",b,a))}},defaultSeparatorPadding:{get:function(){return void 0===this.nj?fi:this.nj},set:function(a){if(void 0!==this.nj){"number"==typeof a&&(a=new hi(a));var b=this.nj;b.w(a)||(this.nj=a=a.G(),this.o(),this.g("defaultSeparatorPadding",b,a))}}},defaultRowSeparatorStroke:{get:function(){return void 0===this.ii?null:this.ii},set:function(a){var b=this.ii;b!==a&&(null===a||"string"==typeof a||a instanceof Ya)&&(a instanceof Ya&&a.freeze(),this.ii=a,this.M(),this.g("defaultRowSeparatorStroke",b,a))}},defaultRowSeparatorStrokeWidth:{get:function(){return void 0===this.Rg?1:this.Rg},set:function(a){if(void 0!==this.Rg){var b=this.Rg;b!==a&&isFinite(a)&&0<=a&&(this.Rg=a,this.o(),this.g("defaultRowSeparatorStrokeWidth",b,a))}}},defaultRowSeparatorDashArray:{get:function(){return void 0===this.hi?null:this.hi},set:function(a){if(void 0!==this.hi){var b=this.hi;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];"number"==typeof o&&0<=o&&isFinite(o)||N("defaultRowSeparatorDashArray value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}this.hi=a,this.M(),this.g("defaultRowSeparatorDashArray",b,a)}}}},defaultColumnSeparatorStroke:{get:function(){return void 0===this.Pg?null:this.Pg},set:function(a){if(void 0!==this.Pg){var b=this.Pg;b!==a&&(null===a||"string"==typeof a||a instanceof Ya)&&(a instanceof Ya&&a.freeze(),this.Pg=a,this.M(),this.g("defaultColumnSeparatorStroke",b,a))}}},defaultColumnSeparatorStrokeWidth:{get:function(){return void 0===this.Qg?1:this.Qg},set:function(a){if(void 0!==this.Qg){var b=this.Qg;b!==a&&isFinite(a)&&0<=a&&(this.Qg=a,this.o(),this.g("defaultColumnSeparatorStrokeWidth",b,a))}}},defaultColumnSeparatorDashArray:{get:function(){return void 0===this.gi?null:this.gi},set:function(a){if(void 0!==this.gi){var b=this.gi;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];"number"==typeof o&&0<=o&&isFinite(o)||N("defaultColumnSeparatorDashArray value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}this.gi=a,this.M(),this.g("defaultColumnSeparatorDashArray",b,a)}}}},viewboxStretch:{get:function(){return this.Yp},set:function(a){var b=this.Yp;b!==a&&(this.Yp=a,this.o(),this.g("viewboxStretch",b,a))}},gridCellSize:{get:function(){return this.Sn},set:function(a){var b=this.Sn;if(!b.w(a)){a.u()&&0!==a.width&&0!==a.height||N("Invalid Panel.gridCellSize: "+a),this.Sn=a.G();var t=this.diagram;null!==t&&this===t.grid&&Br(t),this.M(),this.g("gridCellSize",b,a)}}},gridOrigin:{get:function(){return this.Tn},set:function(a){var b=this.Tn;if(!b.w(a)){a.u()||N("Invalid Panel.gridOrigin: "+a),this.Tn=a.G();var t=this.diagram;null!==t&&this===t.grid&&Br(t),this.M(),this.g("gridOrigin",b,a)}}},graduatedMin:{get:function(){return this.Pn},set:function(a){var b=this.Pn;b!==a&&(this.Pn=a,this.o(),this.g("graduatedMin",b,a),fa(this)&&(null!==(a=this.part)&&ta(this,a,"graduatedRange")))}},graduatedMax:{get:function(){return this.On},set:function(a){var b=this.On;b!==a&&(this.On=a,this.o(),this.g("graduatedMax",b,a),fa(this)&&(null!==(a=this.part)&&ta(this,a,"graduatedRange")))}},graduatedRange:{get:function(){return this.graduatedMax-this.graduatedMin}},graduatedTickUnit:{get:function(){return this.Rn},set:function(a){var b=this.Rn;b!==a&&0<a&&(this.Rn=a,this.o(),this.g("graduatedTickUnit",b,a))}},graduatedTickBase:{get:function(){return this.Qn},set:function(a){var b=this.Qn;b!==a&&(this.Qn=a,this.o(),this.g("graduatedTickBase",b,a))}},Ih:{get:function(){return 0!=(8388608&this.F)},set:function(a){0!=(8388608&this.F)!==a&&(this.F^=8388608)}},rowCount:{get:function(){return void 0===this.rb?0:this.rb.length}},columnCount:{get:function(){return void 0===this.mb?0:this.mb.length}},rowSizing:{get:function(){return void 0===this.Mj?nl:this.Mj},set:function(a){if(void 0!==this.Mj){var b=this.Mj;b!==a&&(this.Mj=a,this.o(),this.g("rowSizing",b,a))}}},columnSizing:{get:function(){return void 0===this.kj?nl:this.kj},set:function(a){if(void 0!==this.kj){var b=this.kj;b!==a&&(this.kj=a,this.o(),this.g("columnSizing",b,a))}}},topIndex:{get:function(){return void 0===this.Ki?0:this.Ki},set:function(a){if(void 0!==this.Ki){var b=this.Ki;b!==a&&((!isFinite(a)||0>a)&&N("Panel.topIndex must be greater than zero and a real number, not: "+a),this.Ki=a,this.o(),this.g("topIndex",b,a))}}},leftIndex:{get:function(){return void 0===this.vi?0:this.vi},set:function(a){if(void 0!==this.vi){var b=this.vi;b!==a&&((!isFinite(a)||0>a)&&N("Panel.leftIndex must be greater than zero and a real number, not: "+a),this.vi=a,this.o(),this.g("leftIndex",b,a))}}},data:{get:function(){return this.hb},set:function(a){var b=this.hb;if(b!==a){var t=this instanceof lu&&!(this instanceof Lu);qh(this),this.hb=a;var e=this.diagram;null!==e&&(t?(t=e.partManager,this instanceof Wu?(null!==b&&t.Oe.remove(b),null!==a&&t.Oe.add(a,this)):this instanceof lu&&(null!==b&&t.Pe.remove(b),null!==a&&t.Pe.add(a,this))):null!==(t=this.panel)&&null!==t.Kd&&(null!==b&&t.Kd.remove(b),null!==a&&t.Kd.add(a,this))),this.g("data",b,a),null!==e&&e.undoManager.isUndoingRedoing||null!==a&&this.Ba()}}},itemIndex:{get:function(){return this.io},set:function(a){var b=this.io;b!==a&&(this.io=a,this.g("itemIndex",b,a))}},itemArray:{get:function(){return this.si},set:function(a){var b=this.si;if(b!==a||null!==a&&function(a,b){for(var t=(a=a.W.j).length,e=b.length,n=0,o=null;n<t&&!((o=a[n])instanceof jh&&null!==o.data);)o=a[++n];if(t-n!==e)return!0;if(null===o)return 0<e;for(var g=0;n<t&&g<e;){if(!((o=a[n])instanceof jh)||o.data!==b[g])return!0;n++,g++}return!1}(this,a)){var t=this.diagram;b!==a&&(null!==t&&null!==b&&Sf(t.partManager,this,t),this.si=a,null!==t&&null!==a&&Mf(t.partManager,this)),this.g("itemArray",b,a),null!==t&&t.undoManager.isUndoingRedoing||this.Gt()}}},itemTemplate:{get:function(){return null===this.me?null:this.me.H("")},set:function(a){if(null===this.me){if(null===a)return;this.me=new kt}var b=this.me.H("");b!==a&&((a instanceof lu||a.isPanelMain)&&N("Panel.itemTemplate must not be a Part or be Panel.isPanelMain: "+a),this.me.add("",a),this.g("itemTemplate",b,a),null!==(a=this.diagram)&&a.undoManager.isUndoingRedoing||this.Gt())}},itemTemplateMap:{get:function(){return this.me},set:function(a){var b=this.me;if(b!==a){for(var t=a.iterator;t.next(););this.me=a,this.g("itemTemplateMap",b,a),null!==(a=this.diagram)&&a.undoManager.isUndoingRedoing||this.Gt()}}},itemCategoryProperty:{get:function(){return this.ql},set:function(a){var b=this.ql;b!==a&&(this.ql=a,this.g("itemCategoryProperty",b,a))}},isAtomic:{get:function(){return 0!=(1048576&this.F)},set:function(a){var b=0!=(1048576&this.F);b!==a&&(this.F^=1048576,this.g("isAtomic",b,a))}},isClipping:{get:function(){return 0!=(2097152&this.F)},set:function(a){var b=0!=(2097152&this.F);b!==a&&(a&&this.type!==jh.Spot&&L("Warning: Panel.isClipping set on non-Spot Panel: "+this.toString()),this.F^=2097152,this.o(),this.g("isClipping",b,a))}},isOpposite:{get:function(){return 0!=(33554432&this.F)},set:function(a){var b=0!=(33554432&this.F);b!==a&&(this.F^=33554432,this.o(),this.g("isOpposite",b,a))}},isEnabled:{get:function(){return 0!=(4194304&this.F)},set:function(a){var b=0!=(4194304&this.F);if(b!==a){var t=null===this.panel||this.panel.Eg();this.F^=4194304,this.g("isEnabled",b,a),null!==(b=this.diagram)&&b.undoManager.isUndoingRedoing||t&&Wh(this,this,a)}}},alignmentFocusName:{get:function(){return this.Jg},set:function(a){var b=this.Jg;b!==a&&(this.Jg=a,this.o(),this.g("alignmentFocusName",b,a))}}}),v.Object.defineProperties(jh,{Position:{get:function(){return Qh.H("Position")}},Horizontal:{get:function(){return Qh.H("Horizontal")}},Vertical:{get:function(){return Qh.H("Vertical")}},Spot:{get:function(){return Qh.H("Spot")}},Auto:{get:function(){return Qh.H("Auto")}},Table:{get:function(){return Qh.H("Table")}},Viewbox:{get:function(){return Qh.H("Viewbox")}},TableRow:{get:function(){return Qh.H("TableRow")}},TableColumn:{get:function(){return Qh.H("TableColumn")}},Link:{get:function(){return Qh.H("Link")}},Grid:{get:function(){return Qh.H("Grid")}},Graduated:{get:function(){return Qh.H("Graduated")}}}),jh.prototype.findItemPanelForData=jh.prototype.Kx,jh.prototype.rebuildItemElements=jh.prototype.Gt,jh.prototype.updateTargetBindings=jh.prototype.Ba,jh.prototype.copyTemplate=jh.prototype.Wy,jh.prototype.graduatedValueForPoint=jh.prototype.Lz,jh.prototype.graduatedPointForValue=jh.prototype.Kz,jh.prototype.findColumnForLocalX=jh.prototype.hz,jh.prototype.findRowForLocalY=jh.prototype.pz,jh.prototype.removeColumnDefinition=jh.prototype.Xv,jh.prototype.removeRowDefinition=jh.prototype.Zv,jh.prototype.removeAt=jh.prototype.lb,jh.prototype.remove=jh.prototype.remove,jh.prototype.insertAt=jh.prototype.Kb,jh.prototype.elt=jh.prototype.L,jh.prototype.add=jh.prototype.add,jh.prototype.findObject=jh.prototype.Xa,jh.prototype.findInVisualTree=jh.prototype.hm,jh.prototype.walkVisualTreeFrom=jh.prototype.Km,jh.prototype.findMainElement=jh.prototype.zb;var Zh=!1,$h=null,Qh=new kt;function _h(){ft(this),this.ng=null,this.Rr=!0,this.Oa=0,this.Pc=NaN,this.ih=0,this.hh=1/0,this.vb=zi,this.ma=this.ha=0,this.$a=null,this.Hp=il,this.we=rs,this.Bp=this.qg=null,this.Cp=NaN,this.gb=this.Nj=null,this.qn=!1}function tl(a){if(a.sizing===il){var b=a.ng;return a.isRow?b.rowSizing:b.columnSizing}return a.sizing}jh.className="Panel",jh.definePanelLayout=Jh,Jh("Position",new mh),Jh("Vertical",new xh),Jh("Auto",new wh),Jh("Link",new Th),_h.prototype.copy=function(){var a=new _h;return a.Rr=this.Rr,a.Oa=this.Oa,a.Pc=this.Pc,a.ih=this.ih,a.hh=this.hh,a.vb=this.vb,a.ha=this.ha,a.ma=this.ma,a.we=this.we,a.Hp=this.Hp,null===this.qg?a.qg=null:a.qg=this.qg.G(),a.Bp=this.Bp,a.Cp=this.Cp,a.Nj=null,null!==this.Nj&&(a.separatorDashArray=F(this.separatorDashArray)),a.gb=this.gb,a.qn=this.qn,a.$a=this.$a,a},(n=_h.prototype).et=function(a){a.isRow?this.height=a.height:this.width=a.width,this.minimum=a.minimum,this.maximum=a.maximum,this.alignment=a.alignment,this.stretch=a.stretch,this.sizing=a.sizing,this.qg=null===a.separatorPadding?null:a.separatorPadding.G(),this.separatorStroke=a.separatorStroke,this.separatorStrokeWidth=a.separatorStrokeWidth,this.Nj=null,a.separatorDashArray&&(this.Nj=F(a.separatorDashArray)),this.background=a.background,this.coversSeparators=a.coversSeparators,this.$a=a.$a},n.cb=function(a){a.classType===_h&&(this.sizing=a)},n.toString=function(){return"RowColumnDefinition "+(this.isRow?"(Row ":"(Column ")+this.index+") #"+gt(this)},n.cj=function(a){this.ng=a},n.jv=function(){var a=0,b=0,t=this.ng,e=this.isRow;if(null!==t&&t.type===jh.Table)for(var n=e?t.rb.length:t.mb.length,o=0;o<n;o++){var g=e?t.rb[o]:t.mb[o];if(void 0!==g){b=g.index;break}}if(this.index!==b&&(null===(b=this.separatorStroke)&&null!==t&&(b=this.isRow?t.defaultRowSeparatorStroke:t.defaultColumnSeparatorStroke),null!==b&&(a=this.separatorStrokeWidth,isNaN(a)&&(a=null!==t?this.isRow?t.defaultRowSeparatorStrokeWidth:t.defaultColumnSeparatorStrokeWidth:0))),null===(b=this.qg)){if(null===t)return a;b=t.defaultSeparatorPadding}return a+(this.isRow?b.top:b.left)},n.uc=function(){var a=0,b=this.ng,t=0,e=this.isRow;if(null!==b&&b.type===jh.Table)for(var n=e?b.rb.length:b.mb.length,o=0;o<n;o++){var g=e?b.rb[o]:b.mb[o];if(void 0!==g){t=g.index;break}}if(this.index!==t&&(null===(t=this.separatorStroke)&&null!==b&&(t=e?b.defaultRowSeparatorStroke:b.defaultColumnSeparatorStroke),null!==t&&(a=this.separatorStrokeWidth,isNaN(a)&&(a=null!==b?e?b.defaultRowSeparatorStrokeWidth:b.defaultColumnSeparatorStrokeWidth:0))),null===(e=this.qg)){if(null===b)return a;e=b.defaultSeparatorPadding}return a+(this.isRow?e.top+e.bottom:e.left+e.right)},n.xb=function(a,b,t){var e=this.ng;if(null!==e&&(e.Ya(De,a,this,b,t,void 0,void 0),null!==this.$a&&(null!==(b=e.diagram)&&!b.skipsModelSourceBindings&&(null!==(e=e.Ui())&&null!==(b=e.data)))))for(t=this.$a.iterator;t.next();)t.value.Qq(this,b,a,e)},n.bind=function(a){a.bd=this;var b=this.panel;if(null!==b){var t=b.Ui();null!==t&&Xh(t)&&N("Cannot add a Binding to a RowColumnDefinition that is already frozen: "+a+" on "+b)}null===this.$a&&(this.$a=new lt),this.$a.add(a)},v.Object.defineProperties(_h.prototype,{panel:{get:function(){return this.ng}},isRow:{get:function(){return this.Rr},set:function(a){this.Rr=a}},index:{get:function(){return this.Oa},set:function(a){this.Oa=a}},height:{get:function(){return this.Pc},set:function(a){var b=this.Pc;b!==a&&(0>a&&T(a,">= 0",_h,"height"),this.Pc=a,this.actual=this.ha,null!==this.panel&&this.panel.o(),this.xb("height",b,a))}},width:{get:function(){return this.Pc},set:function(a){var b=this.Pc;b!==a&&(0>a&&T(a,">= 0",_h,"width"),this.Pc=a,this.actual=this.ha,null!==this.panel&&this.panel.o(),this.xb("width",b,a))}},minimum:{get:function(){return this.ih},set:function(a){var b=this.ih;b!==a&&((0>a||!isFinite(a))&&T(a,">= 0",_h,"minimum"),this.ih=a,this.actual=this.ha,null!==this.panel&&this.panel.o(),this.xb("minimum",b,a))}},maximum:{get:function(){return this.hh},set:function(a){var b=this.hh;b!==a&&(0>a&&T(a,">= 0",_h,"maximum"),this.hh=a,this.actual=this.ha,null!==this.panel&&this.panel.o(),this.xb("maximum",b,a))}},alignment:{get:function(){return this.vb},set:function(a){var b=this.vb;b.w(a)||(this.vb=a.G(),null!==this.panel&&this.panel.o(),this.xb("alignment",b,a))}},stretch:{get:function(){return this.we},set:function(a){var b=this.we;b!==a&&(this.we=a,null!==this.panel&&this.panel.o(),this.xb("stretch",b,a))}},separatorPadding:{get:function(){return this.qg},set:function(a){"number"==typeof a&&(a=new hi(a));var b=this.qg;null!==a&&null!==b&&b.w(a)||(null!==a&&(a=a.G()),this.qg=a,null!==this.panel&&this.panel.o(),this.xb("separatorPadding",b,a))}},separatorStroke:{get:function(){return this.Bp},set:function(a){var b=this.Bp;b!==a&&(null!==a&&_a(a,"RowColumnDefinition.separatorStroke"),a instanceof Ya&&a.freeze(),this.Bp=a,null!==this.panel&&this.panel.o(),this.xb("separatorStroke",b,a))}},separatorStrokeWidth:{get:function(){return this.Cp},set:function(a){var b=this.Cp;b!==a&&(this.Cp=a,null!==this.panel&&this.panel.o(),this.xb("separatorStrokeWidth",b,a))}},separatorDashArray:{get:function(){return this.Nj},set:function(a){var b=this.Nj;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];"number"==typeof o&&0<=o&&isFinite(o)||N("separatorDashArray value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}this.Nj=a,null!==this.panel&&this.panel.M(),this.xb("separatorDashArray",b,a)}}},background:{get:function(){return this.gb},set:function(a){var b=this.gb;b!==a&&(null!==a&&_a(a,"RowColumnDefinition.background"),a instanceof Ya&&a.freeze(),this.gb=a,null!==this.panel&&this.panel.M(),this.xb("background",b,a))}},coversSeparators:{get:function(){return this.qn},set:function(a){var b=this.qn;b!==a&&(this.qn=a,null!==this.panel&&this.panel.M(),this.xb("coversSeparators",b,a))}},sizing:{get:function(){return this.Hp},set:function(a){var b=this.Hp;b!==a&&(this.Hp=a,null!==this.panel&&this.panel.o(),this.xb("sizing",b,a))}},actual:{get:function(){return this.ha},set:function(a){this.ha=isNaN(this.Pc)?Math.max(Math.min(this.hh,a),this.ih):Math.max(Math.min(this.hh,this.Pc),this.ih)}},total:{get:function(){return this.ha+this.uc()},set:function(a){this.ha=isNaN(this.Pc)?Math.max(Math.min(this.hh,a),this.ih):Math.max(Math.min(this.hh,this.Pc),this.ih),this.ha=Math.max(0,this.ha-this.uc())}},position:{get:function(){return this.ma},set:function(a){this.ma=a}}}),_h.prototype.bind=_h.prototype.bind,_h.prototype.computeEffectiveSpacing=_h.prototype.uc,_h.prototype.computeEffectiveSpacingTop=_h.prototype.jv;var il=new _(_h,"Default",0),el=new _(_h,"None",1),nl=new _(_h,"ProportionalExtra",2);function rl(){_s.call(this),this.Rd=this.ka=null,this.Zk="None",this.Nn=rs,this.Dc=this.$k="black",this.th=1,this.Rl="butt",this.Sl="miter",this.Oj=10,this.rh=null,this.sh=0,this.kf=this.jf=zi,this.$o=this.Zo=NaN,this.Zn=!1,this.bp=null,this.al=this.Yl="None",this.Jd=1,this.Gd=0,this.Ed=1,this.Fd=null}function sl(a,b,t,e){var n=t.length;if(!(4>n)){var o=e.measuredBounds,g=Math.max(1,o.width);o=o.height;for(var r,h,l,p,c,q,f=t[0],d=t[1],u=0,y=I(),m=2;m<n;m+=2)0===(l=(r=t[m])-f)&&(l=.001),p=(f=(h=t[m+1])-d)/l,c=Math.atan2(f,l),q=Math.sqrt(l*l+f*f),y.push([l,c,p,q]),u+=q,f=r,d=h;f=t[0],d=t[1],l=e.measuredBounds.width,e instanceof rl&&(l-=e.strokeWidth),1>l&&(l=1),n=t=l,h=0!==(r=g/2),l=(q=y[m=0])[0],c=q[1],p=q[2],q=q[3];for(var v=0;.1<=u;){if(0===v&&(h?(n=t,n-=r,u-=r,h=!1):n=t,0===n&&(n=1)),n>u)return void R(y);n>q?(v=n-q,n=q):v=0;var x=Math.sqrt(n*n/(1+p*p));if(0>l&&(x=-x),f+=x,d+=p*x,a.translate(f,d),a.rotate(c),a.translate(-g/2,-o/2),0===v&&e.Qi(a,b),a.translate(g/2,o/2),a.rotate(-c),a.translate(-f,-d),u-=n,q-=n,0!==v){if(++m===y.length)return void R(y);l=(q=y[m])[0],c=q[1],p=q[2],q=q[3],n=v}}R(y)}}function al(a){var b=a.geometryStretch;return null!==a.Rd?b===rs?es:b:b===rs?yl[a.figure].defaultStretch:b}function hl(a,b,t,e,n){return(b=(a=t.x-a)*a+(b=t.y-b)*b)<e?(n.x=t.x,n.y=t.y,b):e}function ll(a,b,t,e,n,o,g,r,h){var l=!1,c=(n-g)*(b-e)-(o-r)*(a-t);return 0!==c&&(h.x=((n*r-o*g)*(a-t)-(n-g)*(a*e-b*t))/c,h.y=((n*r-o*g)*(b-e)-(o-r)*(a*e-b*t))/c,(a>t?a-t:t-a)<(b>e?b-e:e-b)?(a=b<e?b:e,b=b<e?e:b,(h.y>a||ne.$(h.y,a))&&(h.y<b||ne.$(h.y,b))&&(l=!0)):(b=a<t?a:t,a=a<t?t:a,(h.x>b||ne.$(h.x,b))&&(h.x<a||ne.$(h.x,a))&&(l=!0)),l)}function cl(a,b,t,e){if(!a.Uc(b,t,e))return!1;a=b.x,b=b.y;var n=t.x,o=t.y;return t=e.x,e=e.y,a===n?(b<o?(a=b,b=o):a=o,e>=a&&e<=b):(a<n?(e=a,a=n):e=n,t>=e&&t<=a)}function fl(a){var b=a.diagram;null!==b&&b.undoManager.isUndoingRedoing||(a.segmentOrientation=Sc,"None"!==a.Yl?(a.segmentIndex=-1,a.alignmentFocus=Ui):"None"!==a.al&&(a.segmentIndex=0,a.alignmentFocus=new Zi(1-Ui.x,Ui.y)))}function pl(a){var b=gl[a];if(void 0===b){var t=a.toLowerCase();if("none"===t)return"None";if(void 0===(b=gl[t])){var e,n=null;for(e in ne.Nm)if(e.toLowerCase()===t){n=e;break}if(null!==n)return a=ae(ne.Nm[n],!1),gl[n]=a,t!==n&&(gl[t]=n),n}}return"string"==typeof b?b:b instanceof oe?a:null}_h.className="RowColumnDefinition",_h.Default=il,_h.None=el,_h.ProportionalExtra=nl,m(rl,_s),rl.prototype.cloneProtected=function(a){_s.prototype.cloneProtected.call(this,a),a.ka=this.ka,a.Zk=this.Zk,a.Nn=this.Nn,a.Rd=this.Rd,a.$k=this.$k,a.Dc=this.Dc,a.th=this.th,a.Rl=this.Rl,a.Sl=this.Sl,a.Oj=this.Oj,null!==this.rh&&(a.rh=F(this.rh)),a.sh=this.sh,a.jf=this.jf.G(),a.kf=this.kf.G(),a.Zo=this.Zo,a.$o=this.$o,a.Zn=this.Zn,a.bp=this.bp,a.Yl=this.Yl,a.al=this.al,a.Jd=this.Jd,a.Gd=this.Gd,a.Ed=this.Ed,a.Fd=this.Fd},(n=rl.prototype).cb=function(a){a===ns||a===os||a===hs||a===rs?this.geometryStretch=a:_s.prototype.cb.call(this,a)},n.toString=function(){return"Shape("+("None"!==this.figure?this.figure:"None"!==this.toArrow?this.toArrow:this.fromArrow)+")#"+gt(this)},n.Qi=function(a,b){var t=this.Dc,e=this.$k;if(null!==t||null!==e){var n=this.actualBounds,o=this.naturalBounds;null!==e&&oa(this,a,e,!0,!1,o,n);var g=this.part,r=this.th;null!==t&&0===r&&null!==g&&(r=g.type===jh.Link&&g instanceof Lu&&"Selection"===g.category&&g.adornedObject instanceof rl&&g.adornedPart.zb()===g.adornedObject?g.adornedObject.strokeWidth:0),null!==t&&0!==r&&(oa(this,a,t,!1,!1,o,n),a.lineWidth=r,a.lineJoin=this.Sl,a.lineCap=this.Rl,a.miterLimit=this.Oj),n=!1,g&&b.Ce("drawShadows")&&(n=g.isShadowed),g=!0,null===t||null!==e&&"transparent"!==e||(g=!1),o=!1;var h=this.strokeDashArray;null!==h&&(o=!0,a.ht(h,this.sh));var l=this.ka;if(null!==l){if(l.type===ge)a.beginPath(),a.moveTo(l.startX,l.startY),a.lineTo(l.endX,l.endY),null!==e&&a.Vd(e),0!==r&&null!==t&&a.fj();else if(l.type===ye){var c=l.startX;h=l.startY;var f=l.endX,p=l.endY;l=Math.min(c,f);var d=Math.min(h,p);c=Math.abs(f-c),h=Math.abs(p-h),a.beginPath(),a.rect(l,d,c,h),null!==e&&a.Vd(e),null!==t&&(g&&n&&ul(a),0!==r&&(0!==c&&0!==h||(a.beginPath(),a.rect(l,d,Math.max(c,.1),Math.max(h,.1))),a.fj()),g&&n&&Ia(a))}else if(l.type===me)c=l.startX,h=l.startY,f=l.endX,p=l.endY,l=Math.abs(f-c)/2,d=Math.abs(p-h)/2,c=Math.min(c,f)+l,h=Math.min(h,p)+d,a.beginPath(),a.moveTo(c,h-d),a.bezierCurveTo(c+ne.Ig*l,h-d,c+l,h-ne.Ig*d,c+l,h),a.bezierCurveTo(c+l,h+ne.Ig*d,c+ne.Ig*l,h+d,c,h+d),a.bezierCurveTo(c-ne.Ig*l,h+d,c-l,h+ne.Ig*d,c-l,h),a.bezierCurveTo(c-l,h-ne.Ig*d,c-ne.Ig*l,h-d,c,h-d),a.closePath(),null!==e&&a.Vd(e),0!==r&&null!==t&&(g&&n?(ul(a),a.fj(),Ia(a)):a.fj());else if(l.type===td)for(l=(h=l.figures).length,d=0;d<l;d++){c=h.j[d],a.beginPath(),a.moveTo(c.startX,c.startY),p=(f=c.segments.j).length;for(var q=null,u=0;u<p;u++){var y=f[u];switch(y.type){case ke:a.moveTo(y.endX,y.endY);break;case Me:a.lineTo(y.endX,y.endY);break;case Se:a.bezierCurveTo(y.point1X,y.point1Y,y.point2X,y.point2Y,y.endX,y.endY);break;case Pe:a.quadraticCurveTo(y.point1X,y.point1Y,y.endX,y.endY);break;case Ne:if(y.radiusX===y.radiusY){var m=Math.PI/180;a.arc(y.point1X,y.point1Y,y.radiusX,y.startAngle*m,(y.startAngle+y.sweepAngle)*m,0>y.sweepAngle,null!==q?q.endX:c.startX,null!==q?q.endY:c.startY)}else if(0===(m=(q=be(y,c)).length))a.lineTo(y.centerX,y.centerY);else for(var v=0;v<m;v++){var x=q[v];0===v&&a.lineTo(x[0],x[1]),a.bezierCurveTo(x[2],x[3],x[4],x[5],x[6],x[7])}break;case Ce:if(v=m=0,null!==q&&q.type===Ne){if(0===(x=(q=be(q,c)).length)){a.lineTo(y.centerX,y.centerY);break}null!==(q=q[x-1]||null)&&(m=q[6],v=q[7])}else m=null!==q?q.endX:c.startX,v=null!==q?q.endY:c.startY;if(0===(m=(q=we(y,c,m,v)).length)){a.lineTo(y.centerX,y.centerY);break}for(v=0;v<m;v++)x=q[v],a.bezierCurveTo(x[2],x[3],x[4],x[5],x[6],x[7]);break;default:N("Segment not of valid type: "+y.type)}y.isClosed&&a.closePath(),q=y}n?c.isShadowed?(!0===c.isFilled&&"transparent"!==e&&null!==e&&a.Vd(e),0!==r&&null!==t&&(g&&ul(a),a.fj(),g&&Ia(a))):(g&&ul(a),!0===c.isFilled&&"transparent"!==e&&null!==e&&a.Vd(e),0!==r&&null!==t&&a.fj(),g&&Ia(a)):(!0===c.isFilled&&null!==e&&a.Vd(e),0!==r&&null!==t&&a.fj())}if(o&&a.ft(),null!==this.pathPattern){if((t=this.pathPattern).measure(1/0,1/0),e=t.measuredBounds,t.arrange(0,0,e.width,e.height),r=this.geometry,a.save(),a.beginPath(),e=I(),r.type===ge)e.push(r.startX),e.push(r.startY),e.push(r.endX),e.push(r.endY),sl(a,b,e,t);else if(r.type===td)for(r=r.figures.iterator;r.next();){for(n=r.value,e.length=0,e.push(n.startX),e.push(n.startY),h=g=n.startX,l=o=n.startY,c=(d=n.segments.j).length,f=0;f<c;f++){switch((p=d[f]).type){case ke:sl(a,b,e,t),e.length=0,e.push(p.endX),e.push(p.endY),h=g=p.endX,l=o=p.endY;break;case Me:e.push(p.endX),e.push(p.endY),g=p.endX,o=p.endY;break;case Se:ne.ze(g,o,p.point1X,p.point1Y,p.point2X,p.point2Y,p.endX,p.endY,.5,e),g=p.endX,o=p.endY;break;case Pe:ne.Cq(g,o,p.point1X,p.point1Y,p.endX,p.endY,.5,e),g=p.endX,o=p.endY;break;case Ne:if(0===(y=(u=be(p,n)).length)){e.push(p.centerX),e.push(p.centerY),g=p.centerX,o=p.centerY;break}for(q=0;q<y;q++)m=u[q],ne.ze(g,o,m[2],m[3],m[4],m[5],m[6],m[7],.5,e),g=m[6],o=m[7];break;case Ce:if(0===(y=(u=we(p,n,g,o)).length)){e.push(p.centerX),e.push(p.centerY),g=p.centerX,o=p.centerY;break}for(q=0;q<y;q++)m=u[q],ne.ze(g,o,m[2],m[3],m[4],m[5],m[6],m[7],.5,e),g=m[6],o=m[7];break;default:N("Segment not of valid type: "+p.type)}p.isClosed&&(e.push(h),e.push(l),sl(a,b,e,t))}sl(a,b,e,t)}else if(r.type===ye)e.push(r.startX),e.push(r.startY),e.push(r.endX),e.push(r.startY),e.push(r.endX),e.push(r.endY),e.push(r.startX),e.push(r.endY),e.push(r.startX),e.push(r.startY),sl(a,b,e,t);else if(r.type===me){if((o=new ve).startX=r.endX,o.startY=(r.startY+r.endY)/2,(g=new xe(Ne)).startAngle=0,g.sweepAngle=360,g.centerX=(r.startX+r.endX)/2,g.centerY=(r.startY+r.endY)/2,g.radiusX=Math.abs(r.startX-r.endX)/2,g.radiusY=Math.abs(r.startY-r.endY)/2,o.add(g),0===(n=(r=be(g,o)).length))e.push(g.centerX),e.push(g.centerY);else for(g=o.startX,o=o.startY,h=0;h<n;h++)l=r[h],ne.ze(g,o,l[2],l[3],l[4],l[5],l[6],l[7],.5,e),g=l[6],o=l[7];sl(a,b,e,t)}R(e),a.restore(),a.sc(!1)}}}},n.ga=function(a,b){if(void 0===b&&(b=new Mt),a instanceof Zi){a.jc()&&N("getDocumentPoint Spot must be a real, specific Spot, not: "+a.toString());var t=this.naturalBounds,e=this.strokeWidth;b.h(a.x*(t.width+e)-e/2+t.x+a.offsetX,a.y*(t.height+e)-e/2+t.y+a.offsetY)}else b.set(a);return this.vd.ra(b),b},n.lm=function(a){void 0===a&&(a=new Wt);var b=this.naturalBounds,t=this.vd;b=Wt.allocAt(b.x,b.y,b.width,b.height);var e=this.strokeWidth;return b.Vc(e/2,e/2),e=Mt.allocAt(b.x,b.y).transform(t),a.h(e.x,e.y,0,0),e.h(b.right,b.y).transform(t),ei(a,e.x,e.y,0,0),e.h(b.right,b.bottom).transform(t),ei(a,e.x,e.y,0,0),e.h(b.x,b.bottom).transform(t),ei(a,e.x,e.y,0,0),Wt.free(b),Mt.free(e),a},n.Hh=function(a,b){var t=this.geometry;if(null===t||null===this.fill&&null===this.stroke)return!1;var e=t.bounds,n=this.strokeWidth/2;t.type!==ge||b||(n+=2);var o=Wt.alloc();if(o.assign(e),o.Vc(n+2,n+2),!o.aa(a))return Wt.free(o),!1;if(e=n+1e-4,t.type===ge)return null!==this.stroke&&(e=(t.endX-t.startX)*(a.x-t.startX)+(t.endY-t.startY)*(a.y-t.startY),!(0>(t.startX-t.endX)*(a.x-t.endX)+(t.startY-t.endY)*(a.y-t.endY)||0>e)&&(Wt.free(o),ne.Nb(t.startX,t.startY,t.endX,t.endY,n,a.x,a.y)));if(t.type===ye){b=t.startX;var g=t.startY,r=t.endX;if(t=t.endY,o.x=Math.min(b,r),o.y=Math.min(g,t),o.width=Math.abs(r-b),o.height=Math.abs(t-g),null===this.fill){if(o.Vc(-e,-e),o.aa(a))return Wt.free(o),!1;o.Vc(e,e)}return null!==this.stroke&&o.Vc(n,n),a=o.aa(a),Wt.free(o),a}if(t.type===me){g=t.startX,n=t.startY,r=t.endX;var h=t.endY;if(t=Math.min(g,r),b=Math.min(n,h),g=Math.abs(r-g)/2,n=Math.abs(h-n)/2,t=a.x-(t+g),b=a.y-(b+n),null===this.fill){if(n-=e,0>=(g-=e)||0>=n||1>=t*t/(g*g)+b*b/(n*n))return Wt.free(o),!1;g+=e,n+=e}return null!==this.stroke&&(g+=e,n+=e),Wt.free(o),!(0>=g||0>=n)&&1>=t*t/(g*g)+b*b/(n*n)}return t.type===td?(Wt.free(o),null===this.fill?fe(t,a.x,a.y,n):ue(t,a,n,1<this.strokeWidth,b)):(N("Unknown Geometry type: "+t.type),!1)},n.sm=function(a,b,t,e){var n=this.desiredSize,o=this.th;if(a=Math.max(a,0),b=Math.max(b,0),null!==this.Rd)var g=this.geometry.bounds;else{var r=this.figure,h=yl[r];if(void 0===h){var l=ne.Ke[r];"string"==typeof l&&(l=ne.Ke[l]),"function"==typeof l?(h=l(null,100,100),yl[r]=h):N("Unsupported Figure: "+r)}g=h.bounds}r=g.width,h=g.height,l=g.width;var c=g.height;switch(ha(this,!0)){case ns:e=t=0;break;case es:l=Math.max(a-o,0),c=Math.max(b-o,0);break;case ss:l=Math.max(a-o,0),e=0;break;case as:t=0,c=Math.max(b-o,0)}switch(isFinite(n.width)&&(l=n.width),isFinite(n.height)&&(c=n.height),n=this.maxSize,g=this.minSize,t=Math.max(t-o,g.width),e=Math.max(e-o,g.height),l=Math.min(n.width,l),c=Math.min(n.height,c),l=isFinite(l)?Math.max(t,l):Math.max(r,t),c=isFinite(c)?Math.max(e,c):Math.max(h,e),t=al(this)){case ns:break;case es:r=l,h=c;break;case os:t=Math.min(l/r,c/h),isFinite(t)||(t=1),r*=t,h*=t;break;default:N(t+" is not a valid geometryStretch.")}null!==this.Rd?(n=r=Math.max(r,.01),e=h=Math.max(h,.01),t=(g=null!==this.Rd?this.Rd:this.ka).copy(),n/=(g=g.bounds).width,e/=g.height,isFinite(n)||(n=1),isFinite(e)||(e=1),1===n&&1===e||t.scale(n,e),this.ka=t):null!==this.ka&&ne.$(this.ka.kl,a-o)&&ne.$(this.ka.jl,b-o)||(this.ka=rl.makeGeometry(this,r,h)),g=this.ka.bounds,1/0===a||1/0===b?ia(this,g.x-o/2,g.y-o/2,0===a&&0===r?0:g.width+o,0===b&&0===h?0:g.height+o):ia(this,-o/2,-o/2,l+o,c+o)},n.Fh=function(a,b,t,e){ol(this,a,b,t,e)},n.Uc=function(a,b,t){return this.hk(a.x,a.y,b.x,b.y,t)},n.hk=function(a,b,t,e,n){var o=this.transform,g=1/(o.m11*o.m22-o.m12*o.m21),r=o.m22*g,h=-o.m12*g,l=-o.m21*g,c=o.m11*g,f=g*(o.m21*o.dy-o.m22*o.dx),p=g*(o.m12*o.dx-o.m11*o.dy);if(o=a*r+b*l+f,g=a*h+b*c+p,r=t*r+e*l+f,h=t*h+e*c+p,f=this.th/2,null===(l=this.ka)&&(this.measure(1/0,1/0),l=this.ka),p=l.bounds,c=!1,l.type===ge)if(1.5>=this.strokeWidth)c=ne.Ee(l.startX,l.startY,l.endX,l.endY,o,g,r,h,n);else{if(l.startX===l.endX?(e=f,c=0):(b=(l.endY-l.startY)/(l.endX-l.startX),e=(c=f/Math.sqrt(1+b*b))*b),b=I(),a=new Mt,ne.Ee(l.startX+e,l.startY+c,l.endX+e,l.endY+c,o,g,r,h,a)&&b.push(a),a=new Mt,ne.Ee(l.startX-e,l.startY-c,l.endX-e,l.endY-c,o,g,r,h,a)&&b.push(a),a=new Mt,ne.Ee(l.startX+e,l.startY+c,l.startX-e,l.startY-c,o,g,r,h,a)&&b.push(a),a=new Mt,ne.Ee(l.endX+e,l.endY+c,l.endX-e,l.endY-c,o,g,r,h,a)&&b.push(a),0===(r=b.length))return R(b),!1;for(c=!0,h=1/0,e=0;e<r;e++)(t=((a=b[e]).x-o)*(a.x-o)+(a.y-g)*(a.y-g))<h&&(h=t,n.x=a.x,n.y=a.y);R(b)}else if(l.type===ye)c=ne.Uc(p.x-f,p.y-f,p.x+p.width+f,p.y+p.height+f,o,g,r,h,n);else if(l.type===me){t:if(0===(b=Wt.allocAt(p.x,p.y,p.width,p.height).Vc(f,f)).width)c=ne.Ee(b.x,b.y,b.x,b.y+b.height,o,g,r,h,n);else if(0===b.height)c=ne.Ee(b.x,b.y,b.x+b.width,b.y,o,g,r,h,n);else{if(a=b.width/2,l=b.height/2,e=b.x+a,c=b.y+l,t=9999,o!==r&&(t=(g-h)/(o-r)),9999>Math.abs(t)){if(0>a*a*t*t+l*l-(h=g-c-t*(o-e))*h){n.x=NaN,n.y=NaN,c=!1;break t}r=(-a*a*t*h+a*l*(f=Math.sqrt(a*a*t*t+l*l-h*h)))/(l*l+a*a*t*t)+e,a=(-a*a*t*h-a*l*f)/(l*l+a*a*t*t)+e,l=t*(r-e)+h+c,h=t*(a-e)+h+c,Math.abs((o-r)*(o-r))+Math.abs((g-l)*(g-l))<Math.abs((o-a)*(o-a))+Math.abs((g-h)*(g-h))?(n.x=r,n.y=l):(n.x=a,n.y=h)}else{if(r=l*l,0>(r-=r/(a*a)*(h=o-e)*h)){n.x=NaN,n.y=NaN,c=!1;break t}r=c+(h=Math.sqrt(r)),h=c-h,Math.abs(r-g)<Math.abs(h-g)?(n.x=o,n.y=r):(n.x=o,n.y=h)}c=!0}Wt.free(b)}else if(l.type===td){p=Mt.alloc();var d=r-o,q=h-g,u=d*d+q*q;n.x=r,n.y=h;for(var y=0;y<l.figures.count;y++)for(var m=l.figures.j[y],v=m.segments,x=d=m.startX,w=q=m.startY,k=0;k<v.count;k++){var M=v.j[k],S=M.type,P=M.endX,C=M.endY,T=!1;switch(S){case ke:x=P,w=C;break;case Me:T=ll(d,q,P,C,o,g,r,h,p);break;case Se:T=ne.eq(d,q,M.point1X,M.point1Y,M.point2X,M.point2Y,P,C,o,g,r,h,.6,p);break;case Pe:T=ne.eq(d,q,(d+2*M.point1X)/3,(q+2*M.point1Y)/3,(2*M.point1X+P)/3,(2*M.point1X+P)/3,P,C,o,g,r,h,.6,p);break;case Ne:case Ce:var L=(S=M.type===Ne?be(M,m):we(M,m,d,q)).length;if(0===L){T=ll(d,q,M.centerX,M.centerY,o,g,r,h,p);break}for(C=null,P=0;P<L;P++){if(C=S[P],0===P&&ll(d,q,C[0],C[1],o,g,r,h,p)){var A=hl(o,g,p,u,n);A<u&&(u=A,c=!0)}ne.eq(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],o,g,r,h,.6,p)&&((A=hl(o,g,p,u,n))<u&&(u=A,c=!0))}P=C[6],C=C[7];break;default:N("Unknown Segment type: "+S)}d=P,q=C,T&&((T=hl(o,g,p,u,n))<u&&(u=T,c=!0)),M.isClosed&&(ll(d,q,P=x,C=w,o,g,r,h,p)&&((M=hl(o,g,p,u,n))<u&&(u=M,c=!0)))}o=t-a,g=e-b,0!==(r=Math.sqrt(o*o+g*g))&&(o/=r,g/=r),n.x-=o*f,n.y-=g*f,Mt.free(p)}else N("Unknown Geometry type: "+l.type);return!!c&&(this.transform.ra(n),!0)},n.Gh=function(a,b){if(void 0===b)return a.Ae(this.actualBounds);var t=this.ka;null===t&&(this.measure(1/0,1/0),t=this.ka),t=t.bounds;var e=this.strokeWidth/2,n=!1,o=Mt.alloc();return o.h(t.x-e,t.y-e),a.aa(b.ra(o))&&(o.h(t.x-e,t.bottom+e),a.aa(b.ra(o))&&(o.h(t.right+e,t.bottom+e),a.aa(b.ra(o))&&(o.h(t.right+e,t.y-e),a.aa(b.ra(o))&&(n=!0)))),Mt.free(o),n},n.Gc=function(a,b){if(this.Gh(a,b)||void 0===b&&(b=this.transform,a.Ae(this.actualBounds)))return!0;var t=ie.alloc();t.set(b),t.tt();var e=a.left,n=a.right,o=a.top;a=a.bottom;var g=Mt.alloc();if(g.h(e,o),t.ra(g),this.Hh(g,!0))return Mt.free(g),!0;if(g.h(n,o),t.ra(g),this.Hh(g,!0))return Mt.free(g),!0;if(g.h(e,a),t.ra(g),this.Hh(g,!0))return Mt.free(g),!0;if(g.h(n,a),t.ra(g),this.Hh(g,!0))return Mt.free(g),!0;var r=Mt.alloc(),h=Mt.alloc();return t.set(b),t.Mv(this.transform),t.tt(),r.x=n,r.y=o,r.transform(t),g.x=e,g.y=o,g.transform(t),b=!1,cl(this,g,r,h)?b=!0:(g.x=n,g.y=a,g.transform(t),cl(this,g,r,h)?b=!0:(r.x=e,r.y=a,r.transform(t),cl(this,g,r,h)?b=!0:(g.x=e,g.y=o,g.transform(t),cl(this,g,r,h)&&(b=!0)))),Mt.free(g),ie.free(t),Mt.free(r),Mt.free(h),b},n.Lx=function(a,b,t){function e(a,b){for(var t=a.length,e=0;e<t;e+=2)if(b.dd(a[e],a[e+1])>n)return!0;return!1}if(t&&null!==this.fill&&this.Hh(a,!0))return!0;var n=a.Be(b),o=n;if(1.5<this.strokeWidth&&(n=this.strokeWidth/2+Math.sqrt(n),n*=n),null===(b=this.ka)&&(this.measure(1/0,1/0),null===(b=this.ka)))return!1;if(!t){var g=b.bounds,r=g.x,h=g.y,l=g.x+g.width;if(g=g.y+g.height,Lt(a.x,a.y,r,h)<=n&&Lt(a.x,a.y,l,h)<=n&&Lt(a.x,a.y,r,g)<=n&&Lt(a.x,a.y,l,g)<=n)return!0}if(r=b.startX,h=b.startY,l=b.endX,g=b.endY,b.type===ge){if(t=(r-l)*(a.x-l)+(h-g)*(a.y-g),Tt(a.x,a.y,r,h,l,g)<=(0<=(l-r)*(a.x-r)+(g-h)*(a.y-h)&&0<=t?n:o))return!0}else{if(b.type===ye)return b=!1,t&&(b=Tt(a.x,a.y,r,h,r,g)<=n||Tt(a.x,a.y,r,h,l,h)<=n||Tt(a.x,a.y,l,h,l,g)<=n||Tt(a.x,a.y,r,g,l,g)<=n),b;if(b.type===me){b=a.x-(r+l)/2,o=a.y-(h+g)/2;var c=Math.abs(l-r)/2,f=Math.abs(g-h)/2;if(0===c||0===f)return Tt(a.x,a.y,r,h,l,g)<=n;if(!t)return!(Lt(b,o,-c,0)>=n||Lt(b,o,0,-f)>=n||Lt(b,o,0,f)>=n||Lt(b,o,c,0)>=n);if((a=ne.bz(c,f,b,o))*a<=n)return!0}else if(b.type===td){if(o=(l=b.bounds).x,r=l.y,h=l.x+l.width,l=l.y+l.height,a.x>h&&a.x<o&&a.y>l&&a.y<r&&Tt(a.x,a.y,o,r,o,l)>n&&Tt(a.x,a.y,o,r,h,r)>n&&Tt(a.x,a.y,h,l,o,l)>n&&Tt(a.x,a.y,h,l,h,r)>n)return!1;if(o=Math.sqrt(n),!t){for(t=b.figures,b=0;b<t.count;b++){if(g=(o=t.j[b]).startX,c=o.startY,a.dd(g,c)>n)return!1;for(h=(r=o.segments.j).length,l=0;l<h;l++)switch(f=r[l],f.type){case ke:case Me:if(g=f.endX,c=f.endY,a.dd(g,c)>n)return!1;break;case Se:var p=I();if(ne.ze(g,c,f.point1X,f.point1Y,f.point2X,f.point2Y,f.endX,f.endY,.8,p),g=e(p,a),R(p),g)return!1;if(g=f.endX,c=f.endY,a.dd(g,c)>n)return!1;break;case Pe:if(p=I(),ne.Cq(g,c,f.point1X,f.point1Y,f.endX,f.endY,.8,p),g=e(p,a),R(p),g)return!1;if(g=f.endX,c=f.endY,a.dd(g,c)>n)return!1;break;case Ne:case Ce:var d=(p=f.type===Ne?be(f,o):we(f,o,g,c)).length;if(0===d){if(g=f.centerX,c=f.centerY,a.dd(g,c)>n)return!1;break}f=null;for(var q=I(),u=0;u<d;u++)if(f=p[u],q.length=0,ne.ze(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],.8,q),e(q,a))return R(q),!1;R(q),null!==f&&(g=f[6],c=f[7]);break;default:N("Unknown Segment type: "+f.type)}}return!0}if(null===this.fill?fe(b,a.x,a.y,o):ue(b,a,o,!0,!1))return!0}}return!1},n.cc=function(){this.ka=null},rl.makeGeometry=function(a,b,t){if("None"!==a.toArrow)var e=gl[a.toArrow];else"None"!==a.fromArrow?e=gl[a.fromArrow]:("string"==typeof(e=ne.Ke[a.figure])&&(e=ne.Ke[e]),void 0===e&&N("Unknown Shape.figure: "+a.figure),(e=e(a,b,t)).kl=b,e.jl=t);if(null===e){var n=ne.Ke.Rectangle;"function"==typeof n&&(e=n(a,b,t))}return e},v.Object.defineProperties(rl.prototype,{geometry:{get:function(){return null!==this.ka?this.ka:this.Rd},set:function(a){var b=this.ka;if(b!==a){this.Rd=this.ka=null!==a?a.freeze():null;var t=this.part;null!==t&&(t.gh=NaN),this.o(),this.g("geometry",b,a),fa(this)&&(null!==(a=this.part)&&ta(this,a,"geometryString"))}}},geometryString:{get:function(){return null===this.geometry?"":this.geometry.toString()},set:function(a){var b=(a=ae(a)).normalize();this.geometry=a,this.position=a=Mt.allocAt(-b.x,-b.y),Mt.free(a)}},isGeometryPositioned:{get:function(){return this.Zn},set:function(a){var b=this.Zn;b!==a&&(this.Zn=a,this.o(),this.g("isGeometryPositioned",b,a))}},fill:{get:function(){return this.$k},set:function(a){var b=this.$k;b!==a&&(null!==a&&_a(a,"Shape.fill"),a instanceof Ya&&a.freeze(),this.$k=a,this.M(),this.g("fill",b,a))}},stroke:{get:function(){return this.Dc},set:function(a){var b=this.Dc;b!==a&&(null!==a&&_a(a,"Shape.stroke"),a instanceof Ya&&a.freeze(),this.Dc=a,this.M(),this.g("stroke",b,a))}},strokeWidth:{get:function(){return this.th},set:function(a){var b=this.th;if(b!==a)if(0<=a){this.th=a,this.o();var t=this.part;null!==t&&(t.gh=NaN),this.g("strokeWidth",b,a)}else T(a,"value >= 0",rl,"strokeWidth:value")}},strokeCap:{get:function(){return this.Rl},set:function(a){var b=this.Rl;b!==a&&("string"!=typeof a||"butt"!==a&&"round"!==a&&"square"!==a?T(a,'"butt", "round", or "square"',rl,"strokeCap"):(this.Rl=a,this.M(),this.g("strokeCap",b,a)))}},strokeJoin:{get:function(){return this.Sl},set:function(a){var b=this.Sl;b!==a&&("string"!=typeof a||"miter"!==a&&"bevel"!==a&&"round"!==a?T(a,'"miter", "bevel", or "round"',rl,"strokeJoin"):(this.Sl=a,this.M(),this.g("strokeJoin",b,a)))}},strokeMiterLimit:{get:function(){return this.Oj},set:function(a){var b=this.Oj;if(b!==a&&1<=a){this.Oj=a,this.M();var t=this.part;null!==t&&(t.gh=NaN),this.g("strokeMiterLimit",b,a)}}},strokeDashArray:{get:function(){return this.rh},set:function(a){var b=this.rh;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];0<=o&&isFinite(o)||N("strokeDashArray:value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}this.rh=a,this.M(),this.g("strokeDashArray",b,a)}}},strokeDashOffset:{get:function(){return this.sh},set:function(a){var b=this.sh;b!==a&&0<=a&&(this.sh=a,this.M(),this.g("strokeDashOffset",b,a))}},figure:{get:function(){return this.Zk},set:function(a){var b=this.Zk;if(b!==a){var t=ne.Ke[a];"function"==typeof t?t=a:(t=ne.Ke[a.toLowerCase()])||N("Unknown Shape.figure: "+a),b!==t&&(null!==(a=this.part)&&(a.gh=NaN),this.Zk=t,this.Rd=null,this.cc(),this.o(),this.g("figure",b,t))}}},toArrow:{get:function(){return this.Yl},set:function(a){var b=this.Yl;if(!0===a?a="Standard":!1===a&&(a=""),b!==a){var t=pl(a);null===t?N("Unknown Shape.toArrow: "+a):b!==t&&(this.Yl=t,this.Rd=null,this.cc(),this.o(),fl(this),this.g("toArrow",b,t))}}},fromArrow:{get:function(){return this.al},set:function(a){var b=this.al;if(!0===a?a="Standard":!1===a&&(a=""),b!==a){var t=pl(a);null===t?N("Unknown Shape.fromArrow: "+a):b!==t&&(this.al=t,this.Rd=null,this.cc(),this.o(),fl(this),this.g("fromArrow",b,t))}}},spot1:{get:function(){return this.jf},set:function(a){var b=this.jf;b.w(a)||(this.jf=a=a.G(),this.o(),this.g("spot1",b,a))}},spot2:{get:function(){return this.kf},set:function(a){var b=this.kf;b.w(a)||(this.kf=a=a.G(),this.o(),this.g("spot2",b,a))}},parameter1:{get:function(){return this.Zo},set:function(a){var b=this.Zo;b!==a&&(this.Zo=a,this.cc(),this.o(),this.g("parameter1",b,a))}},parameter2:{get:function(){return this.$o},set:function(a){var b=this.$o;b!==a&&(this.$o=a,this.cc(),this.o(),this.g("parameter2",b,a))}},naturalBounds:{get:function(){if(null!==this.ka)return this.oc.assign(this.ka.bounds),this.oc;var a=this.desiredSize;return new Wt(0,0,a.width,a.height)}},pathPattern:{get:function(){return this.bp},set:function(a){var b=this.bp;b!==a&&(this.bp=a,this.M(),this.g("pathPattern",b,a))}},geometryStretch:{get:function(){return this.Nn},set:function(a){var b=this.Nn;b!==a&&(this.Nn=a,this.g("geometryStretch",b,a))}},interval:{get:function(){return this.Jd},set:function(a){var b=this.Jd;if(b!==(a=Math.round(a))&&0!==a&&isFinite(a)){this.Jd=a;var t=this.diagram;null!==t&&this.panel===t.grid&&Br(t),this.o(),null!==(t=this.panel)&&(t.$g=null),this.g("interval",b,a)}}},graduatedStart:{get:function(){return this.Gd},set:function(a){var b=this.Gd;b!==a&&(0>a?a=0:1<a&&(a=1),this.Gd=a,this.o(),this.g("graduatedStart",b,a))}},graduatedEnd:{get:function(){return this.Ed},set:function(a){var b=this.Ed;b!==a&&(0>a?a=0:1<a&&(a=1),this.Ed=a,this.o(),this.g("graduatedEnd",b,a))}},graduatedSkip:{get:function(){return this.Fd},set:function(a){var b=this.Fd;b!==a&&(this.Fd=a,this.o(),this.g("graduatedSkip",b,a))}}}),rl.prototype.intersectsRect=rl.prototype.Gc,rl.prototype.containedInRect=rl.prototype.Gh,rl.prototype.getNearestIntersectionPoint=rl.prototype.Uc,rl.prototype.getDocumentBounds=rl.prototype.lm,rl.prototype.getDocumentPoint=rl.prototype.ga;var gl=new et,yl=new et;function ml(){_s.call(this),Gl||(Yl=ys?new Ra(null).context:null,Gl=!0),this.ix=this.Tb="",this.Dc="black",this.ge="13px sans-serif",this.Ii="start",this.Dd=ns,this.Mi=Gi,this.xj=!0,this.pi=this.ri=!1,this.lg=Dl,this.wg=Al,this.$r=this.pb=this.Nc=0,this.Eu=this.Fu=null,this.Dn=!1,this.zc=this.en=this.Rp=this.Ji=this.Sp=null,this.hf=this.gf=0,this.oe=1/0,this.ti=0,this.he=null,this.ue=0,this.fe=this.fb=this.Qb=null,this.Jd=1,this.Gd=0,this.Ed=1,this.Fd=this.tj=null}function vl(a,b){a.F=6144|b.F,a.qb=b.opacity,a.gb=b.background,a.dc=b.areaBackground,a.Lc=b.desiredSize.G(),a.eg=b.minSize.G(),a.dg=b.maxSize.G(),a.bg=b.bg.copy(),a.ya=b.scale,a.Yb=b.angle,a.we=b.stretch,a.fh=b.margin.G(),a.vb=b.alignment.G(),a.Fk=b.alignmentFocus.G(),a.Hl=b.segmentFraction,a.Il=b.segmentOffset.G(),a.Jl=b.segmentOrientation,null!==b.md&&(a.md=b.md.copy()),a.Ll=b.shadowVisible,b instanceof ml&&(a.Tb=b.Tb,a.Dc=b.Dc,a.ge=b.ge,a.Ii=b.Ii,a.Dd=b.Dd,a.Mi=b.Mi,a.xj=b.xj,a.ri=b.ri,a.pi=b.pi,a.lg=b.lg,a.wg=b.wg,a.he=null,a.gf=b.gf,a.hf=b.hf,a.oe=b.oe,a.ti=b.ti,a.Jd=b.Jd,a.Gd=b.Gd,a.Ed=b.Ed,a.tj=b.tj,a.Fd=b.Fd)}function xl(a,b,t){null===a.fe?(a.fe=b,a.pb=t):(null!==a.fb&&null!==a.Qb||(a.fb=[],a.Qb=[],a.fb.push(a.fe),a.Qb.push(a.pb)),a.fb.push(b),a.Qb.push(t))}function bl(a,b,t,e){b=b.trim();var n=0,o=a.ge,g=a.gf+a.hf;g=Math.max(0,Ml(a)+g);var r=a.lg===Fl?Sl(o):0;if(a.Nc>=a.oe)null!==e&&e.h(0,g);else{var h=b;if(a.wg===Tl)if(a.ue=1,o=kl(b),0===r||o<=t)a.pb=Math.max(a.pb,o),xl(a,b,a.pb),null!==e&&e.h(o,g);else{for(o=kl((n=wl(a,h))+(b=wl(a,h=h.substr(n.length))));0<b.length&&o<=t;)o=kl(((n+=b)+(b=wl(a,h=h.substr(b.length)))).trim());for(n+=b.trim(),t=Math.max(1,t-r);kl(n)>t&&1<n.length;)n=n.substr(0,n.length-1);b=kl(n+=zl),a.pb=b,xl(a,n,b),null!==e&&e.h(b,g)}else{for(r=0,0===h.length&&(r=1,xl(a,h,0));0<h.length;){var l=wl(a,h);for(h=h.substr(l.length);kl(l)>t;){var c=1;for(o=kl(l.substr(0,c)),b=0;o<=t;)c++,b=o,o=kl(l.substr(0,c));if(1===c){var f=o;n=Math.max(n,o)}else f=b,n=Math.max(n,b);if(1>--c&&(c=1),xl(a,l.substr(0,c),f),r++,l=l.substr(c),a.Nc+r>a.oe)break}for(o=kl(l+(b=wl(a,h)));0<b.length&&o<=t;)o=kl(((l+=b)+(b=wl(a,h=h.substr(b.length)))).trim());if(""!==(l=l.trim())&&(""===l[l.length-1]&&(l=l.substring(0,l.length-1)+""),0===b.length?(c=o,n=Math.max(n,o)):(c=b=kl(l),n=Math.max(n,b)),xl(a,l,c),r++,a.Nc+r>a.oe))break}a.ue=Math.min(a.oe,r),a.pb=Math.max(a.pb,n),null!==e&&e.h(a.pb,g*a.ue)}}}function wl(a,b){if(a.wg===jl)return b.substr(0,1);a=b.length;for(var t=0,e=Ol;t<a&&!e.test(b.charAt(t));)t++;for(;t<a&&e.test(b.charAt(t));)t++;return t>=a?b:b.substr(0,t)}function kl(a){return null===Yl?8*a.length:Yl.measureText(a).width}function Ml(a){if(null!==a.he)return a.he;var b=a.ge;if(null===Yl){var t=16;return a.he=t}return void 0!==Bl[b]&&5e3>Il?t=Bl[b]:(t=1.3*Yl.measureText("M").width,Bl[b]=t,Il++),a.he=t}function Sl(a){if(null===Yl)return 6;if(void 0!==Rl[a]&&5e3>El)var b=Rl[a];else b=Yl.measureText(zl).width,Rl[a]=b,El++;return b}function Pl(a,b){var t=a.Tb.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e=a.gf+a.hf;if(e=Math.max(0,Ml(a)+e),0===t.length)return a.pb=0,a.Nc=1,e;if(!a.isMultiline){var n=t.indexOf("\n",0);0<=n&&(t=t.substr(0,n))}n=0;for(var g,o=a.Nc=0,r=!1;!r;){if(-1===(g=t.indexOf("\n",o))&&(g=t.length,r=!0),o<=g){if(o=t.substr(o,g-o),a.wg!==Tl){a.ue=0;var h=qt.alloc();bl(a,o,b,h),n+=h.height,qt.free(h),a.Nc+=a.ue}else bl(a,o,b,null),n+=e,a.Nc++;a.Nc===a.oe&&(r=!0)}o=g+1}return a.$r=n}rl.className="Shape",rl.getFigureGenerators=function(){var b,a=new kt;for(b in ne.Ke)b!==b.toLowerCase()&&a.add(b,ne.Ke[b]);return a.freeze(),a},rl.defineFigureGenerator=function(a,b){var t=a.toLowerCase(),e=ne.Ke;e[a]=b,e[t]=a},rl.getArrowheadGeometries=function(){var a=new kt;for(e in ne.Nm)if(void 0===gl[e]){var b=ae(ne.Nm[e],!1);gl[e]=b,(b=e.toLowerCase())!==e&&(gl[b]=e)}for(var t in gl)if(t!==t.toLowerCase()){var e=gl[t];e instanceof oe&&a.add(t,e)}return a.freeze(),a},rl.defineArrowheadGeometry=function(a,b){var t=null;t="string"==typeof b?ae(b,!1):b,"none"!==(b=a.toLowerCase())&&a!==b||N("Shape.defineArrowheadGeometry name must not be empty or None or all-lower-case: "+a);var e=gl;e[a]=t,e[b]=a},m(ml,_s),ml.prototype.cloneProtected=function(a){_s.prototype.cloneProtected.call(this,a),a.Tb=this.Tb,a.ix=this.ix,a.Dc=this.Dc,a.ge=this.ge,a.Ii=this.Ii,a.Dd=this.Dd,a.Mi=this.Mi,a.xj=this.xj,a.ri=this.ri,a.pi=this.pi,a.lg=this.lg,a.wg=this.wg,a.Nc=this.Nc,a.$r=this.$r,a.pb=this.pb,a.Fu=this.Fu,a.Eu=this.Eu,a.Dn=this.Dn,a.Sp=this.Sp,a.Ji=this.Ji,a.Rp=this.Rp,a.en=this.en,a.zc=this.zc,a.gf=this.gf,a.hf=this.hf,a.oe=this.oe,a.he=this.he,a.ue=this.ue,a.Qb=this.Qb,a.fb=this.fb,a.fe=this.fe,a.ti=this.ti,a.Jd=this.Jd,a.Gd=this.Gd,a.Ed=this.Ed,a.tj=this.tj,a.Fd=this.Fd},(n=ml.prototype).cb=function(a){a.classType===ml?this.wrap=a:_s.prototype.cb.call(this,a)},n.toString=function(){return 22<this.Tb.length?'TextBlock("'+this.Tb.substring(0,20)+'"...)':'TextBlock("'+this.Tb+'")'},n.o=function(){_s.prototype.o.call(this),this.Eu=this.Fu=null},n.Qi=function(a,b){if(null!==this.Dc&&0!==this.Tb.length&&null!==this.ge){var t=this.naturalBounds,e=this.actualBounds,n=t.width,o=t.height,g=Ml(this),r=a.textAlign=this.Ii,h=b.nl;"start"===r?r=h?"right":"left":"end"===r&&(r=h?"left":"right"),h=this.ri;var l=this.pi;oa(this,a,this.Dc,!0,!1,t,e),(h||l)&&oa(this,a,this.Dc,!1,!1,t,e),e=0,t=!1;var c=Mt.allocAt(0,0);this.vd.ra(c);var f=Mt.allocAt(0,g);this.vd.ra(f);var p=c.Be(f);switch(Mt.free(c),Mt.free(f),8>p*(c=b.scale)*c&&(t=!0),b.Db!==a&&(t=!1),!1===b.Ce("textGreeking")&&(t=!1),b=this.gf,p=this.hf,this.flip){case us:a.translate(n,0),a.scale(-1,1);break;case ls:a.translate(0,o),a.scale(1,-1);break;case cs:a.translate(n,o),a.scale(-1,-1)}if(o>(f=(b+g+p)*(c=this.Nc))&&(e=(e=this.Mi).y*o-e.y*f+e.offsetY),1===c&&null!==this.fe)(p=this.pb)>n&&(p=n),this.Pi(this.fe,a,0,e+b,n,g,p,t,r,h,l);else if(null!==this.Qb&&null!==this.fb)for(f=0;f<c;f++){var d=this.Qb[f];d>n&&(d=n),e+=b,this.Pi(this.fb[f],a,0,e,n,g,d,t,r,h,l),e+=g+p}switch(this.flip){case us:a.scale(-1,1),a.translate(-n,0);break;case ls:a.scale(1,-1),a.translate(0,-o);break;case cs:a.scale(-1,-1),a.translate(-n,-o)}}},n.Pi=function(a,b,t,e,n,o,g,r,h,l,c){var f=0;r?("left"===h?f=0:"right"===h?f=n-g:"center"===h&&(f=(n-g)/2),b.fillRect(t+f,e+.25*o,g,1)):("left"===h?f=0:"right"===h?f=n:"center"===h&&(f=n/2),n=null!==Nl?Nl(this,o):.75*o,b.fillText(a,t+f,e+n),0===(a=o/20|0)&&(a=1),"right"===h?f-=g:"center"===h&&(f-=g/2),l&&(h=null!==Cl?Cl(this,o):.8*o,b.beginPath(),b.lineWidth=a,b.moveTo(t+f,e+h),b.lineTo(t+f+g,e+h),b.stroke()),c&&(b.beginPath(),b.lineWidth=a,e=e+o-o/2.2|0,0!=a%2&&(e+=.5),b.moveTo(t+f,e),b.lineTo(t+f+g,e),b.stroke()))},n.sm=function(a,b,t,e){this.ti=a;var n,o=this.ge;if(null!==Yl&&Vl!==o&&(Vl=Yl.font=o),this.pb=this.ue=0,this.fe=this.fb=this.Qb=this.he=null,isNaN(this.desiredSize.width)){if(0===(o=this.Tb.replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length)o=0;else if(this.isMultiline){for(var g=n=0,r=!1;!r;){var h=o.indexOf("\n",g);-1===h&&(h=o.length,r=!0),n=Math.max(n,kl(o.substr(g,h-g).trim())),g=h+1}o=n}else 0<=(n=o.indexOf("\n",0))&&(o=o.substr(0,n)),o=kl(o);o=Math.min(o,a/this.scale),o=Math.max(8,o)}else o=this.desiredSize.width;if(null!==this.panel&&(o=Math.min(o,this.panel.maxSize.width)),n=Pl(this,o),g=n=isNaN(this.desiredSize.height)?Math.min(n,b/this.scale):this.desiredSize.height,0!==this.pb&&null!==this.Qb&&null!==this.fb&&this.lg===Fl&&(b=this.ge,b=this.lg===Fl?Sl(b):0,r=this.gf+this.hf,r=Math.max(0,Ml(this)+r),!((g=Math.min(this.maxLines-1,Math.max(Math.floor(g/r+.01)-1,0)))+1>=this.fb.length))){for(r=this.fb[g],b=Math.max(1,a-b);kl(r)>b&&1<r.length;)r=r.substr(0,r.length-1);b=kl(r+=zl),this.fb[g]=r,this.fb=this.fb.slice(0,g+1),this.Qb[g]=b,this.Qb=this.Qb.slice(0,g+1),this.ue=this.fb.length,this.pb=Math.max(this.pb,b),this.Nc=this.ue,1===this.Nc&&(this.fe=this.fb[0])}(this.wrap===Ll||isNaN(this.desiredSize.width))&&(o=isNaN(a)?this.pb:Math.min(a,this.pb),isNaN(this.desiredSize.width)&&(o=Math.max(8,o))),o=Math.max(t,o),n=Math.max(e,n),Jt(this.oc,o,n),ia(this,0,0,o,n)},n.Fh=function(a,b,t,e){ol(this,a,b,t,e)},v.Object.defineProperties(ml.prototype,{font:{get:function(){return this.ge},set:function(a){var b=this.ge;b!==a&&(this.ge=a,this.he=null,this.o(),this.g("font",b,a))}},text:{get:function(){return this.Tb},set:function(a){var b=this.Tb;b!==(a=null!=a?a.toString():"")&&(this.Tb=a,this.o(),this.g("text",b,a))}},textAlign:{get:function(){return this.Ii},set:function(a){var b=this.Ii;b===a||"start"!==a&&"end"!==a&&"left"!==a&&"right"!==a&&"center"!==a||(this.Ii=a,this.M(),this.g("textAlign",b,a))}},flip:{get:function(){return this.Dd},set:function(a){var b=this.Dd;b!==a&&(this.Dd=a,this.M(),this.g("flip",b,a))}},verticalAlignment:{get:function(){return this.Mi},set:function(a){var b=this.Mi;b.w(a)||(this.Mi=a=a.G(),aa(this),this.g("verticalAlignment",b,a))}},naturalBounds:{get:function(){if(!this.oc.u()){var a=qt.alloc();bl(this,this.Tb,999999,a);var b=a.width;qt.free(a),a=Pl(this,b);var t=this.desiredSize;isNaN(t.width)||(b=t.width),isNaN(t.height)||(a=t.height),Jt(this.oc,b,a)}return this.oc}},isMultiline:{get:function(){return this.xj},set:function(a){var b=this.xj;b!==a&&(this.xj=a,this.o(),this.g("isMultiline",b,a))}},isUnderline:{get:function(){return this.ri},set:function(a){var b=this.ri;b!==a&&(this.ri=a,this.M(),this.g("isUnderline",b,a))}},isStrikethrough:{get:function(){return this.pi},set:function(a){var b=this.pi;b!==a&&(this.pi=a,this.M(),this.g("isStrikethrough",b,a))}},wrap:{get:function(){return this.wg},set:function(a){var b=this.wg;b!==a&&(this.wg=a,this.o(),this.g("wrap",b,a))}},overflow:{get:function(){return this.lg},set:function(a){var b=this.lg;b!==a&&(this.lg=a,this.o(),this.g("overflow",b,a))}},stroke:{get:function(){return this.Dc},set:function(a){var b=this.Dc;b!==a&&(null!==a&&_a(a,"TextBlock.stroke"),a instanceof Ya&&a.freeze(),this.Dc=a,this.M(),this.g("stroke",b,a))}},lineCount:{get:function(){return this.Nc}},editable:{get:function(){return this.Dn},set:function(a){var b=this.Dn;b!==a&&(this.Dn=a,this.g("editable",b,a))}},textEditor:{get:function(){return this.Sp},set:function(a){var b=this.Sp;b!==a&&(this.Sp=a,this.g("textEditor",b,a))}},errorFunction:{get:function(){return this.zc},set:function(a){var b=this.zc;b!==a&&(this.zc=a,this.g("errorFunction",b,a))}},interval:{get:function(){return this.Jd},set:function(a){var b=this.Jd;if(b!==(a=Math.round(a))&&0!==a&&isFinite(a)){this.Jd=a,this.o();var t=this.panel;null!==t&&(t.$g=null),this.g("interval",b,a)}}},graduatedStart:{get:function(){return this.Gd},set:function(a){var b=this.Gd;b!==a&&(0>a?a=0:1<a&&(a=1),this.Gd=a,this.o(),this.g("graduatedStart",b,a))}},graduatedEnd:{get:function(){return this.Ed},set:function(a){var b=this.Ed;b!==a&&(0>a?a=0:1<a&&(a=1),this.Ed=a,this.o(),this.g("graduatedEnd",b,a))}},graduatedFunction:{get:function(){return this.tj},set:function(a){var b=this.tj;b!==a&&(this.tj=a,this.o(),this.g("graduatedFunction",b,a))}},graduatedSkip:{get:function(){return this.Fd},set:function(a){var b=this.Fd;b!==a&&(this.Fd=a,this.o(),this.g("graduatedSkip",b,a))}},textValidation:{get:function(){return this.Ji},set:function(a){var b=this.Ji;b!==a&&(this.Ji=a,this.g("textValidation",b,a))}},textEdited:{get:function(){return this.Rp},set:function(a){var b=this.Rp;b!==a&&(this.Rp=a,this.g("textEdited",b,a))}},spacingAbove:{get:function(){return this.gf},set:function(a){var b=this.gf;b!==a&&(this.gf=a,this.g("spacingAbove",b,a))}},spacingBelow:{get:function(){return this.hf},set:function(a){var b=this.hf;b!==a&&(this.hf=a,this.g("spacingBelow",b,a))}},maxLines:{get:function(){return this.oe},set:function(a){var b=this.oe;b!==a&&(0>=(a=Math.floor(a))&&T(a,"> 0",ml,"maxLines"),this.oe=a,this.g("maxLines",b,a),this.o())}},metrics:{get:function(){return{arrSize:null!==this.Qb?this.Qb:[this.pb],arrText:null!==this.fb?this.fb:[this.fe],maxLineWidth:this.pb,fontHeight:this.he}}},choices:{get:function(){return this.en},set:function(a){var b=this.en;b!==a&&(this.en=a,this.g("choices",b,a))}}});var Nl=null,Cl=null,Tl=new _(ml,"None",0),Ll=new _(ml,"WrapFit",1),Al=new _(ml,"WrapDesiredSize",2),jl=new _(ml,"WrapBreakAll",3),Dl=new _(ml,"OverflowClip",0),Fl=new _(ml,"OverflowEllipsis",1),Ol=/[ \u200b\u00ad]/,Bl=new et,Il=0,Rl=new et,El=0,zl="...",Vl="",Yl=null,Gl=!1;function Xl(){this.Qb=[],this.fb=[]}function ql(){_s.call(this),this.Vg=null,this.Jp="",this.qh=si,this.fl=es,this.lf=this.zc=null,this.el=xi,this.Dd=ns,this.Ul=null,this.uu=!1,this.Er=!0,this.vl=!1,this.Nl=null}function Ul(a){void 0===a&&(a=""),""!==a?Wl[a]&&(delete Wl[a],Jl--):(Wl=new et,Jl=0)}function Kl(a,b){a.Pr=!0,a.bl=!1;for(var t,e=G(),n=e.length,o=0;o<n;o++){var g=e[o];t=a.getAttribute("src");var r=g.Ci.H(t);if(null!==r)for(var h=r.length,l=0;l<h;l++)t=r[l],g.ss.add(t),g.Pb(),void 0===a.Pu&&(a.Pu=b,null!==t.lf&&t.lf(t,b))}}function Hl(a,b){a.bl=b;for(var t,e=G(),n=e.length,o=0;o<n;o++){var g=e[o],r=a.getAttribute("src");if(null!==(t=g.Ci.H(r))){g=t.length,r=I();for(var h=0;h<g;h++)r.push(t[h]);for(h=0;h<g;h++)null!==(t=r[h]).zc&&t.zc(t,b);R(r)}}}ml.className="TextBlock",ml.getEllipsis=function(){return zl},ml.setEllipsis=function(a){zl=a,Rl=new et,El=0},ml.getBaseline=function(){return Nl},ml.setBaseline=function(a){Nl=a;for(var b=(a=G()).length,t=0;t<b;t++)a[t].Fe()},ml.getUnderline=function(){return Cl},ml.setUnderline=function(a){Cl=a;for(var b=(a=G()).length,t=0;t<b;t++)a[t].Fe()},ml.isValidFont=function(a){if(Gl||(Yl=ys?new Ra(null).context:null,Gl=!0),null===Yl)return!0;var b=Yl.font;if(a===b||"10px sans-serif"===a)return!0;Yl.font="10px sans-serif",Yl.font=a;var t=Yl.font;if("10px sans-serif"!==t)return Yl.font=b,!0;Yl.font="19px serif";var e=Yl.font;return Yl.font=a,t=Yl.font,Yl.font=b,t!==e},ml.None=Tl,ml.WrapFit=Ll,ml.WrapDesiredSize=Al,ml.WrapBreakAll=jl,ml.OverflowClip=Dl,ml.OverflowEllipsis=Fl,Xl.prototype.reset=function(){this.Qb=[],this.fb=[]},Xl.prototype.et=function(a){this.Qb=F(a.Qb),this.fb=F(a.fb)},Xl.className="TextBlockMetrics",m(ql,_s),ql.prototype.cloneProtected=function(a){_s.prototype.cloneProtected.call(this,a),a.element=this.Vg,a.Jp=this.Jp,a.qh=this.qh.G(),a.fl=this.fl,a.Dd=this.Dd,a.zc=this.zc,a.lf=this.lf,a.el=this.el.G(),a.Er=this.Er,a.Nl=this.Nl},(n=ql.prototype).cb=function(a){a===ns||a===os||a===hs?this.imageStretch=a:_s.prototype.cb.call(this,a)},n.toString=function(){return"Picture("+this.source+")#"+gt(this)},n.Fe=function(){this.M()},n.Qi=function(a,b){var t=this.Vg;if(null!==t){var e=t.getAttribute("src");if(t instanceof HTMLImageElement&&(null===e||""===e)&&N('Element has no source ("src") attribute: '+t),!(t.bl instanceof Event)){e=this.naturalBounds;var n=0,o=0,g=this.uu,r=g?+t.width:t.naturalWidth;if(g=g?+t.height:t.naturalHeight,void 0===r&&t.videoWidth&&(r=t.videoWidth),void 0===g&&t.videoHeight&&(g=t.videoHeight),r=r||e.width,g=g||e.height,0!==r&&0!==g){var h=r,l=g;this.sourceRect.u()&&(n=this.qh.x,o=this.qh.y,r=this.qh.width,g=this.qh.height);var c=r,f=g,p=this.fl,d=this.el;switch(p){case ns:if(this.sourceRect.u())break;c>=e.width&&(n=n+d.offsetX+(c*d.x-e.width*d.x)),f>=e.height&&(o=o+d.offsetY+(f*d.y-e.height*d.y)),r=Math.min(e.width,c),g=Math.min(e.height,f);break;case es:c=e.width,f=e.height;break;case os:case hs:p===os?(c*=p=Math.min(e.height/f,e.width/c),f*=p):p===hs&&(f*=p=Math.max(e.height/f,e.width/c),(c*=p)>=e.width&&(n=(n+d.offsetX+(c*d.x-e.width*d.x)/c)*r),f>=e.height&&(o=(o+d.offsetY+(f*d.y-e.height*d.y)/f)*g),r*=1/(c/e.width),g*=1/(f/e.height),c=e.width,f=e.height)}var q=c*(p=this.vf()*b.scale)*f*p,u=r*g/q,y=t.__goCache;p=null;var m=Zl;if(t.Pr&&void 0!==y&&4<q&&u>m*m)for(null===y.Oi&&(Ql(y,4,h,l,t),Ql(y,16,h,l,t)),l=(h=y.Oi).length,q=0;q<l&&h[q].ratio*h[q].ratio<u;q++)p=h[q];if(!b.Xk){if(null===this.Ul)if(null===this.Vg)this.Ul=!1;else{(h=new Ra(null).context).drawImage(this.Vg,0,0);try{h.getImageData(0,0,1,1).data[3]&&(this.Ul=!1),this.Ul=!1}catch(t){this.Ul=!0}}if(this.Ul)return}switch(h=0,c<e.width&&(h=d.offsetX+(e.width*d.x-c*d.x)),l=0,f<e.height&&(l=d.offsetY+(e.height*d.y-f*d.y)),this.flip){case us:a.translate(Math.min(e.width,c),0),a.scale(-1,1);break;case ls:a.translate(0,Math.min(e.height,f)),a.scale(1,-1);break;case cs:a.translate(Math.min(e.width,c),Math.min(e.height,f)),a.scale(-1,-1)}if(b.Ce("pictureRatioOptimization")&&!b.ni&&void 0!==y&&null!==p&&1!==p.ratio){a.save(),b=p.ratio;try{a.drawImage(p.source,n/b,o/b,Math.min(p.source.width,r/b),Math.min(p.source.height,g/b),h,l,Math.min(e.width,c),Math.min(e.height,f))}catch(t){this.Er=!1}a.restore()}else try{a.drawImage(t,n,o,r,g,h,l,Math.min(e.width,c),Math.min(e.height,f))}catch(t){this.Er=!1}switch(this.flip){case us:a.scale(-1,1),a.translate(-Math.min(e.width,c),0);break;case ls:a.scale(1,-1),a.translate(0,-Math.min(e.height,f));break;case cs:a.scale(-1,-1),a.translate(-Math.min(e.width,c),-Math.min(e.height,f))}}}}},n.sm=function(a,b,t,e){var n=this.desiredSize,o=ha(this,!0),g=this.Vg,r=this.uu;(r||!this.vl&&g&&g.complete)&&(this.vl=!0),null===g&&(isFinite(n.width)||(a=0),isFinite(n.height)||(b=0)),isFinite(n.width)||o===es||o===ss?(isFinite(a)||(a=this.sourceRect.u()?this.sourceRect.width:r?+g.width:g.naturalWidth),t=0):null!==g&&!1!==this.vl&&(a=this.sourceRect.u()?this.sourceRect.width:r?+g.width:g.naturalWidth),isFinite(n.height)||o===es||o===as?(isFinite(b)||(b=this.sourceRect.u()?this.sourceRect.height:r?+g.height:g.naturalHeight),e=0):null!==g&&!1!==this.vl&&(b=this.sourceRect.u()?this.sourceRect.height:r?+g.height:g.naturalHeight),isFinite(n.width)&&(a=n.width),isFinite(n.height)&&(b=n.height),n=this.maxSize,o=this.minSize,t=Math.max(t,o.width),e=Math.max(e,o.height),a=Math.min(n.width,a),b=Math.min(n.height,b),a=Math.max(t,a),b=Math.max(e,b),null===g||g.complete||(isFinite(a)||(a=0),isFinite(b)||(b=0)),Jt(this.oc,a,b),ia(this,0,0,a,b)},n.Fh=function(a,b,t,e){ol(this,a,b,t,e)},v.Object.defineProperties(ql.prototype,{element:{get:function(){return this.Vg},set:function(a){var b=this.Vg;if(b!==a){if(null===a||a instanceof HTMLImageElement||a instanceof HTMLVideoElement||a instanceof HTMLCanvasElement||N("Picture.element must be an instance of Image, Canvas, or Video, not: "+a),this.uu=a instanceof HTMLCanvasElement,this.Vg=a,null!==a)if(a instanceof HTMLCanvasElement||!0===a.complete)a.bl instanceof Event&&null!==this.zc&&this.zc(this,a.bl),!0===a.Pr&&null!==this.lf&&this.lf(this,a.Pu),a.Pr=!0,this.desiredSize.u()||(ma(this,!1),this.o());else{var t=this;a.Vw||(a.addEventListener("load",(function(b){Kl(a,b),t.desiredSize.u()||(ma(t,!1),t.o())})),a.addEventListener("error",(function(b){Hl(a,b)})),a.Vw=!0)}this.g("element",b,a),this.M()}}},source:{get:function(){return this.Jp},set:function(a){var b=this.Jp;if(b!==a){this.Jp=a;var t=Wl,e=this.diagram,n=null;if(void 0!==t[a])n=t[a];else{30<Jl&&(Ul(),t=Wl),n=P("img");var o=this;n.addEventListener("load",(function(a){Kl(n,a),o.desiredSize.u()||(ma(o,!1),o.o())})),n.addEventListener("error",(function(a){Hl(n,a)})),n.Vw=!0;var g=this.Nl;null!==g&&(n.crossOrigin=g(this)),n.src=a,t[a]=n,Jl++}null!==e&&zr(e,this),this.element=n,null!==e&&Er(e,this),void 0===n.__goCache&&(n.__goCache=new $l),this.o(),this.M(),this.g("source",b,a)}}},sourceCrossOrigin:{get:function(){return this.Nl},set:function(a){if(this.Nl!==a&&(this.Nl=a,null!==this.element)){var b=this.element.getAttribute("src");null===a&&"string"==typeof b?this.element.crossOrigin=null:null!==a&&(this.element.crossOrigin=a(this)),this.element.src=b}}},sourceRect:{get:function(){return this.qh},set:function(a){var b=this.qh;b.w(a)||(this.qh=a=a.G(),this.M(),this.g("sourceRect",b,a))}},imageStretch:{get:function(){return this.fl},set:function(a){var b=this.fl;b!==a&&(this.fl=a,this.M(),this.g("imageStretch",b,a))}},flip:{get:function(){return this.Dd},set:function(a){var b=this.Dd;b!==a&&(this.Dd=a,this.M(),this.g("flip",b,a))}},imageAlignment:{get:function(){return this.el},set:function(a){var b=this.el;b.w(a)||(this.el=a=a.G(),this.o(),this.g("imageAlignment",b,a))}},errorFunction:{get:function(){return this.zc},set:function(a){var b=this.zc;b!==a&&(this.zc=a,this.g("errorFunction",b,a))}},successFunction:{get:function(){return this.lf},set:function(a){var b=this.lf;b!==a&&(this.lf=a,this.g("successFunction",b,a))}},naturalBounds:{get:function(){return this.oc}}});var Wl=null,Jl=0,Zl=4;function $l(){this.Oi=null}function Ql(a,b,t,e,n){null===a.Oi&&(a.Oi=[]);var o=new Ra(null),g=o.context,r=1/b;o.width=t/b,o.height=e/b,0!==o.width&&0!==o.height&&(b=new _l(o.Ea,b),t=1,0<a.Oi.length&&(n=(t=a.Oi[a.Oi.length-1]).source,t=t.ratio),g.setTransform(r*t,0,0,r*t,0,0),g.drawImage(n,0,0),a.Oi.push(b))}function _l(a,b){this.source=a,this.ratio=b}function tu(){this.mt=new oe,this.fc=null}function iu(a,b,t,e,n){a.fc=new ve,a.fc.startX=b,a.fc.startY=t,a.fc.isFilled=e,a.mt.figures.add(a.fc),void 0!==n&&(a.fc.isShadowed=n)}function eu(a){var b=a.fc.segments.length;0<b&&a.fc.segments.L(b-1).close()}function nu(a,b,t,e,n,o,g){var r;void 0===r&&(r=!1);var h=new xe(Se);h.point1X=b,h.point1Y=t,h.point2X=e,h.point2Y=n,h.endX=o,h.endY=g,r&&h.close(),a.fc.segments.add(h)}function ou(a,b,t,e,n){var o;void 0===o&&(o=!1);var g=new xe(Pe);g.point1X=b,g.point1Y=t,g.endX=e,g.endY=n,o&&g.close(),a.fc.segments.add(g)}function ru(a,b,t,e,n,o,g,r){var h;void 0===h&&(h=!1),b=new xe(Ce,g,r,b,t,e,n,o),h&&b.close(),a.fc.segments.add(b)}function su(a){var b=au;return null!==b?(au=null,b.reset(a),b):((b=new tu).reset(a),b)}ql.className="Picture",Wl=new et,ql.clearCache=Ul,$l.className="PictureCacheArray",_l.className="PictureCacheInstance",(n=tu.prototype).reset=function(a){null!==a?(a.ea(),this.mt=a,a.figures.clear()):this.mt=new oe,this.fc=null},n.Lq=function(a){this.fc.isShadowed=a},n.moveTo=function(a,b,t){void 0===t&&(t=!1);var e=new xe(ke);e.endX=a,e.endY=b,t&&e.close(),this.fc.segments.add(e)},n.lineTo=function(a,b,t){void 0===t&&(t=!1);var e=new xe(Me);e.endX=a,e.endY=b,t&&e.close(),this.fc.segments.add(e)},n.arcTo=function(a,b,t,e,n,o,g){void 0===o&&(o=0),void 0===g&&(g=!1);var r=new xe(Ne);r.startAngle=a,r.sweepAngle=b,r.centerX=t,r.centerY=e,r.radiusX=n,r.radiusY=0!==o?o:n,g&&r.close(),this.fc.segments.add(r)};var au=null;function hu(a,b){var t=a.toLowerCase(),e=ne.Ke;e[a]=b,e[t]=a}function lu(a){jh.call(this,a),this.D=2408959,this.eh=this.Lf="",this.mp=this.ip=this.yp=this.mo=null,this.Ap="",this.Hf=this.Wn=this.zp=this.ph=null,this.kp="",this.jp=Gt,this.Tb=this.np="",this.ui=this.hn=this.di=null,this.cg=new Mt(NaN,NaN).freeze(),this.to="",this.Ye=null,this.uo=gi,this.op=zi,this.Do=Dt,this.vo=Ft,this.An=null,this.no=127,this.Ep=Ot,this.Dp="gray",this.ef=4,this.Xw=-1,this.aq=NaN,this.yy=new Wt,this.Fj=null,this.gh=NaN}function uu(a){0!=(16384&a.D)!=!1&&(a.updateAdornments(),bu(a,!1))}function cu(a){if(!1===wu(a)){ku(a,!0),a.ml();var b=a.diagram;null!==b&&(b.od.add(a),b.Pb())}}function fu(a){if(a.D|=2097152,!1!==wu(a)){var b=a.position,t=a.location;t.u()&&b.u()||gu(a,b,t),t=a.ub;var e=Wt.alloc().assign(t);t.ea(),t.x=b.x,t.y=b.y,t.freeze(),a.Et(e,t),Wt.free(e),ku(a,!1)}}function du(a,b){var t=a.yy;isNaN(a.gh)&&(a.gh=function t(a){for(var b=(a=a.W.j).length,e=0,n=0;n<b;n++){var o=a[n];if(o instanceof jh)e=Math.max(e,t(o));else if(o instanceof rl){t:{switch(o.Zk){case"None":case"Square":case"Ellipse":case"Circle":case"LineH":case"LineV":case"FramedRectangle":case"RoundedRectangle":case"Line1":case"Line2":case"Border":case"Cube1":case"Cube2":case"Junction":case"Cylinder1":case"Cylinder2":case"Cylinder3":case"Cylinder4":case"PlusLine":case"XLine":case"ThinCross":case"ThickCross":o=0;break t}o=o.th/2*o.Oj*o.vf()}e=Math.max(e,o)}}return e}(a));var e=a.gh,n=2*e;if(!a.isShadowed)return t.h(b.x-1-e,b.y-1-e,b.width+2+n,b.height+2+n),t;e=b.x,n=b.y;var o=b.width;b=b.height;var g=a.shadowBlur;return o+=g,b+=g,e-=g/2,n-=g/2,0<(a=a.shadowOffset).x?o+=a.x:(e+=a.x,o-=a.x),0<a.y?b+=a.y:(n+=a.y,b-=a.y),t.h(e-1,n-1,o+2,b+2),t}function pu(a,b,t,e){null===b||a instanceof Lu||(b=b.animationManager).$e&&po(b,a,e.copy(),t.copy())}function gu(a,b,t){var e=Mt.alloc(),n=a.locationSpot,o=a.locationObject;n.jc()&&N("determineOffset: Part's locationSpot must be real: "+n.toString());var g=o.naturalBounds,r=o instanceof rl?o.strokeWidth:0;if(e.xk(0,0,g.width+r,g.height+r,n),o!==a)for(e.offset(-r/2,-r/2),o.transform.ra(e),n=o.panel;null!==n&&n!==a;)n.transform.ra(e),n=n.panel;a.bg.ra(e),e.offset(-a.nc.x,-a.nc.y),n=a.diagram,o=t.u(),g=b.u(),o&&g?0!=(2097152&a.D)?yu(a,b,t,n,e):mu(a,b,t,n,e):o?yu(a,b,t,n,e):g&&mu(a,b,t,n,e),a.D|=2097152,Mt.free(e),a.ml()}function yu(a,b,t,e,n){var o=b.x,g=b.y;b.h(t.x-n.x,t.y-n.y),null!==e&&((n=(t=e.animationManager).isAnimating)||!t.$e||a instanceof Lu||po(t,a,new Mt(o,g),b),n||b.x===o&&b.y===g||(t=e.skipsUndoManager,e.skipsUndoManager=!0,a.g("position",new Mt(o,g),b),e.skipsUndoManager=t))}function mu(a,b,t,e,n){var o=t.copy();t.h(b.x+n.x,b.y+n.y),t.w(o)||null===e||(b=e.skipsUndoManager,e.skipsUndoManager=!0,a.g("location",o,t.copy()),e.skipsUndoManager=b)}function vu(a,b,t){Mu(a,!1),a instanceof Au&&Qr(t,a),a.layer.isTemporary||b||t.Na(),b=a.ub;var e=t.viewportBounds;e.u()?Su(a)?(ii(b,e)||a.zd(!1),a.updateAdornments()):b.Gc(e)?(a.zd(!0),a.updateAdornments()):a.Lb():t.mi=!0}function xu(a,b,t,e){b.constructor===a.constructor||Tu||(Tu=!0,L('Should not change the class of the Part when changing category from "'+t+'" to "'+e+'"'),L("  Old class: "+E(a.constructor)+", new class: "+E(b.constructor)+", part: "+a.toString())),a.Yj();var n=a.data;t=a.layerName;var o=a.isSelected,g=a.isHighlighted,r=!0,h=!0,l=!1;a instanceof Au&&(r=a.isTreeLeaf,h=a.isTreeExpanded,l=a.wasTreeExpanded),b.tf(a),b.cloneProtected(a),a.Lf=e,a.o(),a.M(),e=!0,null!==(b=a.diagram)&&(e=b.skipsUndoManager,b.skipsUndoManager=!0),a.hb=n,a.D=o?4096|a.D:-4097&a.D,a.D=g?524288|a.D:-524289&a.D,a instanceof Au&&(a.P=r?4|a.P:-5&a.P,a.P=h?1|a.P:-2&a.P,a.P=l?2|a.P:-3&a.P),null!==n&&a.Ba(),(n=a.layerName)!==t&&(a.eh=t,a.layerName=n),null!==b&&(b.skipsUndoManager=e),a.Wb()&&a.C(64)}function bu(a,b){a.D=b?16384|a.D:-16385&a.D}function wu(a){return 0!=(32768&a.D)}function ku(a,b){a.D=b?32768|a.D:-32769&a.D}function Mu(a,b){a.D=b?65536|a.D:-65537&a.D}function Su(a){return 0!=(131072&a.D)}function Pu(a,b){a.D=b?1048576|a.D:-1048577&a.D}function Nu(a){return!!a.isVisible()&&(null===(a=a.layer)||!a.isTemporary)}function Cu(a,b,t,e,n,o){if(void 0===o&&(o=null),!(a.contains(b)||null!==o&&!o(b)||b instanceof Lu))if(a.add(b),b instanceof Au){if(t&&b instanceof qu)for(var g=b.memberParts;g.next();)Cu(a,g.value,t,e,n,o);if(!1!==n)for(g=b.linksConnected;g.next();){var r=g.value;if(!a.contains(r)){var h=r.fromNode,l=r.toNode;h=null===h||a.contains(h),l=null===l||a.contains(l),(n?h&&l:h||l)&&Cu(a,r,t,e,n,o)}}if(1<e)for(b=b.wv();b.next();)Cu(a,b.value,t,e-1,n,o)}else if(b instanceof Wu)for(b=b.labelNodes;b.next();)Cu(a,b.value,t,e,n,o)}tu.className="StreamGeometryContext",hu("Rectangle",(function(a,b,t){a=50>ne.Gf;var e="r"+b+","+t,n=ne.Ff[e];return void 0!==n||((n=new oe(ye)).endX=b,n.endY=t,a&&(ne.Ff[e]=n,ne.Gf++)),n})),hu("Square",(function(a,b,t){a=50>ne.Gf;var e="s"+b+","+t,n=ne.Ff[e];return void 0!==n||((n=new oe(ye)).endX=b,n.endY=t,n.defaultStretch=os,a&&(ne.Ff[e]=n,ne.Gf++)),n})),hu("RoundedRectangle",(function(a,b,t){var e=50>ne.Gf,n="rr"+b+","+t,o=ne.Ff[n];return void 0===o&&(o=a?a.parameter1:NaN,(isNaN(o)||0>=o)&&(o=5),o=Math.min(o,b/3),a=(o=Math.min(o,t/3))*ne.Ig,o=(new oe).add(new ve(o,0,!0).add(new xe(Me,b-o,0)).add(new xe(Se,b,o,b-a,0,b,a)).add(new xe(Me,b,t-o)).add(new xe(Se,b-o,t,b,t-a,b-a,t)).add(new xe(Me,o,t)).add(new xe(Se,0,t-o,a,t,0,t-a)).add(new xe(Me,0,o)).add(new xe(Se,o,0,0,a,a,0).close())),1<a&&(o.spot1=new Zi(0,0,a,a),o.spot2=new Zi(1,1,-a,-a)),e&&(ne.Ff[n]=o,ne.Gf++)),o})),hu("Border","RoundedRectangle"),hu("Ellipse",(function(a,b,t){a=50>ne.Gf;var e="e"+b+","+t,n=ne.Ff[e];return void 0!==n||((n=new oe(me)).endX=b,n.endY=t,n.spot1=Hi,n.spot2=Wi,a&&(ne.Ff[e]=n,ne.Gf++)),n})),hu("Circle",(function(a,b,t){a=50>ne.Gf;var e="c"+b+","+t,n=ne.Ff[e];return void 0!==n||((n=new oe(me)).endX=b,n.endY=t,n.spot1=Hi,n.spot2=Wi,n.defaultStretch=os,a&&(ne.Ff[e]=n,ne.Gf++)),n})),hu("TriangleRight",(function(a,b,t){return(new oe).add(new ve(0,0).add(new xe(Me,b,.5*t)).add(new xe(Me,0,t).close())).Jm(0,.25,.5,.75)})),hu("TriangleDown",(function(a,b,t){return(new oe).add(new ve(0,0).add(new xe(Me,b,0)).add(new xe(Me,.5*b,t).close())).Jm(.25,0,.75,.5)})),hu("TriangleLeft",(function(a,b,t){return(new oe).add(new ve(b,t).add(new xe(Me,0,.5*t)).add(new xe(Me,b,0).close())).Jm(.5,.25,1,.75)})),hu("TriangleUp",(function(a,b,t){return(new oe).add(new ve(b,t).add(new xe(Me,0,t)).add(new xe(Me,.5*b,0).close())).Jm(.25,.5,.75,1)})),hu("Triangle","TriangleUp"),hu("Diamond",(function(a,b,t){return(new oe).add(new ve(.5*b,0).add(new xe(Me,0,.5*t)).add(new xe(Me,.5*b,t)).add(new xe(Me,b,.5*t).close())).Jm(.25,.25,.75,.75)})),hu("LineH",(function(a,b,t){return(a=new oe(ge)).startX=0,a.startY=t/2,a.endX=b,a.endY=t/2,a})),hu("LineV",(function(a,b,t){return(a=new oe(ge)).startX=b/2,a.startY=0,a.endX=b/2,a.endY=t,a})),hu("None","Rectangle"),hu("BarH","Rectangle"),hu("BarV","Rectangle"),hu("MinusLine","LineH"),hu("PlusLine",(function(a,b,t){return(new oe).add(new ve(0,t/2,!1).add(new xe(Me,b,t/2)).add(new xe(ke,b/2,0)).add(new xe(Me,b/2,t)))})),hu("XLine",(function(a,b,t){return(new oe).add(new ve(0,t,!1).add(new xe(Me,b,0)).add(new xe(ke,0,0)).add(new xe(Me,b,t)))})),ne.Nm={"":"",Standard:"F1 m 0,0 l 8,4 -8,4 2,-4 z",Backward:"F1 m 8,0 l -2,4 2,4 -8,-4 z",Triangle:"F1 m 0,0 l 8,4.62 -8,4.62 z",BackwardTriangle:"F1 m 8,4 l 0,4 -8,-4 8,-4 0,4 z",Boomerang:"F1 m 0,0 l 8,4 -8,4 4,-4 -4,-4 z",BackwardBoomerang:"F1 m 8,0 l -8,4 8,4 -4,-4 4,-4 z",SidewaysV:"m 0,0 l 8,4 -8,4 0,-1 6,-3 -6,-3 0,-1 z",BackwardV:"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z",OpenTriangle:"m 0,0 l 8,4 -8,4",BackwardOpenTriangle:"m 8,0 l -8,4 8,4",OpenTriangleLine:"m 0,0 l 8,4 -8,4 m 8.5,0 l 0,-8",BackwardOpenTriangleLine:"m 8,0 l  -8,4 8,4 m -8.5,0 l 0,-8",OpenTriangleTop:"m 0,0 l 8,4 m 0,4",BackwardOpenTriangleTop:"m 8,0 l -8,4 m 0,4",OpenTriangleBottom:"m 0,8 l 8,-4",BackwardOpenTriangleBottom:"m 0,4 l 8,4",HalfTriangleTop:"F1 m 0,0 l 0,4 8,0 z m 0,8",BackwardHalfTriangleTop:"F1 m 8,0 l 0,4 -8,0 z m 0,8",HalfTriangleBottom:"F1 m 0,4 l 0,4 8,-4 z",BackwardHalfTriangleBottom:"F1 m 8,4 l 0,4 -8,-4 z",ForwardSemiCircle:"m 4,0 b 270 180 0 4 4",BackwardSemiCircle:"m 4,8 b 90 180 0 -4 4",Feather:"m 0,0 l 3,4 -3,4",BackwardFeather:"m 3,0 l -3,4 3,4",DoubleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardDoubleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4",TripleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardTripleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4 m 3,-8 l -3,4 3,4",ForwardSlash:"m 0,8 l 5,-8",BackSlash:"m 0,0 l 5,8",DoubleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8",DoubleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8",TripleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8 m -2,8 l 4,-8",TripleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8 m -2,-8 l 4,8",Fork:"m 0,4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4",LineFork:"m 0,0 l 0,8 m 0,-4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardLineFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4 m 8,-8 l 0,8",CircleFork:"F1 m 6,4 b 0 360 -3 0 3 z m 0,0 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 6,0 b 0 360 -3 0 3",CircleLineFork:"F1 m 6,4 b 0 360 -3 0 3 z m 1,-4 l 0,8 m 0,-4 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleLineFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 0,-4 l 0,8 m 7,-4 b 0 360 -3 0 3",Circle:"F1 m 8,4 b 0 360 -4 0 4 z",Block:"F1 m 0,0 l 0,8 8,0 0,-8 z",StretchedDiamond:"F1 m 0,3 l 5,-3 5,3 -5,3 -5,-3 z",Diamond:"F1 m 0,4 l 4,-4 4,4 -4,4 -4,-4 z",Chevron:"F1 m 0,0 l 5,0 3,4 -3,4 -5,0 3,-4 -3,-4 z",StretchedChevron:"F1 m 0,0 l 8,0 3,4 -3,4 -8,0 3,-4 -3,-4 z",NormalArrow:"F1 m 0,2 l 4,0 0,-2 4,4 -4,4 0,-2 -4,0 z",X:"m 0,0 l 8,8 m 0,-8 l -8,8",TailedNormalArrow:"F1 m 0,0 l 2,0 1,2 3,0 0,-2 2,4 -2,4 0,-2 -3,0 -1,2 -2,0 1,-4 -1,-4 z",DoubleTriangle:"F1 m 0,0 l 4,4 -4,4 0,-8 z  m 4,0 l 4,4 -4,4 0,-8 z",BigEndArrow:"F1 m 0,0 l 5,2 0,-2 3,4 -3,4 0,-2 -5,2 0,-8 z",ConcaveTailArrow:"F1 m 0,2 h 4 v -2 l 4,4 -4,4 v -2 h -4 l 2,-2 -2,-2 z",RoundedTriangle:"F1 m 0,1 a 1,1 0 0 1 1,-1 l 7,3 a 0.5,1 0 0 1 0,2 l -7,3 a 1,1 0 0 1 -1,-1 l 0,-6 z",SimpleArrow:"F1 m 1,2 l -1,-2 2,0 1,2 -1,2 -2,0 1,-2 5,0 0,-2 2,2 -2,2 0,-2 z",AccelerationArrow:"F1 m 0,0 l 0,8 0.2,0 0,-8 -0.2,0 z m 2,0 l 0,8 1,0 0,-8 -1,0 z m 3,0 l 2,0 2,4 -2,4 -2,0 0,-8 z",BoxArrow:"F1 m 0,0 l 4,0 0,2 2,0 0,-2 2,4 -2,4 0,-2 -2,0 0,2 -4,0 0,-8 z",TriangleLine:"F1 m 8,4 l -8,-4 0,8 8,-4 z m 0.5,4 l 0,-8",CircleEndedArrow:"F1 m 10,4 l -2,-3 0,2 -2,0 0,2 2,0 0,2 2,-3 z m -4,0 b 0 360 -3 0 3 z",DynamicWidthArrow:"F1 m 0,3 l 2,0 2,-1 2,-2 2,4 -2,4 -2,-2 -2,-1 -2,0 0,-2 z",EquilibriumArrow:"m 0,3 l 8,0 -3,-3 m 3,5 l -8,0 3,3",FastForward:"F1 m 0,0 l 3.5,4 0,-4 3.5,4 0,-4 1,0 0,8 -1,0 0,-4 -3.5,4 0,-4 -3.5,4 0,-8 z",Kite:"F1 m 0,4 l 2,-4 6,4 -6,4 -2,-4 z",HalfArrowTop:"F1 m 0,0 l 4,4 4,0 -8,-4 z m 0,8",HalfArrowBottom:"F1 m 0,8 l 4,-4 4,0 -8,4 z",OpposingDirectionDoubleArrow:"F1 m 0,4 l 2,-4 0,2 4,0 0,-2 2,4 -2,4 0,-2 -4,0 0,2 -2,-4 z",PartialDoubleTriangle:"F1 m 0,0 4,3 0,-3 4,4 -4,4 0,-3 -4,3 0,-8 z",LineCircle:"F1 m 0,0 l 0,8 m 7 -4 b 0 360 -3 0 3 z",DoubleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",TripleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",CircleLine:"F1 m 6 4 b 0 360 -3 0 3 z m 1,-4 l 0,8",DiamondCircle:"F1 m 8,4 l -4,4 -4,-4 4,-4 4,4 m 8,0 b 0 360 -4 0 4 z",PlusCircle:"F1 m 8,4 b 0 360 -4 0 4 l -8 0 z m -4 -4 l 0 8",OpenRightTriangleTop:"m 8,0 l 0,4 -8,0 m 0,4",OpenRightTriangleBottom:"m 8,8 l 0,-4 -8,0",Line:"m 0,0 l 0,8",DoubleLine:"m 0,0 l 0,8 m 2,0 l 0,-8",TripleLine:"m 0,0 l 0,8 m 2,0 l 0,-8 m 2,0 l 0,8",PentagonArrow:"F1 m 8,4 l -4,-4 -4,0 0,8 4,0 4,-4 z"},m(lu,jh),lu.prototype.cloneProtected=function(a){jh.prototype.cloneProtected.call(this,a),a.D=-4097&this.D|49152,a.Lf=this.Lf,a.eh=this.eh,a.mo=this.mo,a.yp=this.yp,a.ip=this.ip,a.mp=this.mp,a.Ap=this.Ap,a.zp=this.zp,a.Wn=this.Wn,a.Hf=null,a.kp=this.kp,a.jp=this.jp.G(),a.np=this.np,a.op=this.op.G(),a.Tb=this.Tb,a.hn=this.hn,a.cg.assign(this.cg),a.to=this.to,a.uo=this.uo.G(),a.Do=this.Do.G(),a.vo=this.vo.G(),a.An=this.An,a.no=this.no,a.Ep=this.Ep.G(),a.Dp=this.Dp,a.ef=this.ef,a.aq=this.aq},lu.prototype.tf=function(a){jh.prototype.tf.call(this,a),a.Jh(),a.ph=null,a.Ye=null,a.Fj=null},lu.prototype.toString=function(){var a=E(this.constructor)+"#"+gt(this);return null!==this.data&&(a+="("+z(this.data)+")"),a},lu.prototype.vk=function(a,b,t,e,n,o,g){var r=this.diagram;null!==r&&(a===Fe&&"elements"===b?n instanceof jh?Rh(n,(function(a){Mf(r.partManager,a),Rr(r,a)})):Er(r,n):a===Oe&&"elements"===b&&(n instanceof jh?Rh(n,(function(a){Sf(r.partManager,a,r)})):zr(r,n)),r.Ya(a,b,t,e,n,o,g))},lu.prototype.Ba=function(a){if(jh.prototype.Ba.call(this,a),null!==this.data){for(var b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e];n instanceof jh&&Rh(n,(function(a){null!==a.data&&a.Ba()}))}for(b=this.adornments;b.next();)b.value.Ba(a)}},lu.prototype.updateRelationshipsFromData=function(){null!==this.data&&this.diagram.partManager.updateRelationshipsFromData(this)},lu.prototype.fk=function(a){var b=this.Hf;return null===b?null:b.H(a)},lu.prototype.Ch=function(a,b){if(null!==b){var t=null,e=this.Hf;if(null!==e&&(t=e.H(a)),t!==b){if(null!==t){var n=t.diagram;null!==n&&n.remove(t)}null===e&&(this.Hf=e=new kt),b.Lf!==a&&(b.category=a),e.add(a,b),null!==(a=this.diagram)&&(a.add(b),null!==(a=b.adornedObject)&&(null!==(a=a.Ui())&&(b.data=a.data)))}}},lu.prototype.Af=function(a){var b=this.Hf;if(null!==b){var t=b.H(a);if(null!==t){var e=t.diagram;null!==e&&e.remove(t)}b.remove(a),0===b.count&&(this.Hf=null)}},lu.prototype.Yj=function(){var a=this.Hf;if(null!==a){var b=I();for(a=a.iterator;a.next();)b.push(a.key);a=b.length;for(var t=0;t<a;t++)this.Af(b[t]);R(b)}},lu.prototype.updateAdornments=function(){var a=this.diagram;if(null!==a){for(var b=this.adornments;b.next();){var t=b.value;t.o(),t.placeholder&&t.placeholder.o()}t:{if(this.isSelected&&this.selectionAdorned&&(null!==(b=this.selectionObject)&&this.actualBounds.u()&&this.isVisible()&&b.zf()&&b.actualBounds.u())){if(null===(t=this.fk("Selection"))){if(null===(t=this.selectionAdornmentTemplate)&&(t=this.Kh()?a.linkSelectionAdornmentTemplate:this instanceof qu?a.groupSelectionAdornmentTemplate:a.nodeSelectionAdornmentTemplate),!(t instanceof Lu))break t;qh(t),null!==(t=t.copy())&&(this.Kh()&&this.selectionObject===this.path&&(t.type=jh.Link),t.adornedObject=b)}if(null!==t){t.type===jh.Link&&t.o(),this.Ch("Selection",t);break t}}this.Af("Selection")}for(function(a,b){b.toolManager.mouseDownTools.each((function(b){b.isEnabled&&b.updateAdornments(a)})),b.toolManager.updateAdornments(a)}(this,a),b=this.adornments;b.next();)b.value.Ba()}},lu.prototype.Lb=function(){var a=this.diagram;null!==a&&(wr(a),0!=(16384&this.D)!=!0&&(bu(this,!0),a.Pb()))},lu.prototype.move=function(a,b){!0===b?this.location=a:this.position=a},lu.prototype.moveTo=function(a,b,t){a=Mt.allocAt(a,b),this.move(a,t),Mt.free(a)},lu.prototype.isVisible=function(){if(!this.visible)return!1;var a=this.layer;if(null!==a){if(!a.visible)return!1;if(null!==(a=a.diagram)&&a.animationManager.Dt(this))return!0}return!!(null===(a=this.containingGroup)||a.isSubGraphExpanded&&a.isVisible())},(n=lu.prototype).Ob=function(a){var b=this.diagram;a?(this.C(4),this.Lb(),null!==b&&b.od.add(this)):(this.C(8),this.Yj()),this.Jh(),null!==b&&(b.Na(),b.M())},n.Xa=function(a){if(this.name===a)return this;var b=this.Fj;if(null===b&&(this.Fj=b=new kt),null!==b.H(a))return b.H(a);var t=jh.prototype.Xa.call(this,a);return null!==t?(b.set(a,t),t):(b.set(a,null),null)},n.wf=function(a,b,t){void 0===t&&(t=new Mt),b=b.jc()?xi:b;var e=a.naturalBounds;if(t.h(e.width*b.x+b.offsetX,e.height*b.y+b.offsetY),null===a||a===this)return t;for(a.transform.ra(t),a=a.panel;null!==a&&a!==this;)a.transform.ra(t),a=a.panel;return this.bg.ra(t),t.offset(-this.nc.x,-this.nc.y),t},n.lm=function(a){return void 0===a&&(a=new Wt),a.assign(this.actualBounds)},n.yb=function(){!0===ya(this)&&this.measure(1/0,1/0),this.arrange()},lu.prototype.arrange=function(){if(!1===va(this))fu(this);else{var a=this.ub,b=Wt.alloc();b.assign(a),a.ea();var t=Su(this);this.Fh(0,0,this.nc.width,this.nc.height);var e=this.position;gu(this,e,this.location),a.x=e.x,a.y=e.y,a.freeze(),this.Et(b,a),xa(this,!1),b.w(a)?this.zd(t):!this.Wb()||ne.A(b.width,a.width)&&ne.A(b.height,a.height)||0<=this.Xw&&this.C(16),Wt.free(b),ku(this,!1)}},(n=lu.prototype).Et=function(a,b){var t=this.diagram;if(null!==t){var e=!1;if(!1===t.ki&&a.u()){var n=Wt.alloc();n.assign(t.documentBounds),n.kw(t.padding),a.x>n.x&&a.y>n.y&&a.right<n.right&&a.bottom<n.bottom&&b.x>n.x&&b.y>n.y&&b.right<n.right&&b.bottom<n.bottom&&(e=!0),Wt.free(n)}0!=(65536&this.D)!=!0&&a.w(b)||vu(this,e,t),t.M(),Qt(a,b)||(this instanceof Au&&!t.undoManager.isUndoingRedoing&&this.fd(),this.Jh())}},n.hw=function(a,b){if(this.Kh()||!a.u())return!1;var t=this.diagram;if(null!==t&&(pu(this,t,a,b),!0===t.undoManager.isUndoingRedoing))return!0;if(this.ma=a,this.D&=-2097153,(t=this.cg).u()){var e=t.copy();t.h(t.x+(a.x-b.x),t.y+(a.y-b.y)),this.g("location",e,t.copy())}return!1===wu(this)&&!1===va(this)&&(cu(this),fu(this)),!0},n.Kq=function(a,b,t){var e=this.cg,n=this.ma;if(t){if(e.x===a&&e.y===b)return;wu(this)||va(this)?n.h(NaN,NaN):n.h(n.x+a-e.x,n.y+b-e.y),e.h(a,b)}else{if(n.x===a&&n.y===b)return;wu(this)||va(this)?this.Ot():e.h(e.x+a-n.x,e.y+b-n.y),n.h(a,b)}cu(this)},n.Ot=function(){this.D&=-2097153,cu(this)},n.bj=function(){return!0},n.Wb=function(){return!0},n.Kh=function(){return!1},n.yf=function(){return!0},lu.prototype.canCopy=function(){if(!this.copyable)return!1;var a=this.layer;return null===a||!!a.allowCopy&&(null===(a=a.diagram)||!!a.allowCopy)},lu.prototype.canDelete=function(){if(!this.deletable)return!1;var a=this.layer;return null===a||!!a.allowDelete&&(null===(a=a.diagram)||!!a.allowDelete)},lu.prototype.canEdit=function(){if(!this.textEditable)return!1;var a=this.layer;return null===a||!!a.allowTextEdit&&(null===(a=a.diagram)||!!a.allowTextEdit)},lu.prototype.canGroup=function(){if(!this.groupable)return!1;var a=this.layer;return null===a||!!a.allowGroup&&(null===(a=a.diagram)||!!a.allowGroup)},lu.prototype.canMove=function(){if(!this.movable)return!1;var a=this.layer;return null===a||!!a.allowMove&&(null===(a=a.diagram)||!!a.allowMove)},lu.prototype.canReshape=function(){if(!this.reshapable)return!1;var a=this.layer;return null===a||!!a.allowReshape&&(null===(a=a.diagram)||!!a.allowReshape)},lu.prototype.canResize=function(){if(!this.resizable)return!1;var a=this.layer;return null===a||!!a.allowResize&&(null===(a=a.diagram)||!!a.allowResize)},lu.prototype.canRotate=function(){if(!this.rotatable)return!1;var a=this.layer;return null===a||!!a.allowRotate&&(null===(a=a.diagram)||!!a.allowRotate)},lu.prototype.canSelect=function(){if(!this.selectable)return!1;var a=this.layer;return null===a||!!a.allowSelect&&(null===(a=a.diagram)||!!a.allowSelect)},(n=lu.prototype).zd=function(a){this.D=a?131072|this.D:-131073&this.D},n.Jh=function(){var a=this.containingGroup;null!==a&&(a.o(),null!==a.placeholder&&a.placeholder.o(),a.fd())},n.M=function(){var a=this.diagram;null!==a&&!va(this)&&!wu(this)&&this.isVisible()&&this.ub.u()&&a.M(du(this,this.ub))},n.o=function(){jh.prototype.o.call(this);var a=this.diagram;null!==a&&(a.od.add(this),this instanceof Au&&null!==this.labeledLink&&aa(this.labeledLink),a.Pb(!0))},n.qq=function(a){a||null!==(a=this.di)&&Uu(a,this)},n.rq=function(a){a||null!==(a=this.di)&&Ku(a,this)},n.dk=function(){var a=this.data;if(null!==a){var b=this.diagram;null!==b&&(null!==(b=b.model)&&b.Am(a))}},n.qz=function(){return function t(a,b){var e=b.containingGroup;return null!==e?1+t(a,e):b instanceof Au&&null!==(b=b.labeledLink)?t(a,b):0}(this,this)},n.uz=function(){return function t(a,b){var e=b.containingGroup;return null!==e||b instanceof Au&&null!==(e=b.labeledLink)?t(a,e):b}(this,this)},n.Xd=function(a){return a instanceof qu&&function t(a,b,e){if(b===e||null===e)return!1;var n=b.containingGroup;return!(null===n||n!==e&&!t(a,n,e))||b instanceof Au&&null!==(b=b.labeledLink)&&t(a,b,e)}(this,this,a)},n.Ix=function(a){if(null===a)return null;if(this===a)return this.containingGroup;for(var b=this;null!==b;){if(b instanceof qu&&Pu(b,!0),b instanceof Au){var t=b.labeledLink;null!==t&&(b=t)}b=b.containingGroup}for(t=null,b=a;null!==b;){if(0!=(1048576&b.D)){t=b;break}b instanceof Au&&(null!==(a=b.labeledLink)&&(b=a)),b=b.containingGroup}for(b=this;null!==b;)b instanceof qu&&Pu(b,!1),b instanceof Au&&(null!==(a=b.labeledLink)&&(b=a)),b=b.containingGroup;return t},lu.prototype.canLayout=function(){if(!this.isLayoutPositioned||!this.isVisible())return!1;var a=this.layer;return!(null!==a&&a.isTemporary||this instanceof Au&&this.isLinkLabel)},lu.prototype.C=function(a){if(void 0===a&&(a=16777215),this.isLayoutPositioned&&0!=(a&this.layoutConditions)){var b=this.layer;null!==b&&b.isTemporary||this instanceof Au&&this.isLinkLabel?b=!1:b=null===(b=this.diagram)||!b.undoManager.isUndoingRedoing}else b=!1;if(b)if(null!==(b=this.di)){var t=b.layout;null!==t?t.C():b.C(a)}else null!==(a=this.diagram)&&(null!==(a=a.layout)&&a.C())},v.Object.defineProperties(lu.prototype,{key:{get:function(){var a=this.diagram;if(null!==a)return a.model.ja(this.data)}},adornments:{get:function(){return null===this.Hf?ot:this.Hf.iteratorValues}},layer:{get:function(){return this.ui}},diagram:{get:function(){var a=this.ui;return null!==a?a.diagram:null}},layerName:{get:function(){return this.eh},set:function(a){var b=this.eh;if(b!==a){var t=this.diagram;if((null===t||null!==t.im(a)&&!t.partManager.addsToTemporaryLayer)&&(this.eh=a,null!==t&&t.Na(),this.g("layerName",b,a),null!==(b=this.layer)&&b.name!==a&&(null!==(t=b.diagram)&&(null!==(a=t.im(a))&&a!==b)))){var e=b.Fc(-1,this,!0);if(0<=e&&t.Ya(Oe,"parts",b,this,null,e,!0),e=a.aj(99999999,this,!0),b.visible!==a.visible&&this.Ob(a.visible),0<=e&&t.Ya(Fe,"parts",a,null,this,!0,e),null!==(e=this.layerChanged)){var n=t.Z;t.Z=!0,e(this,b,a),t.Z=n}}}}},layerChanged:{get:function(){return this.mo},set:function(a){var b=this.mo;b!==a&&(this.mo=a,this.g("layerChanged",b,a))}},zOrder:{get:function(){return this.aq},set:function(a){var b=this.aq;if(b!==a){this.aq=a;var t=this.layer;null!==t&&li(t,-1,this),this.g("zOrder",b,a),null!==(a=this.diagram)&&a.M()}}},locationObject:{get:function(){if(null===this.Ye){var a=this.locationObjectName;""!==a?(a=this.Xa(a),this.Ye=null!==a?a:this):this instanceof Lu&&this.type!==jh.Link&&null!==this.placeholder?this.Ye=this.placeholder:this.Ye=this}return this.Ye.visible?this.Ye:this}},minLocation:{get:function(){return this.Do},set:function(a){var b=this.Do;b.w(a)||(this.Do=a=a.G(),this.g("minLocation",b,a))}},maxLocation:{get:function(){return this.vo},set:function(a){var b=this.vo;b.w(a)||(this.vo=a=a.G(),this.g("maxLocation",b,a))}},locationObjectName:{get:function(){return this.to},set:function(a){var b=this.to;b!==a&&(this.to=a,this.Ye=null,this.o(),this.g("locationObjectName",b,a))}},locationSpot:{get:function(){return this.uo},set:function(a){var b=this.uo;b.w(a)||(this.uo=a=a.G(),this.o(),this.g("locationSpot",b,a))}},location:{get:function(){return this.cg},set:function(a){var b=a.x,t=a.y,e=this.cg,n=e.x,o=e.y;(n===b||isNaN(n)&&isNaN(b))&&(o===t||isNaN(o)&&isNaN(t))||(n=a=a.copy(),this.Kh()?b=!1:(this.cg=n,this.D|=2097152,!1===va(this)&&(cu(this),(b=this.ma).u()&&(t=b.copy(),b.h(b.x+(n.x-e.x),b.y+(n.y-e.y)),pu(this,this.diagram,b,t),null!==(n=this.diagram)?(o=n.skipsUndoManager,n.skipsUndoManager=!0,this.g("position",t,b),n.skipsUndoManager=o):this.g("position",t,b))),b=!0),b&&this.g("location",e.copy(),a.copy()))}},category:{get:function(){return this.Lf},set:function(a){var b=this.Lf;if(b!==a){var t=this.diagram,e=this.data,n=null;if(null!==t&&null!==e&&!(this instanceof Lu)){var o=t.model.undoManager;o.isEnabled&&!o.isUndoingRedoing&&(n=this.clone()).W.addAll(this.W)}this.Lf=a,this.g("category",b,a),null===t||null===e||this instanceof Lu?this instanceof Lu&&(null!==(n=this.adornedPart)&&(null!==(a=n.Hf)&&a.remove(b),n.Ch(this.category,this))):(o=t.model).undoManager.isUndoingRedoing||(this.Kh()?(t.partManager.setLinkCategoryForData(e,a),null!==(t=t.partManager.findLinkTemplateForCategory(a))&&(qh(t),null!==(t=t.copy())&&xu(this,t,b,a))):(null!==o&&o.Jq(e,a),null!==(t=bf(t.partManager,e,a))&&(qh(t),null===(t=t.copy())||t instanceof Wu||(e=this.location.copy(),xu(this,t,b,a),this.location.u()||(this.location=e)))),null!==n&&((b=this.clone()).W.addAll(this.W),this.g("self",n,b)))}}},self:{get:function(){return this},set:function(a){xu(this,a,this.category,a.category)}},copyable:{get:function(){return 0!=(1&this.D)},set:function(a){var b=0!=(1&this.D);b!==a&&(this.D^=1,this.g("copyable",b,a))}},deletable:{get:function(){return 0!=(2&this.D)},set:function(a){var b=0!=(2&this.D);b!==a&&(this.D^=2,this.g("deletable",b,a))}},textEditable:{get:function(){return 0!=(4&this.D)},set:function(a){var b=0!=(4&this.D);b!==a&&(this.D^=4,this.g("textEditable",b,a),this.Lb())}},groupable:{get:function(){return 0!=(8&this.D)},set:function(a){var b=0!=(8&this.D);b!==a&&(this.D^=8,this.g("groupable",b,a))}},movable:{get:function(){return 0!=(16&this.D)},set:function(a){var b=0!=(16&this.D);b!==a&&(this.D^=16,this.g("movable",b,a))}},selectionAdorned:{get:function(){return 0!=(32&this.D)},set:function(a){var b=0!=(32&this.D);b!==a&&(this.D^=32,this.g("selectionAdorned",b,a),this.Lb())}},isInDocumentBounds:{get:function(){return 0!=(64&this.D)},set:function(a){var b=0!=(64&this.D);if(b!==a){this.D^=64;var t=this.diagram;null!==t&&t.Na(),this.g("isInDocumentBounds",b,a)}}},isLayoutPositioned:{get:function(){return 0!=(128&this.D)},set:function(a){var b=0!=(128&this.D);b!==a&&(this.D^=128,this.g("isLayoutPositioned",b,a),this.C(a?4:8))}},selectable:{get:function(){return 0!=(256&this.D)},set:function(a){var b=0!=(256&this.D);b!==a&&(this.D^=256,this.g("selectable",b,a),this.Lb())}},reshapable:{get:function(){return 0!=(512&this.D)},set:function(a){var b=0!=(512&this.D);b!==a&&(this.D^=512,this.g("reshapable",b,a),this.Lb())}},resizable:{get:function(){return 0!=(1024&this.D)},set:function(a){var b=0!=(1024&this.D);b!==a&&(this.D^=1024,this.g("resizable",b,a),this.Lb())}},rotatable:{get:function(){return 0!=(2048&this.D)},set:function(a){var b=0!=(2048&this.D);b!==a&&(this.D^=2048,this.g("rotatable",b,a),this.Lb())}},isSelected:{get:function(){return 0!=(4096&this.D)},set:function(a){var b=0!=(4096&this.D);if(b!==a){var t=this.diagram;if(!a||this.canSelect()&&!(null!==t&&t.selection.count>=t.maxSelectionCount)){this.D^=4096;var e=!1;if(null!==t){e=t.skipsUndoManager,t.skipsUndoManager=!0;var n=t.selection;n.ea(),a?n.add(this):n.remove(this),n.freeze()}this.g("isSelected",b,a),this.Lb(),null!==(a=this.selectionChanged)&&a(this),null!==t&&(t.Pb(),t.skipsUndoManager=e)}}}},isHighlighted:{get:function(){return 0!=(524288&this.D)},set:function(a){var b=0!=(524288&this.D);if(b!==a){this.D^=524288;var t=this.diagram;null!==t&&((t=t.highlighteds).ea(),a?t.add(this):t.remove(this),t.freeze()),this.g("isHighlighted",b,a),this.M(),null!==(a=this.highlightedChanged)&&a(this)}}},isShadowed:{get:function(){return 0!=(8192&this.D)},set:function(a){var b=0!=(8192&this.D);b!==a&&(this.D^=8192,this.g("isShadowed",b,a),this.M())}},isAnimated:{get:function(){return 0!=(262144&this.D)},set:function(a){var b=0!=(262144&this.D);b!==a&&(this.D^=262144,this.g("isAnimated",b,a))}},highlightedChanged:{get:function(){return this.Wn},set:function(a){var b=this.Wn;b!==a&&(this.Wn=a,this.g("highlightedChanged",b,a))}},selectionObjectName:{get:function(){return this.Ap},set:function(a){var b=this.Ap;b!==a&&(this.Ap=a,this.ph=null,this.g("selectionObjectName",b,a))}},selectionAdornmentTemplate:{get:function(){return this.yp},set:function(a){var b=this.yp;b!==a&&(this.yp=a,this.g("selectionAdornmentTemplate",b,a))}},selectionObject:{get:function(){if(null===this.ph){var a=this.selectionObjectName;null!==a&&""!==a?(a=this.Xa(a),this.ph=null!==a?a:this):this instanceof Wu?(a=this.path,this.ph=null!==a?a:this):this.ph=this}return this.ph}},selectionChanged:{get:function(){return this.zp},set:function(a){var b=this.zp;b!==a&&(this.zp=a,this.g("selectionChanged",b,a))}},resizeAdornmentTemplate:{get:function(){return this.ip},set:function(a){var b=this.ip;b!==a&&(this.ip=a,this.g("resizeAdornmentTemplate",b,a))}},resizeObjectName:{get:function(){return this.kp},set:function(a){var b=this.kp;b!==a&&(this.kp=a,this.g("resizeObjectName",b,a))}},resizeObject:{get:function(){var a=this.resizeObjectName;return""!==a&&null!==(a=this.Xa(a))?a:this}},resizeCellSize:{get:function(){return this.jp},set:function(a){var b=this.jp;b.w(a)||(this.jp=a=a.G(),this.g("resizeCellSize",b,a))}},rotateAdornmentTemplate:{get:function(){return this.mp},set:function(a){var b=this.mp;b!==a&&(this.mp=a,this.g("rotateAdornmentTemplate",b,a))}},rotateObjectName:{get:function(){return this.np},set:function(a){var b=this.np;b!==a&&(this.np=a,this.g("rotateObjectName",b,a))}},rotateObject:{get:function(){var a=this.rotateObjectName;return""!==a&&null!==(a=this.Xa(a))?a:this}},rotationSpot:{get:function(){return this.op},set:function(a){var b=this.op;b.w(a)||(this.op=a=a.G(),this.g("rotationSpot",b,a))}},text:{get:function(){return this.Tb},set:function(a){var b=this.Tb;b!==a&&(this.Tb=a,this.g("text",b,a))}},containingGroup:{get:function(){return this.di},set:function(a){if(this.Wb()){var b=this.di;if(b!==a){null===a||this!==a&&!a.Xd(this)||(this===a&&N("Cannot make a Group a member of itself: "+this.toString()),N("Cannot make a Group indirectly contain itself: "+this.toString()+" already contains "+a.toString())),this.C(2);var t=this.diagram;if(null!==b?Ku(b,this):this instanceof qu&&null!==t&&t.zh.remove(this),this.di=a,null!==a?Uu(a,this):this instanceof qu&&null!==t&&t.zh.add(this),this.C(1),null!==t&&t.Z){var e=this.data,n=t.model;if(null!==e&&n.jk()){var o=n.ja(null!==a?a.data:null);n.Mt(e,o)}}if(null!==(e=this.containingGroupChanged)&&(n=!0,null!==t&&(n=t.Z,t.Z=!0),e(this,b,a),null!==t&&(t.Z=n)),this instanceof qu)for(Cu(t=new ct,this,!0,0,!0),t=t.iterator;t.next();)if((e=t.value)instanceof Au)for(e=e.linksConnected;e.next();)Ju(e.value);if(this instanceof Au){for(t=this.linksConnected;t.next();)Ju(t.value);null!==(t=this.labeledLink)&&Ju(t)}this.g("containingGroup",b,a),null!==a&&(null!==(b=a.layer)&&li(b,-1,a))}}else N("cannot set the Part.containingGroup of a Link or Adornment")}},containingGroupChanged:{get:function(){return this.hn},set:function(a){var b=this.hn;b!==a&&(this.hn=a,this.g("containingGroupChanged",b,a))}},isTopLevel:{get:function(){return!(null!==this.containingGroup||this instanceof Au&&null!==this.labeledLink)}},layoutConditions:{get:function(){return this.no},set:function(a){var b=this.no;b!==a&&(this.no=a,this.g("layoutConditions",b,a))}},dragComputation:{get:function(){return this.An},set:function(a){var b=this.An;b!==a&&(this.An=a,this.g("dragComputation",b,a))}},shadowOffset:{get:function(){return this.Ep},set:function(a){var b=this.Ep;b.w(a)||(this.Ep=a=a.G(),this.M(),this.g("shadowOffset",b,a))}},shadowColor:{get:function(){return this.Dp},set:function(a){var b=this.Dp;b!==a&&(this.Dp=a,this.M(),this.g("shadowColor",b,a))}},shadowBlur:{get:function(){return this.ef},set:function(a){var b=this.ef;b!==a&&(this.ef=a,this.M(),this.g("shadowBlur",b,a))}}}),lu.prototype.invalidateLayout=lu.prototype.C,lu.prototype.findCommonContainingGroup=lu.prototype.Ix,lu.prototype.isMemberOf=lu.prototype.Xd,lu.prototype.findTopLevelPart=lu.prototype.uz,lu.prototype.findSubGraphLevel=lu.prototype.qz,lu.prototype.ensureBounds=lu.prototype.yb,lu.prototype.getDocumentBounds=lu.prototype.lm,lu.prototype.getRelativePoint=lu.prototype.wf,lu.prototype.findObject=lu.prototype.Xa,lu.prototype.moveTo=lu.prototype.moveTo,lu.prototype.invalidateAdornments=lu.prototype.Lb,lu.prototype.clearAdornments=lu.prototype.Yj,lu.prototype.removeAdornment=lu.prototype.Af,lu.prototype.addAdornment=lu.prototype.Ch,lu.prototype.findAdornment=lu.prototype.fk,lu.prototype.updateTargetBindings=lu.prototype.Ba;var Tu=!1;function Lu(a){lu.call(this,a),this.D&=-257,this.eh="Adornment",this.be=null,this.ax=0,this.qx=!1,this.l=[],this.Ra=null}function Au(a){lu.call(this,a),this.P=13,this.Wa=new lt,this.Wp=this.rl=this.xi=this.po=this.oo=null,this.Ik=di,this.rc=this.Ne=null,this.fp=Gu,this.Ah=!1}function ju(a,b){null!==b&&(null===a.Ne&&(a.Ne=new ct),a.Ne.add(b))}function Du(a,b,t,e){if(null===b||null===a.Ne)return null;for(var n=a.Ne.iterator;n.next();){var o=n.value;if(o.Bt===a&&o.Nv===b&&o.Zx===t&&o.$x===e||o.Bt===b&&o.Nv===a&&o.Zx===e&&o.$x===t)return o}return null}function Fu(a,b){for(var t=a.linksConnected;t.next();){var e=t.value;e.fromPort!==b&&e.toPort!==b||(Ou(a,e.fromPort),Ou(a,e.toPort),e.Ta())}}function Ou(a,b){null!==b&&(null!==(b=b.ep)&&b.nm(),null===(a=a.containingGroup)||a.isSubGraphExpanded||Ou(a,a.port))}function Bu(a,b,t){Ou(a,t);var e=a.Wa.contains(b);if(e||a.Wa.add(b),!e||b.fromNode===b.toNode){var n=a.linkConnected;if(null!==n){var o=!0,g=a.diagram;null!==g&&(o=g.Z,g.Z=!0),n(a,b,t),null!==g&&(g.Z=o)}}!e&&b.isTreeLink&&(t=b.fromNode,b=b.toNode,null!==t&&null!==b&&t!==b&&(e=!0,null!==(a=a.diagram)&&(e=a.isTreePathToChildren),o=e?t:b,(n=e?b:t).Ah||(n.Ah=o),!o.isTreeLeaf||null!==a&&a.undoManager.isUndoingRedoing||(e?t===o&&(o.isTreeLeaf=!1):b===o&&(o.isTreeLeaf=!1))))}function Iu(a,b,t){Ou(a,t);var e=a.Wa.remove(b),n=null;if(e||b.toNode===b.fromNode){var o=a.linkDisconnected;if(n=a.diagram,null!==o){var g=!0;null!==n&&(g=n.Z,n.Z=!0),o(a,b,t),null!==n&&(n.Z=g)}}e&&b.isTreeLink&&(t=!0,null!==n&&(t=n.isTreePathToChildren),a=t?b.toNode:b.fromNode,b=t?b.fromNode:b.toNode,null!==a&&(a.Ah=!1),null===b||b.isTreeLeaf||(0===b.Wa.count?(b.Ah=null,null!==n&&n.undoManager.isUndoingRedoing||(b.isTreeLeaf=!0)):Ru(b)))}function Ru(a){if(a.Ah=!1,0!==a.Wa.count){var b=!0,t=a.diagram;if(null===t||!t.undoManager.isUndoingRedoing){for(null!==t&&(b=t.isTreePathToChildren),t=a.Wa.iterator;t.next();){var e=t.value;if(e.isTreeLink)if(b){if(e.fromNode===a)return void(a.isTreeLeaf=!1)}else if(e.toNode===a)return void(a.isTreeLeaf=!1)}a.isTreeLeaf=!0}}}function Eu(a){null===a.rc?a.rc=new kt:a.rc.clear(),a.Km(a,(function(a,t){zu(a,t)})),0===a.rc.count&&a.rc.add("",a)}function zu(a,b){var t=b.portId;null!==t&&null!==a.rc&&a.rc.add(t,b)}function Vu(a,b,t){var e=b.portId;if(null!==e&&(null!==a.rc&&a.rc.remove(e),null!==(b=a.diagram)&&t)){for(t=null,a=a.findLinksConnected(e);a.next();)e=a.value,null===t&&(t=I()),t.push(e);if(null!==t){for(a=0;a<t.length;a++)b.remove(t[a]);R(t)}}}lu.className="Part",lu.LayoutNone=0,lu.LayoutAdded=1,lu.LayoutRemoved=2,lu.LayoutShown=4,lu.LayoutHidden=8,lu.LayoutNodeSized=16,lu.LayoutGroupLayout=32,lu.LayoutNodeReplaced=64,lu.LayoutStandard=127,lu.LayoutAll=16777215,m(Lu,lu),Lu.prototype.toString=function(){var a=this.adornedPart;return"Adornment("+this.category+")"+(null!==a?a.toString():"")},Lu.prototype.updateRelationshipsFromData=function(){},Lu.prototype.nk=function(a){var b=this.adornedObject.part;if(b instanceof Wu&&this.adornedObject instanceof rl){var t=b.path;b.nk(a),a=t.geometry,t=(b=this.W.j).length;for(var e=0;e<t;e++){var n=b[e];n.isPanelMain&&n instanceof rl&&(n.ka=a)}}},Lu.prototype.bj=function(){var a=this.be;return null===a||(null===(a=a.part)||!va(a))},Lu.prototype.Wb=function(){return!1},Lu.prototype.vk=function(a,b,t,e,n,o,g){if(a===Fe&&"elements"===b){if(n instanceof Hu)null===this.Ra&&(this.Ra=n);else if(n instanceof jh){var r=n.hm((function(a){return a instanceof Hu}));r instanceof Hu&&null===this.Ra&&(this.Ra=r)}}else a===Oe&&"elements"===b&&null!==this.Ra&&(e===this.Ra||e instanceof jh&&this.Ra.Dg(e))&&(this.Ra=null);lu.prototype.vk.call(this,a,b,t,e,n,o,g)},Lu.prototype.updateAdornments=function(){},Lu.prototype.dk=function(){},v.Object.defineProperties(Lu.prototype,{placeholder:{get:function(){return this.Ra}},adornedObject:{get:function(){return this.be},set:function(a){var b=this.adornedPart,t=null;null!==a&&(t=a.part),null===b||null!==a&&b===t||b.Af(this.category),this.be=a,null!==t&&t.Ch(this.category,this)}},adornedPart:{get:function(){var a=this.be;return null!==a?a.part:null}},containingGroup:{get:function(){return null}}}),Lu.className="Adornment",m(Au,lu),Au.prototype.cloneProtected=function(a){lu.prototype.cloneProtected.call(this,a),a.P=this.P,a.P=-17&this.P,a.oo=this.oo,a.po=this.po,a.xi=this.xi,a.Wp=this.Wp,a.Ik=this.Ik.G(),a.fp=this.fp},(n=Au.prototype).tf=function(a){lu.prototype.tf.call(this,a),a.fd(),a.Ne=this.Ne,a.rc=null},n.Tz=function(a,b,t){null==b&&(b=""),null==t&&(t=""),null!==(a=Du(this,a,b,t))&&a.nm()},n.vk=function(a,b,t,e,n,o,g){(a===Fe&&"elements"===b||a===Oe&&"elements"===b)&&(this.rc=null),lu.prototype.vk.call(this,a,b,t,e,n,o,g)},n.fd=function(a){void 0===a&&(a=null);for(var b=this.linksConnected;b.next();){var t=b.value;null!==a&&a.contains(t)||(Ou(this,t.fromPort),Ou(this,t.toPort),t.Ta())}},n.bj=function(){return!0},Au.prototype.getAvoidableRect=function(a){return a.set(this.actualBounds),a.cq(this.Ik),a},Au.prototype.findVisibleNode=function(){for(var a=this;null!==a&&!a.isVisible();)a=a.containingGroup;return a},Au.prototype.isVisible=function(){if(!lu.prototype.isVisible.call(this))return!1;var a=!0,b=As,t=this.diagram;if(null!==t){if(t.animationManager.Dt(this))return!0;a=t.isTreePathToChildren,b=t.treeCollapsePolicy}if(b===As){if(null!==(a=this.Bg())&&!a.isTreeExpanded)return!1}else if(b===js){if(0<(a=a?this.tv():this.uv()).count&&a.all((function(a){return!a.isTreeExpanded})))return!1}else if(b===Ds&&(0<(a=a?this.tv():this.uv()).count&&a.any((function(a){return!a.isTreeExpanded}))))return!1;return null===(a=this.labeledLink)||a.isVisible()},Au.prototype.Ob=function(a){lu.prototype.Ob.call(this,a);for(var b=this.linksConnected;b.next();)b.value.Ob(a)},Au.prototype.Jx=function(){var a=new ct,b=new ct;return function t(a,b,e,n){if(!e.has(b)){e.add(b);var o=!0,r=a.diagram;null!==r&&(o=r.isTreePathToChildren),b.linksConnected.each((function(r){r.isTreeLink?(o?r.fromNode===b:r.toNode===b)&&t(a,o?r.toNode:r.fromNode,e,n):n.add(r)}))}}(this,this,a,b),b.iterator},Au.prototype.findLinksConnected=function(a){if(void 0===a&&(a=null),null===a)return this.Wa.iterator;var b=new at(this.Wa),t=this;return b.predicate=function(b){return b.fromNode===t&&b.fromPortId===a||b.toNode===t&&b.toPortId===a},b},(n=Au.prototype).lq=function(a){void 0===a&&(a=null);var b=new at(this.Wa),t=this;return b.predicate=function(b){return b.fromNode===t&&(null===a||b.fromPortId===a)},b},n.wd=function(a){void 0===a&&(a=null);var b=new at(this.Wa),t=this;return b.predicate=function(b){return b.toNode===t&&(null===a||b.toPortId===a)},b},n.sv=function(a){void 0===a&&(a=null);for(var b=null,t=null,e=this.Wa.iterator;e.next();){var n=e.value;n.fromNode===this?null!==a&&n.fromPortId!==a||(n=n.toNode,null!==b?b.add(n):null!==t&&t!==n?((b=new ct).add(t),b.add(n)):t=n):n.toNode!==this||null!==a&&n.toPortId!==a||(n=n.fromNode,null!==b?b.add(n):null!==t&&t!==n?((b=new ct).add(t),b.add(n)):t=n)}return null!==b?b.iterator:null!==t?new st(t):ot},n.uv=function(a){void 0===a&&(a=null);for(var b=null,t=null,e=this.Wa.iterator;e.next();){var n=e.value;n.fromNode!==this||null!==a&&n.fromPortId!==a||(n=n.toNode,null!==b?b.add(n):null!==t&&t!==n?((b=new ct).add(t),b.add(n)):t=n)}return null!==b?b.iterator:null!==t?new st(t):ot},n.tv=function(a){void 0===a&&(a=null);for(var b=null,t=null,e=this.Wa.iterator;e.next();){var n=e.value;n.toNode!==this||null!==a&&n.toPortId!==a||(n=n.fromNode,null!==b?b.add(n):null!==t&&t!==n?((b=new ct).add(t),b.add(n)):t=n)}return null!==b?b.iterator:null!==t?new st(t):ot},n.lz=function(a,b,t){void 0===b&&(b=null),void 0===t&&(t=null);var e=new at(this.Wa),n=this;return e.predicate=function(e){return!(e.fromNode!==n||e.toNode!==a||null!==b&&e.fromPortId!==b||null!==t&&e.toPortId!==t)||!(e.fromNode!==a||e.toNode!==n||null!==t&&e.fromPortId!==t||null!==b&&e.toPortId!==b)},e},n.mz=function(a,b,t){void 0===b&&(b=null),void 0===t&&(t=null);var e=new at(this.Wa),n=this;return e.predicate=function(e){return!(e.fromNode!==n||e.toNode!==a||null!==b&&e.fromPortId!==b||null!==t&&e.toPortId!==t)},e},Au.prototype.updateRelationshipsFromData=function(){var a=this.diagram;null!==a&&a.partManager.updateRelationshipsFromData(this)},(n=Au.prototype).qq=function(a){lu.prototype.qq.call(this,a),a||(Ru(this),null!==(a=this.rl)&&Zu(a,this))},n.rq=function(a){lu.prototype.rq.call(this,a),a||null!==(a=this.rl)&&null!==a.ad&&(a.ad.remove(this),a.o())},n.dk=function(){if(0<this.Wa.count){var a=this.diagram;if(null!==a)for(var b=null===a.commandHandler||a.commandHandler.deletesConnectedLinks,t=this.Wa.copy().iterator;t.next();){var e=t.value;b?a.remove(e):(e.fromNode===this&&(e.fromNode=null),e.toNode===this&&(e.toNode=null))}}this.labeledLink=null,lu.prototype.dk.call(this)},n.lt=function(a){if(null===this.rc){if(""===a&&!1===this.Ih)return this;Eu(this)}var b=this.rc.H(a);return null!==b||""!==a&&null!==(b=this.rc.H(""))?b:this},n.Vz=function(a){if(null===a||a===this)return!1;var b=!0,t=this.diagram;if(null!==t&&(b=t.isTreePathToChildren),t=this,b)for(;t!==a;){b=null;for(var e=t.Wa.iterator;e.next();){var n=e.value;if(n.isTreeLink&&((b=n.fromNode)!==t&&b!==this))break}if(b===this||null===b||b===t)return!1;t=b}else for(;t!==a;){for(b=null,e=t.Wa.iterator;e.next()&&(!(n=e.value).isTreeLink||((b=n.toNode)===t||b===this)););if(b===this||null===b||b===t)return!1;t=b}return!0},n.yz=function(){var a=!0,b=this.diagram;if(null!==b&&(a=b.isTreePathToChildren),b=this,a)for(;;){a=null;for(var t=b.Wa.iterator;t.next();){var e=t.value;if(e.isTreeLink&&((a=e.fromNode)!==b&&a!==this))break}if(a===this)return this;if(null===a||a===b)return b;b=a}else for(;;){for(a=null,t=b.Wa.iterator;t.next()&&(!(e=t.value).isTreeLink||((a=e.toNode)===b||a===this)););if(a===this)return this;if(null===a||a===b)return b;b=a}},n.iz=function(a){if(null===a)return null;if(this===a)return this;for(var b=this;null!==b;)Pu(b,!0),b=b.Bg();var t=null;for(b=a;null!==b;){if(0!=(1048576&b.D)){t=b;break}b=b.Bg()}for(b=this;null!==b;)Pu(b,!1),b=b.Bg();return t},n.Vi=function(){var a=!0,b=this.diagram;if(null!==b&&(a=b.isTreePathToChildren),b=this.Wa.iterator,a){for(;b.next();)if((a=b.value).isTreeLink&&a.fromNode!==this)return a}else for(;b.next();)if((a=b.value).isTreeLink&&a.toNode!==this)return a;return null},n.Bg=function(){var a=this.Ah;if(null===a)return null;if(a instanceof Au)return a;var b=!0;if(null!==(a=this.diagram)&&(b=a.isTreePathToChildren),a=this.Wa.iterator,b){for(;a.next();)if((b=a.value).isTreeLink&&(b=b.fromNode)!==this)return this.Ah=b}else for(;a.next();)if((b=a.value).isTreeLink&&(b=b.toNode)!==this)return this.Ah=b;return this.Ah=null},n.wz=function(){var b=new ct;return function a(b,t){if(null!==b){t.add(b);var e=b.Vi();null!==e&&(t.add(e),a(b.Bg(),t))}}(this,b),b},n.vz=function(){return function t(a,b){return null===(b=b.Bg())?0:1+t(a,b)}(this,this)},n.nq=function(){var a=!0,b=this.diagram;null!==b&&(a=b.isTreePathToChildren),b=new at(this.Wa);var t=this;return b.predicate=a?function(a){return!(!a.isTreeLink||a.fromNode!==t)}:function(a){return!(!a.isTreeLink||a.toNode!==t)},b},n.wv=function(){var a=!0,b=this.diagram;null!==b&&(a=b.isTreePathToChildren);var t=b=null,e=this.Wa.iterator;if(a)for(;e.next();)(a=e.value).isTreeLink&&a.fromNode===this&&(a=a.toNode,null!==b?b.add(a):null!==t&&t!==a?((b=new lt).add(t),b.add(a)):t=a);else for(;e.next();)(a=e.value).isTreeLink&&a.toNode===this&&(a=a.fromNode,null!==b?b.add(a):null!==t&&t!==a?((b=new lt).add(t),b.add(a)):t=a);return null!==b?b.iterator:null!==t?new st(t):ot},n.xz=function(a){void 0===a&&(a=1/0);var b=new ct;return Cu(b,this,!1,a,!0),b},Au.prototype.collapseTree=function(a){void 0===a&&(a=1),1>a&&(a=1);var b=this.diagram;if(null!==b&&!b.De){b.De=!0;var t=new ct;t.add(this),function t(a,b,e,n,o,r,g){if(1<n)for(var h=e?a.lq():a.wd();h.next();){var l=h.value;l.isTreeLink&&(null===(l=l.pt(a))||l===a||b.contains(l)||(b.add(l),t(l,b,e,n-1,o,r,g)))}else!function t(a,b,e,n,o,r){for(var g=o===a||a.isTreeExpanded,h=e?a.lq():a.wd();h.next();){var l=h.value;if(l.isTreeLink&&(null!==(l=l.pt(a))&&l!==a)){var c=b.contains(l);c||b.add(l),g&&(r&&n.Tj(l,o),l.Jh(),l.Ob(!1)),l.isTreeExpanded&&(l.wasTreeExpanded=l.isTreeExpanded,c||t(l,b,e,n,o,r))}}a.isTreeExpanded=!1}(a,b,e,o,r,g)}(this,t,b.isTreePathToChildren,a,b,this,b.treeCollapsePolicy===As),b.De=!1}},Au.prototype.expandTree=function(a){void 0===a&&(a=2),2>a&&(a=2);var b=this.diagram;if(null!==b&&!b.De){b.De=!0;var t=new ct;t.add(this),function t(a,b,e,n,o,r,g){for(var h=r!==a&&a.isTreeExpanded,l=e?a.lq():a.wd();l.next();){var c=l.value;c.isTreeLink&&(h||c.ld||c.Ta(),null!==(c=c.pt(a))&&c!==a&&!b.contains(c)&&(b.add(c),h||(c.Ob(!0),c.Jh(),g&&o.Vj(c,r)),2<n||c.wasTreeExpanded))&&(c.wasTreeExpanded=!1,t(c,b,e,n-1,o,r,g))}a.isTreeExpanded=!0}(this,t,b.isTreePathToChildren,a,b,this,b.treeCollapsePolicy===As),b.De=!1}},v.Object.defineProperties(Au.prototype,{portSpreading:{get:function(){return this.fp},set:function(a){var b=this.fp;b!==a&&(this.fp=a,this.g("portSpreading",b,a),null!==(a=this.diagram)&&a.undoManager.isUndoingRedoing||this.fd())}},avoidable:{get:function(){return 0!=(8&this.P)},set:function(a){var b=0!=(8&this.P);if(b!==a){this.P^=8;var t=this.diagram;null!==t&&Qr(t,this),this.g("avoidable",b,a)}}},avoidableMargin:{get:function(){return this.Ik},set:function(a){"number"==typeof a&&(a=new hi(a));var b=this.Ik;if(!b.w(a)){this.Ik=a=a.G();var t=this.diagram;null!==t&&Qr(t,this),this.g("avoidableMargin",b,a)}}},linksConnected:{get:function(){return this.Wa.iterator}},linkConnected:{get:function(){return this.oo},set:function(a){var b=this.oo;b!==a&&(this.oo=a,this.g("linkConnected",b,a))}},linkDisconnected:{get:function(){return this.po},set:function(a){var b=this.po;b!==a&&(this.po=a,this.g("linkDisconnected",b,a))}},linkValidation:{get:function(){return this.xi},set:function(a){var b=this.xi;b!==a&&(this.xi=a,this.g("linkValidation",b,a))}},isLinkLabel:{get:function(){return null!==this.rl}},labeledLink:{get:function(){return this.rl},set:function(a){var b=this.rl;if(b!==a){var t=this.diagram,e=this.data;if(null!==b){if(null!==b.ad&&(b.ad.remove(this),b.o()),null!==t&&null!==e&&!t.undoManager.isUndoingRedoing){var n=b.data,o=t.model;if(null!==n&&o.pm()){var g=o.ja(e);void 0!==g&&o.ay(n,g)}}this.containingGroup=null}this.rl=a,null!==a&&(Zu(a,this),null===t||null===e||t.undoManager.isUndoingRedoing||(n=a.data,t=t.model,null!==n&&t.pm()&&(void 0!==(e=t.ja(e))&&t.ev(n,e))),this.containingGroup=a.containingGroup),aa(this),this.g("labeledLink",b,a)}}},port:{get:function(){return this.lt("")}},ports:{get:function(){return null===this.rc&&Eu(this),this.rc.iteratorValues}},isTreeExpanded:{get:function(){return 0!=(1&this.P)},set:function(a){var b=0!=(1&this.P);if(b!==a){this.P^=1;var t=this.diagram;if(this.g("isTreeExpanded",b,a),null!==(b=this.treeExpandedChanged)){var e=!0;null!==t&&(e=t.Z,t.Z=!0),b(this),null!==t&&(t.Z=e)}null!==t&&t.undoManager.isUndoingRedoing?this.Ob(a):a?this.expandTree():this.collapseTree()}}},wasTreeExpanded:{get:function(){return 0!=(2&this.P)},set:function(a){var b=0!=(2&this.P);b!==a&&(this.P^=2,this.g("wasTreeExpanded",b,a))}},treeExpandedChanged:{get:function(){return this.Wp},set:function(a){var b=this.Wp;b!==a&&(this.Wp=a,this.g("treeExpandedChanged",b,a))}},isTreeLeaf:{get:function(){return 0!=(4&this.P)},set:function(a){var b=0!=(4&this.P);b!==a&&(this.P^=4,this.g("isTreeLeaf",b,a))}}}),Au.prototype.expandTree=Au.prototype.expandTree,Au.prototype.collapseTree=Au.prototype.collapseTree,Au.prototype.findTreeParts=Au.prototype.xz,Au.prototype.findTreeChildrenNodes=Au.prototype.wv,Au.prototype.findTreeChildrenLinks=Au.prototype.nq,Au.prototype.findTreeLevel=Au.prototype.vz,Au.prototype.findTreeParentChain=Au.prototype.wz,Au.prototype.findTreeParentNode=Au.prototype.Bg,Au.prototype.findTreeParentLink=Au.prototype.Vi,Au.prototype.findCommonTreeParent=Au.prototype.iz,Au.prototype.findTreeRoot=Au.prototype.yz,Au.prototype.isInTreeOf=Au.prototype.Vz,Au.prototype.findPort=Au.prototype.lt,Au.prototype.findLinksTo=Au.prototype.mz,Au.prototype.findLinksBetween=Au.prototype.lz,Au.prototype.findNodesInto=Au.prototype.tv,Au.prototype.findNodesOutOf=Au.prototype.uv,Au.prototype.findNodesConnected=Au.prototype.sv,Au.prototype.findLinksInto=Au.prototype.wd,Au.prototype.findLinksOutOf=Au.prototype.lq,Au.prototype.findExternalTreeLinksConnected=Au.prototype.Jx,Au.prototype.invalidateConnectedLinks=Au.prototype.fd,Au.prototype.invalidateLinkBundle=Au.prototype.Tz;var Yu=new _(Au,"SpreadingNone",10),Gu=new _(Au,"SpreadingEvenly",11),Xu=new _(Au,"SpreadingPacked",12);function qu(a){Au.call(this,a),this.P|=4608,this.zo=new ct,this.zl=new ct,this.Ra=this.Np=this.yi=this.Ao=this.yo=null,this.ic=new Zc,this.ic.group=this}function Uu(a,b){if(a.zo.add(b)){b instanceof qu&&a.zl.add(b);var t=a.memberAdded;if(null!==t){var e=!0,n=a.diagram;null!==n&&(e=n.Z,n.Z=!0),t(a,b),null!==n&&(n.Z=e)}a.isVisible()&&a.isSubGraphExpanded||b.Ob(!1)}b instanceof Wu&&!a.computesBoundsIncludingLinks||(null===(b=a.Ra)&&(b=a),b.o())}function Ku(a,b){if(a.zo.remove(b)){b instanceof qu&&a.zl.remove(b);var t=a.memberRemoved;if(null!==t){var e=!0,n=a.diagram;null!==n&&(e=n.Z,n.Z=!0),t(a,b),null!==n&&(n.Z=e)}a.isVisible()&&a.isSubGraphExpanded||b.Ob(!0)}b instanceof Wu&&!a.computesBoundsIncludingLinks||(null===(b=a.Ra)&&(b=a),b.o())}function Hu(){_s.call(this),this.bb=fi,this.tp=new Wt(NaN,NaN,NaN,NaN)}function Wu(){lu.call(this,jh.Link),this.Pa=8,this.Re=null,this.Se="",this.mf=this.Mn=null,this.nf="",this.Vp=null,this.Dk=mc,this.pn=0,this.rn=mc,this.sn=NaN,this.Lj=dc,this.Ip=.5,this.ad=null,this.wb=(new lt).freeze(),this.oh=this.jh=null,this.El=new Wt,this.ka=new oe,this.Yn=!0,this.I=this.v=this.Kf=this.Tf=null,this.l=[],this.Wu=new Mt,this.Gr=this.mx=this.lx=null,this.ru=NaN,this.O=null}function Ju(a){var b=a.fromNode,t=a.toNode,e=null;if(e=null!==b?null!==t?b.Ix(t):b.containingGroup:null!==t?t.containingGroup:null,b=e,(t=a.di)!==b){null!==t&&Ku(t,a),a.di=b,null!==b&&Uu(b,a);var n=a.containingGroupChanged;if(null!==n){var o=!0,g=a.diagram;null!==g&&(o=g.Z,g.Z=!0),n(a,t,b),null!==g&&(g.Z=o)}!a.ld||a.lx!==t&&a.mx!==t||a.Ta()}if(a.isLabeledLink)for(a=a.labelNodes;a.next();)a.value.containingGroup=e}function Zu(a,b){null===a.ad&&(a.ad=new ct),a.ad.add(b),a.o()}function $u(a,b,t){if(0!==b||0!==t){for(var e=a.ld,n=new lt,o=a.wb.iterator;o.next();){var g=o.value;n.add(new Mt(g.x+b,g.y+t).freeze())}n.freeze(),o=a.wb,a.wb=n,g=a.diagram,isNaN(b)||isNaN(t)||null!==g&&g.animationManager.qc?a.o():(a.cg.h(a.cg.x+b,a.cg.y+t),a.ma.h(a.ma.x+b,a.ma.y+t),aa(a)),e&&Qu(a),null!==g&&g.animationManager.qc&&(a.oh=n),a.g("points",o,n)}}function Qu(a){0===a.wb.count?a.ld=!1:(a.ld=!0,a.Gr=null,a.ru=NaN,a.defaultFromPoint=a.i(0),a.defaultToPoint=a.i(a.pointsCount-1),lc(a,!1))}function _u(a,b){return Math.abs(b.x-a.x)>Math.abs(b.y-a.y)?(b.x>=a.x?b.x=a.x+9e9:b.x=a.x-9e9,b.y=a.y):(b.y>=a.y?b.y=a.y+9e9:b.y=a.y-9e9,b.x=a.x),b}function tc(a,b){var t=b.ep;return null===t&&((t=new Kc).port=b,t.node=b.part,b.ep=t),rp(t,a)}function ic(a){return a===pi||.5===a.x&&.5===a.y}function ec(a){if(null===a.diagram||!a.isAvoiding||!Jr(a.diagram))return!1;var b=a.points.j,t=b.length;if(4>t)return!1;a=Zr(a.diagram,!0,a.containingGroup,null);for(var e=1;e<t-2;e++){var n=b[e],o=b[e+1];if(!a.lk(Math.min(n.x,o.x),Math.min(n.y,o.y),Math.abs(n.x-o.x),Math.abs(n.y-o.y)))return!0}return!1}function nc(a,b,t,e){return a=t-a,isNaN(a)||1/0===a||-1/0===a?NaN:(0>a&&(a=-a),b=e-b,isNaN(b)||1/0===b||-1/0===b?NaN:(0>b&&(b=-b),ne.$(a,0)?b:ne.$(b,0)?a:Math.sqrt(a*a+b*b)))}function oc(a,b,t,e){var n=a.pointsCount;if(2>n)return b;if(t){var o=a.i(1);if(t=o.x-e.x,o=o.y-e.y,0===(e=nc(b.x,b.y,t,o)))return b;n=2===n?.5*e:e,(a=a.computeShortLength(!0))>n&&(a=n),n=a*(o-b.y)/e,b.x+=a*(t-b.x)/e,b.y+=n}else{if(t=(o=a.i(n-2)).x-e.x,o=o.y-e.y,0===(e=nc(b.x,b.y,t,o)))return b;n=2===n?.5*e:e,(a=a.computeShortLength(!1))>n&&(a=n),n=a*(b.y-o)/e,b.x-=a*(b.x-t)/e,b.y-=n}return b}function rc(a,b,t,e){for(var n=a.pointsCount,o=b;ne.$(b.x,o.x)&&ne.$(b.y,o.y);){if(t>=n)return n-1;o=a.i(t++)}if(!ne.$(b.x,o.x)&&!ne.$(b.y,o.y))return t-1;for(var g=o;ne.$(b.x,o.x)&&ne.$(o.x,g.x)&&(!e||(b.y>=o.y?o.y>=g.y:o.y<=g.y))||ne.$(b.y,o.y)&&ne.$(o.y,g.y)&&(!e||(b.x>=o.x?o.x>=g.x:o.x<=g.x));){if(t>=n)return n-1;g=a.i(t++)}return t-2}function sc(a,b,t,e,n,o,g){if(!g&&hc(a)){g=[];var r=0;if(a.isVisible()&&(r=function(a,b,t,e){var n=a.diagram;if(null===n||b.w(t))return 0;for(n=n.layers;n.next();){var o=n.value;if(null!==o&&o.visible)for(var g=(o=o.Ca.j).length,r=0;r<g;r++){var h=o[r];if(h instanceof Wu){if(h===a)return 0<e.length&&e.sort((function(a,b){return a-b})),e.length;if(h.isVisible()&&hc(h)){var l=h.routeBounds;l.u()&&a.routeBounds.Gc(l)&&!a.usesSamePort(h)&&(null!==(l=h.path)&&l.zf()&&ac(b,t,e,h))}}}}return 0<e.length&&e.sort((function(a,b){return a-b})),e.length}(a,n,o,g)),0<r)if(ne.A(n.y,o.y))if(n.x<o.x)for(var h=0;h<r;){var l=Math.max(n.x,Math.min(g[h++]-5,o.x-10));b.lineTo(l+t,o.y+e);for(var c=l+t,f=Math.min(l+10,o.x);h<r&&(l=g[h])<f+10;)h++,f=Math.min(l+5,o.x);l=o.y-10+e,f+=t;var p=o.y+e;a.curve===xc?iu(b,f,p,!1):nu(b,c,l,f,l,f,p)}else for(--r;0<=r;){for(h=Math.min(n.x,Math.max(g[r--]+5,o.x+10)),b.lineTo(h+t,o.y+e),c=h+t,l=Math.max(h-10,o.x);0<=r&&(h=g[r])>l-10;)r--,l=Math.max(h-5,o.x);h=o.y-10+e,l+=t,f=o.y+e,a.curve===xc?iu(b,l,f,!1):nu(b,c,h,l,h,l,f)}else if(ne.A(n.x,o.x))if(n.y<o.y)for(h=0;h<r;){for(l=Math.max(n.y,Math.min(g[h++]-5,o.y-10)),b.lineTo(o.x+t,l+e),c=l+e,l=Math.min(l+10,o.y);h<r&&(f=g[h])<l+10;)h++,l=Math.min(f+5,o.y);f=o.x-10+t,p=o.x+t,l+=e,a.curve===xc?iu(b,p,l,!1):nu(b,f,c,f,l,p,l)}else for(--r;0<=r;){for(h=Math.min(n.y,Math.max(g[r--]+5,o.y+10)),b.lineTo(o.x+t,h+e),c=h+e,h=Math.max(h-10,o.y);0<=r&&(l=g[r])>h-10;)r--,h=Math.max(l-5,o.y);l=o.x-10+t,f=o.x+t,h+=e,a.curve===xc?iu(b,f,h,!1):nu(b,l,c,l,h,f,h)}}b.lineTo(o.x+t,o.y+e)}function ac(a,b,t,e){for(var n=ne.A(a.y,b.y),o=e.pointsCount,g=e.i(0),r=Mt.alloc(),h=1;h<o;h++){var l=e.i(h);if(h<o-1){var c=e.i(h+1);if(g.y===l.y&&l.y===c.y){if(l.x>g.x&&c.x>=l.x||l.x<g.x&&c.x<=l.x)continue}else if(g.x===l.x&&l.x===c.x&&(l.y>g.y&&c.y>=l.y||l.y<g.y&&c.y<=l.y))continue}t:{c=a.x;var f=a.y,p=b.x,d=b.y,q=g.x;g=g.y;var u=l.x,y=l.y;if(ne.A(c,p)){if(!ne.A(f,d)&&ne.A(g,y)&&Math.min(f,d)<g&&Math.max(f,d)>g&&Math.min(q,u)<c&&Math.max(q,u)>c&&!ne.A(q,u)){r.x=c,r.y=g,c=!0;break t}}else if(ne.A(f,d)&&ne.A(q,u)&&Math.min(c,p)<q&&Math.max(c,p)>q&&Math.min(g,y)<f&&Math.max(g,y)>f&&!ne.A(g,y)){r.x=q,r.y=f,c=!0;break t}r.x=0,r.y=0,c=!1}c&&(n?t.push(r.x):t.push(r.y)),g=l}Mt.free(r)}function hc(a){return(a=a.curve)===bc||a===xc}function lc(a,b){(b||hc(a))&&(null===(b=a.diagram)||b.animationManager.isTicking||b.Sg.contains(a)||0===a.El.width&&0===a.El.height||b.Sg.add(a,a.El.copy()))}function uc(a,b,t){if(null!==b&&null!==b.ka&&hc(b)){var e=b.routeBounds;e.u()&&(a.routeBounds.Gc(e)||t.Gc(e))&&(a.usesSamePort(b)||b.cc())}}function cc(a){var b=a.Re;if(null!==b){var t=a.mf;if(null!==t){for(var e=a.Se,n=a.nf,o=a=null,g=b.Wa.j,r=g.length,h=0;h<r;h++){var l=g[h];(l.Re===b&&l.Se===e&&l.mf===t&&l.nf===n||l.Re===t&&l.Se===n&&l.mf===b&&l.nf===e)&&(null===o?o=l:(null===a&&(a=[]).push(o),a.push(l)))}if(null!==a){for(null===(o=Du(b,t,e,n))&&(ju(b,o=new Dc(b,e,t,n)),ju(t,o)),o.links=a,b=0;b<a.length;b++)a[b].Kf=o;o.nm()}}}}function fc(a){var b=a.Kf;null!==b&&(a.Kf=null,0<=(a=b.links.indexOf(a))&&(B(b.links,a),b.nm()))}Au.className="Node",Au.SpreadingNone=Yu,Au.SpreadingEvenly=Gu,Au.SpreadingPacked=Xu,m(qu,Au),qu.prototype.cloneProtected=function(a){Au.prototype.cloneProtected.call(this,a),this.P=-32769&this.P,a.yo=this.yo,a.Ao=this.Ao,a.yi=this.yi,a.Np=this.Np;var b=a.hm((function(a){return a instanceof Hu}));a.Ra=b instanceof Hu?b:null,null!==this.ic?(a.ic=this.ic.copy(),a.ic.group=a):(null!==a.ic&&(a.ic.group=null),a.ic=null)},(n=qu.prototype).tf=function(a){Au.prototype.tf.call(this,a);var b=a.gk();for(a=a.memberParts;a.next();){var t=a.value;if(t.o(),t.C(8),t.Yj(),t instanceof Au)t.fd(b);else if(t instanceof Wu)for(t=t.labelNodes;t.next();)t.value.fd(b)}},n.vk=function(a,b,t,e,n,o,g){if(a===Fe&&"elements"===b){if(n instanceof Hu)null===this.Ra?this.Ra=n:this.Ra!==n&&N("Cannot insert a second Placeholder into the visual tree of a Group.");else if(n instanceof jh){var r=n.hm((function(a){return a instanceof Hu}));r instanceof Hu&&(null===this.Ra?this.Ra=r:this.Ra!==r&&N("Cannot insert a second Placeholder into the visual tree of a Group."))}}else a===Oe&&"elements"===b&&null!==this.Ra&&(e===this.Ra||e instanceof jh&&this.Ra.Dg(e))&&(this.Ra=null);Au.prototype.vk.call(this,a,b,t,e,n,o,g)},n.Fh=function(a,b,t,e){this.Ye=this.Ra,Au.prototype.Fh.call(this,a,b,t,e)},n.yb=function(){this.memberParts.each((function(a){a.yb()})),Au.prototype.yb.call(this)},n.bj=function(){if(!Au.prototype.bj.call(this))return!1;for(var a=this.memberParts;a.next();){var b=a.value;if(b instanceof Au){if(b.isVisible()&&va(b))return!1}else if(b instanceof Wu&&b.isVisible()&&va(b)&&b.fromNode!==this&&b.toNode!==this)return!1}return!0},n.dk=function(){if(0<this.zo.count){var a=this.diagram;if(null!==a)for(var b=this.zo.copy().iterator;b.next();)a.remove(b.value)}Au.prototype.dk.call(this)},qu.prototype.canAddMembers=function(a){var b=this.diagram;if(null===b)return!1;for(b=b.commandHandler,a=Qs(a).iterator;a.next();)if(!b.isValidMember(this,a.value))return!1;return!0},qu.prototype.addMembers=function(a,b){var t=this.diagram;if(null===t)return!1;t=t.commandHandler;var e=!0;for(a=Qs(a).iterator;a.next();){var n=a.value;!b||t.isValidMember(this,n)?n.containingGroup=this:e=!1}return e},qu.prototype.canUngroup=function(){if(!this.ungroupable)return!1;var a=this.layer;return!(null!==a&&!a.allowUngroup)&&!(null!==(a=a.diagram)&&!a.allowUngroup)},(n=qu.prototype).fd=function(a){void 0===a&&(a=null);var b=0!=(65536&this.P);if(Au.prototype.fd.call(this,a),!b)for(0!=(65536&this.P)!=!0&&(this.P=65536^this.P),b=this.rv();b.next();){var t=b.value;if(null===a||!a.contains(t)){var e=t.fromNode;null!==e&&e!==this&&e.Xd(this)&&!e.isVisible()?(Ou(e,t.fromPort),Ou(e,t.toPort),t.Ta()):null!==(e=t.toNode)&&e!==this&&e.Xd(this)&&!e.isVisible()&&(Ou(e,t.fromPort),Ou(e,t.toPort),t.Ta())}}},n.rv=function(){var a=this.gk();a.add(this);for(var b=new ct,t=a.iterator;t.next();){var e=t.value;if(e instanceof Au)for(e=e.linksConnected;e.next();){var n=e.value;a.contains(n)||b.add(n)}}return b.iterator},n.kz=function(){var a=this.gk();a.add(this);for(var b=new ct,t=a.iterator;t.next();){var e=t.value;if(e instanceof Au)for(e=e.linksConnected;e.next();){var n=e.value,o=n.fromNode;a.contains(o)&&o!==this||b.add(o),n=n.toNode,a.contains(n)&&n!==this||b.add(n)}}return b.iterator},n.jz=function(){var b=new ct;return function a(b,t){null!==b&&(t.add(b),a(b.containingGroup,t))}(this,b),b},n.gk=function(){var a=new ct;return Cu(a,this,!0,0,!0),a.remove(this),a},n.Ob=function(a){Au.prototype.Ob.call(this,a);for(var b=this.memberParts;b.next();)b.value.Ob(a)},qu.prototype.collapseSubGraph=function(){var a=this.diagram;null===a||a.De||(a.De=!0,function t(a,b,e,n){for(var o=a.memberParts;o.next();){var r=o.value;if(r.Ob(!1),r instanceof qu&&r.isSubGraphExpanded&&(r.wasSubGraphExpanded=r.isSubGraphExpanded,t(r,b,e,n)),r instanceof Au)r.fd(b),e.Tj(r,n);else if(r instanceof Wu)for(r=r.labelNodes;r.next();)r.value.fd(b)}a.isSubGraphExpanded=!1}(this,this.gk(),a,this),a.De=!1)},qu.prototype.expandSubGraph=function(){var a=this.diagram;null===a||a.De||(a.De=!0,function t(a,b,e,n){for(var o=a.memberParts;o.next();){var r=o.value;if(r.Ob(!0),r instanceof qu&&r.wasSubGraphExpanded&&(r.wasSubGraphExpanded=!1,t(r,b,e,n)),r instanceof Au)r.fd(b),e.Vj(r,n);else if(r instanceof Wu)for(r=r.labelNodes;r.next();)r.value.fd(b)}a.isSubGraphExpanded=!0}(this,this.gk(),a,this),a.De=!1)},qu.prototype.move=function(a,b){void 0===b&&(b=!1);var t=b?this.location:this.position,e=t.x;t=t.y;var n=a.x,o=a.y;if(!(e===n||isNaN(e)&&isNaN(n))||!(t===o||isNaN(t)&&isNaN(o))){for(e=n-(isNaN(e)?0:e),t=o-(isNaN(t)?0:t),o=Mt.alloc(),Au.prototype.move.call(this,a,b),a=new ct,b=this.gk().iterator;b.next();)(n=b.value)instanceof Wu&&(n.suspendsRouting&&a.add(n),n.ld||n.fromNode!==this&&n.toNode!==this)&&(n.suspendsRouting=!0);for(b.reset();b.next();)if(!((n=b.value).Kh()||n instanceof Au&&n.isLinkLabel)){var g=n.position,r=n.location;g.u()?(o.x=g.x+e,o.y=g.y+t,n.position=o):r.u()&&(o.x=r.x+e,o.y=r.y+t,n.location=o)}for(b.reset();b.next();)(n=b.value)instanceof Wu&&(n.suspendsRouting=a.contains(n),n.ld||n.fromNode!==this&&n.toNode!==this)&&(g=n.position,o.x=g.x+e,o.y=g.y+t,o.u()?n.move(o):n.Ta(),ec(n)&&n.Ta());Mt.free(o)}},v.Object.defineProperties(qu.prototype,{placeholder:{get:function(){return this.Ra}},computesBoundsAfterDrag:{get:function(){return 0!=(2048&this.P)},set:function(a){var b=0!=(2048&this.P);b!==a&&(this.P^=2048,this.g("computesBoundsAfterDrag",b,a))}},computesBoundsIncludingLinks:{get:function(){return 0!=(4096&this.P)},set:function(a){var b=0!=(4096&this.P);b!==a&&(this.P^=4096,this.g("computesBoundsIncludingLinks",b,a))}},computesBoundsIncludingLocation:{get:function(){return 0!=(8192&this.P)},set:function(a){var b=0!=(8192&this.P);b!==a&&(this.P^=8192,this.g("computesBoundsIncludingLocation",b,a))}},handlesDragDropForMembers:{get:function(){return 0!=(16384&this.P)},set:function(a){var b=0!=(16384&this.P);b!==a&&(this.P^=16384,this.g("handlesDragDropForMembers",b,a))}},memberParts:{get:function(){return this.zo.iterator}},layout:{get:function(){return this.ic},set:function(a){var b=this.ic;if(b!==a){null!==b&&(b.diagram=null,b.group=null),this.ic=a;var t=this.diagram;null!==a&&(a.diagram=t,a.group=this),null!==t&&(t.If=!0),this.g("layout",b,a),null!==t&&t.Pb()}}},memberAdded:{get:function(){return this.yo},set:function(a){var b=this.yo;b!==a&&(this.yo=a,this.g("memberAdded",b,a))}},memberRemoved:{get:function(){return this.Ao},set:function(a){var b=this.Ao;b!==a&&(this.Ao=a,this.g("memberRemoved",b,a))}},memberValidation:{get:function(){return this.yi},set:function(a){var b=this.yi;b!==a&&(this.yi=a,this.g("memberValidation",b,a))}},ungroupable:{get:function(){return 0!=(256&this.P)},set:function(a){var b=0!=(256&this.P);b!==a&&(this.P^=256,this.g("ungroupable",b,a))}},isSubGraphExpanded:{get:function(){return 0!=(512&this.P)},set:function(a){var b=0!=(512&this.P);if(b!==a){this.P^=512;var t=this.diagram;if(this.g("isSubGraphExpanded",b,a),null!==(b=this.subGraphExpandedChanged)){var e=!0;null!==t&&(e=t.Z,t.Z=!0),b(this),null!==t&&(t.Z=e)}null!==t&&t.undoManager.isUndoingRedoing?(null!==this.Ra&&this.Ra.o(),this.memberParts.each((function(a){a.updateAdornments()}))):a?this.expandSubGraph():this.collapseSubGraph()}}},wasSubGraphExpanded:{get:function(){return 0!=(1024&this.P)},set:function(a){var b=0!=(1024&this.P);b!==a&&(this.P^=1024,this.g("wasSubGraphExpanded",b,a))}},subGraphExpandedChanged:{get:function(){return this.Np},set:function(a){var b=this.Np;b!==a&&(this.Np=a,this.g("subGraphExpandedChanged",b,a))}},uk:{get:function(){return 0!=(32768&this.P)},set:function(a){0!=(32768&this.P)!==a&&(this.P^=32768)}}}),qu.prototype.expandSubGraph=qu.prototype.expandSubGraph,qu.prototype.collapseSubGraph=qu.prototype.collapseSubGraph,qu.prototype.findSubGraphParts=qu.prototype.gk,qu.prototype.findContainingGroupChain=qu.prototype.jz,qu.prototype.findExternalNodesConnected=qu.prototype.kz,qu.prototype.findExternalLinksConnected=qu.prototype.rv,qu.prototype.ensureBounds=qu.prototype.yb,qu.className="Group",m(Hu,_s),Hu.prototype.cloneProtected=function(a){_s.prototype.cloneProtected.call(this,a),a.bb=this.bb.G(),a.tp=this.tp.copy()},Hu.prototype.Hh=function(a){if(null===this.background&&null===this.areaBackground)return!1;var b=this.naturalBounds;return ni(0,0,b.width,b.height,a.x,a.y)},Hu.prototype.sm=function(){var a=this.part;if(null!==a&&(a instanceof qu||a instanceof Lu)||N("Placeholder is not inside a Group or Adornment."),a instanceof qu){var b=this.computeBorder(this.tp),t=this.minSize,e=this.oc;for(Jt(e,(isFinite(t.width)?Math.max(t.width,b.width):b.width)||0,(isFinite(t.height)?Math.max(t.height,b.height):b.height)||0),ia(this,0,0,e.width,e.height),e=a.memberParts,t=!1;e.next();)if(e.value.isVisible()){t=!0;break}e=a.diagram,!t||null===e||e.animationManager.Hv(a)||isNaN(b.x)||isNaN(b.y)||((t=Mt.alloc()).dj(b,a.locationSpot),t.w(a.location)||(a.location=new Mt(t.x,t.y)),Mt.free(t))}else{b=this.oc,e=(t=this.bb).left+t.right;var n=t.top+t.bottom,o=a.adornedObject;a.angle=o.Xi();var g=0;o instanceof rl&&(g=o.strokeWidth);var r=o.vf(),h=o.naturalBounds,l=(h.width+g)*r;g=(h.height+g)*r,a.type!==jh.Link&&(o=o.ga("Selection"===a.category?gi:a.locationSpot,Mt.alloc()),a.location=o,Mt.free(o)),isNaN(l)||isNaN(g)?(l=(a=a.adornedObject).ga(gi,Mt.alloc()),(o=Wt.allocAt(l.x,l.y,0,0)).Ie(a.ga(Mi,l)),o.Ie(a.ga(mi,l)),o.Ie(a.ga(wi,l)),Jt(b,o.width+e||0,o.height+n||0),ia(this,-t.left,-t.top,b.width,b.height),Mt.free(l),Wt.free(o)):(Jt(b,l+e||0,g+n||0),ia(this,-t.left,-t.top,b.width,b.height))}},Hu.prototype.Fh=function(a,b,t,e){this.actualBounds.h(a,b,t,e)},Hu.prototype.computeBorder=function(a){var b=this.part,t=b.diagram;if(null!==t&&b instanceof qu&&!b.layer.isTemporary&&b.computesBoundsAfterDrag&&this.tp.u()){var e=t.toolManager.findTool("Dragging");if(e===t.currentTool&&null!==(t=e.computeBorder(b,this.tp,a)))return t}t=Wt.alloc(),e=this.computeMemberBounds(t);var n=this.bb;return b instanceof qu&&!b.isSubGraphExpanded?a.h(e.x-n.left,e.y-n.top,0,0):a.h(e.x-n.left,e.y-n.top,Math.max(e.width+n.left+n.right,0),Math.max(e.height+n.top+n.bottom,0)),Wt.free(t),b instanceof qu&&b.computesBoundsIncludingLocation&&b.location.u()&&a.Ie(b.location),a},Hu.prototype.computeMemberBounds=function(a){if(!(this.part instanceof qu))return a.h(0,0,0,0),a;for(var b=this.part,t=1/0,e=1/0,n=-1/0,o=-1/0,g=b.memberParts;g.next();){var r=g.value;if(r.isVisible()){if(r instanceof Wu){if(!b.computesBoundsIncludingLinks)continue;if(ya(r))continue;if(r.fromNode===b||r.toNode===b)continue}(r=r.actualBounds).left<t&&(t=r.left),r.top<e&&(e=r.top),r.right>n&&(n=r.right),r.bottom>o&&(o=r.bottom)}}return isFinite(t)&&isFinite(e)?a.h(t,e,n-t,o-e):(b=b.location,a.h(b.x,b.y,0,0)),a},v.Object.defineProperties(Hu.prototype,{padding:{get:function(){return this.bb},set:function(a){"number"==typeof a&&(a=new hi(a));var b=this.bb;b.w(a)||(this.bb=a=a.G(),this.g("padding",b,a))}}}),Hu.className="Placeholder",m(Wu,lu),Wu.prototype.cloneProtected=function(a){lu.prototype.cloneProtected.call(this,a),a.Pa=-113&this.Pa,a.Se=this.Se,a.Mn=this.Mn,a.nf=this.nf,a.Vp=this.Vp,a.Dk=this.Dk,a.pn=this.pn,a.rn=this.rn,a.sn=this.sn,a.Lj=this.Lj,a.Ip=this.Ip,null!==this.O&&(a.O=this.O.copy())},(n=Wu.prototype).tf=function(a){lu.prototype.tf.call(this,a),this.Se=a.Se,this.nf=a.nf,a.jh=null,a.Ta(),a.Kf=this.Kf;var b=a.fromPort;null!==b&&Ou(a.fromNode,b),null!==(b=a.toPort)&&Ou(a.toNode,b)},n.cb=function(a){a.classType===Wu?2==(2&a.value)?this.routing=a:a===vc||a===xc||a===bc?this.curve=a:a===wc||a===kc||a===Mc?this.adjusting=a:a!==dc&&a!==mc&&N("Unknown Link enum value for a Link property: "+a):lu.prototype.cb.call(this,a)},n.Ec=function(){null===this.O&&(this.O=new Jc)},n.bj=function(){var a=this.fromNode;if(null!==a){var b=a.findVisibleNode();if(null!==b&&(a=b),va(a)||wu(a))return!1}return null===(a=this.toNode)||(null!==(b=a.findVisibleNode())&&(a=b),!va(a)&&!wu(a))},n.hw=function(){return!1},n.Ot=function(){},n.Wb=function(){return!1},Wu.prototype.computeAngle=function(a,b,t){return Wu.computeAngle(b,t)},Wu.computeAngle=function(a,b){switch(a){default:case mc:a=0;break;case Sc:a=b;break;case Pc:a=b+90;break;case Nc:a=b-90;break;case Cc:a=b+180;break;case Tc:90<(a=ne.zq(b))&&270>a&&(a-=180);break;case Lc:90<(a=ne.zq(b+90))&&270>a&&(a-=180);break;case Ac:90<(a=ne.zq(b-90))&&270>a&&(a-=180);break;case jc:if(45<(a=ne.zq(b))&&135>a||225<a&&315>a)return 0;90<a&&270>a&&(a-=180)}return ne.zq(a)},(n=Wu.prototype).Jh=function(){var a=this.containingGroup;null!==a&&this.fromNode!==a&&this.toNode!==a&&a.computesBoundsIncludingLinks&&lu.prototype.Jh.call(this)},n.pt=function(a){var b=this.fromNode;return a===b?this.toNode:b},n.Fz=function(a){var b=this.fromPort;return a===b?this.toPort:b},n.qq=function(a){if(lu.prototype.qq.call(this,a),hc(this)&&this.tq(this.actualBounds),!a){var b=null;null!==(a=this.Re)&&Bu(a,this,b=this.fromPort);var t=this.mf;if(null!==t){var e=this.toPort;t===a&&e===b||Bu(t,this,e)}cc(this)}},n.rq=function(a){if(lu.prototype.rq.call(this,a),hc(this)&&this.tq(this.actualBounds),!a){var b=null;null!==(a=this.Re)&&Iu(a,this,b=this.fromPort);var t=this.mf;if(null!==t){var e=this.toPort;t===a&&e===b||Iu(t,this,e)}fc(this)}},n.dk=function(){if(this.ld=!0,null!==this.ad){var a=this.diagram;if(null!==a)for(var b=this.ad.copy().iterator;b.next();)a.remove(b.value)}null!==this.data&&(null!==(a=this.diagram)&&a.partManager.removeDataForLink(this))},Wu.prototype.updateRelationshipsFromData=function(){if(null!==this.data){var a=this.diagram;null!==a&&a.partManager.updateRelationshipsFromData(this)}},Wu.prototype.move=function(a,b){var t=b?this.location:this.position,e=t.x;isNaN(e)&&(e=0);var n=t.y;for(isNaN(n)&&(n=0),e=a.x-e,n=a.y-n,!0===b?lu.prototype.move.call(this,a,!1):(a=Mt.allocAt(t.x+e,t.y+n),lu.prototype.move.call(this,a,!1),Mt.free(a)),$u(this,e,n),a=this.labelNodes;a.next();)t=(b=a.value).position,b.moveTo(t.x+e,t.y+n)},Wu.prototype.canRelinkFrom=function(){if(!this.relinkableFrom)return!1;var a=this.layer;return null===a||!!a.allowRelink&&!(null!==(a=a.diagram)&&!a.allowRelink)},Wu.prototype.canRelinkTo=function(){if(!this.relinkableTo)return!1;var a=this.layer;return null===a||!!a.allowRelink&&!(null!==(a=a.diagram)&&!a.allowRelink)},Wu.prototype.computeMidPoint=function(a){var b=this.pointsCount;if(0===b)return a.assign(Bt),a;if(1===b)return a.assign(this.i(0)),a;if(2===b){var t=this.i(0),e=this.i(1);return a.h((t.x+e.x)/2,(t.y+e.y)/2),a}if(this.isOrthogonal&&(15<=this.computeCorner()||this.computeCurve()===vc))return this.ka.zv(.5,a),a.add(this.i(0)),t=this.ka.figures.first(),a.offset(-t.startX,-t.startY),a;if(this.computeCurve()===vc){if(3===b)return this.i(1);if(t=3*((e=(b-1)/3|0)/2|0),1==e%2){e=this.i(t);var n=this.i(t+1),o=this.i(t+2);t=this.i(t+3),ne.Qy(e.x,e.y,n.x,n.y,o.x,o.y,t.x,t.y,a)}else a.assign(this.i(t));return a}var g=this.flattenedLengths;for(t=this.flattenedTotalLength,n=o=e=0;e<t/2&&o<b&&!(e+(n=g[o])>t/2);)e+=n,o++;return b=this.i(o),o=this.i(o+1),1>Math.abs(b.x-o.x)?b.y>o.y?a.h(b.x,b.y-(t/2-e)):a.h(b.x,b.y+(t/2-e)):1>Math.abs(b.y-o.y)?b.x>o.x?a.h(b.x-(t/2-e),b.y):a.h(b.x+(t/2-e),b.y):(t=(t/2-e)/n,a.h(b.x+t*(o.x-b.x),b.y+t*(o.y-b.y))),a},Wu.prototype.computeMidAngle=function(){var a=this.pointsCount;if(2>a)return NaN;if(2===a)return this.i(0).Sa(this.i(1));if(this.isOrthogonal&&(15<=this.computeCorner()||this.computeCurve()===vc))return this.ka.Ox(.5);if(this.computeCurve()===vc&&4<=a){var b=(a-1)/3|0,t=3*(b/2|0);if(1==b%2){t=Math.floor(t),a=this.i(t),b=this.i(t+1);var e=this.i(t+2);return t=this.i(t+3),ne.Py(a.x,a.y,b.x,b.y,e.x,e.y,t.x,t.y)}if(0<t&&t+1<a)return this.i(t-1).Sa(this.i(t+1))}b=this.flattenedLengths,e=this.flattenedTotalLength;var n,o=0;for(t=0;o<e/2&&t<a&&!(o+(n=b[t])>e/2);)o+=n,t++;if(b=this.i(t),e=this.i(t+1),1>Math.abs(b.x-e.x)&&1>Math.abs(b.y-e.y)){if(0<t&&t+2<a)return this.i(t-1).Sa(this.i(t+2))}else{if(1>Math.abs(b.x-e.x))return b.y>e.y?270:90;if(1>Math.abs(b.y-e.y))return b.x>e.x?180:0}return b.Sa(e)},(n=Wu.prototype).i=function(a){return this.wb.j[a]},n.jd=function(a,b){this.wb.hd(a,b)},n.K=function(a,b,t){this.wb.hd(a,new Mt(b,t))},n.Rz=function(a,b){this.wb.Kb(a,b)},n.m=function(a,b,t){this.wb.Kb(a,new Mt(b,t))},n.ye=function(a){this.wb.add(a)},n.rf=function(a,b){this.wb.add(new Mt(a,b))},n.Yv=function(a){this.wb.lb(a)},n.Zj=function(){this.wb.clear()},n.Nh=function(){null===this.jh&&(this.jh=this.wb,this.wb=this.wb.copy())},n.sf=function(){if(null!==this.jh){for(var a=this.jh,b=this.wb,t=1/0,e=1/0,n=a.j,o=n.length,g=0;g<o;g++){var r=n[g];t=Math.min(r.x,t),e=Math.min(r.y,e)}r=g=1/0;for(var h=b.j,l=h.length,c=0;c<l;c++){var f=h[c];g=Math.min(f.x,g),r=Math.min(f.y,r),f.freeze()}if(b.freeze(),l===o){for(o=0;o<l;o++)if(c=n[o],f=h[o],c.x-t!=f.x-g||c.y-e!=f.y-r){this.o(),this.cc();break}}else this.o(),this.cc();this.jh=null,null!==(t=this.diagram)&&t.animationManager.qc&&(this.oh=b),Qu(this),this.g("points",a,b)}},n.ey=function(){null!==this.jh&&(this.wb=this.jh,this.jh=null)},n.Ta=function(){if(!this.suspendsRouting){var a=this.diagram;if(a){if(a.yt.contains(this)||a.undoManager.isUndoingRedoing)return;if((a=a.animationManager).isTicking&&!a.isAnimating)return;null!==this.oh&&!a.isTicking&&a.isAnimating&&(this.oh=null)}null!==(a=this.path)&&(this.ld=!1,this.o(),a.o())}},n.hj=function(){if(!this.ld&&!this.kv){var a=!0;try{this.kv=!0,this.Nh(),a=this.computePoints()}finally{this.kv=!1,a?this.sf():this.ey()}}},Wu.prototype.computePoints=function(){var a=this.diagram;if(null===a)return!1;var b=this.fromNode,t=null;if(null===b?(a.mh||(a.Fl=new rl,a.Fl.desiredSize=It,a.Fl.strokeWidth=0,a.mh=new Au,a.mh.add(a.Fl),a.mh.yb()),this.defaultFromPoint&&(a.mh.position=a.mh.location=this.defaultFromPoint,a.mh.yb(),b=a.mh,t=a.Fl)):t=this.fromPort,null!==t&&!b.isVisible()){var e=b.findVisibleNode();null!==e&&e!==b?(b=e,t=e.port):b=e}if(this.lx=b,null===b||!b.location.u())return!1;for(;!(null===t||t.actualBounds.u()&&t.zf());)t=t.panel;if(null===t)return!1;var n=this.toNode,o=null;if(null===n?(a.nh||(a.Gl=new rl,a.Gl.desiredSize=It,a.Gl.strokeWidth=0,a.nh=new Au,a.nh.add(a.Gl),a.nh.yb()),this.defaultToPoint&&(a.nh.position=a.nh.location=this.defaultToPoint,a.nh.yb(),n=a.nh,o=a.Gl)):o=this.toPort,null===o||n.isVisible()||(null!==(a=n.findVisibleNode())&&a!==n?(n=a,o=a.port):n=a),this.mx=n,null===n||!n.location.u())return!1;for(;!(null===o||o.actualBounds.u()&&o.zf());)o=o.panel;if(null===o)return!1;var g=this.pointsCount;e=this.computeSpot(!0,t),a=this.computeSpot(!1,o);var r=ic(e),h=ic(a),l=t===o&&null!==t,c=this.isOrthogonal,f=this.curve===vc;this.Tf=!(!l||c)&&(f=!0);var p=this.computeAdjusting()===mc||l;if(!c&&!l&&r&&h){if(r=!1,!p&&3<=g&&(p=this.getLinkPoint(b,t,e,!0,!1,n,o),h=this.getLinkPoint(n,o,a,!1,!1,b,t),r=this.adjustPoints(0,p,g-1,h))&&(p=this.getLinkPoint(b,t,e,!0,!1,n,o),h=this.getLinkPoint(n,o,a,!1,!1,b,t),this.adjustPoints(0,p,g-1,h)),!r)if(this.Zj(),f){g=this.getLinkPoint(b,t,e,!0,!1,n,o),r=(p=this.getLinkPoint(n,o,a,!1,!1,b,t)).x-g.x,h=p.y-g.y,l=this.computeCurviness(),f=c=0;var d=g.x+r/3,q=g.y+h/3,u=d,y=q;ne.A(h,0)?y=0<r?y-l:y+l:(c=-r/h,f=Math.sqrt(l*l/(c*c+1)),0>l&&(f=-f),y=c*((u=(0>h?-1:1)*f+d)-d)+q);var m=d=g.x+2*r/3,v=q=g.y+2*h/3;ne.A(h,0)?v=0<r?v-l:v+l:v=c*((m=(0>h?-1:1)*f+d)-d)+q,this.Zj(),this.ye(g),this.rf(u,y),this.rf(m,v),this.ye(p),this.jd(0,this.getLinkPoint(b,t,e,!0,!1,n,o)),this.jd(3,this.getLinkPoint(n,o,a,!1,!1,b,t))}else e=this.getLinkPoint(b,t,e,!0,!1,n,o),a=this.getLinkPoint(n,o,a,!1,!1,b,t),this.hasCurviness()?(p=a.x-e.x,n=a.y-e.y,o=this.computeCurviness(),g=b=e.x+p/2,r=t=e.y+n/2,ne.A(n,0)?r=0<p?r-o:r+o:(p=-p/n,g=Math.sqrt(o*o/(p*p+1)),0>o&&(g=-g),r=p*((g=(0>n?-1:1)*g+b)-b)+t),this.ye(e),this.rf(g,r)):this.ye(e),this.ye(a)}else{f=this.isAvoiding,p&&(c&&f||l)&&this.Zj();var x=l?this.computeCurviness():0;f=this.getLinkPoint(b,t,e,!0,c,n,o),d=u=q=0,(c||!r||l)&&(y=this.computeEndSegmentLength(b,t,e,!0),d=this.getLinkDirection(b,t,f,e,!0,c,n,o),l&&(r||e.w(a)||!c&&1===e.x+a.x&&1===e.y+a.y)&&(d-=c?90:30,0>x&&(d-=180)),0>d?d+=360:360<=d&&(d-=360),l&&(y+=Math.abs(x)*(c?1:2)),0===d?q=y:90===d?u=y:180===d?q=-y:270===d?u=-y:(q=y*Math.cos(d*Math.PI/180),u=y*Math.sin(d*Math.PI/180)),e.jc()&&l&&(y=t.ga(xi,Mt.alloc()),m=Mt.allocAt(y.x+1e3*q,y.y+1e3*u),this.getLinkPointFromPoint(b,t,y,m,!0,f),Mt.free(y),Mt.free(m))),y=this.getLinkPoint(n,o,a,!1,c,b,t);var w=v=m=0;if(c||!h||l){var k=this.computeEndSegmentLength(n,o,a,!1);w=this.getLinkDirection(n,o,y,a,!1,c,b,t),l&&(h||e.w(a)||!c&&1===e.x+a.x&&1===e.y+a.y)&&(w+=c?0:30,0>x&&(w+=180)),0>w?w+=360:360<=w&&(w-=360),l&&(k+=Math.abs(x)*(c?1:2)),0===w?m=k:90===w?v=k:180===w?m=-k:270===w?v=-k:(m=k*Math.cos(w*Math.PI/180),v=k*Math.sin(w*Math.PI/180)),a.jc()&&l&&(a=o.ga(xi,Mt.alloc()),e=Mt.allocAt(a.x+1e3*m,a.y+1e3*v),this.getLinkPointFromPoint(n,o,a,e,!1,y),Mt.free(a),Mt.free(e))}a=f,(c||!r||l)&&(a=new Mt(f.x+q,f.y+u)),e=y,(c||!h||l)&&(e=new Mt(y.x+m,y.y+v)),!p&&!c&&r&&3<g&&this.adjustPoints(0,f,g-2,e)?this.jd(g-1,y):!p&&!c&&h&&3<g&&this.adjustPoints(1,a,g-1,y)?this.jd(0,f):!p&&(c?6<=g:4<g)&&this.adjustPoints(1,a,g-2,e)?(this.jd(0,f),this.jd(g-1,y)):(this.Zj(),this.ye(f),(c||!r||l)&&this.ye(a),c&&this.addOrthoPoints(a,d,e,w,b,n),(c||!h||l)&&this.ye(e),this.ye(y))}return!0},Wu.prototype.getLinkPointFromPoint=function(a,b,t,e,n,o){if(void 0===o&&(o=new Mt),null===a||null===b)return o.assign(t),o;if(a.isVisible()||null!==(n=a.findVisibleNode())&&n!==a&&(b=n.port),a=null,null===(n=b.panel)||n.ae()||(n=n.panel),null===n){n=e.x,e=e.y;var g=t.x;t=t.y}else{n=1/((a=n.vd).m11*a.m22-a.m12*a.m21),g=a.m22*n;var r=-a.m12*n,h=-a.m21*n,l=a.m11*n,c=n*(a.m21*a.dy-a.m22*a.dx),f=n*(a.m12*a.dx-a.m11*a.dy);n=e.x*g+e.y*h+c,e=e.x*r+e.y*l+f,g=t.x*g+t.y*h+c,t=t.x*r+t.y*l+f}return b.hk(n,e,g,t,o),null!==a&&o.transform(a),o},Wu.prototype.getLinkPoint=function(a,b,t,e,n,o,g,r){if(void 0===r&&(r=new Mt),t.eb()&&!ic(t))return b.ga(t,r),r;if(t.gd()){var h=tc(this,b);if(null!==h){if(r.assign(h.wq),n&&this.routing===yc){var l=tc(this,g);if(null!==l&&h.em<l.em){h=Mt.alloc(),l=Mt.alloc();var c=new Wt(b.ga(gi,h),b.ga(Mi,l)),f=this.computeSpot(!e,g);a=this.getLinkPoint(o,g,f,!e,n,a,b,l),(t.xf(Pi)||t.xf(Ni))&&a.y>=c.y&&a.y<=c.y+c.height?r.y=a.y:(t.xf(Si)||t.xf(Ci))&&a.x>=c.x&&a.x<=c.x+c.width&&(r.x=a.x),Mt.free(h),Mt.free(l)}}return r}}return t=b.ga(.5===t.x&&.5===t.y?t:xi,Mt.alloc()),this.pointsCount>(n?6:2)?(g=e?this.i(1):this.i(this.pointsCount-2),n&&(g=_u(t,g.copy()))):(h=this.computeSpot(!e,g),o=Mt.alloc(),g=g.ga(.5===h.x&&.5===h.y?h:xi,o),n&&(g=_u(t,g)),Mt.free(o)),this.getLinkPointFromPoint(a,b,t,g,e,r),Mt.free(t),r},Wu.prototype.getLinkDirection=function(a,b,t,e,n,o,g,r){t:if(e.eb())var h=e.x>e.y?e.x>1-e.y?0:e.x<1-e.y?270:315:e.x<e.y?e.x>1-e.y?90:e.x<1-e.y?180:135:.5>e.x?225:.5<e.x?45:0;else{if(e.gd()&&null!==(h=tc(this,b)))switch(h.yc){case 1:h=270;break t;case 2:h=180;break t;default:case 4:h=0;break t;case 8:h=90;break t}h=b.ga(xi,Mt.alloc()),this.pointsCount>(o?6:2)?(r=n?this.i(1):this.i(this.pointsCount-2),r=o?_u(h,r.copy()):t):(t=Mt.alloc(),r=r.ga(xi,t),Mt.free(t)),t=Math.abs(r.x-h.x)>Math.abs(r.y-h.y)?r.x>=h.x?0:180:r.y>=h.y?90:270,Mt.free(h),h=t}return e.jc()&&g.Xd(a)&&(360<=(h+=180)&&(h-=360)),ic(e)||0===(a=b.Xi())||(45<=a&&135>a?h+=90:135<=a&&225>a?h+=180:225<=a&&315>a&&(h+=270),360<=h&&(h-=360)),h},Wu.prototype.computeEndSegmentLength=function(a,b,t,e){return null!==b&&t.gd()&&null!==(a=tc(this,b))?a.pv:(a=e?this.fromEndSegmentLength:this.toEndSegmentLength,null!==b&&isNaN(a)&&(a=e?b.fromEndSegmentLength:b.toEndSegmentLength),isNaN(a)&&(a=10),a)},Wu.prototype.computeSpot=function(a,b){return void 0===b&&(b=null),a?null===(a=b||this.fromPort)?a=xi:((b=this.fromSpot).Mb()&&(b=a.fromSpot),a=b===zi?pi:b):null===(a=b||this.toPort)?a=xi:((b=this.toSpot).Mb()&&(b=a.toSpot),a=b===zi?pi:b),a},Wu.prototype.computeOtherPoint=function(a,b){return this.computeAdjusting()!==mc&&4<this.pointsCount?this.computeMidPoint(new Mt):(a=b.ga(xi),null!==(b=null!==(b=b.ep)?rp(b,this):null)&&(a=b.wq),a)},Wu.prototype.computeShortLength=function(a){if(a){if(a=this.fromShortLength,isNaN(a)){var b=this.fromPort;null!==b&&(a=b.fromShortLength)}return isNaN(a)?0:a}return a=this.toShortLength,isNaN(a)&&(null!==(b=this.toPort)&&(a=b.toShortLength)),isNaN(a)?0:a},Wu.prototype.uf=function(a,b,t,e,n,o){if(!1===this.pickable)return!1;void 0===b&&(b=null),void 0===t&&(t=null);var g=o;if(void 0===o&&(g=ie.alloc()).reset(),g.multiply(this.transform),this.Gh(a,g))return zh(this,b,t,n),void 0===o&&ie.free(g),!0;if(this.Gc(a,g)){var r=!1;if(!this.isAtomic)for(var h=this.W.j,l=h.length;l--;){var c=h[l];if(c.visible||c===this.locationObject){var f=c.actualBounds,p=this.naturalBounds;if(!(f.x>p.width||f.y>p.height||0>f.x+f.width||0>f.y+f.height)){if((f=ie.alloc()).set(g),c instanceof jh)r=c.uf(a,b,t,e,n,f);else if(this.path===c){if(c instanceof rl)if(r=a,p=e,!1===c.pickable)r=!1;else if(f.multiply(c.transform),p)t:{var d=r,q=f;if(c.Gh(d,q))r=!0;else{if(void 0===q&&(q=c.transform,d.Ae(c.actualBounds))){r=!0;break t}r=d.left,p=d.right;var u=d.top;d=d.bottom;var y=Mt.alloc(),m=Mt.alloc(),v=Mt.alloc(),x=ie.alloc();x.set(q),x.Mv(c.transform),x.tt(),m.x=p,m.y=u,m.transform(x),y.x=r,y.y=u,y.transform(x),q=!1,cl(c,y,m,v)?q=!0:(y.x=p,y.y=d,y.transform(x),cl(c,y,m,v)?q=!0:(m.x=r,m.y=d,m.transform(x),cl(c,y,m,v)?q=!0:(y.x=r,y.y=u,y.transform(x),cl(c,y,m,v)&&(q=!0)))),ie.free(x),Mt.free(y),Mt.free(m),Mt.free(v),r=q}}else r=c.Gh(r,f)}else r=ea(c,a,e,f);r&&(p=c,null!==b&&(p=b(c)),p&&(null===t||t(p))&&n.add(p)),ie.free(f)}}}return void 0===o&&ie.free(g),r||null!==this.background||null!==this.areaBackground}return void 0===o&&ie.free(g),!1},Wu.prototype.computeCurve=function(){if(null===this.Tf){var a=this.fromPort,b=this.isOrthogonal;this.Tf=null!==a&&a===this.toPort&&!b}return this.Tf?vc:this.curve},Wu.prototype.computeCorner=function(){if(this.curve===vc)return 0;var a=this.corner;return(isNaN(a)||0>a)&&(a=10),a},Wu.prototype.findMidLabel=function(){for(var a=this.path,b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e];if(n!==a&&!n.isPanelMain&&(-1/0===n.segmentIndex||isNaN(n.segmentIndex)))return n}for(a=this.labelNodes;a.next();)if(-1/0===(b=a.value).segmentIndex||isNaN(b.segmentIndex))return b;return null},Wu.prototype.computeSpacing=function(){if(!this.isVisible())return 0;var a=Math.max(14,this.computeThickness()),b=this.fromPort,t=this.toPort;if(null!==b&&null!==t){var e=this.findMidLabel();if(null!==e){var n=e.naturalBounds,o=e.margin,g=isNaN(n.width)?30:n.width*e.scale+o.left+o.right;n=isNaN(n.height)?14:n.height*e.scale+o.top+o.bottom,(e=e.segmentOrientation)===Sc||e===Tc||e===Cc?a=Math.max(a,n):e===Nc||e===Ac||e===Pc||e===Lc?a=Math.max(a,g):(b=b.ga(xi).Sa(t.ga(xi))/180*Math.PI,a=Math.max(a,Math.abs(Math.sin(b)*g)+Math.abs(Math.cos(b)*n)+1)),this.curve===vc&&(a*=1.333)}}return a},Wu.prototype.arrangeBundledLinks=function(a,b){if(b)for(b=0;b<a.length;b++){var t=a[b];t.computeAdjusting()===mc&&t.Ta()}},Wu.prototype.computeCurviness=function(){var a=this.curviness;if(isNaN(a)){a=16;var b=this.Kf;if(null!==b){for(var t=I(),e=0,n=b.links,o=0;o<n.length;o++){var g=n[o].computeSpacing();t.push(g),e+=g}for(e=-e/2,o=0;o<n.length;o++){if(n[o]===this){a=e+t[o]/2;break}e+=t[o]}b.Bt===this.fromNode&&(a=-a),R(t)}}return a},Wu.prototype.computeThickness=function(){if(!this.isVisible())return 0;var a=this.path;return null!==a?Math.max(a.strokeWidth,1):1},Wu.prototype.hasCurviness=function(){return!isNaN(this.curviness)||null!==this.Kf},Wu.prototype.adjustPoints=function(a,b,t,e){var n=this.computeAdjusting();if(this.isOrthogonal){if(n===kc)return!1;n===Mc&&(n=wc)}switch(n){case kc:var o=this.i(a),g=this.i(t);if(!o.Ma(b)||!g.Ma(e)){n=o.x,o=o.y;var r=g.x-n,h=g.y-o,l=Math.sqrt(r*r+h*h);if(!ne.$(l,0)){if(ne.$(r,0))var c=0>h?-Math.PI/2:Math.PI/2;else c=Math.atan(h/Math.abs(r)),0>r&&(c=Math.PI-c);g=b.x;var f=b.y;r=e.x-g;var p=e.y-f;for(h=Math.sqrt(r*r+p*p),ne.$(r,0)?p=0>p?-Math.PI/2:Math.PI/2:(p=Math.atan(p/Math.abs(r)),0>r&&(p=Math.PI-p)),l=h/l,c=p-c,this.jd(a,b),a+=1;a<t;a++)r=(b=this.i(a)).x-n,h=b.y-o,b=Math.sqrt(r*r+h*h),ne.$(b,0)||(ne.$(r,0)?h=0>h?-Math.PI/2:Math.PI/2:(h=Math.atan(h/Math.abs(r)),0>r&&(h=Math.PI-h)),r=h+c,b*=l,this.K(a,g+b*Math.cos(r),f+b*Math.sin(r)));this.jd(t,e)}}return!0;case Mc:if(o=this.i(a),f=this.i(t),!o.Ma(b)||!f.Ma(e)){n=o.x,o=o.y,l=((g=f.x)-n)*(g-n)+((f=f.y)-o)*(f-o),r=b.x,c=b.y,h=e.x,p=e.y;var d=1;if(0!=h-r){var q=(p-c)/(h-r);d=Math.sqrt(1+1/(q*q))}else q=9e9;for(this.jd(a,b),a+=1;a<t;a++){var u=(b=this.i(a)).x,y=b.y,m=.5;0!==l&&(m=((n-u)*(n-g)+(o-y)*(o-f))/l);var v=n+m*(g-n),x=o+m*(f-o);b=Math.sqrt((u-v)*(u-v)+(y-x)*(y-x)),y<q*(u-v)+x&&(b=-b),0<q&&(b=-b),u=r+m*(h-r),m=c+m*(p-c),0!==q?(b=u+b/d,this.K(a,b,m-(b-u)/q)):this.K(a,u,m+b)}this.jd(t,e)}return!0;case wc:return this.isOrthogonal&&(n=this.i(a),o=this.i(a+1),g=this.i(a+2),f=r=o.x,l=c=o.y,ne.A(n.y,o.y)?ne.A(o.x,g.x)?c=b.y:ne.A(o.y,g.y)&&(r=b.x):ne.A(n.x,o.x)&&(ne.A(o.y,g.y)?r=b.x:ne.A(o.x,g.x)&&(c=b.y)),this.K(a+1,r,c),n=this.i(t),o=this.i(t-1),g=this.i(t-2),h=r=o.x,p=c=o.y,ne.A(n.y,o.y)?ne.A(o.x,g.x)?c=e.y:ne.A(o.y,g.y)&&(r=e.x):ne.A(n.x,o.x)&&(ne.A(o.y,g.y)?r=e.x:ne.A(o.x,g.x)&&(c=e.y)),this.K(t-1,r,c),ec(this))?(this.K(a+1,f,l),this.K(t-1,h,p),t=!1):(this.jd(a,b),this.jd(t,e),t=!0),t;default:return!1}},Wu.prototype.addOrthoPoints=function(a,b,t,e,n,o){b=-45<=b&&45>b?0:45<=b&&135>b?90:135<=b&&225>b?180:270,e=-45<=e&&45>e?0:45<=e&&135>e?90:135<=e&&225>e?180:270;var g=n.actualBounds.copy(),r=o.actualBounds.copy();if(g.u()&&r.u()){if(g.Vc(8,8),r.Vc(8,8),g.Ie(a),r.Ie(t),0===b)if(t.x>a.x||270===e&&t.y<a.y&&r.right>a.x||90===e&&t.y>a.y&&r.right>a.x){var h=new Mt(t.x,a.y),l=new Mt(t.x,(a.y+t.y)/2);180===e?(h.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1),l.x=h.x,l.y=t.y):270===e&&t.y<a.y||90===e&&t.y>a.y?(h.x=a.x<r.left?this.computeMidOrthoPosition(a.x,a.y,r.left,t.y,!1):a.x<r.right&&(270===e&&a.y<r.top||90===e&&a.y>r.bottom)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):r.right,l.x=h.x,l.y=t.y):0===e&&a.x<r.left&&a.y>r.top&&a.y<r.bottom&&(h.x=a.x,h.y=a.y<t.y?Math.min(t.y,r.top):Math.max(t.y,r.bottom),l.y=h.y)}else h=new Mt(a.x,t.y),l=new Mt((a.x+t.x)/2,t.y),(180===e||90===e&&t.y<g.top||270===e&&t.y>g.bottom)&&(180===e&&(r.aa(a)||g.aa(t))?h.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):t.y<a.y&&(180===e||90===e)?h.y=this.computeMidOrthoPosition(a.x,g.top,t.x,Math.max(t.y,r.bottom),!0):t.y>a.y&&(180===e||270===e)&&(h.y=this.computeMidOrthoPosition(a.x,g.bottom,t.x,Math.min(t.y,r.top),!0)),l.x=t.x,l.y=h.y),h.y>g.top&&h.y<g.bottom&&(t.x>=g.left&&t.x<=a.x||a.x<=r.right&&a.x>=t.x?90!==e&&270!==e||(h=new Mt(Math.max((a.x+t.x)/2,a.x),a.y),l=new Mt(h.x,t.y)):(h.y=270===e||(0===e||180===e)&&t.y<a.y?Math.min(t.y,0===e?g.top:Math.min(g.top,r.top)):Math.max(t.y,0===e?g.bottom:Math.max(g.bottom,r.bottom)),l.x=t.x,l.y=h.y));else 180===b?t.x<a.x||270===e&&t.y<a.y&&r.left<a.x||90===e&&t.y>a.y&&r.left<a.x?(h=new Mt(t.x,a.y),l=new Mt(t.x,(a.y+t.y)/2),0===e?(h.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1),l.x=h.x,l.y=t.y):270===e&&t.y<a.y||90===e&&t.y>a.y?(h.x=a.x>r.right?this.computeMidOrthoPosition(a.x,a.y,r.right,t.y,!1):a.x>r.left&&(270===e&&a.y<r.top||90===e&&a.y>r.bottom)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):r.left,l.x=h.x,l.y=t.y):180===e&&a.x>r.right&&a.y>r.top&&a.y<r.bottom&&(h.x=a.x,h.y=a.y<t.y?Math.min(t.y,r.top):Math.max(t.y,r.bottom),l.y=h.y)):(h=new Mt(a.x,t.y),l=new Mt((a.x+t.x)/2,t.y),(0===e||90===e&&t.y<g.top||270===e&&t.y>g.bottom)&&(0===e&&(r.aa(a)||g.aa(t))?h.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):t.y<a.y&&(0===e||90===e)?h.y=this.computeMidOrthoPosition(a.x,g.top,t.x,Math.max(t.y,r.bottom),!0):t.y>a.y&&(0===e||270===e)&&(h.y=this.computeMidOrthoPosition(a.x,g.bottom,t.x,Math.min(t.y,r.top),!0)),l.x=t.x,l.y=h.y),h.y>g.top&&h.y<g.bottom&&(t.x<=g.right&&t.x>=a.x||a.x>=r.left&&a.x<=t.x?90!==e&&270!==e||(h=new Mt(Math.min((a.x+t.x)/2,a.x),a.y),l=new Mt(h.x,t.y)):(h.y=270===e||(0===e||180===e)&&t.y<a.y?Math.min(t.y,180===e?g.top:Math.min(g.top,r.top)):Math.max(t.y,180===e?g.bottom:Math.max(g.bottom,r.bottom)),l.x=t.x,l.y=h.y))):90===b?t.y>a.y||180===e&&t.x<a.x&&r.bottom>a.y||0===e&&t.x>a.x&&r.bottom>a.y?(h=new Mt(a.x,t.y),l=new Mt((a.x+t.x)/2,t.y),270===e?(h.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0),l.x=t.x,l.y=h.y):180===e&&t.x<a.x||0===e&&t.x>a.x?(h.y=a.y<r.top?this.computeMidOrthoPosition(a.x,a.y,t.x,r.top,!0):a.y<r.bottom&&(180===e&&a.x<r.left||0===e&&a.x>r.right)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):r.bottom,l.x=t.x,l.y=h.y):90===e&&a.y<r.top&&a.x>r.left&&a.x<r.right&&(h.x=a.x<t.x?Math.min(t.x,r.left):Math.max(t.x,r.right),h.y=a.y,l.x=h.x)):(h=new Mt(t.x,a.y),l=new Mt(t.x,(a.y+t.y)/2),(270===e||0===e&&t.x<g.left||180===e&&t.x>g.right)&&(270===e&&(r.aa(a)||g.aa(t))?h.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):t.x<a.x&&(270===e||0===e)?h.x=this.computeMidOrthoPosition(g.left,a.y,Math.max(t.x,r.right),t.y,!1):t.x>a.x&&(270===e||180===e)&&(h.x=this.computeMidOrthoPosition(g.right,a.y,Math.min(t.x,r.left),t.y,!1)),l.x=h.x,l.y=t.y),h.x>g.left&&h.x<g.right&&(t.y>=g.top&&t.y<=a.y||a.y<=r.bottom&&a.y>=t.y?0!==e&&180!==e||(h=new Mt(a.x,Math.max((a.y+t.y)/2,a.y)),l=new Mt(t.x,h.y)):(h.x=180===e||(90===e||270===e)&&t.x<a.x?Math.min(t.x,90===e?g.left:Math.min(g.left,r.left)):Math.max(t.x,90===e?g.right:Math.max(g.right,r.right)),l.x=h.x,l.y=t.y))):t.y<a.y||180===e&&t.x<a.x&&r.top<a.y||0===e&&t.x>a.x&&r.top<a.y?(h=new Mt(a.x,t.y),l=new Mt((a.x+t.x)/2,t.y),90===e?(h.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0),l.x=t.x,l.y=h.y):180===e&&t.x<a.x||0===e&&t.x>=a.x?(h.y=a.y>r.bottom?this.computeMidOrthoPosition(a.x,a.y,t.x,r.bottom,!0):a.y>r.top&&(180===e&&a.x<r.left||0===e&&a.x>r.right)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):r.top,l.x=t.x,l.y=h.y):270===e&&a.y>r.bottom&&a.x>r.left&&a.x<r.right&&(h.x=a.x<t.x?Math.min(t.x,r.left):Math.max(t.x,r.right),h.y=a.y,l.x=h.x)):(h=new Mt(t.x,a.y),l=new Mt(t.x,(a.y+t.y)/2),(90===e||0===e&&t.x<g.left||180===e&&t.x>g.right)&&(90===e&&(r.aa(a)||g.aa(t))?h.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):t.x<a.x&&(90===e||0===e)?h.x=this.computeMidOrthoPosition(g.left,a.y,Math.max(t.x,r.right),t.y,!1):t.x>a.x&&(90===e||180===e)&&(h.x=this.computeMidOrthoPosition(g.right,a.y,Math.min(t.x,r.left),t.y,!1)),l.x=h.x,l.y=t.y),h.x>g.left&&h.x<g.right&&(t.y<=g.bottom&&t.y>=a.y||a.y>=r.top&&a.y<=t.y?0!==e&&180!==e||(h=new Mt(a.x,Math.min((a.y+t.y)/2,a.y)),l=new Mt(t.x,h.y)):(h.x=180===e||(90===e||270===e)&&t.x<a.x?Math.min(t.x,270===e?g.left:Math.min(g.left,r.left)):Math.max(t.x,270===e?g.right:Math.max(g.right,r.right)),l.x=h.x,l.y=t.y)));var c=h,f=l,p=t;if(this.isAvoiding){var d=this.diagram;if(null===d||!Jr(d)||g.aa(p)&&!o.Xd(n)||r.aa(a)&&!n.Xd(o)||n===o||this.layer.isTemporary)b=!1;else{var q=Zr(d,!0,this.containingGroup,null);if(q.lk(Math.min(a.x,c.x),Math.min(a.y,c.y),Math.abs(a.x-c.x),Math.abs(a.y-c.y))&&q.lk(Math.min(c.x,f.x),Math.min(c.y,f.y),Math.abs(c.x-f.x),Math.abs(c.y-f.y))&&q.lk(Math.min(f.x,p.x),Math.min(f.y,p.y),Math.abs(f.x-p.x),Math.abs(f.y-p.y)))b=!1;else{n=a,o=p;var u=t=null;if(d.isVirtualized){(d=q.bounds.copy()).Vc(-q.dm,-q.cm);var y=Mt.alloc();Oc(q,a.x,a.y)||(ne.Uc(d.x,d.y,d.x+d.width,d.y+d.height,a.x,a.y,c.x,c.y,y)?(t=a=y.copy(),b=y.Sa(c)):ne.Uc(d.x,d.y,d.x+d.width,d.y+d.height,c.x,c.y,f.x,f.y,y)?(t=a=y.copy(),b=y.Sa(f)):ne.Uc(d.x,d.y,d.x+d.width,d.y+d.height,f.x,f.y,p.x,p.y,y)&&(t=a=y.copy(),b=y.Sa(p))),Oc(q,p.x,p.y)||(ne.Uc(d.x,d.y,d.x+d.width,d.y+d.height,p.x,p.y,f.x,f.y,y)?(u=p=y.copy(),e=f.Sa(y)):ne.Uc(d.x,d.y,d.x+d.width,d.y+d.height,f.x,f.y,c.x,c.y,y)?(u=p=y.copy(),e=c.Sa(y)):ne.Uc(d.x,d.y,d.x+d.width,d.y+d.height,c.x,c.y,a.x,a.y,y)&&(u=p=y.copy(),e=a.Sa(y))),Mt.free(y)}g=g.copy().Hc(r),r=q.vA,g.Vc(q.dm*r,q.cm*r),Yc(q,a,b,p,e,g),r=Bc(q,p.x,p.y),!q.abort&&r>=qc&&(Rc(q),r=q.$z,g.Vc(q.dm*r,q.cm*r),Yc(q,a,b,p,e,g),r=Bc(q,p.x,p.y)),!q.abort&&r>=qc&&q.CA&&(Rc(q),Yc(q,a,b,p,e,q.bounds),r=Bc(q,p.x,p.y)),!q.abort&&r<qc&&Bc(q,p.x,p.y)!==Gc?(!function t(a,b,e,n,o,r){var g=b.dm,h=b.cm,l=Bc(b,e,n),c=e,f=n;for(0===o?c+=g:90===o?f+=h:180===o?c-=g:f-=h;l>Xc&&Bc(b,c,f)===l-1;)e=c,n=f,0===o?c+=g:90===o?f+=h:180===o?c-=g:f-=h,--l;r?l>Xc&&(180===o||0===o?e=Math.floor(e/g)*g+g/2:90!==o&&270!==o||(n=Math.floor(n/h)*h+h/2)):(e=Math.floor(e/g)*g+g/2,n=Math.floor(n/h)*h+h/2);l>Xc&&(r=o,c=e,f=n,0===o?(r=90,f+=h):90===o?(r=180,c-=g):180===o?(r=270,f-=h):270===o&&(r=0,c+=g),Bc(b,c,f)===l-1?t(a,b,c,f,r,!1):(c=e,f=n,0===o?(r=270,f-=h):90===o?(r=0,c+=g):180===o?(r=90,f+=h):270===o&&(r=180,c-=g),Bc(b,c,f)===l-1&&t(a,b,c,f,r,!1))),a.rf(e,n)}(this,q,p.x,p.y,e,!0),g=this.i(2),4>this.pointsCount?(0===b||180===b?(g.x=a.x,g.y=p.y):(g.x=p.x,g.y=a.y),this.K(2,g.x,g.y),this.m(3,g.x,g.y)):(p=this.i(3),0===b||180===b?ne.A(g.x,p.x)?(g=0===b?Math.max(g.x,a.x):Math.min(g.x,a.x),this.K(2,g,a.y),this.K(3,g,p.y)):ne.A(g.y,p.y)?(Math.abs(a.y-g.y)<=q.cm/2&&(this.K(2,g.x,a.y),this.K(3,p.x,a.y)),this.m(2,g.x,a.y)):this.K(2,a.x,g.y):90!==b&&270!==b||(ne.A(g.y,p.y)?(g=90===b?Math.max(g.y,a.y):Math.min(g.y,a.y),this.K(2,a.x,g),this.K(3,p.x,g)):ne.A(g.x,p.x)?(Math.abs(a.x-g.x)<=q.dm/2&&(this.K(2,a.x,g.y),this.K(3,a.x,p.y)),this.m(2,a.x,g.y)):this.K(2,g.x,a.y))),null!==t&&(a=this.i(1),p=this.i(2),a.x!==p.x&&a.y!==p.y?0===b||180===b?this.m(2,a.x,p.y):this.m(2,p.x,a.y):0===b||180===b?this.m(2,n.x,t.y):this.m(2,t.x,n.y)),null!==u&&(0===e||180===e?this.rf(o.x,u.y):this.rf(u.x,o.y)),b=!0):b=!1}}}else b=!1;b||(this.ye(h),this.ye(l))}},Wu.prototype.computeMidOrthoPosition=function(a,b,t,e,n){var o=0;return this.hasCurviness()&&(o=this.computeCurviness()),n?(b+e)/2+o:(a+t)/2+o},Wu.prototype.gz=function(a){var b=a.x;a=a.y;for(var t=this.i(0),e=this.i(1),n=Tt(b,a,t.x,t.y,e.x,e.y),o=0,g=1;g<this.pointsCount-1;g++){t=this.i(g+1);var r=Tt(b,a,e.x,e.y,t.x,t.y);e=t,r<n&&(o=g,n=r)}return o},Wu.prototype.cc=function(){this.Yn=!0},Wu.prototype.nk=function(a){if(!a){if(!1===this.ld)return;if(a=this.zb(),!this.Yn&&(null===a||null!==a.geometry))return}if(this.ka=this.makeGeometry(),null!==(a=this.path)){a.ka=this.ka;for(var b=this.W.j,t=b.length,e=0;e<t;e++){var n=b[e];n!==a&&n.isPanelMain&&n instanceof rl&&(n.ka=this.ka)}}},Wu.prototype.makeGeometry=function(){var a=this.ka,b=this.pointsCount;if(2>b)return a.type=ge,this.Yn=!1,a;var t=!1,e=this.diagram;null!==e&&hc(this)&&e.Sg.contains(this)&&(0!==this.El.width||0!==this.El.height)&&(t=!0);var n=this.i(0).copy(),o=n.copy();e=this.wb.j;var g=this.computeCurve();if(g===vc&&3<=b&&!ne.$(this.smoothness,0))if(3===b){var r=this.i(1);e=Math.min(n.x,r.x);var h=Math.min(n.y,r.y);r=this.i(2),e=Math.min(e,r.x),h=Math.min(h,r.y)}else{if(this.isOrthogonal)for(h=0;h<b;h++)r=e[h],o.x=Math.min(r.x,o.x),o.y=Math.min(r.y,o.y);else for(e=3;e<b;e+=3)e+3>=b&&(e=b-1),h=this.i(e),o.x=Math.min(h.x,o.x),o.y=Math.min(h.y,o.y);e=o.x,h=o.y}else{for(h=0;h<b;h++)r=e[h],o.x=Math.min(r.x,o.x),o.y=Math.min(r.y,o.y);e=o.x,h=o.y}if(e-=this.Wu.x,h-=this.Wu.y,n.x-=e,n.y-=h,2!==b||hc(this)){if(a.type=td,r=su(a),0!==this.computeShortLength(!0)&&(n=oc(this,n,!0,o)),iu(r,n.x,n.y,!1),g===vc&&3<=b&&!ne.$(this.smoothness,0))if(3===b)b=(t=this.i(1)).x-e,t=t.y-h,(n=this.i(2).copy()).x-=e,n.y-=h,0!==this.computeShortLength(!1)&&(n=oc(this,n,!1,o)),nu(r,b,t,b,t,n.x,n.y);else if(this.isOrthogonal){o=new Mt(e,h),n=this.i(1).copy(),g=new Mt(e,h),b=new Mt(e,h),t=this.i(0);for(var l,c=this.smoothness/3,f=1;f<this.pointsCount-1;f++){var p=t,d=l=this.i(f),q=this.i(rc(this,l,f,!1));if(!(ne.$(p.x,d.x)&&ne.$(d.x,q.x)||ne.$(p.y,d.y)&&ne.$(d.y,q.y))){var u=c;isNaN(u)&&(u=this.smoothness/3);var y=p.x;p=p.y;var m=d.x;d=d.y;var v=q.x;q=q.y;var x=u*nc(y,p,m,d);u*=nc(m,d,v,q),ne.$(p,d)&&ne.$(m,v)&&(m>y?q>d?(g.x=m-x,g.y=d-x,b.x=m+u,b.y=d+u):(g.x=m-x,g.y=d+x,b.x=m+u,b.y=d-u):q>d?(g.x=m+x,g.y=d-x,b.x=m-u,b.y=d+u):(g.x=m+x,g.y=d+x,b.x=m-u,b.y=d-u)),ne.$(y,m)&&ne.$(d,q)&&(d>p?(v>m?(g.x=m-x,g.y=d-x,b.x=m+u):(g.x=m+x,g.y=d-x,b.x=m-u),b.y=d+u):(v>m?(g.x=m-x,g.y=d+x,b.x=m+u):(g.x=m+x,g.y=d+x,b.x=m-u),b.y=d-u)),(ne.$(y,m)&&ne.$(m,v)||ne.$(p,d)&&ne.$(d,q))&&(y=.5*(y+v),p=.5*(p+q),g.x=y,g.y=p,b.x=y,b.y=p),(1===f||2===f&&ne.$(t.x,this.i(0).x)&&ne.$(t.y,this.i(0).y))&&(n.x=.5*(t.x+l.x),n.y=.5*(t.y+l.y)),nu(r,n.x-e,n.y-h,g.x-e,g.y-h,l.x-e,l.y-h),o.set(g),n.set(b),t=l}}o=t.x,t=t.y,n=this.i(this.pointsCount-1),0!==this.computeShortLength(!1)&&(n=oc(this,n.copy(),!1,jt)),o=.5*(o+n.x),t=.5*(t+n.y),nu(r,b.x-e,b.y-h,o-e,t-h,n.x-e,n.y-h)}else for(t=3;t<b;t+=3)o=this.i(t-2),t+3>=b&&(t=b-1),n=this.i(t-1),g=this.i(t),t===b-1&&0!==this.computeShortLength(!1)&&(g=oc(this,g.copy(),!1,jt)),nu(r,o.x-e,o.y-h,n.x-e,n.y-h,g.x-e,g.y-h);else{for((o=Mt.alloc()).assign(this.i(0)),(n=Mt.alloc()).assign(o),g=this.computeCorner(),f=1,l=0;f<b;){if(f=rc(this,o,f,1<f),c=this.i(f),f>=b-1){if(o.w(c)){if(0===l)for(f=1;f<b;)n.assign(o),sc(this,r,-e,-h,o,c=this.i(f++),t),o.assign(c)}else 0!==this.computeShortLength(!1)&&(c=oc(this,c.copy(),!1,jt)),sc(this,r,-e,-h,o,c,t);break}if(l=rc(this,c,f+1,f<b-3),f=-e,y=-h,p=c,u=this.i(l),m=t,ne.A(o.y,p.y)&&ne.A(p.x,u.x))if(d=Math.min(g,Math.abs(p.x-n.x)/2),d=v=Math.min(d,Math.abs(u.y-p.y)/2),ne.A(d,0))sc(this,r,f,y,o,p,m),o.assign(p);else{var w=q=p.x,k=x=p.y;q=p.x>o.x?p.x-d:p.x+d,k=u.y>p.y?p.y+v:p.y-v,sc(this,r,f,y,o,new Mt(q,x),m),ou(r,p.x+f,p.y+y,w+f,k+y),o.h(w,k)}else ne.A(o.x,p.x)&&ne.A(p.y,u.y)?(d=Math.min(g,Math.abs(p.y-n.y)/2),d=v=Math.min(d,Math.abs(u.x-p.x)/2),ne.A(v,0)?(sc(this,r,f,y,o,p,m),o.assign(p)):(w=q=p.x,k=x=p.y,x=p.y>o.y?p.y-d:p.y+d,w=u.x>p.x?p.x+v:p.x-v,sc(this,r,f,y,o,new Mt(q,x),m),ou(r,p.x+f,p.y+y,w+f,k+y),o.h(w,k))):(sc(this,r,f,y,o,p,m),o.assign(p));n.assign(c),f=l}Mt.free(o)}au=r}else(r=this.i(1).copy()).x-=e,r.y-=h,0!==this.computeShortLength(!0)&&(n=oc(this,n,!0,o)),0!==this.computeShortLength(!1)&&(r=oc(this,r,!1,o)),a.type=ge,a.startX=n.x,a.startY=n.y,a.endX=r.x,a.endY=r.y;return this.Yn=!1,a},Wu.prototype.tq=function(a){var b=this.layer;if(null!==b&&b.visible&&!b.isTemporary){var t=b.diagram;if(null!==t&&!t.animationManager.isAnimating){var e=!1;for(t=t.layers;t.next();){var n=t.value;if(n.visible)if(n===b){e=!0;for(var o=!1,g=(n=n.Ca.j).length,r=0;r<g;r++){var h=n[r];h instanceof Wu&&(h===this?o=!0:o&&uc(this,h,a))}}else if(e)for(n=(o=n.Ca.j).length,g=0;g<n;g++)(r=o[g])instanceof Wu&&uc(this,r,a)}}}},Wu.prototype.usesSamePort=function(a){var b=this.pointsCount,t=a.pointsCount;if(0<b&&0<t){var e=this.i(0),n=a.i(0);if(e.Ma(n))return!0;if(b=this.i(b-1),a=a.i(t-1),b.Ma(a)||e.Ma(a)||b.Ma(n))return!0}else if(this.fromNode===a.fromNode||this.toNode===a.toNode||this.fromNode===a.toNode||this.toNode===a.fromNode)return!0;return!1},Wu.prototype.isVisible=function(){if(!lu.prototype.isVisible.call(this))return!1;var a=this.containingGroup,b=!0,t=this.diagram;if(null!==t&&(b=t.isTreePathToChildren),null!==(t=this.fromNode)){if(this.isTreeLink&&b&&!t.isTreeExpanded)return!1;if(t===a)return!0;for(var e=t;null!==e;){if(e.labeledLink===this)return!0;e=e.containingGroup}if(null===(t=t.findVisibleNode())||t===a)return!1}if(null!==(t=this.toNode)){if(this.isTreeLink&&!b&&!t.isTreeExpanded)return!1;if(t===a)return!0;for(b=t;null!==b;){if(b.labeledLink===this)return!0;b=b.containingGroup}if(null===(b=t.findVisibleNode())||b===a)return!1}return!0},Wu.prototype.Ob=function(a){if(lu.prototype.Ob.call(this,a),null!==this.Kf&&this.Kf.nm(),null!==this.ad)for(var b=this.ad.iterator;b.next();)b.value.Ob(a)},Wu.prototype.computeAdjusting=function(){return null!==this.diagram&&this.diagram.animationManager.isAnimating?wc:this.Dk},Wu.prototype.Kh=function(){return!0},v.Object.defineProperties(Wu.prototype,{fromNode:{get:function(){return this.Re},set:function(a){var b=this.Re;if(b!==a){var t=this.fromPort;null!==b&&(this.mf!==b&&Iu(b,this,t),fc(this),this.C(2)),this.Re=a,null!==a&&this.Ob(a.isVisible()),this.Tf=null,this.Ta();var e=this.diagram;null!==e&&e.Z&&e.partManager.setFromNodeForLink(this,a,b);var n=this.fromPort,o=this.fromPortChanged;if(null!==o){var g=!0;null!==e&&(g=e.Z,e.Z=!0),o(this,t,n),null!==e&&(e.Z=g)}null!==a&&(this.mf!==a&&Bu(a,this,n),cc(this),this.C(1)),this.g("fromNode",b,a),Ju(this)}}},fromPortId:{get:function(){return this.Se},set:function(a){var b=this.Se;if(b!==a){var t=this.fromPort;null!==t&&Ou(this.fromNode,t),fc(this),this.Se=a;var e=this.fromPort;null!==e&&Ou(this.fromNode,e);var n=this.diagram;if(null!==n){var o=this.data,g=n.model;null!==o&&g.pm()&&g.jy(o,a)}t!==e&&(this.Tf=null,this.Ta(),null!==(o=this.fromPortChanged)&&(g=!0,null!==n&&(g=n.Z,n.Z=!0),o(this,t,e),null!==n&&(n.Z=g))),cc(this),this.g("fromPortId",b,a)}}},fromPort:{get:function(){var a=this.Re;return null===a?null:a.lt(this.Se)}},fromPortChanged:{get:function(){return this.Mn},set:function(a){var b=this.Mn;b!==a&&(this.Mn=a,this.g("fromPortChanged",b,a))}},toNode:{get:function(){return this.mf},set:function(a){var b=this.mf;if(b!==a){var t=this.toPort;null!==b&&(this.Re!==b&&Iu(b,this,t),fc(this),this.C(2)),this.mf=a,null!==a&&this.Ob(a.isVisible()),this.Tf=null,this.Ta();var e=this.diagram;null!==e&&e.Z&&e.partManager.setToNodeForLink(this,a,b);var n=this.toPort,o=this.toPortChanged;if(null!==o){var g=!0;null!==e&&(g=e.Z,e.Z=!0),o(this,t,n),null!==e&&(e.Z=g)}null!==a&&(this.Re!==a&&Bu(a,this,n),cc(this),this.C(1)),this.g("toNode",b,a),Ju(this)}}},toPortId:{get:function(){return this.nf},set:function(a){var b=this.nf;if(b!==a){var t=this.toPort;null!==t&&Ou(this.toNode,t),fc(this),this.nf=a;var e=this.toPort;null!==e&&Ou(this.toNode,e);var n=this.diagram;if(null!==n){var o=this.data,g=n.model;null!==o&&g.pm()&&g.ny(o,a)}t!==e&&(this.Tf=null,this.Ta(),null!==(o=this.toPortChanged)&&(g=!0,null!==n&&(g=n.Z,n.Z=!0),o(this,t,e),null!==n&&(n.Z=g))),cc(this),this.g("toPortId",b,a)}}},toPort:{get:function(){var a=this.mf;return null===a?null:a.lt(this.nf)}},toPortChanged:{get:function(){return this.Vp},set:function(a){var b=this.Vp;b!==a&&(this.Vp=a,this.g("toPortChanged",b,a))}},fromSpot:{get:function(){return null!==this.O?this.O.Yg:zi},set:function(a){this.Ec();var b=this.O.Yg;b.w(a)||(a=a.G(),this.O.Yg=a,this.g("fromSpot",b,a),(b.gd()||a.gd())&&(null!==(a=this.fromNode)&&Ou(a,this.fromPort)),this.Ta())}},fromEndSegmentLength:{get:function(){return null!==this.O?this.O.Wg:NaN},set:function(a){this.Ec();var b=this.O.Wg;b!==a&&(0>a&&T(a,">= 0",Wu,"fromEndSegmentLength"),this.O.Wg=a,this.g("fromEndSegmentLength",b,a),this.Ta())}},fromShortLength:{get:function(){return null!==this.O?this.O.Xg:NaN},set:function(a){this.Ec();var b=this.O.Xg;b!==a&&(this.O.Xg=a,this.g("fromShortLength",b,a),this.cc())}},toSpot:{get:function(){return null!==this.O?this.O.yh:zi},set:function(a){this.Ec();var b=this.O.yh;b.w(a)||(a=a.G(),this.O.yh=a,this.g("toSpot",b,a),(b.gd()||a.gd())&&(null!==(a=this.toNode)&&Ou(a,this.toPort)),this.Ta())}},toEndSegmentLength:{get:function(){return null!==this.O?this.O.wh:NaN},set:function(a){this.Ec();var b=this.O.wh;b!==a&&(0>a&&T(a,">= 0",Wu,"toEndSegmentLength"),this.O.wh=a,this.g("toEndSegmentLength",b,a),this.Ta())}},toShortLength:{get:function(){return null!==this.O?this.O.xh:NaN},set:function(a){this.Ec();var b=this.O.xh;b!==a&&(this.O.xh=a,this.g("toShortLength",b,a),this.cc())}},isLabeledLink:{get:function(){return null!==this.ad&&0<this.ad.count}},labelNodes:{get:function(){return null===this.ad?ot:this.ad.iterator}},relinkableFrom:{get:function(){return 0!=(1&this.Pa)},set:function(a){var b=0!=(1&this.Pa);b!==a&&(this.Pa^=1,this.g("relinkableFrom",b,a),this.Lb())}},relinkableTo:{get:function(){return 0!=(2&this.Pa)},set:function(a){var b=0!=(2&this.Pa);b!==a&&(this.Pa^=2,this.g("relinkableTo",b,a),this.Lb())}},resegmentable:{get:function(){return 0!=(4&this.Pa)},set:function(a){var b=0!=(4&this.Pa);b!==a&&(this.Pa^=4,this.g("resegmentable",b,a),this.Lb())}},isTreeLink:{get:function(){return 0!=(8&this.Pa)},set:function(a){var b=0!=(8&this.Pa);b!==a&&(this.Pa^=8,this.g("isTreeLink",b,a),null!==this.fromNode&&Ru(this.fromNode),null!==this.toNode&&Ru(this.toNode))}},path:{get:function(){var a=this.zb();return a instanceof rl?a:null}},routeBounds:{get:function(){this.hj();var a=this.El,b=1/0,t=1/0,e=this.pointsCount;if(0===e)a.h(NaN,NaN,0,0);else{if(1===e)e=this.i(0),b=Math.min(e.x,b),t=Math.min(e.y,t),a.h(e.x,e.y,0,0);else if(2===e){e=this.i(0);var n=this.i(1);b=Math.min(e.x,n.x),t=Math.min(e.y,n.y),a.h(e.x,e.y,0,0),a.Ie(n)}else if(this.computeCurve()===vc&&3<=e&&!this.isOrthogonal)if(b=(n=this.i(0)).x,t=n.y,a.h(b,t,0,0),3===e){e=this.i(1),b=Math.min(e.x,b),t=Math.min(e.y,t);var o=this.i(2);b=Math.min(o.x,b),t=Math.min(o.y,t),ne.bm(n.x,n.y,e.x,e.y,e.x,e.y,o.x,o.y,.5,a)}else for(o=3;o<e;o+=3){var g=this.i(o-2);o+3>=e&&(o=e-1);var r=this.i(o-1),h=this.i(o);ne.bm(n.x,n.y,g.x,g.y,r.x,r.y,h.x,h.y,.5,a),b=Math.min(h.x,b),t=Math.min(h.y,t),n=h}else for(n=this.i(0),o=this.i(1),b=Math.min(n.x,o.x),t=Math.min(n.y,o.y),a.h(n.x,n.y,0,0),a.Ie(o),n=2;n<e;n++)o=this.i(n),b=Math.min(o.x,b),t=Math.min(o.y,t),a.Ie(o);this.Wu.h(b-a.x,t-a.y)}return a}},midPoint:{get:function(){return this.hj(),this.computeMidPoint(new Mt)}},midAngle:{get:function(){return this.hj(),this.computeMidAngle()}},flattenedLengths:{get:function(){if(null===this.Gr){this.ld||Qu(this);for(var a=this.Gr=[],b=this.pointsCount,t=0;t<b-1;t++){var e=this.i(t),n=this.i(t+1);ne.$(e.x,n.x)?0>(e=n.y-e.y)&&(e=-e):ne.$(e.y,n.y)?0>(e=n.x-e.x)&&(e=-e):e=Math.sqrt(e.Be(n)),a.push(e)}}return this.Gr}},flattenedTotalLength:{get:function(){var a=this.ru;if(isNaN(a)){for(var b=this.flattenedLengths,t=b.length,e=a=0;e<t;e++)a+=b[e];this.ru=a}return a}},points:{get:function(){return this.wb},set:function(a){var b=this.wb;if(b!==a){var t=null;if(Array.isArray(a)){var e=0==a.length%2;if(e)for(var n=0;n<a.length;n++)if("number"!=typeof a[n]||isNaN(a[n])){e=!1;break}if(e)for(t=new lt,e=0;e<a.length/2;e++)n=new Mt(a[2*e],a[2*e+1]).freeze(),t.add(n);else{for(e=!0,n=0;n<a.length;n++){var o=a[n];if(!j(o)||"number"!=typeof o.x||isNaN(o.x)||"number"!=typeof o.y||isNaN(o.y)){e=!1;break}}if(e)for(t=new lt,e=0;e<a.length;e++)n=a[e],t.add(new Mt(n.x,n.y).freeze())}}else if(a instanceof lt)for(t=a.copy(),a=t.iterator;a.next();)a.value.freeze();else N("Link.points value is not an instance of List or Array: "+a);t.freeze(),this.wb=t,this.cc(),this.o(),Qu(this),null!==(a=this.diagram)&&(a.kk||a.undoManager.isUndoingRedoing||a.yt.add(this),a.animationManager.qc&&(this.oh=t)),this.g("points",b,t)}}},pointsCount:{get:function(){return this.wb.count}},ld:{get:function(){return 0!=(16&this.Pa)},set:function(a){0!=(16&this.Pa)!==a&&(this.Pa^=16)}},suspendsRouting:{get:function(){return 0!=(32&this.Pa)},set:function(a){0!=(32&this.Pa)!==a&&(this.Pa^=32)}},kv:{get:function(){return 0!=(64&this.Pa)},set:function(a){0!=(64&this.Pa)!==a&&(this.Pa^=64)}},defaultFromPoint:{get:function(){return this.v},set:function(a){this.v=a.copy()}},defaultToPoint:{get:function(){return this.I},set:function(a){this.I=a.copy()}},isOrthogonal:{get:function(){return 2==(2&this.Lj.value)}},isAvoiding:{get:function(){return 4==(4&this.Lj.value)}},geometry:{get:function(){return this.Yn&&(this.hj(),this.ka=this.makeGeometry()),this.ka}},firstPickIndex:{get:function(){return 2>=this.pointsCount?0:this.isOrthogonal||!ic(this.computeSpot(!0))?1:0}},lastPickIndex:{get:function(){var a=this.pointsCount;return 0===a?0:2>=a?a-1:this.isOrthogonal||!ic(this.computeSpot(!1))?a-2:a-1}},adjusting:{get:function(){return this.Dk},set:function(a){var b=this.Dk;b!==a&&(this.Dk=a,this.g("adjusting",b,a))}},corner:{get:function(){return this.pn},set:function(a){var b=this.pn;b!==a&&(this.pn=a,this.cc(),this.g("corner",b,a))}},curve:{get:function(){return this.rn},set:function(a){var b=this.rn;b!==a&&(this.rn=a,this.Ta(),this.cc(),lc(this,b===xc||b===bc||a===xc||a===bc),this.g("curve",b,a))}},curviness:{get:function(){return this.sn},set:function(a){var b=this.sn;b!==a&&(this.sn=a,this.Ta(),this.cc(),this.g("curviness",b,a))}},routing:{get:function(){return this.Lj},set:function(a){var b=this.Lj;b!==a&&(this.Lj=a,this.Tf=null,this.Ta(),lc(this,2==(2&b.value)||2==(2&a.value)),this.g("routing",b,a))}},smoothness:{get:function(){return this.Ip},set:function(a){var b=this.Ip;b!==a&&(this.Ip=a,this.cc(),this.g("smoothness",b,a))}},key:{get:function(){var a=this.diagram;if(null!==a&&a.model.pm())return a.model.Vb(this.data)}}}),Wu.prototype.invalidateOtherJumpOvers=Wu.prototype.tq,Wu.prototype.findClosestSegment=Wu.prototype.gz,Wu.prototype.updateRoute=Wu.prototype.hj,Wu.prototype.invalidateRoute=Wu.prototype.Ta,Wu.prototype.rollbackRoute=Wu.prototype.ey,Wu.prototype.commitRoute=Wu.prototype.sf,Wu.prototype.startRoute=Wu.prototype.Nh,Wu.prototype.clearPoints=Wu.prototype.Zj,Wu.prototype.removePoint=Wu.prototype.Yv,Wu.prototype.addPointAt=Wu.prototype.rf,Wu.prototype.addPoint=Wu.prototype.ye,Wu.prototype.insertPointAt=Wu.prototype.m,Wu.prototype.insertPoint=Wu.prototype.Rz,Wu.prototype.setPointAt=Wu.prototype.K,Wu.prototype.setPoint=Wu.prototype.jd,Wu.prototype.getPoint=Wu.prototype.i,Wu.prototype.getOtherPort=Wu.prototype.Fz,Wu.prototype.getOtherNode=Wu.prototype.pt;var dc=new _(Wu,"Normal",1),pc=new _(Wu,"Orthogonal",2),gc=new _(Wu,"AvoidsNodes",6),yc=new _(Wu,"AvoidsNodesStraight",7),mc=new _(Wu,"None",0),vc=new _(Wu,"Bezier",9),xc=new _(Wu,"JumpGap",10),bc=new _(Wu,"JumpOver",11),wc=new _(Wu,"End",17),kc=new _(Wu,"Scale",18),Mc=new _(Wu,"Stretch",19),Sc=new _(Wu,"OrientAlong",21),Pc=new _(Wu,"OrientPlus90",22),Nc=new _(Wu,"OrientMinus90",23),Cc=new _(Wu,"OrientOpposite",24),Tc=new _(Wu,"OrientUpright",25),Lc=new _(Wu,"OrientPlus90Upright",26),Ac=new _(Wu,"OrientMinus90Upright",27),jc=new _(Wu,"OrientUpright45",28);function Dc(a,b,t,e){ft(this),this.le=this.Nr=!1,this.Bt=a,this.Zx=b,this.Nv=t,this.$x=e,this.links=[]}function Fc(){ft(this),this.oy=this.group=null,this.st=!0,this.abort=!1,this.Od=this.Nd=1,this.xo=this.wo=-1,this.lc=this.kc=8,this.Bb=[[]],this.Sj=this.Rj=0,this.CA=!1,this.vA=22,this.$z=111}function Oc(a,b,t){return a.Nd<=b&&b<=a.wo&&a.Od<=t&&t<=a.xo}function Bc(a,b,t){return Oc(a,b,t)?(b-=a.Nd,b/=a.kc,t-=a.Od,t/=a.lc,a.Bb[0|b][0|t]):Uc}function Ic(a,b,t){Oc(a,b,t)&&(b-=a.Nd,b/=a.kc,t-=a.Od,t/=a.lc,a.Bb[0|b][0|t]=Gc)}function Rc(a){if(null!==a.Bb)for(var b=0;b<=a.Rj;b++)for(var t=0;t<=a.Sj;t++)a.Bb[b][t]>=Xc&&(a.Bb[b][t]=Uc)}function Ec(a,b,t,e,n,o,g,r,h){if(!(b<o||b>g||t<r||t>h)){var l=0|b,c=0|t,f=a.Bb[l][c];if(f>=Xc&&f<qc)for(n?c+=e:l+=e,f+=1;o<=l&&l<=g&&r<=c&&c<=h&&!(f>=a.Bb[l][c]);)a.Bb[l][c]=f,f+=1,n?c+=e:l+=e;if(l=n?c:l,n)if(0<e)for(t+=e;t<l;t+=e)Ec(a,b,t,1,!n,o,g,r,h),Ec(a,b,t,-1,!n,o,g,r,h);else for(t+=e;t>l;t+=e)Ec(a,b,t,1,!n,o,g,r,h),Ec(a,b,t,-1,!n,o,g,r,h);else if(0<e)for(b+=e;b<l;b+=e)Ec(a,b,t,1,!n,o,g,r,h),Ec(a,b,t,-1,!n,o,g,r,h);else for(b+=e;b>l;b+=e)Ec(a,b,t,1,!n,o,g,r,h),Ec(a,b,t,-1,!n,o,g,r,h)}}function zc(a,b,t,e,n,o,g,r,h){b|=0,t|=0;var l=Gc,c=Xc;for(a.Bb[b][t]=c;l===Gc&&b>o&&b<g&&t>r&&t<h;)c+=1,a.Bb[b][t]=c,n?t+=e:b+=e,l=a.Bb[b][t]}function Vc(a,b,t,e,n,o,g,r,h){b|=0,t|=0;var l=Gc,c=qc;for(a.Bb[b][t]=c;l===Gc&&b>o&&b<g&&t>r&&t<h;)a.Bb[b][t]=c,n?t+=e:b+=e,l=a.Bb[b][t]}function Yc(a,b,t,e,n,o){if(null!==a.Bb){a.abort=!1;var g=b.x,r=b.y;if(Oc(a,g,r)&&(g-=a.Nd,g/=a.kc,r-=a.Od,r/=a.lc,Oc(a,b=e.x,e=e.y)))if(b-=a.Nd,b/=a.kc,e-=a.Od,e/=a.lc,1>=Math.abs(g-b)&&1>=Math.abs(r-e))a.abort=!0;else{var h=o.x,l=o.y,c=o.x+o.width,f=o.y+o.height;h-=a.Nd,h/=a.kc,l-=a.Od,l/=a.lc,c-=a.Nd,c/=a.kc,f-=a.Od,f/=a.lc,o=Math.max(0,Math.min(a.Rj,0|h)),c=Math.min(a.Rj,Math.max(0,0|c)),l=Math.max(0,Math.min(a.Sj,0|l)),f=Math.min(a.Sj,Math.max(0,0|f)),g|=0,r|=0,b|=0,e|=0,h=0===t||90===t?1:-1,t=90===t||270===t,a.Bb[g][r]===Gc?(zc(a,g,r,h,t,o,c,l,f),zc(a,g,r,1,!t,o,c,l,f),zc(a,g,r,-1,!t,o,c,l,f)):zc(a,g,r,h,t,g,r,g,r),a.Bb[b][e]===Gc?(Vc(a,b,e,0===n||90===n?1:-1,90===n||270===n,o,c,l,f),Vc(a,b,e,1,!(90===n||270===n),o,c,l,f),Vc(a,b,e,-1,!(90===n||270===n),o,c,l,f)):Vc(a,b,e,h,t,b,e,b,e),a.abort||(Ec(a,g,r,1,!1,o,c,l,f),Ec(a,g,r,-1,!1,o,c,l,f),Ec(a,g,r,1,!0,o,c,l,f),Ec(a,g,r,-1,!0,o,c,l,f))}}}Wu.className="Link",Wu.Normal=dc,Wu.Orthogonal=pc,Wu.AvoidsNodes=gc,Wu.AvoidsNodesStraight=yc,Wu.None=mc,Wu.Bezier=vc,Wu.JumpGap=xc,Wu.JumpOver=bc,Wu.End=wc,Wu.Scale=kc,Wu.Stretch=Mc,Wu.OrientAlong=Sc,Wu.OrientPlus90=Pc,Wu.OrientMinus90=Nc,Wu.OrientOpposite=Cc,Wu.OrientUpright=Tc,Wu.OrientPlus90Upright=Lc,Wu.OrientMinus90Upright=Ac,Wu.OrientUpright45=jc,Dc.prototype.nm=function(){if(!this.Nr){var a=this.links;0<a.length&&(null!==(a=a[0].diagram)&&(a.tu.add(this),this.le=a.undoManager.isUndoingRedoing))}this.Nr=!0},Dc.prototype.uw=function(){if(this.Nr){this.Nr=!1;var a=this.links;if(0<a.length){var b=a[0],t=b.diagram;t=null===t||t.kk&&!this.le,this.le=!1,b.arrangeBundledLinks(a,t),1===a.length&&(b.Kf=null,a.length=0)}0===a.length&&(a=this.Bt,null!==this&&null!==a.Ne&&a.Ne.remove(this),a=this.Nv,null!==this&&null!==a.Ne&&a.Ne.remove(this))}},Dc.className="LinkBundle",Fc.prototype.initialize=function(a){if(!(0>=a.width||0>=a.height)){var b=a.y,t=a.x+a.width,e=a.y+a.height;if(this.Nd=Math.floor((a.x-this.kc)/this.kc)*this.kc,this.Od=Math.floor((b-this.lc)/this.lc)*this.lc,this.wo=Math.ceil((t+2*this.kc)/this.kc)*this.kc,this.xo=Math.ceil((e+2*this.lc)/this.lc)*this.lc,a=1+(0|Math.ceil((this.wo-this.Nd)/this.kc)),b=1+(0|Math.ceil((this.xo-this.Od)/this.lc)),null===this.Bb||this.Rj<a-1||this.Sj<b-1){for(t=[],e=0;e<=a;e++)t[e]=[];this.Bb=t,this.Rj=a-1,this.Sj=b-1}if(a=Uc,null!==this.Bb)for(b=0;b<=this.Rj;b++)for(t=0;t<=this.Sj;t++)this.Bb[b][t]=a}},Fc.prototype.lk=function(a,b,t,e){if(a>this.wo||a+t<this.Nd||b>this.xo||b+e<this.Od)return!0;a=(a-this.Nd)/this.kc|0,b=(b-this.Od)/this.lc|0,t=Math.max(0,t)/this.kc+1|0;var n=Math.max(0,e)/this.lc+1|0;if(0>a&&(t+=a,a=0),0>b&&(n+=b,b=0),0>t||0>n)return!0;for(e=0|Math.min(a+t-1,this.Rj),t=0|Math.min(b+n-1,this.Sj);a<=e;a++)for(n=b;n<=t;n++)if(this.Bb[a][n]===Gc)return!1;return!0},v.Object.defineProperties(Fc.prototype,{bounds:{get:function(){return new Wt(this.Nd,this.Od,this.wo-this.Nd,this.xo-this.Od)}},dm:{get:function(){return this.kc},set:function(a){0<a&&a!==this.kc&&(this.kc=a,this.initialize(this.bounds))}},cm:{get:function(){return this.lc},set:function(a){0<a&&a!==this.lc&&(this.lc=a,this.initialize(this.bounds))}}});var Gc=0,Xc=1,qc=999999,Uc=qc+1;function Kc(){ft(this),this.port=this.node=null,this.Yd=[],this.yq=!1}function Hc(a,b,t,e){switch(b=b.offsetY){case 8:return 90;case 2:return 180;case 1:return 270;case 4:return 0}switch(b){case 9:return 180<t?270:90;case 6:return 90<t&&270>=t?180:0}switch(a=180*Math.atan2(a.height,a.width)/Math.PI,b){case 3:return t>a&&t<=180+a?180:270;case 5:return t>180-a&&t<=360-a?270:0;case 12:return t>a&&t<=180+a?90:0;case 10:return t>180-a&&t<=360-a?180:90;case 7:return 90<t&&t<=180+a?180:t>180+a&&t<=360-a?270:0;case 13:return 180<t&&t<=360-a?270:t>a&&180>=t?90:0;case 14:return t>a&&t<=180-a?90:t>180-a&&270>=t?180:0;case 11:return t>180-a&&t<=180+a?180:t>180+a?270:90}return e&&15!==b&&(0>(t-=15)&&(t+=360)),t>a&&t<180-a?90:t>=180-a&&t<=180+a?180:t>180+a&&t<360-a?270:0}function rp(a,b){var t=a.Yd;if(0===t.length){t:if(!a.yq){t=a.yq,a.yq=!0;var e=null,n=a.node,o=n instanceof qu?n:null;if(null===o||o.isSubGraphExpanded)var g=n.isTreeExpanded?n.findLinksConnected(a.port.portId):n.Jx();else{if(!o.actualBounds.u()){a.yq=t;break t}g=(e=o).rv()}o=a.Yd.length=0;var r=a.port.ga(gi,Mt.alloc()),h=a.port.ga(Mi,Mt.alloc());for((n=Wt.allocAt(r.x,r.y,0,0)).Ie(h),Mt.free(r),Mt.free(h),r=Mt.allocAt(n.x+n.width/2,n.y+n.height/2),h=a.port.Xi(),g=g.iterator;g.next();){var l=g.value;if(l.isVisible()&&l.fromPort!==l.toPort){var c=l.fromPort===a.port||null!==l.fromNode&&l.fromNode.Xd(e),f=l.computeSpot(c,a.port);if(f.gd()&&null!==(c=c?l.toPort:l.fromPort)){var p=c.part;if(null!==p){var d=p.findVisibleNode();null!==d&&d!==p&&(c=(p=d).port),c=l.computeOtherPoint(p,c),p=r.Sa(c),0>(p-=h)&&(p+=360),0===(f=Hc(n,f,p,l.isOrthogonal))?(f=4,180<p&&(p-=360)):f=90===f?8:180===f?2:1,void 0===(d=a.Yd[o])?(d=new Wc(l,p,f),a.Yd[o]=d):(d.link=l,d.angle=p,d.yc=f),d.Rv.set(c),o++}}}}for(Mt.free(r),a.Yd.sort(Kc.prototype.l),h=a.Yd.length,e=-1,o=r=0;o<h;o++)void 0!==(g=a.Yd[o])&&(g.yc!==e&&(e=g.yc,r=0),g.pq=r,r++);for(e=-1,r=0,o=h-1;0<=o;o--)void 0!==(h=a.Yd[o])&&(h.yc!==e&&(e=h.yc,r=h.pq+1),h.em=r);if(o=a.Yd,f=a.port,e=a.node.portSpreading,r=Mt.alloc(),h=Mt.alloc(),g=Mt.alloc(),l=Mt.alloc(),f.ga(gi,r),f.ga(mi,h),f.ga(Mi,g),f.ga(wi,l),d=p=c=f=0,e===Xu)for(var q=0;q<o.length;q++){var u=o[q];if(null!==u){var y=u.link.computeThickness();switch(u.yc){case 8:p+=y;break;case 2:d+=y;break;case 1:f+=y;break;default:case 4:c+=y}}}var m=q=0,v=1,x=u=0;for(y=0;y<o.length;y++){var w=o[y];if(null!==w){if(q!==w.yc){switch(q=w.yc){case 8:var k=g;m=l;break;case 2:k=l,m=r;break;case 1:k=r,m=h;break;default:case 4:k=h,m=g}switch(u=m.x-k.x,x=m.y-k.y,q){case 8:p>Math.abs(u)?(v=Math.abs(u)/p,p=Math.abs(u)):v=1;break;case 2:d>Math.abs(x)?(v=Math.abs(x)/d,d=Math.abs(x)):v=1;break;case 1:f>Math.abs(u)?(v=Math.abs(u)/f,f=Math.abs(u)):v=1;break;default:case 4:c>Math.abs(x)?(v=Math.abs(x)/c,c=Math.abs(x)):v=1}m=0}var M=w.wq;if(e===Xu){switch(w=w.link.computeThickness(),w*=v,M.set(k),q){case 8:M.x=k.x+u/2+p/2-m-w/2;break;case 2:M.y=k.y+x/2+d/2-m-w/2;break;case 1:M.x=k.x+u/2-f/2+m+w/2;break;default:case 4:M.y=k.y+x/2-c/2+m+w/2}m+=w}else{var S=.5;e===Gu&&(S=(w.pq+1)/(w.em+1)),M.x=k.x+u*S,M.y=k.y+x*S}}}for(Mt.free(r),Mt.free(h),Mt.free(g),Mt.free(l),k=a.Yd,o=0;o<k.length;o++)null!==(e=k[o])&&(e.pv=a.computeEndSegmentLength(e));a.yq=t,Wt.free(n)}t=a.Yd}for(a=0;a<t.length;a++)if(null!==(n=t[a])&&n.link===b)return n;return null}function Wc(a,b,t){this.link=a,this.angle=b,this.yc=t,this.Rv=new Mt,this.em=this.pq=0,this.wq=new Mt,this.pv=0}function Jc(){this.yh=this.Yg=zi,this.xh=this.Xg=this.wh=this.Wg=NaN,this.Tp=this.Kn=null,this.Up=this.Ln=1/0}function Zc(){ft(this),this.I=this.B=null,this.oi=this.ao=!0,this.ho=!1,this.Wm=new Mt(0,0).freeze(),this.co=!0,this.bo=null,this.Qw="",this.v=null,this.fo=!1,this.l=null}function $c(a,b,t,e,n,o,g,r){for(t=t.iterator;t.next();){var h=t.value;e&&!h.isTopLevel||null!==n&&!n(h)||!h.canLayout()||(o&&h instanceof Au?h.isLinkLabel||(h instanceof qu&&null===h.layout?$c(a,b,h.memberParts,!1,n,o,g,r):(Qc(h),b.add(h))):g&&h instanceof Wu?b.add(h):!r||!h.Wb()||h instanceof Au||(Qc(h),b.add(h)))}}function Qc(a){var b=a.actualBounds;(0===b.width||0===b.height||isNaN(b.width)||isNaN(b.height))&&a.yb()}function _c(a){ft(this),this.ic=a,this.pf=new ct,this.ee=new ct,this.Ct=new kt,this.xt=new kt}function tf(a,b){if(null===b)return!1;var t=a.pf.remove(b);return t&&(null!==(b=b.node)&&a.Ct.remove(b)),t}function ef(a,b){if(null!==b){a.ee.add(b);var t=b.link;null!==t&&null===a.kq(t)&&a.xt.add(t,b),b.network=a}}function nf(a,b){null!==b&&a.ee.remove(b)&&(null!==(b=b.link)&&a.xt.remove(b))}function of(a,b,t){if(null!==t&&t.network!==b){tf(a,t),b.Eh(t);for(var e=t.sourceEdges;e.next();){var n=e.value;n.network!==b&&(nf(a,n),ef(b,n),of(a,b,n.fromVertex))}for(e=t.destinationEdges;e.next();)(t=e.value).network!==b&&(nf(a,t),ef(b,t),of(a,b,t.toVertex))}}function rf(a){ft(this),this.Yc=a,this.l=new Wt(0,0,10,10).freeze(),this.v=new Mt(5,5).freeze(),this.zi=this.hb=null,this.Gg=new lt,this.yg=new lt}function sf(a,b){return a=a.zi,b=b.zi,a?b?(a=a.text)<(b=b.text)?-1:a>b?1:0:1:null!==b?-1:0}function af(a){ft(this),this.kd=a,this.tg=this.Vf=this.ul=this.hb=null}function hf(){Zc.call(this),this.isViewportSized=!0,this.Zp=this.$p=NaN,this.Ng=new qt(NaN,NaN).freeze(),this.ff=new qt(10,10).freeze(),this.vb=cf,this.Ab=ff,this.Qc=yf,this.Kc=lf}function lf(a,b){return(a=a.text)<(b=b.text)?-1:a>b?1:0}Fc.className="PositionArray",Kc.prototype.toString=function(){for(var a=this.Yd,b=this.node.toString()+" "+a.length.toString()+":",t=0;t<a.length;t++){var e=a[t];null!==e&&(b+="\n  "+e.toString())}return b},Kc.prototype.nm=function(){this.Yd.length=0},Kc.prototype.l=function(a,b){return a===b?0:null===a?-1:null===b?1:a.yc<b.yc?-1:a.yc>b.yc?1:a.angle<b.angle?-1:a.angle>b.angle?1:0},Kc.prototype.computeEndSegmentLength=function(a){var b=a.link,t=b.computeEndSegmentLength(this.node,this.port,pi,b.fromPort===this.port),e=a.pq;if(0>e)return t;var n=a.em;if(1>=n||!b.isOrthogonal)return t;b=a.Rv;var o=a.wq;return 2!==a.yc&&8!==a.yc||(e=n-1-e),((a=2===a.yc||4===a.yc)?b.y<o.y:b.x<o.x)?t+8*e:(a?b.y===o.y:b.x===o.x)?t:t+8*(n-1-e)},Kc.className="Knot",Wc.prototype.toString=function(){return this.link.toString()+" "+this.angle.toString()+" "+this.yc.toString()+":"+this.pq.toString()+"/"+this.em.toString()+" "+this.wq.toString()+" "+this.pv.toString()+" "+this.Rv.toString()},Wc.className="LinkInfo",Jc.prototype.copy=function(){var a=new Jc;return a.Yg=this.Yg.G(),a.yh=this.yh.G(),a.Wg=this.Wg,a.wh=this.wh,a.Xg=this.Xg,a.xh=this.xh,a.Kn=this.Kn,a.Tp=this.Tp,a.Ln=this.Ln,a.Up=this.Up,a},Jc.className="LinkSettings",Zc.prototype.cloneProtected=function(a){a.ao=this.ao,a.oi=this.oi,a.ho=this.ho,a.Wm.assign(this.Wm),a.co=this.co,a.bo=this.bo,a.Qw=this.Qw,a.fo=!0},Zc.prototype.copy=function(){var a=new this.constructor;return this.cloneProtected(a),a},Zc.prototype.cb=function(){},Zc.prototype.toString=function(){var a=E(this.constructor);return a+="(",null!==this.group&&(a+=" in "+this.group),null!==this.diagram&&(a+=" for "+this.diagram),a+")"},Zc.prototype.C=function(){if(this.isValidLayout){var a=this.diagram;if(null!==a&&!a.undoManager.isUndoingRedoing){var b=a.animationManager;!b.isTicking&&(b.defaultAnimation.isAnimating&&b.Xc(),this.isOngoing&&a.kk||this.isInitial&&!a.kk)&&(this.isValidLayout=!1,a.Pb())}}},Zc.prototype.createNetwork=function(){return new _c(this)},Zc.prototype.makeNetwork=function(a){var b=this.createNetwork();return a instanceof Vo?(b.xg(a.nodes,!0),b.xg(a.links,!0)):a instanceof qu?b.xg(a.memberParts):b.xg(a.iterator),b},Zc.prototype.updateParts=function(){var a=this.diagram;if(null===a&&null!==this.network)for(var b=this.network.vertexes.iterator;b.next();){var t=b.value.node;if(null!==t&&null!==(a=t.diagram))break}this.isValidLayout=!0;try{null!==a&&a.ua("Layout"),this.commitLayout()}finally{null!==a&&a.Ua("Layout")}},Zc.prototype.commitLayout=function(){if(null!==this.network){for(var a=this.network.vertexes.iterator;a.next();)a.value.commit();if(this.isRouting)for(a=this.network.edges.iterator;a.next();)a.value.commit()}},Zc.prototype.doLayout=function(a){var b=new ct;a instanceof Vo?($c(this,b,a.nodes,!0,this.uk,!0,!1,!0),$c(this,b,a.parts,!0,this.uk,!0,!1,!0)):a instanceof qu?$c(this,b,a.memberParts,!1,this.uk,!0,!1,!0):b.addAll(a.iterator);var t=b.count;if(0<t){null!==(a=this.diagram)&&a.ua("Layout"),t=Math.ceil(Math.sqrt(t)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);var e=this.arrangementOrigin.x,n=e,o=this.arrangementOrigin.y,g=0,r=0;for(b=b.iterator;b.next();){var h=b.value;Qc(h);var l=h.measuredBounds,c=l.width;l=l.height,h.moveTo(n,o),h instanceof qu&&(h.uk=!1),n+=Math.max(c,50)+20,r=Math.max(r,Math.max(l,50)),g>=t-1?(g=0,n=e,o+=r+20,r=0):g++}null!==a&&a.Ua("Layout")}this.isValidLayout=!0},Zc.prototype.uk=function(a){return!(a.location.u()&&!(a instanceof qu&&a.uk))},Zc.prototype.Zi=function(a,b){var t=this.boundsComputation;return null!==t?(b||(b=new Wt),t(a,this,b)):b?(b.set(a.actualBounds),b):a.actualBounds},Zc.prototype.yx=function(a){var b=new ct;return a instanceof Vo?($c(this,b,a.nodes,!0,null,!0,!0,!0),$c(this,b,a.links,!0,null,!0,!0,!0),$c(this,b,a.parts,!0,null,!0,!0,!0)):$c(this,b,a instanceof qu?a.memberParts:a.iterator,!1,null,!0,!0,!0),b},Zc.prototype.initialOrigin=function(a){var b=this.group;if(null!==b){var t=b.position.copy();return(isNaN(t.x)||isNaN(t.y))&&t.set(a),null!==(b=b.placeholder)&&(t=b.ga(gi),(isNaN(t.x)||isNaN(t.y))&&t.set(a),a=b.padding,t.x+=a.left,t.y+=a.top),t}return a},v.Object.defineProperties(Zc.prototype,{diagram:{get:function(){return this.B},set:function(a){this.B=a}},group:{get:function(){return this.I},set:function(a){this.I!==a&&(this.I=a,null!==a&&(this.B=a.diagram))}},isOngoing:{get:function(){return this.ao},set:function(a){this.ao!==a&&(this.ao=a)}},isInitial:{get:function(){return this.oi},set:function(a){this.oi=a,a||(this.fo=!0)}},isViewportSized:{get:function(){return this.ho},set:function(a){this.ho!==a&&(this.ho=a)&&this.C()}},isRouting:{get:function(){return this.co},set:function(a){this.co!==a&&(this.co=a)}},isRealtime:{get:function(){return this.bo},set:function(a){this.bo!==a&&(this.bo=a)}},isValidLayout:{get:function(){return this.fo},set:function(a){this.fo!==a&&(this.fo=a,a||null!==(a=this.diagram)&&(a.If=!0))}},network:{get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a,null!==a&&(a.layout=this))}},boundsComputation:{get:function(){return this.v},set:function(a){this.v!==a&&(this.v=a,this.C())}},arrangementOrigin:{get:function(){return this.Wm},set:function(a){this.Wm.w(a)||(this.Wm.assign(a),this.C())}}}),Zc.prototype.collectParts=Zc.prototype.yx,Zc.prototype.getLayoutBounds=Zc.prototype.Zi,Zc.prototype.invalidateLayout=Zc.prototype.C,Zc.className="Layout",_c.prototype.clear=function(){if(this.pf)for(var a=this.pf.iterator;a.next();)a.value.clear();if(this.ee)for(a=this.ee.iterator;a.next();)a.value.clear();this.pf=new ct,this.ee=new ct,this.Ct=new kt,this.xt=new kt},_c.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutNetwork"+(null!==this.layout?"("+this.layout.toString()+")":"");if(0>=a)return b;if(b+=" vertexes: "+this.pf.count+" edges: "+this.ee.count,1<a){for(var t=this.pf.iterator;t.next();)b+="\n    "+t.value.toString(a-1);for(t=this.ee.iterator;t.next();)b+="\n    "+t.value.toString(a-1)}return b},_c.prototype.createVertex=function(){return new rf(this)},_c.prototype.createEdge=function(){return new af(this)},_c.prototype.xg=function(a,b,t){if(null!==a){for(void 0===b&&(b=!1),void 0===t&&(t=null),null===t&&(t=function(a){if(a instanceof Au)return!a.isLinkLabel;if(a instanceof Wu){var b=a.fromNode;return null!==b&&!b.isLinkLabel&&(null!==(a=a.toNode)&&!a.isLinkLabel)}return!1}),a=a.iterator;a.next();){var e=a.value;if(e instanceof Au&&(!b||e.isTopLevel)&&e.canLayout()&&t(e))if(e instanceof qu&&null===e.layout)this.xg(e.memberParts,!1);else if(null===this.Wi(e)){var n=this.createVertex();n.node=e,this.Eh(n)}}for(a.reset();a.next();)if((e=a.value)instanceof Wu&&(!b||e.isTopLevel)&&e.canLayout()&&t(e)&&null===this.kq(e)){var o=e.fromNode;n=e.toNode,null!==o&&null!==n&&o!==n&&(o=this.findGroupVertex(o),n=this.findGroupVertex(n),null!==o&&null!==n&&this.mk(o,n,e))}}},_c.prototype.findGroupVertex=function(a){if(null===a)return null;var b=a.findVisibleNode();if(null===b)return null;if(null!==(a=this.Wi(b)))return a;for(b=b.containingGroup;null!==b;){if(null!==(a=this.Wi(b)))return a;b=b.containingGroup}return null},(n=_c.prototype).Eh=function(a){if(null!==a){this.pf.add(a);var b=a.node;null!==b&&this.Ct.add(b,a),a.network=this}},n.am=function(a){if(null===a)return null;var b=this.Wi(a);return null===b&&((b=this.createVertex()).node=a,this.Eh(b)),b},n.ov=function(a){if(null!==a&&tf(this,a)){for(var b=a.Gg,t=b.count-1;0<=t;t--){var e=b.L(t);this.ek(e)}for(a=(b=a.yg).count-1;0<=a;a--)t=b.L(a),this.ek(t)}},n.az=function(a){null!==a&&(null!==(a=this.Wi(a))&&this.ov(a))},n.Wi=function(a){return null===a?null:this.Ct.H(a)},n.bq=function(a){if(null!==a){ef(this,a);var b=a.toVertex;null!==b&&b.fv(a),null!==(b=a.fromVertex)&&b.dv(a)}},n.Hy=function(a){if(null===a)return null;var b=a.fromNode,t=a.toNode,e=this.kq(a);return null===e?((e=this.createEdge()).link=a,null!==b&&(e.fromVertex=this.am(b)),null!==t&&(e.toVertex=this.am(t)),this.bq(e)):(e.fromVertex=null!==b?this.am(b):null,e.toVertex=null!==t?this.am(t):null),e},n.ek=function(a){if(null!==a){var b=a.toVertex;null!==b&&b.nv(a),null!==(b=a.fromVertex)&&b.mv(a),nf(this,a)}},n.$y=function(a){null!==a&&(null!==(a=this.kq(a))&&this.ek(a))},n.kq=function(a){return null===a?null:this.xt.H(a)},n.mk=function(a,b,t){if(null===a||null===b)return null;if(a.network===this&&b.network===this){var e=this.createEdge();return e.link=t,e.fromVertex=a,e.toVertex=b,this.bq(e),e}return null},n.Em=function(a){if(null!==a){var b=a.fromVertex,t=a.toVertex;null!==b&&null!==t&&(b.mv(a),t.nv(a),a.Em(),b.fv(a),t.dv(a))}},n.iq=function(){for(var a=I(),b=this.ee.iterator;b.next();){var t=b.value;t.fromVertex===t.toVertex&&a.push(t)}for(b=a.length,t=0;t<b;t++)this.ek(a[t]);R(a)},_c.prototype.deleteArtificialVertexes=function(){for(var a=I(),b=this.pf.iterator;b.next();){var t=b.value;null===t.node&&a.push(t)}for(t=a.length,b=0;b<t;b++)this.ov(a[b]);for(b=I(),t=this.ee.iterator;t.next();){var e=t.value;null===e.link&&b.push(e)}for(t=b.length,e=0;e<t;e++)this.ek(b[e]);R(a),R(b)},_c.prototype.py=function(a){void 0===a&&(a=!0),a&&(this.deleteArtificialVertexes(),function(a){for(var b=I(),t=a.ee.iterator;t.next();){var e=t.value;null!==e.fromVertex&&null!==e.toVertex||b.push(e)}for(t=b.length,e=0;e<t;e++)a.ek(b[e]);R(b)}(this),this.iq()),a=new lt;for(var b=!0;b;){b=!1;for(var t=this.pf.iterator;t.next();){var e=t.value;if(0<e.Gg.count||0<e.yg.count){b=this.layout.createNetwork(),a.add(b),of(this,b,e),b=!0;break}}}return a.sort((function(a,b){return null===a||null===b||a===b?0:b.vertexes.count-a.vertexes.count})),a},_c.prototype.fz=function(){for(var a=new ct,b=this.pf.iterator;b.next();)a.add(b.value.node);for(b=this.ee.iterator;b.next();)a.add(b.value.link);return a},v.Object.defineProperties(_c.prototype,{layout:{get:function(){return this.ic},set:function(a){null!==a&&(this.ic=a)}},vertexes:{get:function(){return this.pf}},edges:{get:function(){return this.ee}}}),_c.prototype.findAllParts=_c.prototype.fz,_c.prototype.splitIntoSubNetworks=_c.prototype.py,_c.prototype.deleteSelfEdges=_c.prototype.iq,_c.prototype.reverseEdge=_c.prototype.Em,_c.prototype.linkVertexes=_c.prototype.mk,_c.prototype.findEdge=_c.prototype.kq,_c.prototype.deleteLink=_c.prototype.$y,_c.prototype.deleteEdge=_c.prototype.ek,_c.prototype.addLink=_c.prototype.Hy,_c.prototype.addEdge=_c.prototype.bq,_c.prototype.findVertex=_c.prototype.Wi,_c.prototype.deleteNode=_c.prototype.az,_c.prototype.deleteVertex=_c.prototype.ov,_c.prototype.addNode=_c.prototype.am,_c.prototype.addVertex=_c.prototype.Eh,_c.prototype.addParts=_c.prototype.xg,_c.className="LayoutNetwork",rf.prototype.clear=function(){this.zi=this.hb=null,this.Gg=new lt,this.yg=new lt},rf.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutVertex#"+gt(this);if(0<a&&(b+=null!==this.node?"("+this.node.toString()+")":"",1<a)){a="";for(var t=!0,e=this.Gg.iterator;e.next();){var n=e.value;t?t=!1:a+=",",a+=n.toString(0)}for(n="",t=!0,e=this.yg.iterator;e.next();){t?t=!1:n+=",",n+=e.value.toString(0)}b+=" sources: "+a+" destinations: "+n}return b},rf.prototype.commit=function(){var a=this.hb;if(null!==a){var b=this.bounds,t=a.bounds;j(t)?(t.x=b.x,t.y=b.y,t.width=b.width,t.height=b.height):a.bounds=b.copy()}else if(null!==(a=this.node)){if(b=this.bounds,!(a instanceof qu)){t=Wt.alloc();var e=this.network.layout.Zi(a,t),n=a.locationObject.ga(xi);if(e.u()&&n.u())return a.moveTo(b.x+this.focusX-(n.x-e.x),b.y+this.focusY-(n.y-e.y)),void Wt.free(t);Wt.free(t)}a.moveTo(b.x,b.y)}},rf.prototype.fv=function(a){null!==a&&(this.Gg.contains(a)||this.Gg.add(a))},rf.prototype.nv=function(a){null!==a&&this.Gg.remove(a)},rf.prototype.dv=function(a){null!==a&&(this.yg.contains(a)||this.yg.add(a))},rf.prototype.mv=function(a){null!==a&&this.yg.remove(a)},v.Object.defineProperties(rf.prototype,{sourceEdgesArrayAccess:{get:function(){return this.Gg._dataArray}},destinationEdgesArrayAccess:{get:function(){return this.yg._dataArray}},data:{get:function(){return this.hb},set:function(a){if(this.hb=a,null!==a){var b=a.bounds;a=b.x;var t=b.y,e=b.width;b=b.height,this.v.h(e/2,b/2),this.l.h(a,t,e,b)}}},node:{get:function(){return this.zi},set:function(a){if(this.zi!==a){this.zi=a,a.yb();var b=this.network.layout,t=Wt.alloc(),e=b.Zi(a,t);b=e.x;var n=e.y,o=e.width;if(e=e.height,isNaN(b)&&(b=0),isNaN(n)&&(n=0),this.l.h(b,n,o,e),Wt.free(t),!(a instanceof qu)&&(a=a.locationObject.ga(xi)).u())return void this.v.h(a.x-b,a.y-n);this.v.h(o/2,e/2)}}},bounds:{get:function(){return this.l},set:function(a){this.l.w(a)||this.l.assign(a)}},focus:{get:function(){return this.v},set:function(a){this.v.w(a)||this.v.assign(a)}},centerX:{get:function(){return this.l.x+this.v.x},set:function(a){var b=this.l;b.x+this.v.x!==a&&(b.ea(),b.x=a-this.v.x,b.freeze())}},centerY:{get:function(){return this.l.y+this.v.y},set:function(a){var b=this.l;b.y+this.v.y!==a&&(b.ea(),b.y=a-this.v.y,b.freeze())}},focusX:{get:function(){return this.v.x},set:function(a){var b=this.v;b.x!==a&&(b.ea(),b.x=a,b.freeze())}},focusY:{get:function(){return this.v.y},set:function(a){var b=this.v;b.y!==a&&(b.ea(),b.y=a,b.freeze())}},x:{get:function(){return this.l.x},set:function(a){var b=this.l;b.x!==a&&(b.ea(),b.x=a,b.freeze())}},y:{get:function(){return this.l.y},set:function(a){var b=this.l;b.y!==a&&(b.ea(),b.y=a,b.freeze())}},width:{get:function(){return this.l.width},set:function(a){var b=this.l;b.width!==a&&(b.ea(),b.width=a,b.freeze())}},height:{get:function(){return this.l.height},set:function(a){var b=this.l;b.height!==a&&(b.ea(),b.height=a,b.freeze())}},network:{get:function(){return this.Yc},set:function(a){this.Yc=a}},sourceVertexes:{get:function(){for(var a=new ct,b=this.sourceEdges;b.next();)a.add(b.value.fromVertex);return a.iterator}},destinationVertexes:{get:function(){for(var a=new ct,b=this.destinationEdges;b.next();)a.add(b.value.toVertex);return a.iterator}},vertexes:{get:function(){for(var a=new ct,b=this.sourceEdges;b.next();)a.add(b.value.fromVertex);for(b=this.destinationEdges;b.next();)a.add(b.value.toVertex);return a.iterator}},sourceEdges:{get:function(){return this.Gg.iterator}},destinationEdges:{get:function(){return this.yg.iterator}},edges:{get:function(){for(var a=new lt,b=this.sourceEdges;b.next();)a.add(b.value);for(b=this.destinationEdges;b.next();)a.add(b.value);return a.iterator}},edgesCount:{get:function(){return this.Gg.count+this.yg.count}}}),rf.prototype.deleteDestinationEdge=rf.prototype.mv,rf.prototype.addDestinationEdge=rf.prototype.dv,rf.prototype.deleteSourceEdge=rf.prototype.nv,rf.prototype.addSourceEdge=rf.prototype.fv,rf.className="LayoutVertex",rf.standardComparer=sf,rf.smartComparer=function(a,b){if(null!==a){if(null!==b){a=a.zi;var t=b.zi;if(null!==a){if(null!==t){for(b=a.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/),a=t.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/),t=0;t<b.length;t++)if(""!==a[t]&&void 0!==a[t]){var e=parseFloat(b[t]),n=parseFloat(a[t]);if(isNaN(e)){if(!isNaN(n))return 1;if(0!==b[t].localeCompare(a[t]))return b[t].localeCompare(a[t])}else{if(isNaN(n))return-1;if(0!=e-n)return e-n}}else if(""!==b[t])return 1;return""!==a[t]&&void 0!==a[t]?-1:0}return 1}return null!==t?-1:0}return 1}return null!==b?-1:0},af.prototype.clear=function(){this.tg=this.Vf=this.ul=this.hb=null},af.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutEdge#"+gt(this);return 0<a&&(b+=null!==this.ul?"("+this.ul.toString()+")":"",1<a&&(b+=" "+(this.Vf?this.Vf.toString():"null")+" --\x3e "+(this.tg?this.tg.toString():"null"))),b},af.prototype.Em=function(){var a=this.Vf;this.Vf=this.tg,this.tg=a},af.prototype.commit=function(){},af.prototype.Qx=function(a){return this.tg===a?this.Vf:this.Vf===a?this.tg:null},v.Object.defineProperties(af.prototype,{network:{get:function(){return this.kd},set:function(a){this.kd=a}},data:{get:function(){return this.hb},set:function(a){this.hb!==a&&(this.hb=a)}},link:{get:function(){return this.ul},set:function(a){this.ul!==a&&(this.ul=a)}},fromVertex:{get:function(){return this.Vf},set:function(a){this.Vf!==a&&(this.Vf=a)}},toVertex:{get:function(){return this.tg},set:function(a){this.tg!==a&&(this.tg=a)}}}),af.prototype.getOtherVertex=af.prototype.Qx,af.className="LayoutEdge",m(hf,Zc),hf.prototype.cloneProtected=function(a){Zc.prototype.cloneProtected.call(this,a),a.$p=this.$p,a.Zp=this.Zp,a.Ng.assign(this.Ng),a.ff.assign(this.ff),a.vb=this.vb,a.Ab=this.Ab,a.Qc=this.Qc,a.Kc=this.Kc},hf.prototype.cb=function(a){a.classType===hf?a===yf||a===mf||a===pf||a===gf?this.sorting=a:a===ff||a===df?this.arrangement=a:a===cf||a===uf?this.alignment=a:N("Unknown enum value: "+a):Zc.prototype.cb.call(this,a)},hf.prototype.doLayout=function(a){this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);var b=this.yx(a);a=this.diagram;for(var t=b.copy().iterator;t.next();){var e=t.value;if(!e.Kh()||null===e.fromNode&&null===e.toNode){if(e.yb(),e instanceof qu)for(e=e.memberParts;e.next();)b.remove(e.value)}else b.remove(e)}var n=b.na();if(0!==n.length){switch(this.sorting){case gf:n.reverse();break;case yf:n.sort(this.comparer);break;case mf:n.sort(this.comparer),n.reverse()}var o=this.wrappingColumn;isNaN(o)&&(o=0);var g=this.wrappingWidth;switch(isNaN(g)&&null!==a?(b=a.padding,g=Math.max(a.viewportBounds.width-b.left-b.right,0)):g=Math.max(this.wrappingWidth,0),0>=o&&0>=g&&(o=1),b=this.spacing.width,isFinite(b)||(b=0),t=this.spacing.height,isFinite(t)||(t=0),null!==a&&a.ua("Layout"),e=[],this.alignment){case uf:var r=b,h=t,l=Wt.alloc(),c=Math.max(this.cellSize.width,1);if(!isFinite(c))for(var f=c=0;f<n.length;f++){var p=this.Zi(n[f],l);c=Math.max(c,p.width)}if(c=Math.max(c+r,1),f=Math.max(this.cellSize.height,1),!isFinite(f))for(p=f=0;p<n.length;p++){var d=this.Zi(n[p],l);f=Math.max(f,d.height)}f=Math.max(f+h,1),p=this.arrangement;for(var q=d=this.arrangementOrigin.x,u=this.arrangementOrigin.y,y=0,m=0,v=0;v<n.length;v++){var x=n[v],w=this.Zi(x,l),k=Math.ceil((w.width+r)/c)*c,M=Math.ceil((w.height+h)/f)*f;switch(p){case df:var S=Math.abs(q-w.width);break;default:S=q+w.width}switch((0<o&&y>o-1||0<g&&0<y&&S-d>g)&&(e.push(new Wt(0,u,g+r,m)),y=0,q=d,u+=m,m=0),m=Math.max(m,M),p){case df:w=-w.width;break;default:w=0}switch(x.moveTo(q+w,u),p){case df:q-=k;break;default:q+=k}y++}e.push(new Wt(0,u,g+r,m)),Wt.free(l);break;case cf:for(h=g,c=o,f=b,p=t,g=Wt.alloc(),d=Math.max(this.cellSize.width,1),o=u=l=0,r=Mt.alloc(),q=0;q<n.length;q++)m=n[q],y=this.Zi(m,g),m=m.wf(m.locationObject,m.locationSpot,r),l=Math.max(l,m.x),u=Math.max(u,y.width-m.x),o=Math.max(o,m.y);switch(q=this.arrangement){case df:l+=f;break;default:u+=f}d=isFinite(d)?Math.max(d+f,1):Math.max(l+u,1);var P=m=this.arrangementOrigin.x;for(v=this.arrangementOrigin.y,u=0,h>=l&&(h-=l),l=x=0,k=Math.max(this.cellSize.height,1),w=o=0,M=!0,y=Mt.alloc(),S=0;S<n.length;S++){var N=n[S],C=this.Zi(N,g),T=N.wf(N.locationObject,N.locationSpot,r);if(0<u)switch(q){case df:P=(P-m-(C.width-T.x))/d,P=(P=ne.$(Math.round(P),P)?Math.round(P):Math.floor(P))*d+m;break;default:P=(P-m+T.x)/d,P=(P=ne.$(Math.round(P),P)?Math.round(P):Math.ceil(P))*d+m}else switch(q){case df:x=P+T.x+C.width;break;default:x=P-T.x}switch(q){case df:var L=-(P+T.x)+x;break;default:L=P+C.width-T.x-x}if(0<c&&u>c-1||0<h&&0<u&&L>h){for(e.push(new Wt(0,M?v-o:v,h+f,w+o+p)),P=0;P<u&&S!==u;P++){var A=(L=n[S-u+P]).wf(L.locationObject,L.locationSpot,y);L.moveTo(L.position.x,L.position.y+o-A.y)}w+=p,v=M?v+w:v+(w+o),u=w=o=0,P=m,M=!1}switch(P===m&&(l=q===df?Math.max(l,C.width-T.x):Math.min(l,-T.x)),o=Math.max(o,T.y),w=Math.max(w,C.height-T.y),isFinite(k)&&(w=Math.max(w,Math.max(C.height,k)-T.y)),M?N.moveTo(P-T.x,v-T.y):N.moveTo(P-T.x,v),q){case df:P-=T.x+f;break;default:P+=C.width-T.x+f}u++}if(e.push(new Wt(0,v,h+f,(M?w:w+o)+p)),n.length!==u)for(h=0;h<u;h++)f=(c=n[n.length-u+h]).wf(c.locationObject,c.locationSpot,r),c.moveTo(c.position.x,c.position.y+o-f.y);if(Mt.free(r),Mt.free(y),q===df)for(n=0;n<e.length;n++)(o=e[n]).width+=l,o.x-=l;else for(n=0;n<e.length;n++)(o=e[n]).x>l&&(o.width+=o.x-l,o.x=l);Wt.free(g)}for(r=o=g=n=0;r<e.length;r++)h=e[r],n=Math.min(n,h.x),g=Math.min(g,h.y),o=Math.max(o,h.x+h.width);this.arrangement===df?this.commitLayers(e,new Mt(n+b/2-(o+n),g-t/2)):this.commitLayers(e,new Mt(n-b/2,g-t/2)),null!==a&&a.Ua("Layout"),this.isValidLayout=!0}},hf.prototype.commitLayers=function(){},v.Object.defineProperties(hf.prototype,{wrappingWidth:{get:function(){return this.$p},set:function(a){this.$p!==a&&(0<a||isNaN(a))&&(this.$p=a,this.isViewportSized=isNaN(a),this.C())}},wrappingColumn:{get:function(){return this.Zp},set:function(a){this.Zp!==a&&(0<a||isNaN(a))&&(this.Zp=a,this.C())}},cellSize:{get:function(){return this.Ng},set:function(a){this.Ng.w(a)||(this.Ng.assign(a),this.C())}},spacing:{get:function(){return this.ff},set:function(a){this.ff.w(a)||(this.ff.assign(a),this.C())}},alignment:{get:function(){return this.vb},set:function(a){this.vb===a||a!==cf&&a!==uf||(this.vb=a,this.C())}},arrangement:{get:function(){return this.Ab},set:function(a){this.Ab===a||a!==ff&&a!==df||(this.Ab=a,this.C())}},sorting:{get:function(){return this.Qc},set:function(a){this.Qc===a||a!==pf&&a!==gf&&a!==yf&&a!==mf||(this.Qc=a,this.C())}},comparer:{get:function(){return this.Kc},set:function(a){this.Kc!==a&&(this.Kc=a,this.C())}}});var uf=new _(hf,"Position",0),cf=new _(hf,"Location",1),ff=new _(hf,"LeftToRight",2),df=new _(hf,"RightToLeft",3),pf=new _(hf,"Forward",4),gf=new _(hf,"Reverse",5),yf=new _(hf,"Ascending",6),mf=new _(hf,"Descending",7);function vf(){this.So=new ct,this.so=new ct,this.Ca=new ct,this.Pe=new kt,this.Oe=new kt,this.yj=new kt,this.B=null,this.Tq=!1}function xf(a,b,t){if(null!=b&&!a.diagram.undoManager.isUndoingRedoing&&!a.Pe.contains(b)){void 0===t&&(t=!0);t:{if(null!=b&&!a.B.undoManager.isUndoingRedoing&&!a.Pe.contains(b)){var e=a.nt(b),n=bf(a,b,e);if(null!==n&&(qh(n),null!==(n=n.copy()))){var o=a.diagram.skipsModelSourceBindings;a.diagram.skipsModelSourceBindings=!0,n.Lf=e,n.hb=b,a.Tq&&(n.eh="Tool"),a.diagram.add(n),n.hb=null,n.data=b,a.diagram.skipsModelSourceBindings=o,e=n;break t}}e=null}null!==e&&t&&a.resolveReferencesForData(b)}}function bf(a,b,t){var e=(a=a.B).model;return e.jk()&&e.Iv(b)?null===(b=a.groupTemplateMap.H(t))&&(null===(b=a.groupTemplateMap.H(""))&&(Cf||(Cf=!0,L('No Group template found for category "'+t+'"'),L("  Using default group template")),b=a.fu)):null===(b=a.nodeTemplateMap.H(t))&&(null===(b=a.nodeTemplateMap.H(""))&&(Nf||(Nf=!0,L('No Node template found for category "'+t+'"'),L("  Using default node template")),b=a.hu)),b}function wf(a,b,t){for(var e in t){var n=b[e],o=t[e];if(D(o)){if(!D(n)||n.length<o.length)return!1;for(var g=0;g<n.length;g++){var r=o[g];if(void 0!==r&&!kf(a,n[g],r))return!1}}else if(!kf(a,n,o))return!1}return!0}function kf(a,b,t){if("function"==typeof t){if(!t(b))return!1}else if(t instanceof RegExp){if(!b||!t.test(b.toString()))return!1}else if(j(b)&&j(t)){if(!wf(a,b,t))return!1}else if(b!==t)return!1;return!0}function Mf(a,b){var t=b.si;if(D(t)){var e=a.yj.H(t);if(null===e)(e=[]).push(b),a.yj.add(t,e);else{for(a=0;a<e.length;a++)if(e[a]===b)return;e.push(b)}}}function Sf(a,b,t){Rh(b,(function(a){for(var b=(a=a.W.j).length,e=0;e<b;e++)zr(t,a[e])}));var e=b.si;if(D(e)){var n=a.yj.H(e);if(null!==n)for(var o=0;o<n.length;o++)if(n[o]===b){n.splice(o,1),0===n.length&&a.yj.remove(e);break}}}function Pf(a,b,t,e,n){if(null===b||n&&!b.canCopy())return null;if(e.contains(b))return e.H(b);var o=a.copyPartData(b,t);if(!(o instanceof lu))return null;if(o.isSelected=!1,o.isHighlighted=!1,e.add(b,o),b instanceof Au){for(var g=b.linksConnected;g.next();){var r=g.value;if(r.fromNode===b){var h=e.H(r);null!==h&&(h.fromNode=o)}r.toNode===b&&(null!==(r=e.H(r))&&(r.toNode=o))}if(b instanceof qu&&o instanceof qu)for(b=b.memberParts;b.next();)(g=Pf(a,b.value,t,e,n))instanceof Wu||null===g||(g.containingGroup=o)}else if(b instanceof Wu&&o instanceof Wu)for(null!==(g=b.fromNode)&&(null!==(g=e.H(g))&&(o.fromNode=g)),null!==(g=b.toNode)&&(null!==(g=e.H(g))&&(o.toNode=g)),b=b.labelNodes;b.next();)null!==(g=Pf(a,b.value,t,e,n))&&g instanceof Au&&(g.labeledLink=o);return o}hf.className="GridLayout",hf.standardComparer=lf,hf.smartComparer=function(a,b){if(null!==a){if(null!==b){a=a.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/),b=b.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/);for(var t=0;t<a.length;t++)if(""!==b[t]&&void 0!==b[t]){var e=parseFloat(a[t]),n=parseFloat(b[t]);if(isNaN(e)){if(!isNaN(n))return 1;if(0!==a[t].localeCompare(b[t]))return a[t].localeCompare(b[t])}else{if(isNaN(n))return-1;if(0!=e-n)return e-n}}else if(""!==a[t])return 1;return""!==b[t]&&void 0!==b[t]?-1:0}return 1}return null!==b?-1:0},hf.Position=uf,hf.Location=cf,hf.LeftToRight=ff,hf.RightToLeft=df,hf.Forward=pf,hf.Reverse=gf,hf.Ascending=yf,hf.Descending=mf,(n=vf.prototype).clear=function(){this.So.clear(),this.so.clear(),this.Ca.clear(),this.Pe.clear(),this.Oe.clear(),this.yj.clear()},n.Zd=function(a){this.B=a},n.aj=function(a){if(a instanceof Au){if(this.So.add(a),a instanceof qu){var b=a.containingGroup;null===b?this.B.zh.add(a):b.zl.add(a),null!==(b=a.layout)&&(b.diagram=this.B)}}else a instanceof Wu?this.so.add(a):a instanceof Lu||this.Ca.add(a);null===(b=a.data)||a instanceof Lu||(a instanceof Wu?this.Oe.add(b,a):this.Pe.add(b,a))},n.Fc=function(a){if(a.Yj(),a instanceof Au){if(this.So.remove(a),a instanceof qu){var b=a.containingGroup;null===b?this.B.zh.remove(a):b.zl.remove(a),null!==(b=a.layout)&&(b.diagram=null)}}else a instanceof Wu?this.so.remove(a):a instanceof Lu||this.Ca.remove(a);null===(b=a.data)||a instanceof Lu||(a instanceof Wu?this.Oe.remove(b):this.Pe.remove(b))},n.yd=function(){for(var a=this.B.nodeTemplateMap.iterator;a.next();){var b=a.value,t=a.key;(!b.Wb()||b instanceof qu)&&N('Invalid node template in Diagram.nodeTemplateMap: template for "'+t+'" must be a Node or a simple Part, not a Group or Link: '+b)}for(a=this.B.groupTemplateMap.iterator;a.next();)b=a.value,t=a.key,b instanceof qu||N('Invalid group template in Diagram.groupTemplateMap: template for "'+t+'" must be a Group, not a normal Node or Link: '+b);for(a=this.B.linkTemplateMap.iterator;a.next();)b=a.value,t=a.key,b instanceof Wu||N('Invalid link template in Diagram.linkTemplateMap: template for "'+t+'" must be a Link, not a normal Node or simple Part: '+b);for(a=I(),b=this.B.selection.iterator;b.next();)(t=b.value.data)&&a.push(t);for(b=I(),t=this.B.highlighteds.iterator;t.next();){var e=t.value.data;e&&b.push(e)}for(t=I(),e=this.nodes.iterator;e.next();){var n=e.value;null!==n.data&&(t.push(n.data),t.push(n.location))}for(e=this.links.iterator;e.next();)null!==(n=e.value).data&&(t.push(n.data),t.push(n.location));for(e=this.parts.iterator;e.next();)null!==(n=e.value).data&&(t.push(n.data),t.push(n.location));for(this.removeAllModeledParts(),this.addAllModeledParts(),e=0;e<a.length;e++)null!==(n=this.wc(a[e]))&&(n.isSelected=!0);for(e=0;e<b.length;e++)null!==(n=this.wc(b[e]))&&(n.isHighlighted=!0);for(e=0;e<t.length;e+=2)null!==(n=this.wc(t[e]))&&(n.location=t[e+1]);R(a),R(b),R(t)},vf.prototype.addAllModeledParts=function(){this.addModeledParts(this.diagram.model.nodeDataArray)},vf.prototype.addModeledParts=function(a,b){var t=this,e=this.diagram.model;a.forEach((function(a){e.sb(a)&&xf(t,a,!1)})),a.forEach((function(a){e.sb(a)&&t.resolveReferencesForData(a)})),!1!==b&&Gr(this.diagram,!1)},vf.prototype.insertLink=function(){return null},vf.prototype.resolveReferencesForData=function(){},vf.prototype.nt=function(a){return this.B.model.nt(a)},vf.prototype.getLinkCategoryForData=function(){return""},vf.prototype.setLinkCategoryForData=function(){},vf.prototype.setFromNodeForLink=function(){},vf.prototype.setToNodeForLink=function(){},vf.prototype.findLinkTemplateForCategory=function(a){var b=this.B.linkTemplateMap.H(a);return null===b&&(null===(b=this.B.linkTemplateMap.H(""))&&(Tf||(Tf=!0,L('No Link template found for category "'+a+'"'),L("  Using default link template")),b=this.B.gu)),b},vf.prototype.removeAllModeledParts=function(){this.It(this.diagram.model.nodeDataArray)},vf.prototype.It=function(a){var b=this;a.forEach((function(a){b.Gq(a)}))},vf.prototype.Gq=function(a){null!==(a=this.wc(a))&&(Pr(this.diagram,a,!1),this.unresolveReferencesForPart(a))},vf.prototype.unresolveReferencesForPart=function(){},vf.prototype.removeDataForLink=function(){},vf.prototype.findPartForKey=function(a){return null==a?null:null!==(a=this.B.model.Ib(a))?this.Pe.H(a):null},vf.prototype.Jb=function(a){return null==a||null===(a=this.B.model.Ib(a))?null:(a=this.Pe.H(a))instanceof Au?a:null},vf.prototype.findLinkForKey=function(){return null},(n=vf.prototype).wc=function(a){if(null===a)return null;var b=this.Pe.H(a);return null!==b?b:b=this.Oe.H(a)},n.Si=function(a){return null===a?null:(a=this.Pe.H(a))instanceof Au?a:null},n.vc=function(a){return null===a?null:this.Oe.H(a)},n.kt=function(a){for(var b=0;b<arguments.length;++b);b=new ct;for(var t=this.So.iterator;t.next();){var e=t.value,n=e.data;if(null!==n)for(var o=0;o<arguments.length;o++){var g=arguments[o];if(j(g)&&wf(this,n,g)){b.add(e);break}}}return b.iterator},n.jt=function(a){for(var b=0;b<arguments.length;++b);b=new ct;for(var t=this.so.iterator;t.next();){var e=t.value,n=e.data;if(null!==n)for(var o=0;o<arguments.length;o++){var g=arguments[o];if(j(g)&&wf(this,n,g)){b.add(e);break}}}return b.iterator},vf.prototype.doModelChanged=function(a){if(this.B){var b=this.B;if(a.model===b.model){var t=a.change;if(b.doModelChanged(a),b.Z){b.Z=!1;try{var e=a.modelChange;if(""!==e)if(t===De){if("nodeCategory"===e){var n=this.wc(a.object),o=a.newValue;null!==n&&"string"==typeof o&&(n.category=o)}else"nodeDataArray"===e&&(this.It(a.oldValue),this.addModeledParts(a.newValue));b.isModified=!0}else if(t===Fe){var g=a.newValue;"nodeDataArray"===e&&j(g)&&xf(this,g),b.isModified=!0}else if(t===Oe){var r=a.oldValue;"nodeDataArray"===e&&j(r)&&this.Gq(r),b.isModified=!0}else t===je&&("SourceChanged"===e?null!==a.object?this.updateDataBindings(a.object,a.propertyName):(this.Pq(),this.updateAllTargetBindings()):"ModelDisplaced"===e&&this.yd());else if(t===De){var h=a.propertyName,l=a.object;l===b.model?"nodeKeyProperty"!==h&&"nodeCategoryProperty"!==h||b.undoManager.isUndoingRedoing||this.yd():this.updateDataBindings(l,h),b.isModified=!0}else if(t===Fe||t===Oe){var c=a.change===Fe,f=c?a.newParam:a.oldParam,p=c?a.newValue:a.oldValue,d=this.yj.H(a.object);if(Array.isArray(d))for(a=0;a<d.length;a++){var q=d[a];if(c)Kh(q,p,f);else if(!(0>f)){var u=f+Uh(q);q.Fc(u,!0),Hh(q,u,f)}}b.isModified=!0}}finally{b.Z=!0}}}}},vf.prototype.updateAllTargetBindings=function(a){void 0===a&&(a="");for(var b=this.parts.iterator;b.next();)b.value.Ba(a);for(b=this.nodes.iterator;b.next();)b.value.Ba(a);for(b=this.links.iterator;b.next();)b.value.Ba(a)},vf.prototype.Pq=function(){for(var a=this.B.model,b=new ct,t=a.nodeDataArray,e=0;e<t.length;e++)b.add(t[e]);var n=[];for(this.nodes.each((function(a){null===a.data||b.contains(a.data)||n.push(a.data)})),this.parts.each((function(a){null===a.data||b.contains(a.data)||n.push(a.data)})),n.forEach((function(b){$f(a,b,!1)})),e=0;e<t.length;e++){var o=t[e];null===this.wc(o)&&Zf(a,o,!1)}for(this.refreshDataBoundLinks(),t=this.parts.iterator;t.next();)t.value.updateRelationshipsFromData();for(t=this.nodes.iterator;t.next();)t.value.updateRelationshipsFromData();for(t=this.links.iterator;t.next();)t.value.updateRelationshipsFromData()},vf.prototype.refreshDataBoundLinks=function(){},vf.prototype.updateRelationshipsFromData=function(){},vf.prototype.updateDataBindings=function(a,b){if("string"==typeof b){var t=this.wc(a);if(null!==t)t.Ba(b);else{t=null;for(var e=this.yj.iterator;e.next();){for(var n=e.value,o=0;o<n.length;o++){var g=n[o].Kx(a);null!==g&&(null===t&&(t=I()),t.push(g))}if(null!==t)break}if(null!==t){for(e=0;e<t.length;e++)t[e].Ba(b);R(t)}}a===this.diagram.model.modelData&&this.updateAllTargetBindings(b)}},vf.prototype.ck=function(a,b,t){var e=new kt;if(D(a))for(var n=0;n<a.length;n++)Pf(this,a[n],b,e,t);else for(a=a.iterator;a.next();)Pf(this,a.value,b,e,t);if(null!==b){t=b.model,a=null!==(a=b.toolManager.findTool("Dragging"))?a.dragOptions.dragsLink:b.Qk.dragsLink,n=new ct;for(var o=new kt,g=e.iterator;g.next();){var r=g.value;if(r instanceof Wu)a||null!==r.fromNode&&null!==r.toNode||n.add(r);else if(r instanceof Au&&null!==r.data&&t.qm()){var h=r,l=(r=g.key).Bg();null!==l&&(null!==(l=e.H(l))?(t.He(h.data,t.ja(l.data)),h=b.vc(h.data),null!==(r=r.Vi())&&null!==h&&o.add(r,h)):t.He(h.data,void 0))}}if(0<n.count&&b.Jt(n,!1),0<o.count)for(t=o.iterator;t.next();)e.add(t.key,t.value)}if(null!==b&&null!==this.B&&null!==(t=(b=b.model).afterCopyFunction)){var c=new kt;e.each((function(a){null!==a.key.data&&c.add(a.key.data,a.value.data)})),t(c,b,this.B.model)}for(b=e.iterator;b.next();)b.value.Ba();return e},vf.prototype.copyPartData=function(a,b){var t=null,e=a.data;if(null!==e&&null!==b){var n=b.model;a instanceof Wu||j(e=n.copyNodeData(e))&&(n.qf(e),t=b.wc(e))}else qh(a),null!==(t=a.copy())&&(n=this.B,null!==b?b.add(t):null!==e&&null!==n&&null!==n.commandHandler&&n.commandHandler.copiesClipboardData&&(b=n.model,n=null,t instanceof Wu||(n=b.copyNodeData(e)),j(n)&&(t.data=n)));return t},v.Object.defineProperties(vf.prototype,{nodes:{get:function(){return this.So}},links:{get:function(){return this.so}},parts:{get:function(){return this.Ca}},diagram:{get:function(){return this.B}},addsToTemporaryLayer:{get:function(){return this.Tq},set:function(a){this.Tq=a}}}),vf.prototype.updateAllRelationshipsFromData=vf.prototype.Pq,vf.prototype.findLinksByExample=vf.prototype.jt,vf.prototype.findNodesByExample=vf.prototype.kt,vf.prototype.findLinkForData=vf.prototype.vc,vf.prototype.findNodeForData=vf.prototype.Si,vf.prototype.findPartForData=vf.prototype.wc,vf.prototype.findNodeForKey=vf.prototype.Jb,vf.prototype.removeModeledPart=vf.prototype.Gq,vf.prototype.removeModeledParts=vf.prototype.It,vf.prototype.rebuildParts=vf.prototype.yd;var Nf=!1,Cf=!1,Tf=!1;function Lf(a){vf.apply(this,arguments)}function Af(a,b){b.forEach((function(b){jf(a,b)})),Gr(a.diagram,!1)}function jf(a,b){if(null!=b&&!a.diagram.undoManager.isUndoingRedoing&&!a.Oe.contains(b)){var t=a.getLinkCategoryForData(b),e=a.findLinkTemplateForCategory(t);if(null!==e){qh(e);var n=e.copy();if(null!==n){e=a.diagram.skipsModelSourceBindings,a.diagram.skipsModelSourceBindings=!0,n.Lf=t,n.hb=b;var o=vd(t=a.diagram.model,b,!0);""!==o&&(n.fromPortId=o),void 0!==(o=yd(t,b,!0))&&((o=a.Jb(o))instanceof Au&&(n.fromNode=o)),""!==(o=vd(t,b,!1))&&(n.toPortId=o),void 0!==(o=yd(t,b,!1))&&((o=a.Jb(o))instanceof Au&&(n.toNode=o)),t=t.Cg(b),Array.isArray(t)&&t.forEach((function(b){null!==(b=a.Jb(b))&&(b.labeledLink=n)})),a.Tq&&(n.eh="Tool"),a.diagram.add(n),n.hb=null,n.data=b,a.diagram.skipsModelSourceBindings=e}}}}function Df(a,b){b.forEach((function(b){a.Gq(b)}))}function Ff(){vf.apply(this,arguments),this.lh=null}function Of(a,b,t){if(null!==b&&null!==t){var e=a.diagram.toolManager.findTool("Linking"),n=b,o=t;if(a.diagram.isTreePathToChildren){for(b=o.linksConnected;b.next();)if(b.value.toNode===o)return}else for(o=b,b=(n=t).linksConnected;b.next();)if(b.value.fromNode===n)return;if((null===e||!mn(e,n,o,null,!0))&&(e=a.getLinkCategoryForData(t.data),null!==(b=a.findLinkTemplateForCategory(e))&&(qh(b),null!==(b=b.copy())))){var g=a.diagram.skipsModelSourceBindings;a.diagram.skipsModelSourceBindings=!0,b.Lf=e,b.hb=t.data,b.fromNode=n,b.toNode=o,a.diagram.add(b),b.hb=null,b.data=t.data,a.diagram.skipsModelSourceBindings=g}}}function Bf(a){this.Vt=',\n  "insertedNodeKeys": ',this.Jw=',\n  "modifiedNodeData": ',this.Xt=',\n  "removedNodeKeys": ',this.Ph=null,ft(this),this.tn=this.Qa="",this.Zf=!1,this.l={},this.Cc=[],this.ab=new kt,this.Ai="key",this.Ok=this.wl=null,this.kn=this.ln=!1,this.nn=!0,this.Sm=null,this.Gj="category",this.Rf=new kt,this.Cu=new lt,this.sg=!1,this.v=null,this.undoManager=new Ie,void 0!==a&&(this.nodeDataArray=a)}function If(a){return',\n  "modelData": '+Kf(a,a.modelData)}function Rf(a,b){j(b=b.modelData)&&(a.Bm(b),a.modelData=b)}function Ef(a,b,t,e){if(b===t)return!0;if(typeof b!=typeof t||"function"==typeof b||"function"==typeof t)return!1;if(Array.isArray(b)&&Array.isArray(t)){if(e.H(b)===t)return!0;if(e.add(b,t),b.length!==t.length)return!1;for(var n=0;n<b.length;n++)if(!Ef(a,b[n],t[n],e))return!1;return!0}if(j(b)&&j(t)){if(e.H(b)===t)return!0;for(var o in e.add(b,t),b){var g=b[o];if(!qf(o,g)){var r=t[o];if(void 0===r||!Ef(a,g,r,e))return!1}}for(n in t)if(!qf(n,o=t[n])&&(void 0===(g=b[n])||!Ef(a,g,o,e)))return!1;return!0}return!1}function zf(a,b,t){a[t]!==b[t]&&N("Model.computeJsonDifference: Model."+t+' is not the same in both models: "'+a[t]+'" and "'+b[t]+'"')}function Vf(a,b){function t(a,b){if(a!==(b=b.part.data)){var t=e.get(a);null===t?((t=new ct).add(b),e.add(a,t)):t.add(b)}}var e=a.Ph;null===e&&(e=new kt,b.changes.each((function(a){if(null!==a.diagram){var b=a.change;b===De?(a=a.object.panel)&&(b=a.data)&&t(b,a):b!==Fe&&b!==Oe||(b=(a=a.object).itemArray)&&t(b,a)}})),a.Ph=e)}function Yf(a,b){for(var t=new ct,e=0;e<a.nodeDataArray.length;e++){var n=a.nodeDataArray[e];Gf(a,b,n,n,t)}return t}function Gf(a,b,t,e,n){if(Array.isArray(t))for(var o=0;o<t.length;o++){var g=t[o];if(g===b)return n.add(e),!0;if(Gf(a,b,g,e,n))return!0}else if(j(t)&&Object.getPrototypeOf(t)===Object.prototype)for(o in t){if((g=t[o])===b)return n.add(e),!0;if(Gf(a,b,g,e,n))return!0}return!1}function Xf(a,b,t){void 0===t&&(t=!1);var e=b.length;if(0>=e)return"[]";var n=new it;n.add("[ "),t&&1<e&&n.add("\n");for(var o=0;o<e;o++){var g=b[o];void 0!==g&&(0<o&&(n.add(","),t&&n.add("\n")),n.add(a.Lm(g)))}return t&&1<e&&n.add("\n"),n.add(" ]"),n.toString()}function qf(a,b){return void 0===b||"__gohashid"===a||"_"===a[0]||"function"==typeof b}function Uf(a){return isNaN(a)?"NaN":1/0===a?"9e9999":-1/0===a?"-9e9999":a}function Kf(a,b){var t=b;if(t instanceof Mt)b={class:"go.Point",x:Uf(t.x),y:Uf(t.y)};else if(t instanceof qt)b={class:"go.Size",width:Uf(t.width),height:Uf(t.height)};else if(t instanceof Wt)b={class:"go.Rect",x:Uf(t.x),y:Uf(t.y),width:Uf(t.width),height:Uf(t.height)};else if(t instanceof hi)b={class:"go.Margin",top:Uf(t.top),right:Uf(t.right),bottom:Uf(t.bottom),left:Uf(t.left)};else if(t instanceof Zi)b=t.eb()?{class:"go.Spot",x:Uf(t.x),y:Uf(t.y),offsetX:Uf(t.offsetX),offsetY:Uf(t.offsetY)}:{class:"go.Spot",enum:t.toString()};else if(t instanceof Ya){if(b={class:"go.Brush",type:t.type.name},t.type===ih?b.color=t.color:t.type!==eh&&t.type!==nh||(b.start=t.start,b.end=t.end,t.type===nh&&(0!==t.startRadius&&(b.startRadius=Uf(t.startRadius)),isNaN(t.endRadius)||(b.endRadius=Uf(t.endRadius)))),null!==t.colorStops){var e={};for(t=t.colorStops.iterator;t.next();)e[t.key]=t.value;b.colorStops=e}}else t instanceof oe?(b={class:"go.Geometry",type:t.type.name},0!==t.startX&&(b.startX=Uf(t.startX)),0!==t.startY&&(b.startY=Uf(t.startY)),0!==t.endX&&(b.endX=Uf(t.endX)),0!==t.endY&&(b.endY=Uf(t.endY)),t.spot1.w(gi)||(b.spot1=t.spot1),t.spot2.w(Mi)||(b.spot2=t.spot2),t.type===td&&(b.path=se(t))):t instanceof _&&(b={class:"go.EnumValue",classType:od(a,t.classType),name:t.name});for(var n in e="{",t=!0,b){var o=sd(b,n);if(!qf(n,o))if(t?t=!1:e+=", ",e+='"'+n+'":',"points"===n&&o instanceof lt){var g="[";for(o=o.iterator;o.next();){var r=o.value;1<g.length&&(g+=","),g+=a.Lm(r.x),g+=",",g+=a.Lm(r.y)}e+=g+="]"}else e+=a.Lm(o)}return e+"}"}function Hf(a){return"number"==typeof a?a:"NaN"===a?NaN:"9e9999"===a?1/0:"-9e9999"===a?-1/0:parseFloat(a)}function Wf(a,b,t,e,n,o,g,r,h){void 0===r&&(r=null),void 0===h&&(h=null);var l=new Ae;l.model=a,l.change=t,l.modelChange=b,l.propertyName=e,l.object=n,l.oldValue=o,l.oldParam=r,l.newValue=g,l.newParam=h,a.bt(l)}function Jf(a){return"number"==typeof a||"string"==typeof a}function Zf(a,b,t){var e=a.ja(b);void 0!==e&&a.ab.H(e)===b||(a.zt(b),void 0===(e=a.ja(b))?N("Model.makeNodeDataKeyUnique failed on "+b+".  Data not added to Model."):(a.ab.add(e,b),e=null,t&&(e=a.Cc.length,O(a.Cc,e,b)),Wf(a,"nodeDataArray",Fe,"nodeDataArray",a,null,b,null,e),a.Dm(b),a.Cm(b)))}function $f(a,b,t){var e=a.ja(b);if(void 0!==e&&a.ab.remove(e),e=null,t){t:if(t=a.Cc,Array.isArray(t))e=t.indexOf(b);else{e=t.length;for(var n=0;n<e;n++)if(t[n]===b){e=n;break t}e=-1}if(0>e)return;B(a.Cc,e)}Wf(a,"nodeDataArray",Oe,"nodeDataArray",a,b,null,e,null),a.Oq(b)}function Qf(a,b,t){if(void 0!==b){var e=a.Rf.H(b);null===e&&(e=new ct,a.Rf.add(b,e)),e.add(t)}}function _f(a,b,t){if(void 0!==b){var e=a.Rf.H(b);e instanceof ct&&(null==t?a.Rf.remove(b):(e.remove(t),0===e.count&&a.Rf.remove(b)))}}function id(a,b){return void 0===b?null:(a=a.Rf.H(b))instanceof ct?a:null}function ed(a,b,t){if(a.copiesArrays&&Array.isArray(b)){var e=[];for(t=0;t<b.length;t++){var n=ed(a,b[t],a.copiesArrayObjects);e.push(n)}return ft(e),e}if(t&&j(b)){for(e in t=(t=b.constructor)?new t:{},n=a.copiesKey||"string"!=typeof a.nodeKeyProperty?null:a.nodeKeyProperty,b)if("__gohashid"===e)t.__gohashid=void 0;else if(e===n)t[n]=void 0;else{var o=sd(b,e),g=od(a,o);"GraphObject"===g||"Diagram"===g||"Layer"===g||"RowColumnDefinition"===g||"AnimationManager"===g||"Tool"===g||"CommandHandler"===g||"Layout"===g||"InputEvent"===g||"DiagramEvent"===g||o instanceof Bf||o instanceof Ie||o instanceof Be||o instanceof Ae||(o=ed(a,o,!1)),ad(t,e,o)}return ft(t),t}return b instanceof Mt||b instanceof qt||b instanceof Wt||b instanceof Zi||b instanceof hi?b.copy():b}function nd(){return new Bf}function od(a,b){if("function"==typeof b){if(b.className)return b.className;if(b.name)return b.name}else if("object"==typeof b&&null!==b&&b.constructor)return od(a,b.constructor);return typeof b}function rd(a){return ld[a]?ld[a]:void 0!==w.go&&w.go[a]?w.go[a]:null}function sd(a,b){if(!a||!b)return null;try{if("function"==typeof b)var t=b(a);else"function"==typeof a.getAttribute?null===(t=a.getAttribute(b))&&(t=void 0):t=a[b]}catch(t){}return t}function ad(a,b,t){if(a&&b)try{"function"==typeof b?b(a,t):"function"==typeof a.setAttribute?a.setAttribute(b,t):a[b]=t}catch(t){}}vf.className="PartManager",m(Lf,vf),Lf.prototype.addAllModeledParts=function(){var a=this.diagram.model;this.addModeledParts(a.nodeDataArray),Af(this,a.linkDataArray)},Lf.prototype.addModeledParts=function(a){for(vf.prototype.addModeledParts.call(this,a,!1),a=this.links.iterator;a.next();)Ju(a.value);Gr(this.diagram,!1)},Lf.prototype.removeAllModeledParts=function(){var a=this.diagram.model;Df(this,a.linkDataArray),this.It(a.nodeDataArray)},Lf.prototype.getLinkCategoryForData=function(a){return this.diagram.model.xv(a)},Lf.prototype.setLinkCategoryForData=function(a,b){return this.diagram.model.Lt(a,b)},Lf.prototype.setFromNodeForLink=function(a,b){var t=this.diagram.model;t.iy(a.data,t.ja(null!==b?b.data:null))},Lf.prototype.setToNodeForLink=function(a,b){var t=this.diagram.model;t.my(a.data,t.ja(null!==b?b.data:null))},Lf.prototype.removeDataForLink=function(a){this.diagram.model.zm(a.data)},Lf.prototype.findPartForKey=function(a){var b=vf.prototype.findPartForKey.call(this,a);return null===b&&null!==(a=this.diagram.model.zg(a))?this.Oe.H(a):b},Lf.prototype.findLinkForKey=function(a){return null==a?null:null!==(a=this.diagram.model.zg(a))?this.Oe.H(a):null},Lf.prototype.doModelChanged=function(a){var b=this;if(vf.prototype.doModelChanged.call(this,a),this.diagram){var t=this.diagram;if(a.model===t.model){var e=a.change;if(t.Z){t.Z=!1;try{var n=a.modelChange;if(""!==n){if(e===De){if("linkFromKey"===n){var o=this.vc(a.object);if(null!==o){var g=this.Jb(a.newValue);o.fromNode=g}}else if("linkToKey"===n){var r=this.vc(a.object);if(null!==r){var h=this.Jb(a.newValue);r.toNode=h}}else if("linkFromPortId"===n){var l=this.vc(a.object);if(null!==l){var c=a.newValue;"string"==typeof c&&(l.fromPortId=c)}}else if("linkToPortId"===n){var f=this.vc(a.object);if(null!==f){var p=a.newValue;"string"==typeof p&&(f.toPortId=p)}}else if("nodeGroupKey"===n){var d=this.wc(a.object);if(null!==d){var q=a.newValue;if(void 0!==q){var u=this.Jb(q);d.containingGroup=u instanceof qu?u:null}else d.containingGroup=null}}else if("linkLabelKeys"===n){var y=this.vc(a.object);if(null!==y){var m=a.oldValue,v=a.newValue;Array.isArray(m)&&m.forEach((function(a){null!==(a=b.Jb(a))&&(a.labeledLink=null)})),Array.isArray(v)&&v.forEach((function(a){null!==(a=b.Jb(a))&&(a.labeledLink=y)}))}}else if("linkCategory"===n){var x=this.vc(a.object),w=a.newValue;null!==x&&"string"==typeof w&&(x.category=w)}else"linkDataArray"===n&&(Df(this,a.oldValue),Af(this,a.newValue));t.isModified=!0}else if(e===Fe){var k=a.newValue;if("linkDataArray"===n&&"object"==typeof k&&null!==k)jf(this,k);else if("linkLabelKeys"===n&&Jf(k)){var M=this.vc(a.object),S=this.Jb(k);null!==M&&null!==S&&(S.labeledLink=M)}t.isModified=!0}else if(e===Oe){var P=a.oldValue;if("linkDataArray"===n&&"object"==typeof P&&null!==P)this.Gq(P);else if("linkLabelKeys"===n&&Jf(P)){var N=this.Jb(P);null!==N&&(N.labeledLink=null)}t.isModified=!0}}else if(e===De){var C=a.propertyName;a.object!==t.model||"linkFromKeyProperty"!==C&&"linkToKeyProperty"!==C&&"linkFromPortIdProperty"!==C&&"linkToPortIdProperty"!==C&&"linkLabelKeysProperty"!==C&&"nodeIsGroupProperty"!==C&&"nodeGroupKeyProperty"!==C&&"linkCategoryProperty"!==C||t.undoManager.isUndoingRedoing||this.yd(),t.isModified=!0}}finally{t.Z=!0}}}}},Lf.prototype.refreshDataBoundLinks=function(){var a=this,b=this.diagram.model,t=new ct,e=b.linkDataArray;e.forEach((function(a){t.add(a)}));var n=[];this.links.each((function(a){null===a.data||t.contains(a.data)||n.push(a.data)})),n.forEach((function(a){wd(b,a,!1)})),e.forEach((function(t){null===a.vc(t)&&bd(b,t,!1)}))},Lf.prototype.updateRelationshipsFromData=function(a){var b=a.data;if(null!==b){var t=a.diagram;if(null!==t){var e=t.model;if(a instanceof Wu){var n=yd(e,b,!0);if(n=t.Jb(n),a.fromNode=n,n=yd(e,b,!1),n=t.Jb(n),a.toNode=n,0<(b=e.Cg(b)).length||0<a.labelNodes.count){if(1===b.length&&1===a.labelNodes.count){n=b[0];var o=a.labelNodes.first();if(e.ja(o.data)===n)return}n=(new ct).addAll(b);var g=new ct;a.labelNodes.each((function(a){null!==a.data&&(void 0!==(a=e.ja(a.data))&&g.add(a))})),(b=g.copy()).Fq(n),(n=n.copy()).Fq(g),(0<b.count||0<n.count)&&(b.each((function(b){null!==(b=t.Jb(b))&&b.labeledLink===a&&(b.labeledLink=null)})),n.each((function(b){null!==(b=t.Jb(b))&&b.labeledLink!==a&&(b.labeledLink=a)})))}}else!(a instanceof Lu)&&(b=e.Yi(b),null===(b=t.findPartForKey(b))||b instanceof qu)&&(a.containingGroup=b)}}},Lf.prototype.resolveReferencesForData=function(a){var b=this.diagram.model,t=b.ja(a);if(void 0!==t){var e=id(b,t),n=this.wc(a);if(null!==e&&null!==n){e=e.iterator;for(var o={};e.next();){var g=e.value;b.sb(g)?n instanceof qu&&b.Yi(g)===t&&(null!==(g=this.wc(g))&&(g.containingGroup=n)):(o.link=this.vc(g),null!==o.link&&n instanceof Au&&(yd(b,g,!0)===t&&(o.link.fromNode=n),yd(b,g,!1)===t&&(o.link.toNode=n),g=b.Cg(g),Array.isArray(g)&&g.some(function(a){return function(b){return b===t&&(n.labeledLink=a.link,!0)}}(o)))),o={link:o.link}}_f(b,t)}void 0!==(a=b.Yi(a))&&((a=this.Jb(a))instanceof qu&&(n.containingGroup=a))}},Lf.prototype.unresolveReferencesForPart=function(a){var b=this.diagram.model;if(a instanceof Au){var t=b.ja(a.data);if(void 0!==t){for(var e=a.linksConnected;e.next();)Qf(b,t,e.value.data);if(a.isLinkLabel&&(null!==(e=a.labeledLink)&&Qf(b,t,e.data)),a instanceof qu)for(a=a.memberParts;a.next();)e=a.value.data,b.sb(e)&&Qf(b,t,e)}}},Lf.prototype.copyPartData=function(a,b){var t=vf.prototype.copyPartData.call(this,a,b);if(a instanceof Wu)if(null!==(a=a.data)&&null!==b){var e=b.model;"object"==typeof(a=e.hq(a))&&null!==a&&(e.Ni(a),t=b.vc(a))}else null!==t&&(b=this.diagram,null!==a&&null!==b&&null!==b.commandHandler&&b.commandHandler.copiesClipboardData&&("object"==typeof(b=b.model.hq(a))&&null!==b&&(t.data=b)));return t},Lf.prototype.insertLink=function(a,b,t,e){var n=this.diagram,o=n.model,g=n.toolManager.findTool("Linking"),r="";if(null!==a&&(null===b&&(b=a),null===(r=b.portId)&&(r="")),b="",null!==t&&(null===e&&(e=t),null===(b=e.portId)&&(b="")),(e=g.archetypeLinkData)instanceof Wu){if(qh(e),null!==(o=e.copy()))return o.fromNode=a,o.fromPortId=r,o.toNode=t,o.toPortId=b,n.add(o),(a=g.archetypeLabelNodeData)instanceof Au&&(qh(a),null!==(a=a.copy())&&(a.labeledLink=o,n.add(a))),o}else if(null!==e&&("object"==typeof(e=o.hq(e))&&null!==e))return null!==a&&md(o,e,o.ja(a.data),!0),xd(o,e,r,!0),null!==t&&md(o,e,o.ja(t.data),!1),xd(o,e,b,!1),o.Ni(e),null===(a=g.archetypeLabelNodeData)||a instanceof Au||"object"==typeof(a=o.copyNodeData(a))&&null!==a&&(o.qf(a),void 0!==(a=o.ja(a))&&o.ev(e,a)),n.vc(e);return null},Lf.prototype.findLinkForKey=Lf.prototype.findLinkForKey,Lf.prototype.findPartForKey=Lf.prototype.findPartForKey,Lf.prototype.removeAllModeledParts=Lf.prototype.removeAllModeledParts,Lf.prototype.addModeledParts=Lf.prototype.addModeledParts,Lf.prototype.addAllModeledParts=Lf.prototype.addAllModeledParts,Lf.className="GraphLinksPartManager",m(Ff,vf),Ff.prototype.getLinkCategoryForData=function(a){return this.diagram.model.yv(a)},Ff.prototype.setLinkCategoryForData=function(a,b){this.diagram.model.fw(a,b)},Ff.prototype.setFromNodeForLink=function(a,b,t){var e=this.diagram.model;if(void 0===t&&(t=null),b=null!==b?b.data:null,this.diagram.isTreePathToChildren)e.He(a.data,e.ja(b));else{var n=this.lh;this.lh=a,null!==t&&e.He(t.data,void 0),e.He(b,e.ja(null!==a.toNode?a.toNode.data:null)),this.lh=n}},Ff.prototype.setToNodeForLink=function(a,b,t){var e=this.diagram.model;if(void 0===t&&(t=null),b=null!==b?b.data:null,this.diagram.isTreePathToChildren){var n=this.lh;this.lh=a,null!==t&&e.He(t.data,void 0),e.He(b,e.ja(null!==a.fromNode?a.fromNode.data:null)),this.lh=n}else e.He(a.data,e.ja(b))},Ff.prototype.removeDataForLink=function(a){this.diagram.model.He(a.data,void 0)},Ff.prototype.findLinkForKey=function(a){return null==a?null:null!==(a=this.diagram.model.Ib(a))?this.Oe.H(a):null},Ff.prototype.doModelChanged=function(a){if(vf.prototype.doModelChanged.call(this,a),this.diagram){var b=this.diagram;if(a.model===b.model){var t=a.change;if(b.Z){b.Z=!1;try{var e=a.modelChange;if(""!==e){if(t===De){if("nodeParentKey"===e){var n=a.object,o=this.Jb(a.newValue),g=this.Si(n);if(null!==this.lh)null!==o&&(this.lh.data=n,this.lh.category=this.getLinkCategoryForData(n));else if(null!==g){var r=g.Vi();null!==r?null===o?b.remove(r):b.isTreePathToChildren?r.fromNode=o:r.toNode=o:Of(this,o,g)}}else if("parentLinkCategory"===e){var h=this.Si(a.object),l=a.newValue;if(null!==h&&"string"==typeof l){var c=h.Vi();null!==c&&(c.category=l)}}b.isModified=!0}}else if(t===De){var f=a.propertyName;a.object===b.model&&"nodeParentKeyProperty"===f&&(b.undoManager.isUndoingRedoing||this.yd()),b.isModified=!0}}finally{b.Z=!0}}}}},Ff.prototype.updateRelationshipsFromData=function(a){var b=a.data;if(null!==b){var t=a.diagram;if(null!==t){var e=t.model;a instanceof Au&&(b=e.$i(b),(b=t.Jb(b))!==(e=a.Bg())&&(e=a.Vi(),null!==b?null!==e?t.isTreePathToChildren?e.fromNode=b:e.toNode=b:Of(this,b,a):null!==e&&Pr(t,e,!1)))}}},Ff.prototype.updateDataBindings=function(a,b){vf.prototype.updateDataBindings.call(this,a,b),"string"==typeof b&&null!==this.wc(a)&&(null!==(a=this.vc(a))&&a.Ba(b))},Ff.prototype.resolveReferencesForData=function(a){var b=this.diagram.model,t=b.ja(a);if(void 0!==t){var e=id(b,t),n=this.wc(a);if(null!==e&&null!==n){for(e=e.iterator;e.next();){var o=e.value;b.sb(o)&&n instanceof Au&&b.$i(o)===t&&Of(this,n,this.Si(o))}_f(b,t)}void 0!==(a=b.$i(a))&&n instanceof Au&&Of(this,a=this.Jb(a),n)}},Ff.prototype.unresolveReferencesForPart=function(a){var b=this.diagram.model;if(a instanceof Au){var t=b.ja(a.data),e=this.vc(a.data);if(null!==e){e.isSelected=!1,e.isHighlighted=!1;var n=e.layer;if(null!==n){var o=n.Fc(-1,e,!1);0<=o&&this.diagram.Ya(Oe,"parts",n,e,null,o,null),null!==(o=e.layerChanged)&&o(e,n,null)}}for(e=this.diagram.isTreePathToChildren,a=a.linksConnected;a.next();)n=a.value,n=(e?n.toNode:n.fromNode).data,b.sb(n)&&Qf(b,t,n)}},Ff.prototype.insertLink=function(a,b,t){b=this.diagram.model;var e=a,n=t;return this.diagram.isTreePathToChildren||(e=t,n=a),null!==e&&null!==n?(b.He(n.data,b.ja(e.data)),n.Vi()):null},Ff.prototype.findLinkForKey=Ff.prototype.findLinkForKey,Ff.className="TreePartManager",Bf.prototype.cloneProtected=function(a){a.Qa=this.Qa,a.tn=this.tn,a.Zf=this.Zf,a.Ai=this.Ai,a.wl=this.wl,a.Ok=this.Ok,a.ln=this.ln,a.kn=this.kn,a.nn=this.nn,a.Sm=this.Sm,a.Gj=this.Gj},Bf.prototype.copy=function(){var a=new this.constructor;return this.cloneProtected(a),a},Bf.prototype.clear=function(){this.Cc=[],this.ab.clear(),this.Rf.clear(),this.undoManager.clear()},Bf.prototype.toString=function(a){if(void 0===a&&(a=0),1<a)return this.Mq();var b=(""!==this.name?this.name:"")+" Model";if(0<a){b+="\n node data:";for(var t=(a=this.nodeDataArray).length,e=0;e<t;e++){var n=a[e];b+=" "+this.ja(n)+":"+z(n)}}return b},Bf.prototype.zA=function(a){a.change!==je&&N("Model.toIncrementalData argument is not a Transaction ChangedEvent:"+a.toString());var b=a.object;return a.isTransactionFinished&&b instanceof Be?(Vf(this,b),a=this.xw(b,"FinishedUndo"===a.propertyName),this.Ph=null,a):null},Bf.prototype.xw=function(a,b){var t=this,e=!1,n=new ct,o=new ct,g=new ct,r=this.Ph;a.changes.each((function(a){a.model===t&&("nodeDataArray"===a.modelChange?a.change===Fe?n.add(a.newValue):a.change===Oe&&g.add(a.oldValue):t.sb(a.object)?o.add(a.object):a.change!==De||t.modelData!==a.object&&"modelData"!==a.propertyName?null!==a.object&&(r&&r.contains(a.object)?r.get(a.object).each((function(a){t.sb(a)&&o.add(a)})):Yf(t,a.object).each((function(a){o.add(a)}))):e=!0)}));var h=new ct;n.each((function(a){h.add(t.ja(a)),b||o.add(a)}));var l=new ct;g.each((function(a){l.add(t.ja(a)),b&&o.add(a)})),a=t.cloneDeep(o.na());var c=null;return e&&(null===c&&(c={}),c.modelData=this.cloneDeep(this.modelData)),0<h.count&&(null===c&&(c={}),b?c.removedNodeKeys=h.na():c.insertedNodeKeys=h.na()),0<a.length&&(null===c&&(c={}),c.modifiedNodeData=a),0<l.count&&(null===c&&(c={}),b?c.insertedNodeKeys=l.na():c.removedNodeKeys=l.na()),c},Bf.prototype.cloneDeep=function(a){return function t(a,b,e,n,o,r){function g(a,t){h?(void 0===a.__gohashid&&r.push(a),n.set(a,t)):(a=yt++,n.set(a,t),o.set(a,b))}if(!j(b))return b;r||(r=[]);var h=Object.isExtensible(b);if(n||(n=new kt),h){var l=n.get(b);if(l)return l}else for(o||(o=new kt),l=o.iterator;l.next();){var c=l.key;if(l.value===b&&(c=n.get(c)))return c}if(Array.isArray(b)){g(b,l=[]);for(var f=0;f<b.length;f++)l.push(t(a,b[f],!1,n,o,r))}else if(b instanceof Mt||b instanceof qt||b instanceof Wt||b instanceof hi||b instanceof Zi)l=b.copy(),g(b,l);else{if(b instanceof Ya||b instanceof oe||b instanceof _)return b;if(b instanceof lt)l=(new lt).addAll(t(a,b.na(),!1,n,o,r)),g(b,l);else if(b instanceof ct)l=(new ct).addAll(t(a,b.na(),!1,n,o,r)),g(b,l);else if(b instanceof kt)l=(new kt).addAll(t(a,b.na(),!1,n,o,r)),g(b,l);else if(b instanceof Date)l=new Date(b.getTime()),g(b,l);else if(b instanceof RegExp)l=new RegExp(b),g(b,l),l.lastIndex=b.lastIndex;else if("function"==typeof b.copy)l=b.copy(),g(b,l);else for(f in g(b,l={}),b)"__gohashid"!==f&&(l[f]=t(a,b[f],!1,n,o,r))}return e&&r.forEach((function(a){delete a.__gohashid})),l}(this,a,!0)},(n=Bf.prototype).zk=function(){var a="";return""!==this.name&&(a+=',\n  "name": '+this.quote(this.name)),""!==this.dataFormat&&(a+=',\n  "dataFormat": '+this.quote(this.dataFormat)),this.isReadOnly&&(a+=',\n  "isReadOnly": '+this.isReadOnly),"key"!==this.nodeKeyProperty&&"string"==typeof this.nodeKeyProperty&&(a+=',\n  "nodeKeyProperty": '+this.quote(this.nodeKeyProperty)),this.copiesArrays&&(a+=',\n  "copiesArrays": true'),this.copiesArrayObjects&&(a+=',\n  "copiesArrayObjects": true'),this.copiesKey||(a+=',\n  "copiesKey": false'),"category"!==this.nodeCategoryProperty&&"string"==typeof this.nodeCategoryProperty&&(a+=',\n  "nodeCategoryProperty": '+this.quote(this.nodeCategoryProperty)),a},n.Eq=function(a){a.name&&(this.name=a.name),a.dataFormat&&(this.dataFormat=a.dataFormat),a.isReadOnly&&(this.isReadOnly=!0),a.nodeKeyProperty&&(this.nodeKeyProperty=a.nodeKeyProperty),a.copiesArrays&&(this.copiesArrays=!0),a.copiesArrayObjects&&(this.copiesArrayObjects=!0),!1===a.copiesKey&&(this.copiesKey=!1),a.nodeCategoryProperty&&(this.nodeCategoryProperty=a.nodeCategoryProperty)},n.yw=function(){var t,a=this.modelData,b=!1;for(t in a)if(!qf(t,a[t])){b=!0;break}return a="",b&&(a=If(this)),a+',\n  "nodeDataArray": '+Xf(this,this.nodeDataArray,!0)},n.Uv=function(a){Rf(this,a),D(a=a.nodeDataArray)&&(this.Bm(a),this.nodeDataArray=a)},n.Rq=function(a){zf(this,a,"nodeKeyProperty");for(var b=new ct,t=new ct,e=(new ct).addAll(this.ab.iteratorKeys),n=new kt,o=a.nodeDataArray,g=o.length,r=0;r<g;r++){var h=o[r],l=a.ja(h);if(void 0!==l){e.remove(l);var c=this.Ib(l);null===c?(b.add(l),t.add(h)):Ef(this,c,h,n)||t.add(h)}else this.zt(h),l=this.ja(h),b.add(l),t.add(h)}return o="",Ef(this,this.modelData,a.modelData,n)||(o+=If(this)),0<b.count&&(o+=this.Vt+Xf(this,b.na(),!0)),0<t.count&&(o+=this.Jw+Xf(this,t.na(),!0)),0<e.count&&(o+=this.Xt+Xf(this,e.na(),!0)),o},n.Ty=function(a,b){return void 0===b&&(b=od(this,this)),'{ "class": '+this.quote(b)+', "incremental": 1'+this.zk()+this.Rq(a)+"}"},n.ww=function(a,b){var t=this,e=!1,n=new ct,o=new ct,g=new ct,r=this.Ph;a.changes.each((function(a){a.model===t&&("nodeDataArray"===a.modelChange?a.change===Fe?n.add(a.newValue):a.change===Oe&&g.add(a.oldValue):t.sb(a.object)?o.add(a.object):a.change!==De||t.modelData!==a.object&&"modelData"!==a.propertyName?null!==a.object&&(r&&r.contains(a.object)?r.get(a.object).each((function(a){t.sb(a)&&o.add(a)})):Yf(t,a.object).each((function(a){o.add(a)}))):e=!0)}));var h=new ct;n.each((function(a){h.add(t.ja(a)),b||o.add(a)}));var l=new ct;return g.each((function(a){l.add(t.ja(a)),b&&o.add(a)})),a="",e&&(a+=If(this)),0<h.count&&(a+=(b?this.Xt:this.Vt)+Xf(this,h.na(),!0)),0<o.count&&(a+=this.Jw+Xf(this,o.na(),!0)),0<l.count&&(a+=(b?this.Vt:this.Xt)+Xf(this,l.na(),!0)),a},n.Dq=function(a){(void 0!==a.name&&a.name!==this.name||void 0!==a.dataFormat&&a.dataFormat!==this.dataFormat||void 0!==a.isReadOnly&&a.isReadOnly!==this.isReadOnly||void 0!==a.nodeKeyProperty&&a.nodeKeyProperty!==this.nodeKeyProperty||void 0!==a.copiesArrays&&a.copiesArrays!==this.copiesArrays||void 0!==a.copiesArrayObjects&&a.copiesArrayObjects!==this.copiesArrayObjects||void 0!==a.copiesKey&&a.copiesKey!==this.copiesKey||void 0!==a.nodeCategoryProperty&&a.nodeCategoryProperty!==this.nodeCategoryProperty)&&N("applyIncrementalJson cannot change Model properties"),Rf(this,a);var b=a.insertedNodeKeys,t=a.modifiedNodeData,e=new kt;if(Array.isArray(t))for(var n=0;n<t.length;n++){var o=t[n],g=this.ja(o);null!=g&&e.set(g,o)}if(Array.isArray(b))for(n=b.length,o=0;o<n;o++){g=b[o];var r=this.Ib(g);null===r&&(r=(r=e.get(g))?r:this.copyNodeData({}),this.Hm(r,g),this.qf(r))}if(Array.isArray(t))for(b=t.length,e=0;e<b;e++)if(n=t[e],o=this.ja(n),null!==(o=this.Ib(o)))for(var h in n)"__gohashid"===h||h===this.nodeKeyProperty||this.ik()&&h===this.nodeIsGroupProperty||this.setDataProperty(o,h,n[h]);if(a=a.removedNodeKeys,Array.isArray(a))for(t=a.length,h=0;h<t;h++)null!==(b=this.Ib(a[h]))&&this.Am(b)},n.qy=function(a,b){a.change!==je&&N("Model.toIncrementalJson argument is not a Transaction ChangedEvent:"+a.toString());var t=a.object;return a.isTransactionFinished&&t instanceof Be?(void 0===b&&(b=od(this,this)),Vf(this,t),a=this.ww(t,"FinishedUndo"===a.propertyName),this.Ph=null,"2"===b?'{ "incremental": 2'+a+"}":'{ "class": '+this.quote(b)+', "incremental": 1'+this.zk()+a+"}"):'{ "incremental": 0 }'},n.AA=function(a,b){return this.qy(a,b)},n.Mq=function(a){return void 0===a&&(a=od(this,this)),'{ "class": '+this.quote(a)+this.zk()+this.yw()+"}"},n.toJSON=function(a){return this.Mq(a)},n.wx=function(a){var b=null;if("string"==typeof a)try{b=w.JSON.parse(a)}catch(t){}else"object"==typeof a?b=a:N("Unable to modify a Model from: "+a);var t=b.incremental;"number"!=typeof t&&N("Unable to apply non-incremental changes to Model: "+a),0!==t&&(this.ua("applyIncrementalJson"),this.Dq(b),this.Ua("applyIncrementalJson"))},n.Ny=function(a){return this.wx(a)},Bf.constructGraphLinksModel=function(){return new Bf},(n=Bf.prototype).Bm=function(a){if(D(a))for(var b=a.length,t=0;t<b;t++){var e=a[t];if(j(e)){var n=t;e=this.Bm(e),Array.isArray(a)?a[n]=e:N("Cannot replace an object in an HTMLCollection or NodeList at "+n)}}else if(j(a)){for(t in a)if(j(n=a[t])&&(n=this.Bm(n),a[t]=n,"points"===t&&Array.isArray(n))){e=0==n.length%2;for(var o=0;o<n.length;o++)if("number"!=typeof n[o]){e=!1;break}if(e){for(e=new lt,o=0;o<n.length/2;o++)e.add(new Mt(n[2*o],n[2*o+1]));e.freeze(),a[t]=e}}if("object"==typeof a){if(t=a,0===(n=a.class||"").indexOf("go.")&&(n=n.substr(3)),"NaN"===n)t=NaN;else if("Date"===n)t=new Date(a.value);else if("Point"===n)t=new Mt(Hf(a.x),Hf(a.y));else if("Size"===n)t=new qt(Hf(a.width),Hf(a.height));else if("Rect"===n)t=new Wt(Hf(a.x),Hf(a.y),Hf(a.width),Hf(a.height));else if("Margin"===n)t=new hi(Hf(a.top),Hf(a.right),Hf(a.bottom),Hf(a.left));else if("Spot"===n)t="string"==typeof a.enum?Qi(a.enum):new Zi(Hf(a.x),Hf(a.y),Hf(a.offsetX),Hf(a.offsetY));else if("Brush"===n){if((t=new Ya).type=tt(Ya,a.type),"string"==typeof a.color&&(t.color=a.color),a.start instanceof Zi&&(t.start=a.start),a.end instanceof Zi&&(t.end=a.end),"number"==typeof a.startRadius&&(t.startRadius=Hf(a.startRadius)),"number"==typeof a.endRadius&&(t.endRadius=Hf(a.endRadius)),j(a=a.colorStops))for(b in a)t.addColorStop(parseFloat(b),a[b])}else"Geometry"===n?(b=null,(b="string"==typeof a.path?ae(a.path):new oe).type=tt(oe,a.type),"number"==typeof a.startX&&(b.startX=Hf(a.startX)),"number"==typeof a.startY&&(b.startY=Hf(a.startY)),"number"==typeof a.endX&&(b.endX=Hf(a.endX)),"number"==typeof a.endY&&(b.endY=Hf(a.endY)),a.spot1 instanceof Zi&&(b.spot1=a.spot1),a.spot2 instanceof Zi&&(b.spot2=a.spot2),t=b):"EnumValue"===n&&(0===(b=a.classType).indexOf("go.")&&(b=b.substr(3)),"function"==typeof(b=rd(b))&&(t=tt(b,a.name)));a=t}}return a},n.quote=function(a){for(var b="",t=a.length,e=0;e<t;e++){var n=a[e];if('"'===n||"\\"===n)b+="\\"+n;else if("\b"===n)b+="\\b";else if("\f"===n)b+="\\f";else if("\n"===n)b+="\\n";else if("\r"===n)b+="\\r";else if("\t"===n)b+="\\t";else{var o=a.charCodeAt(e);b=16>o?b+"\\u000"+a.charCodeAt(e).toString(16):32>o?b+"\\u00"+a.charCodeAt(e).toString(16):8232===o?b+"\\u2028":8233===o?b+"\\u2029":b+n}}return'"'+b+'"'},n.Lm=function(a){return void 0===a?"undefined":null===a?"null":!0===a?"true":!1===a?"false":"string"==typeof a?this.quote(a):"number"==typeof a?1/0===a?"9e9999":-1/0===a?"-9e9999":isNaN(a)?'{"class":"NaN"}':a.toString():a instanceof Date?'{"class":"Date", "value":"'+a.toJSON()+'"}':a instanceof Number?this.Lm(a.valueOf()):D(a)?Xf(this,a):j(a)?Kf(this,a):"function"==typeof a?"null":a.toString()},n.Dh=function(a){this.Cu.add(a)},n.wk=function(a){this.Cu.remove(a)},n.bt=function(a){this.skipsUndoManager||this.undoManager.Dv(a);for(var b=this.Cu,t=b.length,e=0;e<t;e++)b.L(e)(a)},n.Ya=function(a,b,t,e,n,o,g){Wf(this,"",a,b,t,e,n,o,g)},n.g=function(a,b,t,e,n){Wf(this,"",De,a,this,b,t,e,n)},n.Ft=function(a,b,t,e,n,o){Wf(this,"",De,b,a,t,e,n,o)},Bf.prototype.changeState=function(a,b){if(null!==a&&a.model===this)if(a.change===De)ad(a.object,a.propertyName,a.H(b));else if(a.change===Fe){var t=a.newParam;if("nodeDataArray"===a.modelChange){if(j(a=a.newValue)&&"number"==typeof t){var e=this.ja(a);b?(this.Cc[t]===a&&B(this.Cc,t),void 0!==e&&this.ab.remove(e)):(this.Cc[t]!==a&&O(this.Cc,t,a),void 0!==e&&this.ab.add(e,a))}}else""===a.modelChange?((e=a.object)&&!D(e)&&a.propertyName&&(e=sd(a.object,a.propertyName)),D(e)&&"number"==typeof t&&(a=a.newValue,b?B(e,t):O(e,t,a))):N("unknown ChangedEvent.Insert modelChange: "+a.toString())}else a.change===Oe?(t=a.oldParam,"nodeDataArray"===a.modelChange?j(a=a.oldValue)&&"number"==typeof t&&(e=this.ja(a),b?(this.Cc[t]!==a&&O(this.Cc,t,a),void 0!==e&&this.ab.add(e,a)):(this.Cc[t]===a&&B(this.Cc,t),void 0!==e&&this.ab.remove(e))):""===a.modelChange?((e=a.object)&&!D(e)&&a.propertyName&&(e=sd(a.object,a.propertyName)),D(e)&&"number"==typeof t&&(a=a.oldValue,b?O(e,t,a):B(e,t))):N("unknown ChangedEvent.Remove modelChange: "+a.toString())):a.change!==je&&N("unknown ChangedEvent: "+a.toString())},Bf.prototype.ua=function(a){return this.undoManager.ua(a)},Bf.prototype.Ua=function(a){return this.undoManager.Ua(a)},Bf.prototype.Bf=function(){return this.undoManager.Bf()},Bf.prototype.commit=function(a,b){void 0===b&&(b="");var t=this.skipsUndoManager;null===b&&(this.skipsUndoManager=!0,b=""),this.undoManager.ua(b);var e=!1;try{a(this),e=!0}finally{e?this.undoManager.Ua(b):this.undoManager.Bf(),this.skipsUndoManager=t}},(n=Bf.prototype).Ba=function(a,b){void 0===b&&(b=""),Wf(this,"SourceChanged",je,b,a,null,null)},n.ja=function(a){if(null!==a){var b=this.Ai;if(""!==b&&void 0!==(b=sd(a,b))){if(Jf(b))return b;N("Key value for node data "+a+" is not a number or a string: "+b)}}},n.Hm=function(a,b){if(null!==a){var t=this.Ai;if(""!==t)if(this.sb(a)){var e=sd(a,t);e!==b&&null===this.Ib(b)&&(ad(a,t,b),void 0!==e&&this.ab.remove(e),this.ab.add(b,a),Wf(this,"nodeKey",De,t,a,e,b),"string"==typeof t&&this.Ba(a,t),this.Hq(e,b))}else ad(a,t,b)}},n.sb=function(a){var b=this.ja(a);return void 0!==b&&this.ab.H(b)===a},n.Ib=function(a){return null===a&&N("Model.findNodeDataForKey:key must not be null"),void 0!==a&&Jf(a)?this.ab.H(a):null},n.zt=function(a){if(null!==a){var b=this.Ai;if(""!==b){var t=this.ja(a);if(void 0===t||this.ab.contains(t)){var e=this.wl;if(null!==e&&(null!=(t=e(this,a))&&!this.ab.contains(t)))return void ad(a,b,t);if("string"==typeof t){for(e=2;this.ab.contains(t+e);)e++;ad(a,b,t+e)}else if(void 0===t||"number"==typeof t){for(t=-this.ab.count-1;this.ab.contains(t);)t--;ad(a,b,t)}}}}},n.qf=function(a){null!==a&&(pt(a),this.sb(a)||Zf(this,a,!0))},n.Jy=function(a){if(D(a))for(var b=a.length,t=0;t<b;t++)this.qf(a[t]);else for(a=a.iterator;a.next();)this.qf(a.value)},n.Am=function(a){null!==a&&$f(this,a,!0)},n.pA=function(a){if(D(a))for(var b=a.length,t=0;t<b;t++)this.Am(a[t]);else for(a=a.iterator;a.next();)this.Am(a.value)},n.gA=function(a){if(D(a)){for(var b=new ct(this.ab.iteratorKeys),t=new ct,e=a.length,n=0;n<e;n++){var o=a[n],g=this.ja(o);if(void 0!==g){t.add(g);var r=this.Ib(g);null!==r?this.Xj(r,o):(r={},this.Hm(r,g),this.Xj(r,o),this.qf(r))}else this.qf(o),t.add(this.ja(o))}for(a=b.iterator;a.next();)b=a.value,t.contains(b)||(b=this.Ib(b))&&this.Am(b);this.gq()}},n.Hq=function(a,b){void 0!==b&&((a=id(this,a))instanceof ct&&this.Rf.add(b,a))},n.sw=function(){},n.Dm=function(){},n.Cm=function(){},n.Oq=function(){},n.gq=function(a){void 0===a?this.Rf.clear():this.Rf.remove(a)},Bf.prototype.copyNodeData=function(a){if(null===a)return null;var b=this.Ok;return j(a=null!==b?b(a,this):ed(this,a,!0))&&ft(a),a},Bf.prototype.setDataProperty=function(a,b,t){if(this.sb(a)){if(b===this.nodeKeyProperty)this.Hm(a,t);else if(b===this.nodeCategoryProperty)return void this.Jq(a,t)}else!hd&&a instanceof _s&&(hd=!0,L('Model.setDataProperty is modifying a GraphObject, "'+a.toString()+'"'),L("  Is that really your intent?"));var e=sd(a,b);e!==t&&(ad(a,b,t),this.Ft(a,b,e,t))},(n=Bf.prototype).set=function(a,b,t){this.setDataProperty(a,b,t)},n.Xj=function(a,b){if(b){var t,e=this.sb(a);for(t in b)"__gohashid"===t||e&&t===this.nodeKeyProperty||this.setDataProperty(a,t,b[t])}},n.Fy=function(a,b){this.qt(a,-1,b)},n.qt=function(a,b,t){0>b&&(b=a.length),O(a,b,t),Wf(this,"",Fe,"",a,null,t,null,b)},n.Wv=function(a,b){void 0===b&&(b=-1),a===this.Cc&&N("Model.removeArrayItem should not be called on the Model.nodeDataArray"),-1===b&&(b=a.length-1);var t=a[b];B(a,b),Wf(this,"",Oe,"",a,t,null,b,null)},n.nt=function(a){if(null===a)return"";var b=this.Gj;return""===b||void 0===(b=sd(a,b))?"":"string"==typeof b?b:(N("getCategoryForNodeData found a non-string category for "+a+": "+b),"")},n.Jq=function(a,b){if(null!==a){var t=this.Gj;if(""!==t)if(this.sb(a)){var e=sd(a,t);void 0===e&&(e=""),e!==b&&(ad(a,t,b),Wf(this,"nodeCategory",De,t,a,e,b))}else ad(a,t,b)}},n.qm=function(){return!1},n.ik=function(){return!1},n.pm=function(){return!1},n.vt=function(){return!1},n.jk=function(){return!1},v.Object.defineProperties(Bf.prototype,{name:{get:function(){return this.Qa},set:function(a){var b=this.Qa;b!==a&&(this.Qa=a,this.g("name",b,a))}},dataFormat:{get:function(){return this.tn},set:function(a){var b=this.tn;b!==a&&(this.tn=a,this.g("dataFormat",b,a))}},isReadOnly:{get:function(){return this.Zf},set:function(a){var b=this.Zf;b!==a&&(this.Zf=a,this.g("isReadOnly",b,a))}},modelData:{get:function(){return this.l},set:function(a){var b=this.l;b!==a&&(this.l=a,this.g("modelData",b,a),this.Ba(a))}},undoManager:{get:function(){return this.v},set:function(a){var b=this.v;b!==a&&(null!==b&&b.by(this),this.v=a,null!==a&&a.ux(this))}},skipsUndoManager:{get:function(){return this.sg},set:function(a){this.sg=a}},nodeKeyProperty:{get:function(){return this.Ai},set:function(a){var b=this.Ai;b!==a&&(""===a&&N("Model.nodeKeyProperty may not be the empty string"),0<this.ab.count&&N("Cannot set Model.nodeKeyProperty when there is existing node data"),this.Ai=a,this.g("nodeKeyProperty",b,a))}},makeUniqueKeyFunction:{get:function(){return this.wl},set:function(a){var b=this.wl;b!==a&&(this.wl=a,this.g("makeUniqueKeyFunction",b,a))}},nodeDataArray:{get:function(){return this.Cc},set:function(a){var b=this.Cc;if(b!==a){this.ab.clear(),this.sw();for(var t=a.length,e=0;e<t;e++){var n=a[e];if(!j(n))return void N("Model.nodeDataArray must only contain Objects, not: "+n);pt(n)}for(this.Cc=a,e=new lt,n=0;n<t;n++){var o=a[n],g=this.ja(o);void 0===g||null!==this.ab.H(g)?e.add(o):this.ab.add(g,o)}for(e=e.iterator;e.next();)n=e.value,this.zt(n),void 0!==(o=this.ja(n))&&this.ab.add(o,n);for(Wf(this,"nodeDataArray",De,"nodeDataArray",this,b,a),b=0;b<t;b++)e=a[b],this.Dm(e),this.Cm(e);this.gq(),Array.isArray(a)||(this.isReadOnly=!0)}}},copyNodeDataFunction:{get:function(){return this.Ok},set:function(a){var b=this.Ok;b!==a&&(this.Ok=a,this.g("copyNodeDataFunction",b,a))}},copiesArrays:{get:function(){return this.ln},set:function(a){var b=this.ln;b!==a&&(this.ln=a,this.g("copiesArrays",b,a))}},copiesArrayObjects:{get:function(){return this.kn},set:function(a){var b=this.kn;b!==a&&(this.kn=a,this.g("copiesArrayObjects",b,a))}},copiesKey:{get:function(){return this.nn},set:function(a){var b=this.nn;b!==a&&(this.nn=a,this.g("copiesKey",b,a))}},afterCopyFunction:{get:function(){return this.Sm},set:function(a){var b=this.Sm;b!==a&&(this.Sm=a,this.g("afterCopyFunction",b,a))}},nodeCategoryProperty:{get:function(){return this.Gj},set:function(a){var b=this.Gj;b!==a&&(this.Gj=a,this.g("nodeCategoryProperty",b,a))}}}),v.Object.defineProperties(Bf,{type:{get:function(){return"Model"}}}),Bf.prototype.setCategoryForNodeData=Bf.prototype.Jq,Bf.prototype.getCategoryForNodeData=Bf.prototype.nt,Bf.prototype.removeArrayItem=Bf.prototype.Wv,Bf.prototype.insertArrayItem=Bf.prototype.qt,Bf.prototype.addArrayItem=Bf.prototype.Fy,Bf.prototype.assignAllDataProperties=Bf.prototype.Xj,Bf.prototype.set=Bf.prototype.set,Bf.prototype.clearUnresolvedReferences=Bf.prototype.gq,Bf.prototype.mergeNodeDataArray=Bf.prototype.gA,Bf.prototype.removeNodeDataCollection=Bf.prototype.pA,Bf.prototype.removeNodeData=Bf.prototype.Am,Bf.prototype.addNodeDataCollection=Bf.prototype.Jy,Bf.prototype.addNodeData=Bf.prototype.qf,Bf.prototype.makeNodeDataKeyUnique=Bf.prototype.zt,Bf.prototype.findNodeDataForKey=Bf.prototype.Ib,Bf.prototype.containsNodeData=Bf.prototype.sb,Bf.prototype.setKeyForNodeData=Bf.prototype.Hm,Bf.prototype.getKeyForNodeData=Bf.prototype.ja,Bf.prototype.updateTargetBindings=Bf.prototype.Ba,Bf.prototype.commit=Bf.prototype.commit,Bf.prototype.rollbackTransaction=Bf.prototype.Bf,Bf.prototype.commitTransaction=Bf.prototype.Ua,Bf.prototype.startTransaction=Bf.prototype.ua,Bf.prototype.raiseDataChanged=Bf.prototype.Ft,Bf.prototype.raiseChanged=Bf.prototype.g,Bf.prototype.raiseChangedEvent=Bf.prototype.Ya,Bf.prototype.removeChangedListener=Bf.prototype.wk,Bf.prototype.addChangedListener=Bf.prototype.Dh,Bf.prototype.writeJsonValue=Bf.prototype.Lm,Bf.prototype.replaceJsonObjects=Bf.prototype.Bm,Bf.prototype.applyIncrementalJSON=Bf.prototype.Ny,Bf.prototype.applyIncrementalJson=Bf.prototype.wx,Bf.prototype.toJSON=Bf.prototype.toJSON,Bf.prototype.toJson=Bf.prototype.Mq,Bf.prototype.toIncrementalJSON=Bf.prototype.AA,Bf.prototype.toIncrementalJson=Bf.prototype.qy,Bf.prototype.computeJsonDifference=Bf.prototype.Ty,Bf.prototype.toIncrementalData=Bf.prototype.zA,Bf.prototype.clear=Bf.prototype.clear;var hd=!1,ld={};function ud(a,b,t){ft(this),this.s=!1,void 0===a&&(a=""),void 0===b&&(b=a),void 0===t&&(t=null),this.l=-1,this.bd=null,this.Wl=a,this.Vl=this.Qp=0,this.Ms=null,this.eo=!1,this.Ol=b,this.jn=t,this.Eo=fd,this.cn=null,this.pu=new ct}function cd(a,b,t){return null===(a=a.sourceName)||""===a?b:"/"===a?t.part:"."===a?t:".."===a?t.panel:b.Xa(a)}Bf.className="Model",Bf.fromJSON=Bf.fromJson=function(a,b){void 0===b&&(b=null);var t=null;if("string"==typeof a)try{t=w.JSON.parse(a)}catch(t){}else"object"==typeof a?t=a:N("Unable to construct a Model from: "+a);if(null===b){a=null;var e=t.class;if("string"==typeof e)try{var n=null;0===e.indexOf("go.")?n=rd(e=e.substr(3)):null===(n=rd(e))&&(n=w[e]),"function"==typeof n&&(a=new n)}catch(t){}null===a||a instanceof Bf?b=a:N("Unable to construct a Model of declared class: "+t.class)}return null===b&&(b=Bf.constructGraphLinksModel()),b.Eq(t),b.Uv(t),b},Bf.safePropertyValue=sd,Bf.safePropertySet=ad,ld.Brush=Ya,ld.ChangedEvent=Ae,ld.Geometry=oe,ld.Margin=hi,ld.Panel=jh,ld.Point=Mt,ld.Rect=Wt,ld.Size=qt,ld.Spot=Zi,ld.Transaction=Be,ld.UndoManager=Ie,ud.prototype.copy=function(){var a=new ud;return a.Wl=this.Wl,a.Qp=this.Qp,a.Vl=this.Vl,a.Ms=this.Ms,a.eo=this.eo,a.Ol=this.Ol,a.jn=this.jn,a.Eo=this.Eo,a.cn=this.cn,a},(n=ud.prototype).cb=function(a){a.classType===ud&&(this.mode=a)},n.toString=function(){return"Binding("+this.targetProperty+":"+this.sourceProperty+(-1!==this.gj?" "+this.gj:"")+" "+this.mode.name+")"},n.freeze=function(){return this.s=!0,this},n.ea=function(){return this.s=!1,this},n.Vx=function(a){return void 0===a&&(a=null),this.mode=pd,this.backConverter=a,this},n.Aq=function(a){return void 0===a&&(a=""),this.sourceName=a,this.isToModel=!1,this},n.iA=function(){return this.sourceName=null,this.isToModel=!0,this},n.tw=function(a,b,t){var e=this.Ol;if(void 0===t||""===e||e===t){t=this.Wl;var n=this.jn;if(null===n&&""===t)L("Binding error: target property is the empty string: "+this.toString());else{var o=b;if(""!==e&&(o=sd(b,e)),void 0!==o)if(null===n)""!==t&&ad(a,t,o);else try{if(""!==t)ad(a,t,n(o,a));else n(o,a)}catch(t){}}}},n.Qq=function(a,b,t,e){if(this.Eo===pd){var n=this.Wl;if(void 0===t||n===t){t=this.Ol;var o=this.cn,g=a;if(""!==n&&(g=sd(a,n)),void 0!==g&&!this.pu.contains(a))try{this.pu.add(a);var r=null!==e?e.diagram:null,h=null!==r?r.model:null;if(null===o){if(""!==t)null!==h?h.setDataProperty(b,t,g):ad(b,t,g);else if(null!==h&&null!==e&&0<=e.itemIndex&&null!==e.panel&&Array.isArray(e.panel.itemArray)){var l=e.itemIndex,c=e.panel.itemArray;h.Wv(c,l),h.qt(c,l,g)}}else try{if(""!==t){var f=o(g,b,h);null!==h?h.setDataProperty(b,t,f):ad(b,t,f)}else{var p=o(g,b,h);if(void 0!==p&&null!==h&&null!==e&&0<=e.itemIndex&&null!==e.panel&&Array.isArray(e.panel.itemArray)){var d=e.itemIndex,q=e.panel.itemArray;h.Wv(q,d),h.qt(q,d,p)}}}catch(t){}}finally{this.pu.remove(a)}}}},v.Object.defineProperties(ud.prototype,{gj:{get:function(){return this.l},set:function(a){this.s&&C(this),this.l=a}},targetProperty:{get:function(){return this.Wl},set:function(a){this.s&&C(this),this.Wl=a}},sourceName:{get:function(){return this.Ms},set:function(a){this.s&&C(this),this.Ms=a,null!==a&&(this.eo=!1)}},isToModel:{get:function(){return this.eo},set:function(a){this.s&&C(this),this.eo=a}},sourceProperty:{get:function(){return this.Ol},set:function(a){this.s&&C(this),this.Ol=a}},converter:{get:function(){return this.jn},set:function(a){this.s&&C(this),this.jn=a}},backConverter:{get:function(){return this.cn},set:function(a){this.s&&C(this),this.cn=a}},mode:{get:function(){return this.Eo},set:function(a){this.s&&C(this),this.Eo=a}}}),ud.prototype.updateSource=ud.prototype.Qq,ud.prototype.updateTarget=ud.prototype.tw,ud.prototype.ofModel=ud.prototype.iA,ud.prototype.ofObject=ud.prototype.Aq,ud.prototype.makeTwoWay=ud.prototype.Vx;var fd=new _(ud,"OneWay",1),pd=new _(ud,"TwoWay",2);function br(a,b){Bf.call(this),this.Ut=',\n  "insertedLinkKeys": ',this.Iw=',\n  "modifiedLinkData": ',this.Wt=',\n  "removedLinkKeys": ',this.Oc=[],this.$f=new ct,this.ob=new kt,this.wi="",this.ij=this.Nk=this.xl=null,this.We="from",this.Xe="to",this.Dj=this.Cj="",this.Bj="category",this.Md="",this.Bl="isGroup",this.se="group",this.mn=!1,void 0!==a&&(this.nodeDataArray=a),void 0!==b&&(this.linkDataArray=b)}function gd(a,b){for(var t=new ct,e=0;e<a.linkDataArray.length;e++){var n=a.linkDataArray[e];Gf(a,b,n,n,t)}return t}function yd(a,b,t){if(null!==b&&(""!==(a=t?a.We:a.Xe)&&void 0!==(a=sd(b,a)))){if(Jf(a))return a;N((t?"FromKey":"ToKey")+" value for link data "+b+" is not a number or a string: "+a)}}function md(a,b,t,e){if(null===t&&(t=void 0),null!==b){var n=e?a.We:a.Xe;if(""!==n)if(t=a.rm(t),a.cd(b)){var o=sd(b,n);o!==t&&(_f(a,o,b),ad(b,n,t),null===a.Ib(t)&&Qf(a,t,b),Wf(a,e?"linkFromKey":"linkToKey",De,n,b,o,t),"string"==typeof n&&a.Ba(b,n))}else ad(b,n,t)}}function vd(a,b,t){return null===b||""===(a=t?a.Cj:a.Dj)||void 0===(b=sd(b,a))?"":b}function xd(a,b,t,e){if(null!==b){var n=e?a.Cj:a.Dj;if(""!==n)if(a.cd(b)){var o=sd(b,n);void 0===o&&(o=""),o!==t&&(ad(b,n,t),Wf(a,e?"linkFromPortId":"linkToPortId",De,n,b,o,t),"string"==typeof n&&a.Ba(b,n))}else ad(b,n,t)}}function bd(a,b,t){if(""!==a.linkKeyProperty){var e=a.Vb(b);if(void 0!==e&&a.ob.H(e)===b)return;if(a.xq(b),void 0===(e=a.Vb(b)))return void N("GraphLinksModel.makeLinkDataKeyUnique failed on "+b+". Data not added to model.");a.ob.add(e,b)}a.$f.add(b),e=null,t&&(e=a.Oc.length,a.Oc.splice(e,0,b)),Wf(a,"linkDataArray",Fe,"linkDataArray",a,null,b,null,e),kd(a,b)}function wd(a,b,t){a.$f.remove(b);var e=a.Vb(b);if(void 0!==e&&a.ob.remove(e),e=null,t){if(0>(e=a.Oc.indexOf(b)))return;a.Oc.splice(e,1)}if(Wf(a,"linkDataArray",Oe,"linkDataArray",a,b,null,e,null),_f(a,t=yd(a,b,!0),b),_f(a,t=yd(a,b,!1),b),e=a.Cg(b),Array.isArray(e))for(var n=e.length,o=0;o<n;o++)_f(a,t=e[o],b)}function kd(a,b){var t=yd(a,b,!0);t=a.rm(t),null===a.Ib(t)&&Qf(a,t,b),t=yd(a,b,!1),t=a.rm(t),null===a.Ib(t)&&Qf(a,t,b);var e=a.Cg(b);if(Array.isArray(e))for(var n=e.length,o=0;o<n;o++)t=e[o],null===a.Ib(t)&&Qf(a,t,b)}ud.className="Binding",ud.parseEnum=function(a,b){return function(t){return null===(t=tt(a,t))?b:t}},ud.toString=z,ud.OneWay=fd,ud.TwoWay=pd,m(br,Bf),br.constructGraphLinksModel=Bf.constructGraphLinksModel,br.prototype.cloneProtected=function(a){Bf.prototype.cloneProtected.call(this,a),a.wi=this.wi,a.xl=this.xl,a.Nk=this.Nk,a.We=this.We,a.Xe=this.Xe,a.Cj=this.Cj,a.Dj=this.Dj,a.Bj=this.Bj,a.Md=this.Md,a.Bl=this.Bl,a.se=this.se,a.mn=this.mn},(n=br.prototype).clear=function(){Bf.prototype.clear.call(this),this.Oc=[],this.ob.clear(),this.$f.clear()},n.toString=function(a){if(void 0===a&&(a=0),2<=a)return this.Mq();var b=(""!==this.name?this.name:"")+" GraphLinksModel";if(0<a){b+="\n node data:";var t,e=(a=this.nodeDataArray).length;for(t=0;t<e;t++){var n=a[t];b+=" "+this.ja(n)+":"+z(n)}for(b+="\n link data:",e=(a=this.linkDataArray).length,t=0;t<e;t++)b+=" "+yd(this,n=a[t],!0)+"--\x3e"+yd(this,n,!1)}return b},n.xw=function(a,b){""===this.linkKeyProperty&&N("GraphLinksModel.linkKeyProperty must not be an empty string for .toIncrementalData() to succeed.");var t=Bf.prototype.xw.call(this,a,b),e=this,n=new ct,o=new ct,g=new ct,r=this.Ph;a.changes.each((function(a){a.model===e&&("linkDataArray"===a.modelChange?a.change===Fe?n.add(a.newValue):a.change===Oe&&g.add(a.oldValue):e.cd(a.object)?o.add(a.object):null!==a.object&&(null!==a.object&&r&&r.contains(a.object)?r.get(a.object).each((function(a){e.cd(a)&&o.add(a)})):gd(e,a.object).each((function(a){o.add(a)}))))}));var h=new ct;n.each((function(a){h.add(e.Vb(a)),b||o.add(a)}));var l=new ct;return g.each((function(a){l.add(e.Vb(a)),b&&o.add(a)})),a=e.cloneDeep(o.na()),0<h.count&&(null===t&&(t={}),b?t.removedLinkKeys=h.na():t.insertedLinkKeys=h.na()),0<a.length&&(null===t&&(t={}),t.modifiedLinkData=a),0<l.count&&(null===t&&(t={}),b?t.insertedLinkKeys=l.na():t.removedLinkKeys=l.na()),t},n.zk=function(){var a=Bf.prototype.zk.call(this),b="";return"category"!==this.linkCategoryProperty&&"string"==typeof this.linkCategoryProperty&&(b+=',\n  "linkCategoryProperty": '+this.quote(this.linkCategoryProperty)),""!==this.linkKeyProperty&&"string"==typeof this.linkKeyProperty&&(b+=',\n  "linkKeyProperty": '+this.quote(this.linkKeyProperty)),"from"!==this.linkFromKeyProperty&&"string"==typeof this.linkFromKeyProperty&&(b+=',\n  "linkFromKeyProperty": '+this.quote(this.linkFromKeyProperty)),"to"!==this.linkToKeyProperty&&"string"==typeof this.linkToKeyProperty&&(b+=',\n  "linkToKeyProperty": '+this.quote(this.linkToKeyProperty)),""!==this.linkFromPortIdProperty&&"string"==typeof this.linkFromPortIdProperty&&(b+=',\n  "linkFromPortIdProperty": '+this.quote(this.linkFromPortIdProperty)),""!==this.linkToPortIdProperty&&"string"==typeof this.linkToPortIdProperty&&(b+=',\n  "linkToPortIdProperty": '+this.quote(this.linkToPortIdProperty)),""!==this.linkLabelKeysProperty&&"string"==typeof this.linkLabelKeysProperty&&(b+=',\n  "linkLabelKeysProperty": '+this.quote(this.linkLabelKeysProperty)),"isGroup"!==this.nodeIsGroupProperty&&"string"==typeof this.nodeIsGroupProperty&&(b+=',\n  "nodeIsGroupProperty": '+this.quote(this.nodeIsGroupProperty)),"group"!==this.nodeGroupKeyProperty&&"string"==typeof this.nodeGroupKeyProperty&&(b+=',\n  "nodeGroupKeyProperty": '+this.quote(this.nodeGroupKeyProperty)),a+b},n.Eq=function(a){Bf.prototype.Eq.call(this,a),a.linkKeyProperty&&(this.linkKeyProperty=a.linkKeyProperty),a.linkFromKeyProperty&&(this.linkFromKeyProperty=a.linkFromKeyProperty),a.linkToKeyProperty&&(this.linkToKeyProperty=a.linkToKeyProperty),a.linkFromPortIdProperty&&(this.linkFromPortIdProperty=a.linkFromPortIdProperty),a.linkToPortIdProperty&&(this.linkToPortIdProperty=a.linkToPortIdProperty),a.linkCategoryProperty&&(this.linkCategoryProperty=a.linkCategoryProperty),a.linkLabelKeysProperty&&(this.linkLabelKeysProperty=a.linkLabelKeysProperty),a.nodeIsGroupProperty&&(this.nodeIsGroupProperty=a.nodeIsGroupProperty),a.nodeGroupKeyProperty&&(this.nodeGroupKeyProperty=a.nodeGroupKeyProperty)},n.yw=function(){return Bf.prototype.yw.call(this)+(',\n  "linkDataArray": '+Xf(this,this.linkDataArray,!0))},n.Uv=function(a){Bf.prototype.Uv.call(this,a),a=a.linkDataArray,Array.isArray(a)&&(this.Bm(a),this.linkDataArray=a)},n.Rq=function(a){if(!(a instanceof br))return N("Model.computeJsonDifference: newmodel must be a GraphLinksModel"),"";""===this.linkKeyProperty&&N("GraphLinksModel.linkKeyProperty must not be an empty string for .computeJsonDifference() to succeed.");var b=Bf.prototype.Rq.call(this,a);zf(this,a,"linkKeyProperty"),zf(this,a,"linkFromKeyProperty"),zf(this,a,"linkToKeyProperty"),zf(this,a,"linkLabelKeysProperty"),zf(this,a,"nodeIsGroupProperty"),zf(this,a,"nodeGroupKeyProperty");for(var t=new ct,e=new ct,n=(new ct).addAll(this.ob.iteratorKeys),o=new kt,g=a.linkDataArray,r=g.length,h=0;h<r;h++){var l=g[h],c=a.Vb(l);if(void 0!==c){n.remove(c);var f=this.zg(c);null===f?(t.add(c),e.add(l)):Ef(this,f,l,o)||e.add(l)}else this.xq(l),c=this.Vb(l),t.add(c),e.add(l)}return a=b,0<t.count&&(a+=this.Ut+Xf(this,t.na(),!0)),0<e.count&&(a+=this.Iw+Xf(this,e.na(),!0)),0<n.count&&(a+=this.Wt+Xf(this,n.na(),!0)),a},n.ww=function(a,b){""===this.linkKeyProperty&&N("GraphLinksModel.linkKeyProperty must not be an empty string for .toIncrementalJson() to succeed.");var t=Bf.prototype.ww.call(this,a,b),e=this,n=new ct,o=new ct,g=new ct,r=this.Ph;a.changes.each((function(a){a.model===e&&("linkDataArray"===a.modelChange?a.change===Fe?n.add(a.newValue):a.change===Oe&&g.add(a.oldValue):e.cd(a.object)?o.add(a.object):null!==a.object&&(null!==a.object&&r&&r.contains(a.object)?r.get(a.object).each((function(a){e.cd(a)&&o.add(a)})):gd(e,a.object).each((function(a){o.add(a)}))))}));var h=new ct;n.each((function(a){h.add(e.Vb(a)),b||o.add(a)}));var l=new ct;return g.each((function(a){l.add(e.Vb(a)),b&&o.add(a)})),a=t,0<h.count&&(a+=(b?this.Wt:this.Ut)+Xf(this,h.na(),!0)),0<o.count&&(a+=this.Iw+Xf(this,o.na(),!0)),0<l.count&&(a+=(b?this.Ut:this.Wt)+Xf(this,l.na(),!0)),a},n.Dq=function(a){(void 0!==a.linkCategoryProperty&&a.linkCategoryProperty!==this.linkCategoryProperty||void 0!==a.linkKeyProperty&&a.linkKeyProperty!==this.linkKeyProperty||void 0!==a.linkFromKeyProperty&&a.linkFromKeyProperty!==this.linkFromKeyProperty||void 0!==a.linkToKeyProperty&&a.linkToKeyProperty!==this.linkToKeyProperty||void 0!==a.linkFromPortIdProperty&&a.linkFromPortIdProperty!==this.linkFromPortIdProperty||void 0!==a.linkToPortIdProperty&&a.linkToPortIdProperty!==this.linkToPortIdProperty||void 0!==a.linkLabelKeysProperty&&a.linkLabelKeysProperty!==this.linkLabelKeysProperty||void 0!==a.nodeIsGroupProperty&&a.nodeIsGroupProperty!==this.nodeIsGroupProperty||void 0!==a.nodeGroupKeyProperty&&a.nodeGroupKeyProperty!==this.nodeGroupKeyProperty)&&N("applyIncrementalJson cannot change Model properties"),Bf.prototype.Dq.call(this,a);var b=a.insertedLinkKeys;if(Array.isArray(b))for(var t=b.length,e=0;e<t;e++){var n=b[e],o=this.zg(n);null===o&&(o=this.hq({}),this.Nt(o,n),this.Ni(o))}if(b=a.modifiedLinkData,Array.isArray(b))for(t=b.length,e=0;e<t;e++)if(n=b[e],o=this.Vb(n),null!==(o=this.zg(o)))for(var g in n)"__gohashid"!==g&&g!==this.linkKeyProperty&&this.setDataProperty(o,g,n[g]);if(a=a.removedLinkKeys,Array.isArray(a))for(g=a.length,b=0;b<g;b++)null!==(t=this.zg(a[b]))&&this.zm(t)},br.prototype.changeState=function(a,b){if(a.change===Fe){var t=a.newParam;if("linkDataArray"===a.modelChange){if(j(a=a.newValue)&&"number"==typeof t){var e=this.Vb(a);b?(this.$f.remove(a),this.Oc[t]===a&&this.Oc.splice(t,1),void 0!==e&&this.ob.remove(e)):(this.$f.add(a),this.Oc[t]!==a&&this.Oc.splice(t,0,a),void 0!==e&&this.ob.add(e,a))}return}if("linkLabelKeys"===a.modelChange)return e=this.Cg(a.object),void(Array.isArray(e)&&"number"==typeof t&&(b?(t=e.indexOf(a.newValue),0<=t&&e.splice(t,1)):0>e.indexOf(a.newValue)&&e.splice(t,0,a.newValue)))}else if(a.change===Oe){if(t=a.oldParam,"linkDataArray"===a.modelChange)return void(j(a=a.oldValue)&&"number"==typeof t&&(e=this.Vb(a),b?(this.$f.add(a),this.Oc[t]!==a&&this.Oc.splice(t,0,a),void 0!==e&&this.ob.add(e,a)):(this.$f.remove(a),this.Oc[t]===a&&this.Oc.splice(t,1),void 0!==e&&this.ob.remove(e))));if("linkLabelKeys"===a.modelChange)return e=this.Cg(a.object),void(Array.isArray(e)&&"number"==typeof t&&(b?0>e.indexOf(a.newValue)&&e.splice(t,0,a.newValue):(t=e.indexOf(a.newValue),0<=t&&e.splice(t,1))))}Bf.prototype.changeState.call(this,a,b)},(n=br.prototype).rm=function(a){if(void 0!==a){var b=this.ij;if(null!==b){var t=this.Ib(a);null===t&&(ad(t=this.copyNodeData(b),this.nodeKeyProperty,a),this.qf(t))}return a}},n.Cz=function(a){return yd(this,a,!0)},n.iy=function(a,b){md(this,a,b,!0)},n.Iz=function(a){return yd(this,a,!1)},n.my=function(a,b){md(this,a,b,!1)},n.Dz=function(a){return vd(this,a,!0)},n.jy=function(a,b){xd(this,a,b,!0)},n.Jz=function(a){return vd(this,a,!1)},n.ny=function(a,b){xd(this,a,b,!1)},n.Cg=function(a){if(null===a)return Md;var b=this.Md;return""===b||void 0===(a=sd(a,b))?Md:a},n.ew=function(a,b){if(null!==a){var t=this.Md;if(""!==t)if(this.cd(a)){var e=sd(a,t);if(void 0===e&&(e=Md),e!==b){if(Array.isArray(e))for(var n=e.length,o=0;o<n;o++)_f(this,e[o],a);for(ad(a,t,b),n=b.length,o=0;o<n;o++){var g=b[o];null===this.Ib(g)&&Qf(this,g,a)}Wf(this,"linkLabelKeys",De,t,a,e,b),"string"==typeof t&&this.Ba(a,t)}}else ad(a,t,b)}},n.ev=function(a,b){if(null!=b&&null!==a){var t=this.Md;if(""!==t){var e=sd(a,t);if(void 0===e)(t=[]).push(b),this.ew(a,t);else if(Array.isArray(e)){var n=e.indexOf(b);0<=n||(n=e.length,e.push(b),this.cd(a)&&(null===this.Ib(b)&&Qf(this,b,a),Wf(this,"linkLabelKeys",Fe,t,a,null,b,null,n)))}else N(t+" property is not an Array; cannot addLabelKeyForLinkData: "+a)}}},n.ay=function(a,b){if(null!=b&&null!==a){var t=this.Md;if(""!==t){var e=sd(a,t);if(Array.isArray(e)){var n=e.indexOf(b);0>n||(e.splice(n,1),this.cd(a)&&(_f(this,b,a),Wf(this,"linkLabelKeys",Oe,t,a,b,null,n,null)))}else void 0!==e&&N(t+" property is not an Array; cannot removeLabelKeyforLinkData: "+a)}}},n.Vb=function(a){if(null!==a){var b=this.wi;if(""!==b&&void 0!==(b=sd(a,b))){if(Jf(b))return b;N("Key value for link data "+a+" is not a number or a string: "+b)}}},n.Nt=function(a,b){if(null!==a){var t=this.wi;if(""!==t)if(this.cd(a)){var e=sd(a,t);e!==b&&null===this.zg(b)&&(ad(a,t,b),void 0!==e&&this.ob.remove(e),this.ob.add(b,a),Wf(this,"linkKey",De,t,a,e,b),"string"==typeof t&&this.Ba(a,t))}else ad(a,t,b)}},n.zg=function(a){return null===a&&N("GraphLinksModel.findLinkDataForKey:key must not be null"),void 0!==a&&Jf(a)?this.ob.H(a):null},n.xq=function(a){if(null!==a){var b=this.wi;if(""!==b){var t=this.Vb(a);if(void 0===t||this.ob.contains(t)){var e=this.xl;if(null!==e&&(null!=(t=e(this,a))&&!this.ob.contains(t)))return void ad(a,b,t);if("string"==typeof t){for(e=2;this.ob.contains(t+e);)e++;ad(a,b,t+e)}else if(void 0===t||"number"==typeof t){for(t=-this.ob.count-1;this.ob.contains(t);)t--;ad(a,b,t)}}}}},n.cd=function(a){return null!==a&&this.$f.contains(a)},n.Ni=function(a){null!==a&&(pt(a),this.cd(a)||bd(this,a,!0))},n.Iy=function(a){if(Array.isArray(a))for(var b=a.length,t=0;t<b;t++)this.Ni(a[t]);else for(a=a.iterator;a.next();)this.Ni(a.value)},n.zm=function(a){null!==a&&wd(this,a,!0)},n.nA=function(a){if(Array.isArray(a))for(var b=a.length,t=0;t<b;t++)this.zm(a[t]);else for(a=a.iterator;a.next();)this.zm(a.value)},n.fA=function(a){if(""===this.linkKeyProperty&&N("GraphLinksModel.linkKeyProperty must not be an empty string for .mergeLinkDataArray() to succeed."),D(a)){for(var b=new ct(this.ob.iteratorKeys),t=new ct,e=a.length,n=0;n<e;n++){var o=a[n],g=this.Vb(o);if(void 0!==g){t.add(g);var r=this.zg(g);null!==r?this.Xj(r,o):(r={},this.Nt(r,g),this.Xj(r,o),this.Ni(r))}else this.Ni(o),t.add(this.Vb(o))}for(a=b.iterator;a.next();)b=a.value,t.contains(b)||(b=this.zg(b))&&this.zm(b);this.gq()}},n.hq=function(a){if(null===a)return null;var b=this.Nk;return j(a=null!==b?b(a,this):ed(this,a,!0))&&(ft(a),""!==this.We&&ad(a,this.We,void 0),""!==this.Xe&&ad(a,this.Xe,void 0),""!==this.Md&&ad(a,this.Md,[])),a},n.Iv=function(a){if(null===a)return!1;var b=this.Bl;return""!==b&&!!sd(a,b)},n.Yi=function(a){if(null!==a){var b=this.se;if(""!==b&&void 0!==(b=sd(a,b))){if(Jf(b))return b;N("GroupKey value for node data "+a+" is not a number or a string: "+b)}}},n.Mt=function(a,b){if(null===b&&(b=void 0),null!==a){var t=this.se;if(""!==t)if(this.sb(a)){var e=sd(a,t);e!==b&&(_f(this,e,a),ad(a,t,b),null===this.Ib(b)&&Qf(this,b,a),Wf(this,"nodeGroupKey",De,t,a,e,b),"string"==typeof t&&this.Ba(a,t))}else ad(a,t,b)}},br.prototype.copyNodeData=function(a){return null===a?null:(a=Bf.prototype.copyNodeData.call(this,a),this.ak||""===this.se||void 0===sd(a,this.se)||ad(a,this.se,void 0),a)},br.prototype.setDataProperty=function(a,b,t){if(this.sb(a))if(b===this.nodeKeyProperty)this.Hm(a,t);else{if(b===this.nodeCategoryProperty)return void this.Jq(a,t);if(b===this.nodeGroupKeyProperty)return void this.Mt(a,t)}else if(this.cd(a)){if(b===this.linkFromKeyProperty)return void md(this,a,t,!0);if(b===this.linkToKeyProperty)return void md(this,a,t,!1);if(b===this.linkFromPortIdProperty)return void xd(this,a,t,!0);if(b===this.linkToPortIdProperty)return void xd(this,a,t,!1);if(b===this.linkKeyProperty)return void this.Nt(a,t);if(b===this.linkCategoryProperty)return void this.Lt(a,t);if(b===this.linkLabelKeysProperty)return void this.ew(a,t)}var e=sd(a,b);e!==t&&(ad(a,b,t),this.Ft(a,b,e,t))},(n=br.prototype).Xj=function(a,b){if(b){var t,e=this.sb(a),n=this.cd(a);for(t in b)"__gohashid"===t||e&&t===this.nodeKeyProperty||e&&t===this.nodeIsGroupProperty&&sd(a,t)===b[t]||n&&t===this.linkKeyProperty||this.setDataProperty(a,t,b[t])}},n.Hq=function(a,b){Bf.prototype.Hq.call(this,a,b);for(var t=this.ab.iterator;t.next();)this.$v(t.value,a,b);for(t=this.$f.iterator;t.next();){var e=t.value,n=a,o=b;if(yd(this,e,!0)===n){var g=this.We;ad(e,g,o),Wf(this,"linkFromKey",De,g,e,n,o),"string"==typeof g&&this.Ba(e,g)}if(yd(this,e,!1)===n&&(ad(e,g=this.Xe,o),Wf(this,"linkToKey",De,g,e,n,o),"string"==typeof g&&this.Ba(e,g)),g=this.Cg(e),Array.isArray(g))for(var r=g.length,h=this.Md,l=0;l<r;l++)g[l]===n&&(g[l]=o,Wf(this,"linkLabelKeys",Fe,h,e,n,o,l,l))}},n.$v=function(a,b,t){if(this.Yi(a)===b){var e=this.se;ad(a,e,t),Wf(this,"nodeGroupKey",De,e,a,b,t),"string"==typeof e&&this.Ba(a,e)}},n.sw=function(){Bf.prototype.sw.call(this);for(var a=this.linkDataArray,b=a.length,t=0;t<b;t++)kd(this,a[t])},n.Dm=function(a){Bf.prototype.Dm.call(this,a);var b=id(this,a=this.ja(a));if(null!==b){var t=I();for(b=b.iterator;b.next();){var e=b.value;if(this.sb(e)){if(this.Yi(e)===a){var n=this.se;Wf(this,"nodeGroupKey",De,n,e,a,a),"string"==typeof n&&this.Ba(e,n),t.push(e)}}else if(yd(this,e,!0)===a&&(n=this.We,Wf(this,"linkFromKey",De,n,e,a,a),"string"==typeof n&&this.Ba(e,n),t.push(e)),yd(this,e,!1)===a&&(n=this.Xe,Wf(this,"linkToKey",De,n,e,a,a),"string"==typeof n&&this.Ba(e,n),t.push(e)),n=this.Cg(e),Array.isArray(n))for(var o=n.length,g=this.Md,r=0;r<o;r++)n[r]===a&&(Wf(this,"linkLabelKeys",Fe,g,e,a,a,r,r),t.push(e))}for(b=0;b<t.length;b++)_f(this,a,t[b]);R(t)}},n.Cm=function(a){Bf.prototype.Cm.call(this,a);var b=this.Yi(a);null===this.Ib(b)&&Qf(this,b,a)},n.Oq=function(a){Bf.prototype.Oq.call(this,a),_f(this,this.Yi(a),a)},n.xv=function(a){if(null===a)return"";var b=this.Bj;return""===b||void 0===(b=sd(a,b))?"":"string"==typeof b?b:(N("getCategoryForLinkData found a non-string category for "+a+": "+b),"")},br.prototype.getLinkCategoryForData=function(a){return this.xv(a)},br.prototype.Lt=function(a,b){if(null!==a){var t=this.Bj;if(""!==t)if(this.cd(a)){var e=sd(a,t);void 0===e&&(e=""),e!==b&&(ad(a,t,b),Wf(this,"linkCategory",De,t,a,e,b),"string"==typeof t&&this.Ba(a,t))}else ad(a,t,b)}},br.prototype.setLinkCategoryForData=function(a,b){this.Lt(a,b)},br.prototype.ik=function(){return!0},br.prototype.pm=function(){return!0},br.prototype.vt=function(){return!0},br.prototype.jk=function(){return!0},v.Object.defineProperties(br.prototype,{archetypeNodeData:{get:function(){return this.ij},set:function(a){var b=this.ij;b!==a&&(this.ij=a,this.g("archetypeNodeData",b,a))}},linkFromKeyProperty:{get:function(){return this.We},set:function(a){var b=this.We;b!==a&&(this.We=a,this.g("linkFromKeyProperty",b,a))}},linkToKeyProperty:{get:function(){return this.Xe},set:function(a){var b=this.Xe;b!==a&&(this.Xe=a,this.g("linkToKeyProperty",b,a))}},linkFromPortIdProperty:{get:function(){return this.Cj},set:function(a){var b=this.Cj;b!==a&&(this.Cj=a,this.g("linkFromPortIdProperty",b,a))}},linkToPortIdProperty:{get:function(){return this.Dj},set:function(a){var b=this.Dj;b!==a&&(this.Dj=a,this.g("linkToPortIdProperty",b,a))}},linkLabelKeysProperty:{get:function(){return this.Md},set:function(a){var b=this.Md;b!==a&&(this.Md=a,this.g("linkLabelKeysProperty",b,a))}},linkDataArray:{get:function(){return this.Oc},set:function(a){var b=this.Oc;if(b!==a){this.ob.clear();for(var t=a.length,e=0;e<t;e++){var n=a[e];if(!j(n))return void N("GraphLinksModel.linkDataArray must only contain Objects, not: "+n);pt(n)}if(this.Oc=a,""!==this.linkKeyProperty){for(e=new lt,n=0;n<t;n++){var o=a[n],g=this.Vb(o);void 0===g||null!==this.ob.H(g)?e.add(o):this.ob.add(g,o)}for(e=e.iterator;e.next();)n=e.value,this.xq(n),void 0!==(o=this.Vb(n))&&this.ob.add(o,n)}for(e=new ct,n=0;n<t;n++)e.add(a[n]);for(this.$f=e,Wf(this,"linkDataArray",De,"linkDataArray",this,b,a),b=0;b<t;b++)kd(this,a[b])}}},linkKeyProperty:{get:function(){return this.wi},set:function(a){var b=this.wi;if(b!==a){this.wi=a,this.ob.clear();for(var t=this.linkDataArray.length,e=0;e<t;e++){var n=this.linkDataArray[e],o=this.Vb(n);void 0===o&&(this.xq(n),o=this.Vb(n)),void 0!==o&&this.ob.add(o,n)}this.g("linkKeyProperty",b,a)}}},makeUniqueLinkKeyFunction:{get:function(){return this.xl},set:function(a){var b=this.xl;b!==a&&(this.xl=a,this.g("makeUniqueLinkKeyFunction",b,a))}},copyLinkDataFunction:{get:function(){return this.Nk},set:function(a){var b=this.Nk;b!==a&&(this.Nk=a,this.g("copyLinkDataFunction",b,a))}},nodeIsGroupProperty:{get:function(){return this.Bl},set:function(a){var b=this.Bl;b!==a&&(this.Bl=a,this.g("nodeIsGroupProperty",b,a))}},nodeGroupKeyProperty:{get:function(){return this.se},set:function(a){var b=this.se;b!==a&&(this.se=a,this.g("nodeGroupKeyProperty",b,a))}},ak:{get:function(){return this.mn},set:function(a){this.mn!==a&&(this.mn=a)}},linkCategoryProperty:{get:function(){return this.Bj},set:function(a){var b=this.Bj;b!==a&&(this.Bj=a,this.g("linkCategoryProperty",b,a))}}}),v.Object.defineProperties(br,{type:{get:function(){return"GraphLinksModel"}}}),br.prototype.setCategoryForLinkData=br.prototype.Lt,br.prototype.getCategoryForLinkData=br.prototype.xv,br.prototype.assignAllDataProperties=br.prototype.Xj,br.prototype.setGroupKeyForNodeData=br.prototype.Mt,br.prototype.getGroupKeyForNodeData=br.prototype.Yi,br.prototype.isGroupForNodeData=br.prototype.Iv,br.prototype.copyLinkData=br.prototype.hq,br.prototype.mergeLinkDataArray=br.prototype.fA,br.prototype.removeLinkDataCollection=br.prototype.nA,br.prototype.removeLinkData=br.prototype.zm,br.prototype.addLinkDataCollection=br.prototype.Iy,br.prototype.addLinkData=br.prototype.Ni,br.prototype.containsLinkData=br.prototype.cd,br.prototype.makeLinkDataKeyUnique=br.prototype.xq,br.prototype.findLinkDataForKey=br.prototype.zg,br.prototype.setKeyForLinkData=br.prototype.Nt,br.prototype.getKeyForLinkData=br.prototype.Vb,br.prototype.removeLabelKeyForLinkData=br.prototype.ay,br.prototype.addLabelKeyForLinkData=br.prototype.ev,br.prototype.setLabelKeysForLinkData=br.prototype.ew,br.prototype.getLabelKeysForLinkData=br.prototype.Cg,br.prototype.setToPortIdForLinkData=br.prototype.ny,br.prototype.getToPortIdForLinkData=br.prototype.Jz,br.prototype.setFromPortIdForLinkData=br.prototype.jy,br.prototype.getFromPortIdForLinkData=br.prototype.Dz,br.prototype.setToKeyForLinkData=br.prototype.my,br.prototype.getToKeyForLinkData=br.prototype.Iz,br.prototype.setFromKeyForLinkData=br.prototype.iy,br.prototype.getFromKeyForLinkData=br.prototype.Cz,br.prototype.clear=br.prototype.clear;var Md=Object.freeze([]);function Sd(a){Bf.call(this),this.te="parent",this.on=!1,this.Ij="parentLinkCategory",void 0!==a&&(this.nodeDataArray=a)}function Pd(){Zc.call(this),this.Tw=this.Cn=this.$b=0,this.Ar=360,this.Sw=hr,this.qj=0,this.Kw=new Mt,this.lr=this.Td=0,this.Ys=new Wd,this.cu=this.Hj=0,this.zy=600,this.gp=NaN,this.Ym=1,this.Lp=0,this.Tl=360,this.Ab=hr,this.J=Ed,this.Qc=Ud,this.Kc=sf,this.ff=6,this.Qo=Kd}function Nd(a,b,t,e,n){var o=a.Ar,g=a.$b;a=a.Td,e=e*Math.PI/180,t=t*Math.PI/180;for(var r=b.length,h=0;h<r;h++){var l=e+(n===Ed?h*t/(360<=o?r:r-1):-h*t/r),c=b.L(h),f=g*Math.tan(l)/a;f=Math.sqrt((g*g+a*a*f*f)/(1+f*f)),c.centerX=f*Math.cos(l),c.centerY=f*Math.sin(l),c.actualAngle=180*l/Math.PI}}function Cd(a,b,t,e){var n=a.$b,o=a.Td,g=a.qj;t=t*Math.PI/180;for(var r=b.length,h=0;h<r;h++){var l=b.L(h),c=b.L(h===r-1?0:h+1),f=o*Math.sin(t);l.centerX=n*Math.cos(t),l.centerY=f,l.actualAngle=180*t/Math.PI,isNaN(l.diameter)&&$d(l,0),isNaN(c.diameter)&&$d(c,0),l=Od(a,n,o,e===Ed?t:-t,(l.diameter+c.diameter)/2+g),t+=e===Ed?l:-l}}function Td(a,b,t,e){var n=a.$b,o=a.Td,g=a.lr;t=t*Math.PI/180;for(var r=b.length,h=0;h<r;h++){var l=b.L(h);l.centerX=n*Math.cos(t),l.centerY=o*Math.sin(t),l.actualAngle=180*t/Math.PI,l=Od(a,n,o,e===Ed?t:-t,g),t+=e===Ed?l:-l}}function Ld(a,b,t,e,n){var o=a.Ar;if(a.Hj=0,a.Ys=new Wd,360>t){for(o=e+(n===Ed?o:-o);0>o;)o+=360;180<(o%=360)&&(o-=360),o*=Math.PI/180,a.cu=o,function t(a,b,e,n,o){for(var r=a.$b,g=a.Td,h=a.Cn,l=r*Math.cos(n*Math.PI/180),c=g*Math.sin(n*Math.PI/180),f=Mt.alloc(),d=b.na(),p=0;p<d.length&&(d[p].centerX=l,d[p].centerY=c,!(p>=d.length-1));p++)Ad(a,l,c,d,p,o,f)||jd(a,l,c,d,p,o,f),l=f.x,c=f.y;if(Mt.free(f),a.Hj++,!(23<a.Hj)){if(l=Math.atan2(c,l),l=o===Ed?a.cu-l:l-a.cu,l=Math.abs(l)<Math.abs(l-2*Math.PI)?l:l-2*Math.PI,r=l*(r+g)/2,g=a.Ys,Math.abs(r)<Math.abs(g.km))for(g.km=r,g.Ak=[],g.Mm=[],l=0;l<d.length;l++)g.Ak[l]=d[l].bounds.x,g.Mm[l]=d[l].bounds.y;1<Math.abs(r)&&(a.$b=8>a.Hj?a.$b-r/(2*Math.PI):a.$b-(0<r?1.7:-2.3),a.Td=a.$b*h,t(a,b,e,n,o))}}(a,b,t,e,n)}else!function t(a,b,e,n,o){var r=a.$b,g=a.qj,h=a.Cn,l=r*Math.cos(n*Math.PI/180),c=a.Td*Math.sin(n*Math.PI/180),f=b.na();if(3===f.length)f[0].centerX=r,f[0].centerY=0,f[1].centerX=f[0].centerX-f[0].width/2-f[1].width/2-g,f[1].y=f[0].y,f[2].centerX=(f[0].centerX+f[1].centerX)/2,f[2].y=f[0].y-f[2].height-g;else if(4===f.length)f[0].centerX=r,f[0].centerY=0,f[2].centerX=-f[0].centerX,f[2].centerY=f[0].centerY,f[1].centerX=0,f[1].y=Math.min(f[0].y,f[2].y)-f[1].height-g,f[3].centerX=0,f[3].y=Math.max(f[0].y+f[0].height+g,f[2].y+f[2].height+g);else{r=Mt.alloc();for(var d=0;d<f.length&&(f[d].centerX=l,f[d].centerY=c,!(d>=f.length-1));d++)Ad(a,l,c,f,d,o,r)||jd(a,l,c,f,d,o,r),l=r.x,c=r.y;if(Mt.free(r),a.Hj++,!(23<a.Hj)){l=f[0].centerX,c=f[0].centerY,r=f[f.length-1].centerX,d=f[f.length-1].centerY;var p=Math.abs(l-r)-((f[0].width+f[f.length-1].width)/2+g),y=Math.abs(c-d)-((f[0].height+f[f.length-1].height)/2+g);g=0,1>Math.abs(y)?Math.abs(l-r)<(f[0].width+f[f.length-1].width)/2&&(g=0):g=0<y?y:1>Math.abs(p)?0:p,l=Math.abs(r)>Math.abs(d)?0<r!=c>d:0<d!=l<r,(l=o===Ed?l:!l)&&(g=-Math.abs(g),g=Math.min(g,-f[f.length-1].width),g=Math.min(g,-f[f.length-1].height)),a.Ys.compare(g,f),1<Math.abs(g)&&(a.$b=8>a.Hj?a.$b-g/(2*Math.PI):5>f.length&&10<g?a.$b/2:a.$b-(0<g?1.7:-2.3),a.Td=a.$b*h,t(a,b,e,n,o))}}}(a,b,t,e,n);a.Ys.commit(b)}function Ad(a,b,t,e,n,o,g){var r=a.$b,h=a.Td,l=0;a=(e[n].width+e[n+1].width)/2+a.qj;var c=!1;if(0<=t!=(o===Ed)){if((o=b+a)>r){if((o=b-a)<-r)return g.x=o,g.y=l,!1;c=!0}}else if((o=b-a)<-r){if((o=b+a)>r)return g.x=o,g.y=l,!1;c=!0}return l=Math.sqrt(1-Math.min(1,o*o/(r*r)))*h,0>t!==c&&(l=-l),Math.abs(t-l)>(e[n].height+e[n+1].height)/2?(g.x=o,g.y=l,!1):(g.x=o,g.y=l,!0)}function jd(a,b,t,e,n,o,g){var r=a.$b,h=a.Td,l=0;if(a=(e[n].height+e[n+1].height)/2+a.qj,e=!1,0<=b!=(o===Ed)){if((o=t-a)<-h){if((o=t+a)>h)return g.x=l,void(g.y=o);e=!0}}else if((o=t+a)>h){if((o=t-a)<-h)return g.x=l,void(g.y=o);e=!0}l=Math.sqrt(1-Math.min(1,o*o/(h*h)))*r,0>b!==e&&(l=-l),g.x=l,g.y=o}function Dd(a,b,t,e,n){var o=a.zy;if(.001>Math.abs(a.Cn-1))return void 0!==e&&void 0!==n?n*b:2*Math.PI*b;a=b>t?Math.sqrt(b*b-t*t)/b:Math.sqrt(t*t-b*b)/t;for(var g=0,r=void 0!==e&&void 0!==n?n/(o+1):Math.PI/(2*(o+1)),h=0,l=0;l<=o;l++){h=void 0!==e&&void 0!==n?e+l*n/o:l*Math.PI/(2*o);var c=Math.sin(h);g+=Math.sqrt(1-a*a*c*c)*r}return void 0!==e&&void 0!==n?(b>t?b:t)*g:4*(b>t?b:t)*g}function Fd(a,b,t,e,n){return b/(void 0!==e&&void 0!==n?Dd(a,1,t,e,n):Dd(a,1,t))}function Od(a,b,t,e,n){if(.001>Math.abs(a.Cn-1))return n/b;var o=b>t?Math.sqrt(b*b-t*t)/b:Math.sqrt(t*t-b*b)/t,g=0;a=2*Math.PI/(700*a.network.vertexes.count),b>t&&(e+=Math.PI/2);for(var r=0;;r++){var h=Math.sin(e+r*a);if((g+=(b>t?b:t)*Math.sqrt(1-o*o*h*h)*a)>=n)return r*a}}br.className="GraphLinksModel",ld.GraphLinksModel=br,Bf.constructGraphLinksModel=Bf.constructGraphLinksModel=function(){return new br},Bf.initDiagramModel=nd=function(){return new br},m(Sd,Bf),Sd.constructGraphLinksModel=Bf.constructGraphLinksModel,Sd.prototype.cloneProtected=function(a){Bf.prototype.cloneProtected.call(this,a),a.te=this.te,a.on=this.on,a.Ij=this.Ij},(n=Sd.prototype).toString=function(a){if(void 0===a&&(a=0),2<=a)return this.Mq();var b=(""!==this.name?this.name:"")+" TreeModel";if(0<a){b+="\n node data:";for(var t=(a=this.nodeDataArray).length,e=0;e<t;e++){var n=a[e];b+=" "+this.ja(n)+":"+z(n)}}return b},n.zk=function(){var a=Bf.prototype.zk.call(this),b="";return"parent"!==this.nodeParentKeyProperty&&"string"==typeof this.nodeParentKeyProperty&&(b+=',\n  "nodeParentKeyProperty": '+this.quote(this.nodeParentKeyProperty)),a+b},n.Eq=function(a){Bf.prototype.Eq.call(this,a),a.nodeParentKeyProperty&&(this.nodeParentKeyProperty=a.nodeParentKeyProperty)},n.Rq=function(a){return zf(this,a,"nodeParentKeyProperty"),Bf.prototype.Rq.call(this,a)},n.Dq=function(a){void 0!==a.nodeParentKeyProperty&&a.nodeParentKeyProperty!==this.nodeParentKeyProperty&&N("applyIncrementalJson cannot change Model properties"),Bf.prototype.Dq.call(this,a)},n.rm=function(a){return a},n.$i=function(a){if(null!==a){var b=this.te;if(""!==b&&void 0!==(b=sd(a,b))){if(Jf(b))return b;N("ParentKey value for node data "+a+" is not a number or a string: "+b)}}},n.He=function(a,b){if(null===b&&(b=void 0),null!==a){var t=this.te;if(""!==t)if(b=this.rm(b),this.sb(a)){var e=sd(a,t);e!==b&&(_f(this,e,a),ad(a,t,b),null===this.Ib(b)&&Qf(this,b,a),Wf(this,"nodeParentKey",De,t,a,e,b),"string"==typeof t&&this.Ba(a,t))}else ad(a,t,b)}},n.yv=function(a){if(null===a)return"";var b=this.Ij;return""===b||void 0===(b=sd(a,b))?"":"string"==typeof b?b:(N("getParentLinkCategoryForNodeData found a non-string category for "+a+": "+b),"")},Sd.prototype.getLinkCategoryForData=function(a){return this.yv(a)},Sd.prototype.fw=function(a,b){if(null!==a){var t=this.Ij;if(""!==t)if(this.sb(a)){var e=sd(a,t);void 0===e&&(e=""),e!==b&&(ad(a,t,b),Wf(this,"parentLinkCategory",De,t,a,e,b),"string"==typeof t&&this.Ba(a,t))}else ad(a,t,b)}},Sd.prototype.setLinkCategoryForData=function(a,b){this.fw(a,b)},Sd.prototype.copyNodeData=function(a){return null===a?null:(a=Bf.prototype.copyNodeData.call(this,a),this.bk||""===this.te||void 0===sd(a,this.te)||ad(a,this.te,void 0),a)},Sd.prototype.setDataProperty=function(a,b,t){if(this.sb(a))if(b===this.nodeKeyProperty)this.Hm(a,t);else{if(b===this.nodeCategoryProperty)return void this.Jq(a,t);if(b===this.nodeParentKeyProperty)return void this.He(a,t)}var e=sd(a,b);e!==t&&(ad(a,b,t),this.Ft(a,b,e,t))},(n=Sd.prototype).Hq=function(a,b){Bf.prototype.Hq.call(this,a,b);for(var t=this.ab.iterator;t.next();)this.$v(t.value,a,b)},n.$v=function(a,b,t){if(this.$i(a)===b){var e=this.te;ad(a,e,t),Wf(this,"nodeParentKey",De,e,a,b,t),"string"==typeof e&&this.Ba(a,e)}},n.Dm=function(a){Bf.prototype.Dm.call(this,a);var b=id(this,a=this.ja(a));if(null!==b){var t=I();for(b=b.iterator;b.next();){var e=b.value;if(this.sb(e)&&this.$i(e)===a){var n=this.te;Wf(this,"nodeParentKey",De,n,e,a,a),"string"==typeof n&&this.Ba(e,n),t.push(e)}}for(b=0;b<t.length;b++)_f(this,a,t[b]);R(t)}},n.Cm=function(a){Bf.prototype.Cm.call(this,a);var b=this.$i(a);b=this.rm(b),null===this.Ib(b)&&Qf(this,b,a)},n.Oq=function(a){Bf.prototype.Oq.call(this,a),_f(this,this.$i(a),a)},n.qm=function(){return!0},n.vt=function(){return!0},v.Object.defineProperties(Sd.prototype,{nodeParentKeyProperty:{get:function(){return this.te},set:function(a){var b=this.te;b!==a&&(this.te=a,this.g("nodeParentKeyProperty",b,a))}},bk:{get:function(){return this.on},set:function(a){this.on!==a&&(this.on=a)}},parentLinkCategoryProperty:{get:function(){return this.Ij},set:function(a){var b=this.Ij;b!==a&&(this.Ij=a,this.g("parentLinkCategoryProperty",b,a))}},linkCategoryProperty:{get:function(){return this.parentLinkCategoryProperty},set:function(a){this.parentLinkCategoryProperty=a}}}),v.Object.defineProperties(Sd,{type:{get:function(){return"TreeModel"}}}),Sd.prototype.setParentLinkCategoryForNodeData=Sd.prototype.fw,Sd.prototype.getParentLinkCategoryForNodeData=Sd.prototype.yv,Sd.prototype.setParentKeyForNodeData=Sd.prototype.He,Sd.prototype.getParentKeyForNodeData=Sd.prototype.$i,Sd.className="TreeModel",ld.TreeModel=Sd,m(Pd,Zc),Pd.prototype.cloneProtected=function(a){Zc.prototype.cloneProtected.call(this,a),a.gp=this.gp,a.Ym=this.Ym,a.Lp=this.Lp,a.Tl=this.Tl,a.Ab=this.Ab,a.J=this.J,a.Qc=this.Qc,a.Kc=this.Kc,a.ff=this.ff,a.Qo=this.Qo},Pd.prototype.cb=function(a){a.classType===Pd?a===Xd||a===qd||a===Yd||a===Gd||a===Ud?this.sorting=a:a===zd||a===Vd||a===Ed||a===tr?this.direction=a:a===Id||a===Bd||a===hr||a===Rd?this.arrangement=a:a!==Hd&&a!==Kd||(this.nodeDiameterFormula=a):Zc.prototype.cb.call(this,a)},Pd.prototype.createNetwork=function(){return new Jd(this)},Pd.prototype.doLayout=function(a){if(null===this.network&&(this.network=this.makeNetwork(a)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin),1>=(a=this.network.vertexes).count)1===a.count&&((a=a.first()).centerX=0,a.centerY=0);else{var b=new lt;b.addAll(a.iterator),a=new lt;var t,e,n=new lt,o=this.sort(b),g=this.lr,r=this.arrangement,h=this.nodeDiameterFormula,l=this.radius;(!isFinite(l)||0>=l)&&(l=NaN);var c=this.aspectRatio;(!isFinite(c)||0>=c)&&(c=1);var f=this.startAngle;isFinite(f)||(f=0);var p=this.sweepAngle;if((!isFinite(p)||360<p||1>p)&&(p=360),b=this.spacing,isFinite(b)||(b=NaN),r===Rd&&h===Hd?r=hr:r===Rd&&h!==Hd&&(r=this.arrangement),(this.direction===zd||this.direction===Vd)&&this.sorting!==Ud){for(h=0;!(h>=o.length)&&(a.add(o.L(h)),!(h+1>=o.length));h+=2)n.add(o.L(h+1));this.direction===zd?(this.arrangement===Rd&&a.reverse(),(o=new lt).addAll(a),o.addAll(n)):(this.arrangement===Rd&&n.reverse(),(o=new lt).addAll(n),o.addAll(a))}h=o.length;for(var d=e=t=0;d<o.length;d++){var q=f+p*e*(this.direction===Ed?1:-1)/h,u=o.L(d).diameter;isNaN(u)&&(u=$d(o.L(d),q)),360>p&&(0===d||d===o.length-1)&&(u/=2),t+=u,e++}if(isNaN(l)||r===Rd){if(isNaN(b)&&(b=6),r!==hr&&r!==Rd){for(e=-1/0,g=0;g<h;g++)d=o.L(g),t=o.L(g===h-1?0:g+1),isNaN(d.diameter)&&$d(d,0),isNaN(t.diameter)&&$d(t,0),e=Math.max(e,(d.diameter+t.diameter)/2);g=e+b,l=r===Id?(e+b)/(2*Math.PI/h):Fd(this,g*(360<=p?h:h-1),c,f*Math.PI/180,p*Math.PI/180)}else l=Fd(this,t+(360<=p?h:h-1)*(r!==Rd?b:1.6*b),c,f*Math.PI/180,p*Math.PI/180);e=l*c}else if(d=Dd(this,l,e=l*c,f*Math.PI/180,p*Math.PI/180),isNaN(b))r!==hr&&r!==Rd||(b=(d-t)/(360<=p?h:h-1));else if(r===hr||r===Rd)(d=(d-t)/(360<=p?h:h-1))<b?e=(l=Fd(this,t+b*(360<=p?h:h-1),c,f*Math.PI/180,p*Math.PI/180))*c:b=d;else{for(g=-1/0,t=0;t<h;t++)q=o.L(t),u=o.L(t===h-1?0:t+1),isNaN(q.diameter)&&$d(q,0),isNaN(u.diameter)&&$d(u,0),g=Math.max(g,(q.diameter+u.diameter)/2);(t=Fd(this,(g+=b)*(360<=p?h:h-1),c,f*Math.PI/180,p*Math.PI/180))>l?e=(l=t)*c:g=d/(360<=p?h:h-1)}if(this.Sw=r,this.$b=l,this.Cn=c,this.Tw=f,this.Ar=p,this.qj=b,this.Td=e,this.lr=g,b=o,o=this.Sw,r=this.$b,l=this.Tw,c=this.Ar,f=this.qj,p=this.Td,h=this.lr,this.direction!==zd&&this.direction!==Vd||o!==Rd)if(this.direction===zd||this.direction===Vd){switch(g=0,o){case Bd:g=180*Od(this,r,p,l,h)/Math.PI;break;case hr:h=b=0,null!==(g=a.first())&&(b=$d(g,Math.PI/2)),null!==(g=n.first())&&(h=$d(g,Math.PI/2)),g=180*Od(this,r,p,l,f+(b+h)/2)/Math.PI;break;case Id:g=c/b.length}if(this.direction===zd){switch(o){case Bd:Td(this,a,l,tr);break;case hr:Cd(this,a,l,tr);break;case Id:Nd(this,a,c/2,l,tr)}switch(o){case Bd:Td(this,n,l+g,Ed);break;case hr:Cd(this,n,l+g,Ed);break;case Id:Nd(this,n,c/2,l+g,Ed)}}else{switch(o){case Bd:Td(this,n,l,tr);break;case hr:Cd(this,n,l,tr);break;case Id:Nd(this,n,c/2,l,tr)}switch(o){case Bd:Td(this,a,l+g,Ed);break;case hr:Cd(this,a,l+g,Ed);break;case Id:Nd(this,a,c/2,l+g,Ed)}}}else switch(o){case Bd:Td(this,b,l,this.direction);break;case hr:Cd(this,b,l,this.direction);break;case Id:Nd(this,b,c,l,this.direction);break;case Rd:Ld(this,b,c,l,this.direction)}else Ld(this,b,c,l-c/2,Ed)}this.updateParts(),this.network=null,this.isValidLayout=!0},Pd.prototype.commitLayout=function(){this.commitNodes(),this.isRouting&&this.commitLinks()},Pd.prototype.commitNodes=function(){var a=null!==this.group&&null!==this.group.placeholder&&this.group.isSubGraphExpanded,b=a?this.group.location.copy():null,t=this.actualCenter;a?t=new Mt(0,0):(t.x=this.arrangementOrigin.x+this.$b,t.y=this.arrangementOrigin.y+this.Td);for(var e=this.network.vertexes.iterator;e.next();){var n=e.value;n.x+=t.x,n.y+=t.y,n.commit()}a&&(this.group.yb(),a=this.group.position.copy(),t=this.group.location.copy(),b=b.$d(t.$d(a)),this.group.move(b),this.Kw=b.$d(a))},Pd.prototype.commitLinks=function(){for(var a=this.network.edges.iterator;a.next();)a.value.commit()},Pd.prototype.sort=function(a){switch(this.sorting){case Yd:break;case Gd:a.reverse();break;case Xd:a.sort(this.comparer);break;case qd:a.sort(this.comparer),a.reverse();break;case Ud:for(var b=[],t=0;t<a.length;t++)b.push(0);t=new lt;for(var e=0;e<a.length;e++){var n=-1,o=-1;if(0===e)for(var g=0;g<a.length;g++){var r=a.L(g).edgesCount;r>n&&(n=r,o=g)}else for(g=0;g<a.length;g++)(r=b[g])>n&&(n=r,o=g);for(t.add(a.L(o)),b[o]=-1,g=(o=a.L(o)).sourceEdges;g.next();)0>(n=a.indexOf(g.value.fromVertex))||0<=b[n]&&b[n]++;for(o=o.destinationEdges;o.next();)0>(n=a.indexOf(o.value.toVertex))||0<=b[n]&&b[n]++}for(a=[],b=0;b<t.length;b++){for(n=t.L(b),a[b]=[],o=n.destinationEdges;o.next();)(e=t.indexOf(o.value.toVertex))!==b&&0>a[b].indexOf(e)&&a[b].push(e);for(n=n.sourceEdges;n.next();)(e=t.indexOf(n.value.fromVertex))!==b&&0>a[b].indexOf(e)&&a[b].push(e)}for(o=[],b=0;b<a.length;b++)o[b]=0;b=[],g=[],r=[],n=[],e=new lt;for(var h=0,l=0;l<a.length;l++){var c=a[l].length;if(1===c)n.push(l);else if(0===c)e.add(t.L(l));else{if(0===h)b.push(l);else{for(var f=c=1/0,p=-1,d=[],q=0;q<b.length;q++)0>a[b[q]].indexOf(b[q===b.length-1?0:q+1])&&d.push(q===b.length-1?0:q+1);if(0===d.length)for(q=0;q<b.length;q++)d.push(q);for(q=0;q<d.length;q++){for(var u=d[q],y=a[l],m=0,v=0;v<g.length;v++){var x=o[g[v]],w=o[r[v]];if(x<w){var k=x;x=w}else k=w;if(k<u&&u<=x)for(w=0;w<y.length;w++){var M=y[w];0>b.indexOf(M)||k<o[M]&&o[M]<x||k===o[M]||x===o[M]||m++}else for(w=0;w<y.length;w++)M=y[w],0>b.indexOf(M)||k<o[M]&&o[M]<x&&k!==o[M]&&x!==o[M]&&m++}for(y=m,v=m=0;v<a[l].length;v++)0<=(k=b.indexOf(a[l][v]))&&(m+=(k=Math.abs(u-(k>=u?k+1:k)))<b.length+1-k?k:b.length+1-k);for(v=0;v<g.length;v++)(k=o[g[v]])>=u&&k++,(x=o[r[v]])>=u&&x++,k>x&&(w=x,x=k,k=w),x-k<(b.length+2)/2==(k<u&&u<=x)&&m++;(y<c||y===c&&m<f)&&(c=y,f=m,p=u)}for(b.splice(p,0,l),c=0;c<b.length;c++)o[b[c]]=c;for(c=0;c<a[l].length;c++)f=a[l][c],0<=b.indexOf(f)&&(g.push(l),r.push(f))}h++}}for(g=b.length;;){for(o=!0,r=0;r<n.length;r++)if(l=a[h=n[r]][0],0<=(c=b.indexOf(l))){for(p=f=0;p<a[l].length;p++)0>(d=b.indexOf(a[l][p]))||d===c||(f+=d<c!=(q=d>c?d-c:c-d)>g-q?1:-1);b.splice(0>f?c:c+1,0,h),n.splice(r,1),r--}else o=!1;if(o)break;b.push(n[0]),n.splice(0,1)}for(a=0;a<b.length;a++)e.add(t.L(b[a]));return e;default:N("Invalid sorting type.")}return a},v.Object.defineProperties(Pd.prototype,{radius:{get:function(){return this.gp},set:function(a){this.gp!==a&&(0<a||isNaN(a))&&(this.gp=a,this.C())}},aspectRatio:{get:function(){return this.Ym},set:function(a){this.Ym!==a&&0<a&&(this.Ym=a,this.C())}},startAngle:{get:function(){return this.Lp},set:function(a){this.Lp!==a&&(this.Lp=a,this.C())}},sweepAngle:{get:function(){return this.Tl},set:function(a){this.Tl!==a&&(this.Tl=0<a&&360>=a?a:360,this.C())}},arrangement:{get:function(){return this.Ab},set:function(a){this.Ab===a||a!==Rd&&a!==hr&&a!==Bd&&a!==Id||(this.Ab=a,this.C())}},direction:{get:function(){return this.J},set:function(a){this.J===a||a!==Ed&&a!==tr&&a!==zd&&a!==Vd||(this.J=a,this.C())}},sorting:{get:function(){return this.Qc},set:function(a){this.Qc===a||a!==Yd&&a!==Gd&&a!==Xd&&!qd&&a!==Ud||(this.Qc=a,this.C())}},comparer:{get:function(){return this.Kc},set:function(a){this.Kc!==a&&(this.Kc=a,this.C())}},spacing:{get:function(){return this.ff},set:function(a){this.ff!==a&&(this.ff=a,this.C())}},nodeDiameterFormula:{get:function(){return this.Qo},set:function(a){this.Qo===a||a!==Kd&&a!==Hd||(this.Qo=a,this.C())}},actualXRadius:{get:function(){return this.$b}},actualYRadius:{get:function(){return this.Td}},actualSpacing:{get:function(){return this.qj}},actualCenter:{get:function(){return this.Kw}}});var hr=new _(Pd,"ConstantSpacing",0),Bd=new _(Pd,"ConstantDistance",1),Id=new _(Pd,"ConstantAngle",2),Rd=new _(Pd,"Packed",3),Ed=new _(Pd,"Clockwise",4),tr=new _(Pd,"Counterclockwise",5),zd=new _(Pd,"BidirectionalLeft",6),Vd=new _(Pd,"BidirectionalRight",7),Yd=new _(Pd,"Forwards",8),Gd=new _(Pd,"Reverse",9),Xd=new _(Pd,"Ascending",10),qd=new _(Pd,"Descending",11),Ud=new _(Pd,"Optimized",12),Kd=new _(Pd,"Pythagorean",13),Hd=new _(Pd,"Circular",14);function Wd(){this.km=-1/0,this.Mm=this.Ak=null}function Jd(a){_c.call(this,a)}function Zd(a){rf.call(this,a),this.I=this.oj=NaN}function $d(a,b){var t=a.network;if(null===t)return NaN;if(null===(t=t.layout))return NaN;if(t.arrangement===Rd)if(t.nodeDiameterFormula===Hd)a.oj=Math.max(a.width,a.height);else{if(t=Math.abs(Math.sin(b)),b=Math.abs(Math.cos(b)),0===t)return a.width;if(0===b)return a.height;a.oj=Math.min(a.height/t,a.width/b)}else a.oj=t.nodeDiameterFormula===Hd?Math.max(a.width,a.height):Math.sqrt(a.width*a.width+a.height*a.height);return a.oj}function Qd(a){af.call(this,a)}function _d(){Zc.call(this),this.Bh=null,this.jo=0,this.Ad=new qt(100,100).freeze(),this.Xm=!1,this.df=!0,this.Zc=!1,this.yl=100,this.Fn=1,this.Wf=1e3,this.Ho=10,this.hp=Math,this.Uk=.05,this.Tk=50,this.Rk=150,this.Sk=0,this.wn=10,this.vn=5}function tp(a,b,t){if(function(a,b){if(10<b||3>a.network.vertexes.count)return!1;for(a.Bh=a.network.vertexes.na(),(a=a.Bh).sort((function(a,b){return null===a||null===b||a===b?0:b.xd-a.xd})),b=a.length-1;0<=b&&1>=a[b].xd;)b--;return 1<a.length-b}(a,b)){var e=a.Wf;a.Wf*=1+1/(b+1);var n=function(a,b){for(var t=a.network,e=new hp(a),n=0;n<a.Bh.length;n++){var o=a.Bh[n];if(!(1<o.xd))break;e.Eh(o);var g=new ap;g.St=o.xd,g.Tt=o.width,g.Rt=o.height,g.zw=o.focus.x,g.Aw=o.focus.y,null===o.Ge&&(o.Ge=new lt),o.Ge.add(g),o.cw=o.Ge.count-1}for(o=t.edges.iterator;o.next();){var r=o.value;n=r.fromVertex,g=r.toVertex,n.network===e&&g.network===e?e.bq(r):n.network===e?(null===(r=n.$j)&&(r=new lt,n.$j=r),r.add(g),n.xd--,n.Mh+=g.Mh):g.network===e&&(null===(r=g.$j)&&(r=new lt,g.$j=r),r.add(n),g.xd--,g.Mh+=n.Mh)}for(n=e.edges.iterator;n.next();)(o=n.value).length*=Math.max(1,ne.sqrt((o.fromVertex.Mh+o.toVertex.Mh)/(4*b+1)));for(b=e.vertexes.iterator;b.next();){var h=(n=b.value).$j;if(null!==h&&0<h.count&&!(0>=(g=n.Ge.L(n.Ge.count-1).St-n.xd))){for(var l=r=0,c=h.count-g;c<h.count;c++){var f=h.L(c),p=null;for(o=f.edges.iterator;o.next();){var d=o.value;if(d.Qx(f)===n){p=d;break}}null!==p&&(l+=p.length,r+=f.width*f.height)}o=n.centerX,h=n.centerY,c=n.width,f=n.height,p=n.focus,1>(d=c*f)&&(d=1),r=ne.sqrt((r+d+l*l*4/(g*g))/d),g=(r-1)*c/2,r=(r-1)*f/2,n.bounds=new Wt(o-p.x-g,h-p.y-r,c+2*g,f+2*r),n.focus=new Mt(p.x+g,p.y+r)}}return a.network=e,t}(a,b),o=Math.max(0,Math.max(Math.min(a.network.vertexes.count,t*(b+1)/11),10));for(a.maxIterations+=o,tp(a,b+1,t),op(a,o),function(a,b){for(var t=a.network.vertexes.iterator;t.next();){var e=t.value;if(e.network=b,null!==e.Ge){var n=e.Ge.L(e.cw);e.xd=n.St;var o=n.zw,g=n.Aw;e.bounds=new Wt(e.centerX-o,e.centerY-g,n.Tt,n.Rt),e.focus=new Mt(o,g),e.cw--}}for(t=a.network.edges.iterator;t.next();)t.value.network=b;a.network=b}(a,n),(b=n.vertexes.na()).sort((function(a,b){return null===a||null===b||a===b?0:b.xd-a.xd})),t=0;t<b.length;t++)ip(a,b[t]);a.Wf=e}}function ip(a,b){var t=b.$j;if(null!==t&&0!==t.count){var e=b.centerX,n=b.centerY,o=b.width,g=b.height;null!==b.Ge&&0<b.Ge.count&&(o=(g=b.Ge.L(0)).Tt,g=g.Rt),o=ne.sqrt(o*o+g*g)/2;for(var r=!1,h=g=0,l=0,c=b.vertexes.iterator;c.next();){var f=c.value;1>=f.xd?h++:(r=!0,l++,g+=Math.atan2(b.centerY-f.centerY,b.centerX-f.centerX))}if(0!==h)for(0<l&&(g/=l),l=b=0,b=r?2*Math.PI/(h+1):2*Math.PI/h,0==h%2&&(l=b/2),1<t.count&&t.sort((function(a,b){return null===a||null===b||a===b?0:b.width*b.height-a.width*a.height})),r=0==h%2?0:1,t=t.iterator;t.next();)if(!(1<(h=t.value).xd||a.isFixed(h))){for(c=null,f=h.edges.iterator;f.next();){c=f.value;break}f=h.width;var p=h.height;f=ne.sqrt(f*f+p*p)/2,c=o+c.length+f,f=g+(b*(r/2>>1)+l)*(0==r%2?1:-1),h.centerX=e+c*Math.cos(f),h.centerY=n+c*Math.sin(f),r++}}}function ep(a,b,t,e,n,o,g){var r=9e19,h=-1,l=0;t:for(;l<b;l++){var c=a[l],f=c.x-t,p=c.y-e;if((f=f*f+p*p)<r){for(p=l-1;0<=p;p--)if(a[p].y>c.y&&a[p].x-c.x<n+g.width)continue t;for(p=l+1;p<b;p++)if(a[p].x>c.x&&a[p].y-c.y<o+g.height)continue t;h=l,r=f}}return h}function np(a,b){var t=a.bounds,e=t.x;a=t.y;var n=t.width;t=t.height;var o=b.bounds,g=o.x;b=o.y;var r=o.width;return o=o.height,e+n<g?a>b+o?(t=e+n-g,a=a-b-o,ne.sqrt(t*t+a*a)):a+t<b?(e=e+n-g,a=a+t-b,ne.sqrt(e*e+a*a)):g-(e+n):e>g+r?a>b+o?(t=e-g-r,a=a-b-o,ne.sqrt(t*t+a*a)):a+t<b?(e=e-g-r,a=a+t-b,ne.sqrt(e*e+a*a)):e-(g+r):a>b+o?a-(b+o):a+t<b?b-(a+t):.1}function op(a,b){for(a.Bh=null,b=a.jo+b;a.jo<b&&(a.jo++,sp(a)););a.Bh=null}function sp(a){null===a.Bh&&(a.Bh=a.network.vertexes.na());var b=a.Bh;if(0>=b.length)return!1;var t=b[0];t.forceX=0,t.forceY=0;for(var e=t.centerX,n=e,o=t=t.centerY,g=1;g<b.length;g++){var r=b[g];r.forceX=0,r.forceY=0;var h=r.centerX;r=r.centerY,e=Math.min(e,h),n=Math.max(n,h),t=Math.min(t,r),o=Math.max(o,r)}(n=n-e>o-t)?b.sort((function(a,b){return null===a||null===b||a===b?0:a.centerX-b.centerX})):b.sort((function(a,b){return null===a||null===b||a===b?0:a.centerY-b.centerY})),t=a.Wf;var l=e=r=0;for(o=0;o<b.length;o++){e=(g=b[o]).bounds,r=g.focus,h=e.x+r.x;var c=e.y+r.y;e=g.charge*a.electricalFieldX(h,c),l=g.charge*a.electricalFieldY(h,c),e+=g.mass*a.gravitationalFieldX(h,c),l+=g.mass*a.gravitationalFieldY(h,c),g.forceX+=e,g.forceY+=l;for(var f=o+1;f<b.length;f++){var p=b[f];if(p!==g){e=p.bounds,r=p.focus,l=e.x+r.x;var d=e.y+r.y;if(h-l>t||l-h>t){if(n)break}else if(c-d>t||d-c>t){if(!n)break}else{var q=np(g,p);1>q?(null===(e=a.randomNumberGenerator)&&(a.randomNumberGenerator=e=new cp),q=e.random(),r=e.random(),h>l?e=(1+(e=Math.abs(p.bounds.right-g.bounds.x)))*q:h<l?e=-(1+(e=Math.abs(p.bounds.x-g.bounds.right)))*q:e=(1+(e=Math.max(p.width,g.width)))*q-e/2,c>d?l=(1+(l=Math.abs(p.bounds.bottom-g.bounds.y)))*r:h<l?l=-(1+(l=Math.abs(p.bounds.y-g.bounds.bottom)))*r:l=(1+(l=Math.max(p.height,g.height)))*r-l/2):(e=(l-h)/q*(r=-g.charge*p.charge/(q*q)),l=(d-c)/q*r),g.forceX+=e,g.forceY+=l,p.forceX-=e,p.forceY-=l}}}}for(n=a.network.edges.iterator;n.next();)t=(r=n.value).fromVertex,o=r.toVertex,g=t.bounds,h=t.focus,e=g.x+h.x,g=g.y+h.y,c=o.bounds,f=o.focus,h=c.x+f.x,c=c.y+f.y,1>(f=np(t,o))?(null===(f=a.randomNumberGenerator)&&(a.randomNumberGenerator=f=new cp),r=f.random(),f=f.random(),e=(e>h?1:-1)*(1+(o.width>t.width?o.width:t.width))*r,l=(g>c?1:-1)*(1+(o.height>t.height?o.height:t.height))*f):(e=(h-e)/f*(r=r.stiffness*(f-r.length)),l=(c-g)/f*r),t.forceX+=e,t.forceY+=l,o.forceX-=e,o.forceY-=l;for(e=0,n=a.moveLimit,t=0;t<b.length;t++)o=b[t],a.isFixed(o)?a.moveFixedVertex(o):((g=o.forceX)<-n?g=-n:g>n&&(g=n),(h=o.forceY)<-n?h=-n:h>n&&(h=n),o.centerX+=g,o.centerY+=h,e=Math.max(e,g*g+h*h));return e>a.epsilonDistance*a.epsilonDistance}function ap(){this.Aw=this.zw=this.Rt=this.Tt=this.St=0}function hp(a){_c.call(this,a)}function lp(a){rf.call(this,a),this.Ia=!1,this.Za=this.I=NaN,this.Mh=this.xd=this.Ha=this.Y=0,this.Ge=this.$j=null,this.cw=0}function up(a){af.call(this,a),this.l=this.v=NaN}function cp(){var a=0;void 0===a&&(a=42),this.seed=a,this.sy=48271,this.uy=2147483647,this.Q=44488.07041494893,this.wy=3399,this.ty=1/2147483647,this.random()}function fp(){Zc.call(this),this.Zb=this.ne=25,this.J=0,this.Pk=Up,this.tl=Wp,this.il=$p,this.zj=4,this.Ek=ig,this.mg=7,this.df=!0,this.ro=4,this.Da=this.Zr=this.xa=-1,this.sd=this.Co=0,this.Ga=this.qd=this.rd=this.Ld=this.gc=null,this.Mo=0,this.Lo=this.Ej=null,this.Pd=0,this.No=null,this.Jf=new Mt,this.qe=[],this.qe.length=100}function dp(a){var b=a.fromVertex.node;return a=a.toVertex.node,null===b&&null===a?8:null===b||null===a?4:1}function pp(a){null===a.Ej&&(a.Ej=[]);for(var b=0,t=a.network.vertexes.iterator;t.next();){var e=t.value;a.Ej[b]=e.layer,b++,a.Ej[b]=e.column,b++,a.Ej[b]=e.index,b++}return a.Ej}function gp(a,b){var t=0;for(a=a.network.vertexes.iterator;a.next();){var e=a.value;e.layer=b[t],t++,e.column=b[t],t++,e.index=b[t],t++}}function yp(a,b,t){var e=Xp(a,b),n=a.gc[b];(null===a.Lo||a.Lo.length<n*n)&&(a.Lo=[]);for(var o=a.Lo,g=0;g<n;g++){var p,r=0,h=e[g],l=h.near;if(null!==l&&l.layer===h.layer)if((h=l.index)>g)for(var c=g+1;c<h;c++){var f=e[c];f.near===l&&f.Wj===l.Wj||r++}else for(c=g-1;c>h;c--)(f=e[c]).near===l&&f.Wj===l.Wj||r++;if(0<=t)for(h=e[g].sourceEdgesArrayAccess,l=0;l<h.length;l++){var d=h[l];if(d.valid&&d.fromVertex.layer!==b)for(f=d.fromVertex.index,c=d.portToPos,d=d.portFromPos,p=l+1;p<h.length;p++){var q=h[p];if(q.valid&&q.fromVertex.layer!==b){var u=q.fromVertex.index,y=q.portToPos;q=q.portFromPos,c<y&&(f>u||f===u&&d>q)&&r++,y<c&&(u>f||u===f&&q>d)&&r++}}}if(0>=t)for(h=e[g].destinationEdgesArrayAccess,l=0;l<h.length;l++)if((d=h[l]).valid&&d.toVertex.layer!==b)for(f=d.toVertex.index,c=d.portToPos,d=d.portFromPos,p=l+1;p<h.length;p++)(q=h[p]).valid&&q.toVertex.layer!==b&&(u=q.toVertex.index,y=q.portToPos,d<(q=q.portFromPos)&&(f>u||f===u&&c>y)&&r++,q<d&&(u>f||u===f&&y>c)&&r++);for(o[g*n+g]=r,h=g+1;h<n;h++){var m=0,v=0;if(0<=t){r=e[g].sourceEdgesArrayAccess;var x=e[h].sourceEdgesArrayAccess;for(l=0;l<r.length;l++)if((d=r[l]).valid&&d.fromVertex.layer!==b)for(f=d.fromVertex.index,d=d.portFromPos,p=0;p<x.length;p++)(q=x[p]).valid&&q.fromVertex.layer!==b&&(u=q.fromVertex.index,q=q.portFromPos,(f<u||f===u&&d<q)&&v++,(u<f||u===f&&q<d)&&m++)}if(0>=t)for(r=e[g].destinationEdgesArrayAccess,x=e[h].destinationEdgesArrayAccess,l=0;l<r.length;l++)if((d=r[l]).valid&&d.toVertex.layer!==b)for(f=d.toVertex.index,c=d.portToPos,p=0;p<x.length;p++)(q=x[p]).valid&&q.toVertex.layer!==b&&(u=q.toVertex.index,y=q.portToPos,(f<u||f===u&&c<y)&&v++,(u<f||u===f&&y<c)&&m++);o[g*n+h]=m,o[h*n+g]=v}}return qp(a,b,e),o}function mp(a){for(var b=0,t=0;t<=a.xa;t++){for(var e=a,n=t,o=Xp(e,n),g=e.gc[n],r=0,h=0;h<g;h++){var l=o[h].destinationEdgesArrayAccess;if(null!==l)for(var c=0;c<l.length;c++){var f=l[c];if(f.valid&&f.toVertex.layer!==n){var p=f.fromVertex.column+f.portFromColOffset,d=f.toVertex.column+f.portToColOffset;r+=(Math.abs(p-d)+1)*dp(f)}}}qp(e,n,o),b+=r}return b}function vp(a,b,t){for(var e=Xp(a,b),n=a.gc[b],o=[],g=0;g<n;g++){var r=e[g],h=null;0>=t&&(h=r.sourceEdgesArrayAccess);var l=null;0<=t&&(l=r.destinationEdgesArrayAccess);var c=0,f=0,p=r.near;if(null!==p&&p.layer===r.layer&&(c+=p.column-1,f++),null!==h)for(p=0;p<h.length;p++){var d=(r=h[p]).fromVertex;r.valid&&!r.rev&&d.layer!==b&&(c+=d.column,f++)}if(null!==l)for(h=0;h<l.length;h++)p=(r=l[h]).toVertex,r.valid&&!r.rev&&p.layer!==b&&(c+=p.column,f++);o[g]=0===f?-1:c/f}return qp(a,b,e),o}function xp(a,b,t){for(var e=Xp(a,b),n=a.gc[b],o=[],g=0;g<n;g++){var r=e[g],h=null;0>=t&&(h=r.sourceEdgesArrayAccess);var l=null;0<=t&&(l=r.destinationEdgesArrayAccess);var c=0,f=[],p=r.near;if(null!==p&&p.layer===r.layer&&(f[c]=p.column-1,c++),r=void 0,null!==h)for(p=0;p<h.length;p++){var d=(r=h[p]).fromVertex;r.valid&&!r.rev&&d.layer!==b&&(f[c]=d.column+r.portFromColOffset,c++)}if(null!==l)for(h=0;h<l.length;h++)p=(r=l[h]).toVertex,r.valid&&!r.rev&&p.layer!==b&&(f[c]=p.column+r.portToColOffset,c++);0===c?o[g]=-1:(f.sort((function(a,b){return a-b})),l=c>>1,o[g]=0!=(1&c)?f[l]:f[l-1]+f[l]>>1)}return qp(a,b,e),o}function bp(a,b,t,e,n,o){if(b.component===e){if(b.component=t,n)for(var g=b.destinationEdges;g.next();){var r=g.value,h=r.toVertex,l=b.layer-h.layer;l===(r=a.linkMinLength(r))&&bp(a,h,t,e,n,o)}if(o)for(g=b.sourceEdges;g.next();)(l=(h=(r=g.value).fromVertex).layer-b.layer)===(r=a.linkMinLength(r))&&bp(a,h,t,e,n,o)}}function wp(a,b,t,e,n,o){if(b.component===e){if(b.component=t,n)for(var g=b.destinationEdges;g.next();)wp(a,g.value.toVertex,t,e,n,o);if(o)for(b=b.sourceEdges;b.next();)wp(a,b.value.fromVertex,t,e,n,o)}}function kp(a){for(a=a.vertexes.iterator;a.next();){var b=a.value;if(b.valid)return b}return null}function Mp(a){for(a=a.vertexes.iterator;a.next();){var b=a.value;if(b.valid){for(var t=!0,e=b.destinationEdges;e.next();)if(e.value.toVertex.valid){t=!1;break}if(t)return b}}return null}function Sp(a){for(a=a.vertexes.iterator;a.next();){var b=a.value;if(b.valid){for(var t=!0,e=b.sourceEdges;e.next();)if(e.value.fromVertex.valid){t=!1;break}if(t)return b}}return null}function Pp(a,b){b.fm=a.Mo,a.Mo++;for(var t=b.destinationEdges;t.next();){var e=t.value,n=e.toVertex;-1===n.fm&&(e.forest=!0,Pp(a,n))}b.finish=a.Mo,a.Mo++}function Np(a){for(var b=a.network.vertexes.iterator;b.next();){var t=Cp(a,b.value);a.xa=Math.max(t,a.xa)}}function Cp(a,b){var t=0;if(-1===b.layer){for(var e=b.destinationEdges;e.next();){var n=e.value,o=n.toVertex;n=a.linkMinLength(n),t=Math.max(t,Cp(a,o)+n)}b.layer=t}else t=b.layer;return t}function Tp(a,b){var t=0;if(-1===b.layer){for(var e=b.sourceEdges;e.next();){var n=e.value,o=n.fromVertex;n=a.linkMinLength(n),t=Math.max(t,Tp(a,o)+n)}b.layer=t}else t=b.layer;return t}function Lp(a,b){if(!b.valid){b.valid=!0;for(var t=b.destinationEdges;t.next();)Lp(a,t.value.toVertex);for(t=a.network.vertexes.iterator;t.next();)t.value.component=-1;for(var e=b.sourceEdgesArrayAccess,n=e.length,o=0;o<n;o++){var g=e[o],r=g.fromVertex,h=g.toVertex;g=a.linkMinLength(g),r.layer-h.layer>g&&bp(a,r,0,-1,!0,!1)}for(bp(a,b,1,-1,!0,!0);0!==b.component;){for(o=0,e=1/0,r=0,h=null,g=a.network.vertexes.iterator;g.next();){var l=g.value;if(1===l.component){var c=0,f=!1,p=l.sourceEdgesArrayAccess;n=p.length;for(var d=0;d<n;d++){var q=p[d],u=q.fromVertex;c+=1,1!==u.component&&(o+=1,u=u.layer-l.layer,q=a.linkMinLength(q),e=Math.min(e,u-q))}for(n=(p=l.destinationEdgesArrayAccess).length,d=0;d<n;d++)--c,1!==(q=p[d].toVertex).component?--o:f=!0;(null===h||c<r)&&!f&&(h=l,r=c)}}if(0<o){for(t.reset();t.next();)1===(n=t.value).component&&(n.layer+=e);b.component=0}else h.component=0}for(t=a.network.vertexes.iterator;t.next();)t.value.component=-1;for(bp(a,b,1,-1,!0,!1);0!==b.component;){for(e=0,n=1/0,o=0,r=null,h=a.network.vertexes.iterator;h.next();)if(1===(g=h.value).component){for(l=0,c=!1,f=(p=g.sourceEdgesArrayAccess).length,d=0;d<f;d++)l+=1,1!==(q=p[d].fromVertex).component?e+=1:c=!0;for(f=(p=g.destinationEdgesArrayAccess).length,d=0;d<f;d++)--l,1!==(u=(q=p[d]).toVertex).component&&(--e,u=g.layer-u.layer,q=a.linkMinLength(q),n=Math.min(n,u-q));(null===r||l>o)&&!c&&(r=g,o=l)}if(0>e){for(t.reset();t.next();)1===(e=t.value).component&&(e.layer-=n);b.component=0}else r.component=0}}}function Ap(a,b,t){return 90===a.J?t&&!b.rev||!t&&b.rev?270:90:180===a.J?t&&!b.rev||!t&&b.rev?0:180:270===a.J?t&&!b.rev||!t&&b.rev?90:270:t&&!b.rev||!t&&b.rev?180:0}function jp(a,b){var t=b.layer;for(b.index=a.gc[t],a.gc[t]++,b=b.destinationEdgesArrayAccess,t=!0;t;){t=!1;for(var e=0;e<b.length-1;e++){var n=b[e],o=b[e+1];n.portFromColOffset>o.portFromColOffset&&(t=!0,b[e]=o,b[e+1]=n)}}for(t=0;t<b.length;t++)(e=b[t]).valid&&(-1===(e=e.toVertex).index&&jp(a,e))}function Dp(a,b){var t=b.layer;b.index=a.gc[t],a.gc[t]++,b=b.sourceEdgesArrayAccess;for(var e=!0;e;)for(e=!1,t=0;t<b.length-1;t++){var n=b[t],o=b[t+1];n.portToColOffset>o.portToColOffset&&(e=!0,b[t]=o,b[t+1]=n)}for(t=0;t<b.length;t++)(e=b[t]).valid&&(-1===(e=e.fromVertex).index&&Dp(a,e))}function Fp(a,b,t){var e=Xp(a,b),n=a.gc[b],o=xp(a,b,t),g=vp(a,b,t);for(t=0;t<n;t++)-1===g[t]&&(g[t]=e[t].column),-1===o[t]&&(o[t]=e[t].column);for(var r,h=!0;h;)for(h=!1,t=0;t<n-1;t++)(o[t+1]<o[t]||o[t+1]===o[t]&&g[t+1]<g[t])&&(h=!0,r=o[t],o[t]=o[t+1],o[t+1]=r,r=g[t],g[t]=g[t+1],g[t+1]=r,r=e[t],e[t]=e[t+1],e[t+1]=r);for(t=o=0;t<n;t++)(r=e[t]).index=t,o+=a.nodeMinColumnSpace(r,!0),r.column=o,o+=1,o+=a.nodeMinColumnSpace(r,!1);qp(a,b,e)}function Op(a,b,t){var e,n=Xp(a,b),o=a.gc[b];t=yp(a,b,t);var g=[];for(e=0;e<o;e++)g[e]=-1;var r=[];for(e=0;e<o;e++)r[e]=-1;for(var h=!1,l=!0;l;)for(l=!1,e=0;e<o-1;e++){var c=t[n[e].index*o+n[e+1].index],f=t[n[e+1].index*o+n[e].index],p=0,d=0,q=n[e].column,u=n[e+1].column,y=a.nodeMinColumnSpace(n[e],!0),m=a.nodeMinColumnSpace(n[e],!1),v=a.nodeMinColumnSpace(n[e+1],!0),x=a.nodeMinColumnSpace(n[e+1],!1);y=q-y+v,m=u-m+x;var w=n[e].sourceEdges.iterator;for(w.reset();w.next();)if(x=(v=w.value).fromVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v<e&&(p+=2*(e-v),d+=2*(e+1-v)),v===e+1&&(p+=1),v>e+1&&(p+=4*(v-e),d+=4*(v-(e+1)))}for((w=n[e].destinationEdges.iterator).reset();w.next();)if(x=(v=w.value).toVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v===e+1&&(d+=1)}for((w=n[e+1].sourceEdges.iterator).reset();w.next();)if(x=(v=w.value).fromVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v<e&&(p+=2*(e+1-v),d+=2*(e-v)),v===e&&(d+=1),v>e+1&&(p+=4*(v-(e+1)),d+=4*(v-e))}for((w=n[e+1].destinationEdges.iterator).reset();w.next();)if(x=(v=w.value).toVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v===e&&(p+=1)}v=x=0,w=g[n[e].index];var k=r[n[e].index],M=g[n[e+1].index],S=r[n[e+1].index];-1!==w&&(x+=Math.abs(w-q),v+=Math.abs(w-m)),-1!==k&&(x+=Math.abs(k-q),v+=Math.abs(k-m)),-1!==M&&(x+=Math.abs(M-u),v+=Math.abs(M-y)),-1!==S&&(x+=Math.abs(S-u),v+=Math.abs(S-y)),(d<p-.5||d===p&&f<c-.5||d===p&&f===c&&v<x-.5)&&(l=h=!0,n[e].column=m,n[e+1].column=y,c=n[e],n[e]=n[e+1],n[e+1]=c)}for(e=0;e<o;e++)n[e].index=e;return qp(a,b,n),h}function Bp(a,b,t){for(var e=!1;Ip(a,b,t);)e=!0;return e}function Ip(a,b,t){var e,n=Xp(a,b),o=a.gc[b],g=vp(a,b,-1);if(0<t)for(e=0;e<o;e++)g[e]=-1;var r=vp(a,b,1);if(0>t)for(e=0;e<o;e++)r[e]=-1;for(var h=!1,l=!0;l;)for(l=!1,e=0;e<o;e++){var c=n[e].column,f=a.nodeMinColumnSpace(n[e],!0),p=a.nodeMinColumnSpace(n[e],!1),d=0;d=0>e-1||c-n[e-1].column-1>f+a.nodeMinColumnSpace(n[e-1],!1)?c-1:c,f=e+1>=o||n[e+1].column-c-1>p+a.nodeMinColumnSpace(n[e+1],!0)?c+1:c;var q=p=0,u=0;if(0>=t)for(var y=n[e].sourceEdges.iterator;y.next();){var m=y.value,v=m.fromVertex;if(m.valid&&v.layer!==b){var x=dp(m),w=m.portFromColOffset;m=m.portToColOffset,v=v.column,p+=(Math.abs(c+m-(v+w))+1)*x,q+=(Math.abs(d+m-(v+w))+1)*x,u+=(Math.abs(f+m-(v+w))+1)*x}}if(0<=t)for(y=n[e].destinationEdges.iterator;y.next();)v=(m=y.value).toVertex,m.valid&&v.layer!==b&&(x=dp(m),w=m.portFromColOffset,m=m.portToColOffset,v=v.column,p+=(Math.abs(c+w-(v+m))+1)*x,q+=(Math.abs(d+w-(v+m))+1)*x,u+=(Math.abs(f+w-(v+m))+1)*x);m=w=x=0,y=g[n[e].index],v=r[n[e].index],-1!==y&&(x+=Math.abs(y-c),w+=Math.abs(y-d),m+=Math.abs(y-f)),-1!==v&&(x+=Math.abs(v-c),w+=Math.abs(v-d),m+=Math.abs(v-f)),q<p||q===p&&w<x?(l=h=!0,n[e].column=d):(u<p||u===p&&m<x)&&(l=h=!0,n[e].column=f)}return qp(a,b,n),a.normalize(),h}function Rp(a,b,t){var e=Xp(a,b),n=a.gc[b],o=xp(a,b,t),g=[];for(t=0;t<n;t++)g[t]=o[t];for(o=!0;o;)for(o=!1,t=0;t<n;t++){var r=e[t].column,h=a.nodeMinColumnSpace(e[t],!0),l=a.nodeMinColumnSpace(e[t],!1),c=0;if(-1===g[t])if(0===t&&t===n-1)c=r;else if(0===t){var f=e[t+1].column;c=f-r===l+a.nodeMinColumnSpace(e[t+1],!0)?r-1:r}else t===n-1?c=r-(f=e[t-1].column)===h+a.nodeMinColumnSpace(e[t-1],!1)?r+1:r:c=((h=(f=e[t-1].column)+a.nodeMinColumnSpace(e[t-1],!1)+h+1)+(l=(f=e[t+1].column)-a.nodeMinColumnSpace(e[t+1],!0)-l-1))/2|0;else 0===t&&t===n-1?c=g[t]:0===t?(l=(f=e[t+1].column)-a.nodeMinColumnSpace(e[t+1],!0)-l-1,c=Math.min(g[t],l)):t===n-1?(h=(f=e[t-1].column)+a.nodeMinColumnSpace(e[t-1],!1)+h+1,c=Math.max(g[t],h)):(h=(f=e[t-1].column)+a.nodeMinColumnSpace(e[t-1],!1)+h+1,l=(f=e[t+1].column)-a.nodeMinColumnSpace(e[t+1],!0)-l-1,h<g[t]&&g[t]<l?c=g[t]:h>=g[t]?c=h:l<=g[t]&&(c=l));c!==r&&(o=!0,e[t].column=c)}qp(a,b,e),a.normalize()}function Ep(a,b){for(var t=!0,e=a.network.vertexes.iterator;e.next();){var n=e.value,o=a.nodeMinColumnSpace(n,!0),g=a.nodeMinColumnSpace(n,!1);if(n.column-o<=b&&n.column+g>=b){t=!1;break}}if(a=!1,t)for(e.reset();e.next();)(t=e.value).column>b&&(--t.column,a=!0);return a}function zp(a,b){var t,e=b+1,n=[],o=[];for(t=0;t<=a.xa;t++)n[t]=!1,o[t]=!1;for(var g=a.network.vertexes.iterator;g.next();){var r=(t=g.value).column-a.nodeMinColumnSpace(t,!0),h=t.column+a.nodeMinColumnSpace(t,!1);r<=b&&h>=b&&(n[t.layer]=!0),r<=e&&h>=e&&(o[t.layer]=!0)}for(r=!0,e=!1,t=0;t<=a.xa;t++)r=r&&!(n[t]&&o[t]);if(r)for(g.reset();g.next();)(a=g.value).column>b&&(--a.column,e=!0);return e}function Vp(a,b){for(var t=0;t<=a.Da;t++)for(;Ep(a,t););for(a.normalize(),t=0;t<a.Da;t++)for(;zp(a,t););var e;if(a.normalize(),0<b)for(t=0;t<=a.Da;t++){var n=pp(a),o=mp(a);for(e=o+1;o<e;){e=o,Yp(a,t,1);var g=mp(a);g>o?gp(a,n):g<o&&(o=g,n=pp(a))}}if(0>b)for(t=a.Da;0<=t;t--)for(n=pp(a),e=(o=mp(a))+1;o<e;)e=o,Yp(a,t,-1),(g=mp(a))>o?gp(a,n):g<o&&(o=g,n=pp(a));a.normalize()}function Yp(a,b,t){a.Pd=0;for(var e=a.network.vertexes.iterator;e.next();)e.value.component=-1;if(0<t)for(e.reset();e.next();){var n=e.value;n.column-a.nodeMinColumnSpace(n,!0)<=b&&(n.component=a.Pd)}if(0>t)for(e.reset();e.next();)(n=e.value).column+a.nodeMinColumnSpace(n,!1)>=b&&(n.component=a.Pd);for(a.Pd++,e.reset();e.next();)-1===(b=e.value).component&&(wp(a,b,a.Pd,-1,!0,!0),a.Pd++);var o;for(b=[],o=0;o<a.Pd*a.Pd;o++)b[o]=!1;for(n=[],o=0;o<(a.xa+1)*(a.Da+1);o++)n[o]=-1;for(e.reset();e.next();)for(var g=(o=e.value).layer,r=Math.max(0,o.column-a.nodeMinColumnSpace(o,!0)),h=Math.min(a.Da,o.column+a.nodeMinColumnSpace(o,!1));r<=h;r++)n[g*(a.Da+1)+r]=o.component;for(o=0;o<=a.xa;o++){if(0<t)for(g=0;g<a.Da;g++)-1!==n[o*(a.Da+1)+g]&&-1!==n[o*(a.Da+1)+g+1]&&n[o*(a.Da+1)+g]!==n[o*(a.Da+1)+g+1]&&(b[n[o*(a.Da+1)+g]*a.Pd+n[o*(a.Da+1)+g+1]]=!0);if(0>t)for(g=a.Da;0<g;g--)-1!==n[o*(a.Da+1)+g]&&-1!==n[o*(a.Da+1)+g-1]&&n[o*(a.Da+1)+g]!==n[o*(a.Da+1)+g-1]&&(b[n[o*(a.Da+1)+g]*a.Pd+n[o*(a.Da+1)+g-1]]=!0)}for(n=[],o=0;o<a.Pd;o++)n[o]=!0;for((g=[]).push(0);0!==g.length;)if(h=g[g.length-1],g.pop(),n[h])for(n[h]=!1,o=0;o<a.Pd;o++)b[h*a.Pd+o]&&g.splice(0,0,o);if(0<t)for(e.reset();e.next();)n[(a=e.value).component]&&--a.column;if(0>t)for(e.reset();e.next();)n[(t=e.value).component]&&(t.column+=1)}function Gp(a,b){return 270===a.J?b?Xi:Ki:90===a.J?b?Ki:Xi:180===a.J?b?qi:Ui:b?Ui:qi}function Xp(a,b){var t=a.gc[b];if(t>=a.qe.length){for(var e=[],n=0;n<a.qe.length;n++)e[n]=a.qe[n];a.qe=e}for(void 0===a.qe[t]||null===a.qe[t]?e=[]:(e=a.qe[t],a.qe[t]=null),a=a.No[b],b=0;b<a.length;b++)e[(t=a[b]).index]=t;return e}function qp(a,b,t){a.qe[a.gc[b]]=t}Pd.className="CircularLayout",Pd.ConstantSpacing=hr,Pd.ConstantDistance=Bd,Pd.ConstantAngle=Id,Pd.Packed=Rd,Pd.Clockwise=Ed,Pd.Counterclockwise=tr,Pd.BidirectionalLeft=zd,Pd.BidirectionalRight=Vd,Pd.Forwards=Yd,Pd.Reverse=Gd,Pd.Ascending=Xd,Pd.Descending=qd,Pd.Optimized=Ud,Pd.Pythagorean=Kd,Pd.Circular=Hd,Wd.prototype.compare=function(a,b){if(0<a&&0>this.km||Math.abs(a)<Math.abs(this.km)&&!(0>a&&0<this.km))for(this.km=a,this.Ak=[],this.Mm=[],a=0;a<b.length;a++)this.Ak[a]=b[a].bounds.x,this.Mm[a]=b[a].bounds.y},Wd.prototype.commit=function(a){if(null!==this.Ak&&null!==this.Mm)for(var b=0;b<this.Ak.length;b++){var t=a.L(b);t.x=this.Ak[b],t.y=this.Mm[b]}},Wd.className="VertexArrangement",m(Jd,_c),Jd.prototype.createVertex=function(){return new Zd(this)},Jd.prototype.createEdge=function(){return new Qd(this)},Jd.className="CircularNetwork",m(Zd,rf),v.Object.defineProperties(Zd.prototype,{diameter:{get:function(){return this.oj},set:function(a){this.oj!==a&&(this.oj=a)}},actualAngle:{get:function(){return this.I},set:function(a){this.I!==a&&(this.I=a)}}}),Zd.className="CircularVertex",m(Qd,af),Qd.className="CircularEdge",m(_d,Zc),_d.prototype.cloneProtected=function(a){Zc.prototype.cloneProtected.call(this,a),a.Ad.assign(this.Ad),a.Xm=this.Xm,a.df=this.df,a.Zc=this.Zc,a.yl=this.yl,a.Fn=this.Fn,a.Wf=this.Wf,a.Ho=this.Ho,a.hp=this.hp,a.Uk=this.Uk,a.Tk=this.Tk,a.Rk=this.Rk,a.Sk=this.Sk,a.wn=this.wn,a.vn=this.vn},_d.prototype.createNetwork=function(){return new hp(this)},_d.prototype.doLayout=function(a){if(null===this.network&&(this.network=this.makeNetwork(a)),a=this.maxIterations,0<this.network.vertexes.count){this.network.iq();for(var b=this.network.vertexes.iterator;b.next();){var t=b.value;t.charge=this.electricalCharge(t),t.mass=this.gravitationalMass(t)}for(b=this.network.edges.iterator;b.next();)(t=b.value).stiffness=this.springStiffness(t),t.length=this.springLength(t);if(this.gv(),this.jo=0,this.needsClusterLayout()){for(t=(b=this.network).py().iterator;t.next();){this.network=t.value;for(var e=this.network.vertexes.iterator;e.next();){var n=e.value;n.xd=n.vertexes.count,n.Mh=1,n.$j=null,n.Ge=null}tp(this,0,a)}this.network=b,t.reset(),e=this.arrangementSpacing;for(var o=t.count,g=!0,r=n=0,h=I(),l=0;l<o+b.vertexes.count+2;l++)h[l]=null;o=0,t.reset();for(var c=Wt.alloc();t.next();)if(l=t.value,this.computeBounds(l,c),g)g=!1,n=c.x+c.width/2,r=c.y+c.height/2,h[0]=new Mt(c.x+c.width+e.width,c.y),h[1]=new Mt(c.x,c.y+c.height+e.height),o=2;else{var f=ep(h,o,n,r,c.width,c.height,e),p=h[f],d=new Mt(p.x+c.width+e.width,p.y),q=new Mt(p.x,p.y+c.height+e.height);for(f+1<o&&h.splice(f+1,0,null),h[f]=d,h[f+1]=q,o++,f=p.x-c.x,p=p.y-c.y,l=l.vertexes.iterator;l.next();)(d=l.value).centerX+=f,d.centerY+=p}for(Wt.free(c),l=b.vertexes.iterator;l.next();)d=(g=l.value).bounds,2>o?(n=d.x+d.width/2,r=d.y+d.height/2,h[0]=new Mt(d.x+d.width+e.width,d.y),h[1]=new Mt(d.x,d.y+d.height+e.height),o=2):(f=new Mt((p=h[c=ep(h,o,n,r,d.width,d.height,e)]).x+d.width+e.width,p.y),d=new Mt(p.x,p.y+d.height+e.height),c+1<o&&h.splice(c+1,0,null),h[c]=f,h[c+1]=d,o++,g.centerX=p.x+g.width/2,g.centerY=p.y+g.height/2);for(R(h),t.reset();t.next();){for(n=(e=t.value).vertexes.iterator;n.next();)b.Eh(n.value);for(e=e.edges.iterator;e.next();)b.bq(e.value)}}op(this,a),this.updateParts()}this.yl=a,this.network=null,this.isValidLayout=!0},_d.prototype.needsClusterLayout=function(){if(3>this.network.vertexes.count)return!1;for(var a=0,b=0,t=this.network.vertexes.first().bounds,e=this.network.vertexes.iterator;e.next();){if(e.value.bounds.Gc(t)&&2<++a)return!0;if(10<b)break;b++}return!1},_d.prototype.computeBounds=function(a,b){var t=!0;for(a=a.vertexes.iterator;a.next();){var e=a.value;t?(t=!1,b.set(e.bounds)):b.Hc(e.bounds)}return b},_d.prototype.gv=function(){if(this.comments)for(var a=this.network.vertexes.iterator;a.next();)this.addComments(a.value)},_d.prototype.addComments=function(a){var b=a.node;if(null!==b)for(b=b.sv();b.next();){var t=b.value;if("Comment"===t.category&&t.isVisible()){var e=this.network.Wi(t);null===e&&(e=this.network.am(t)),e.charge=this.defaultCommentElectricalCharge,t=null;for(var n=e.destinationEdges;n.next();){var o=n.value;if(o.toVertex===a){t=o;break}}if(null===t)for(n=e.sourceEdges;n.next();)if((o=n.value).fromVertex===a){t=o;break}null===t&&(t=this.network.mk(a,e,null)),t.length=this.defaultCommentSpringLength}}},_d.prototype.moveFixedVertex=function(){},_d.prototype.commitLayout=function(){this.gw(),this.commitNodes(),this.isRouting&&this.commitLinks()},_d.prototype.gw=function(){if(this.setsPortSpots)for(var a=this.network.edges.iterator;a.next();){var b=a.value.link;null!==b&&(b.fromSpot=zi,b.toSpot=zi)}},_d.prototype.commitNodes=function(){var a=0,b=0;if(this.arrangesToOrigin){var t=Wt.alloc();this.computeBounds(this.network,t),a=(b=this.arrangementOrigin).x-t.x,b=b.y-t.y,Wt.free(t)}t=Wt.alloc();for(var e=this.network.vertexes.iterator;e.next();){var n=e.value;0===a&&0===b||(t.assign(n.bounds),t.x+=a,t.y+=b,n.bounds=t),n.commit()}Wt.free(t)},_d.prototype.commitLinks=function(){for(var a=this.network.edges.iterator;a.next();)a.value.commit()},_d.prototype.springStiffness=function(a){return a=a.stiffness,isNaN(a)?this.Uk:a},_d.prototype.springLength=function(a){return a=a.length,isNaN(a)?this.Tk:a},_d.prototype.electricalCharge=function(a){return a=a.charge,isNaN(a)?this.Rk:a},_d.prototype.electricalFieldX=function(){return 0},_d.prototype.electricalFieldY=function(){return 0},_d.prototype.gravitationalMass=function(a){return a=a.mass,isNaN(a)?this.Sk:a},_d.prototype.gravitationalFieldX=function(){return 0},_d.prototype.gravitationalFieldY=function(){return 0},_d.prototype.isFixed=function(a){return a.isFixed},v.Object.defineProperties(_d.prototype,{currentIteration:{get:function(){return this.jo}},arrangementSpacing:{get:function(){return this.Ad},set:function(a){this.Ad.w(a)||(this.Ad.assign(a),this.C())}},arrangesToOrigin:{get:function(){return this.Xm},set:function(a){this.Xm!==a&&(this.Xm=a,this.C())}},setsPortSpots:{get:function(){return this.df},set:function(a){this.df!==a&&(this.df=a,this.C())}},comments:{get:function(){return this.Zc},set:function(a){this.Zc!==a&&(this.Zc=a,this.C())}},maxIterations:{get:function(){return this.yl},set:function(a){this.yl!==a&&0<=a&&(this.yl=a,this.C())}},epsilonDistance:{get:function(){return this.Fn},set:function(a){this.Fn!==a&&0<a&&(this.Fn=a,this.C())}},infinityDistance:{get:function(){return this.Wf},set:function(a){this.Wf!==a&&1<a&&(this.Wf=a,this.C())}},moveLimit:{get:function(){return this.Ho},set:function(a){this.Ho!==a&&1<a&&(this.Ho=a,this.C())}},randomNumberGenerator:{get:function(){return this.hp},set:function(a){this.hp!==a&&(null!==a&&"function"!=typeof a.random&&N('ForceDirectedLayout.randomNumberGenerator must have a "random()" function on it: '+a),this.hp=a)}},defaultSpringStiffness:{get:function(){return this.Uk},set:function(a){this.Uk!==a&&(this.Uk=a,this.C())}},defaultSpringLength:{get:function(){return this.Tk},set:function(a){this.Tk!==a&&(this.Tk=a,this.C())}},defaultElectricalCharge:{get:function(){return this.Rk},set:function(a){this.Rk!==a&&(this.Rk=a,this.C())}},defaultGravitationalMass:{get:function(){return this.Sk},set:function(a){this.Sk!==a&&(this.Sk=a,this.C())}},defaultCommentSpringLength:{get:function(){return this.wn},set:function(a){this.wn!==a&&(this.wn=a,this.C())}},defaultCommentElectricalCharge:{get:function(){return this.vn},set:function(a){this.vn!==a&&(this.vn=a,this.C())}}}),_d.className="ForceDirectedLayout",ap.className="ForceDirectedSubnet",m(hp,_c),hp.prototype.createVertex=function(){return new lp(this)},hp.prototype.createEdge=function(){return new up(this)},hp.className="ForceDirectedNetwork",m(lp,rf),v.Object.defineProperties(lp.prototype,{isFixed:{get:function(){return this.Ia},set:function(a){this.Ia!==a&&(this.Ia=a)}},charge:{get:function(){return this.I},set:function(a){this.I!==a&&(this.I=a)}},mass:{get:function(){return this.Za},set:function(a){this.Za!==a&&(this.Za=a)}},forceX:{get:function(){return this.Y},set:function(a){this.Y!==a&&(this.Y=a)}},forceY:{get:function(){return this.Ha},set:function(a){this.Ha!==a&&(this.Ha=a)}}}),lp.className="ForceDirectedVertex",m(up,af),v.Object.defineProperties(up.prototype,{stiffness:{get:function(){return this.v},set:function(a){this.v!==a&&(this.v=a)}},length:{get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a)}}}),up.className="ForceDirectedEdge",cp.prototype.random=function(){var a=this.seed%this.Q*this.sy-this.seed/this.Q*this.wy;return this.seed=0<a?a:a+this.uy,this.seed*this.ty},cp.className="RandomNumberGenerator",m(fp,Zc),fp.prototype.cloneProtected=function(a){Zc.prototype.cloneProtected.call(this,a),a.ne=this.ne,a.Zb=this.Zb,a.J=this.J,a.Pk=this.Pk,a.tl=this.tl,a.il=this.il,a.zj=this.zj,a.Ek=this.Ek,a.mg=this.mg,a.df=this.df,a.ro=this.ro},fp.prototype.cb=function(a){a.classType===fp?0===a.name.indexOf("Aggressive")?this.aggressiveOption=a:0===a.name.indexOf("Cycle")?this.cycleRemoveOption=a:0===a.name.indexOf("Init")?this.initializeOption=a:0===a.name.indexOf("Layer")?this.layeringOption=a:N("Unknown enum value: "+a):Zc.prototype.cb.call(this,a)},fp.prototype.createNetwork=function(){return new og(this)},fp.prototype.doLayout=function(a){for(null===this.network&&(this.network=this.makeNetwork(a)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin),this.Zr=-1,this.sd=this.Co=0,this.No=this.Lo=this.Ej=null,a=0;a<this.qe.length;a++)this.qe[a]=null;if(0<this.network.vertexes.count){for(this.network.iq(),this.cycleRemoveOption!==Hp&&this.removeCycles(),a=this.network.vertexes.iterator;a.next();)a.value.layer=-1;for(this.xa=-1,this.assignLayers(),a.reset();a.next();)this.xa=Math.max(this.xa,a.value.layer);this.cycleRemoveOption===Hp&&this.removeCycles();for(var b=[],t=(a=this.network).edges.iterator;t.next();){var e=t.value;e.valid=!1,b.push(e)}for(t=0;t<b.length;t++){var n=(e=b[t]).fromVertex,o=e.toVertex;if(!e.valid&&(null!==n.node&&null!==o.node||n.layer!==o.layer)){var g=0,r=0,h=0,l=0;if(null!==e.link){if(null===(r=e.link))continue;var c=n.node;if(g=o.node,null===c||null===g)continue;var f=r.fromNode;h=r.toNode;var p=r.fromPort;if(r=r.toPort,e.rev){l=f;var d=p;f=h,p=r,h=l,r=d}var q=n.focus;l=o.focus;var u=e.rev?o.bounds:n.bounds;d=Mt.alloc(),c!==f?u.u()&&f.isVisible()?f.actualBounds.u()?(f.wf(p,xi,d),d.x+=f.actualBounds.x-u.x,d.y+=f.actualBounds.y-u.y):(f.wf(p,xi,d),d.u()||d.assign(q)):d.assign(q):u.u()?(f.wf(p,xi,d),d.u()||d.assign(q)):d.assign(q),f=e.rev?n.bounds:o.bounds,c=Mt.alloc(),g!==h?f.u()&&h.isVisible()?h.actualBounds.u()?(h.wf(r,xi,c),c.x+=h.actualBounds.x-f.x,c.y+=h.actualBounds.y-f.y):(h.wf(r,xi,c),c.u()||c.assign(l)):c.assign(l):f.u()?(h.wf(r,xi,c),c.u()||c.assign(l)):c.assign(l),90===this.J||270===this.J?(g=Math.round((d.x-q.x)/this.Zb),h=d.x,r=Math.round((c.x-l.x)/this.Zb),l=c.x):(g=Math.round((d.y-q.y)/this.Zb),h=d.y,r=Math.round((c.y-l.y)/this.Zb),l=c.y),Mt.free(d),Mt.free(c),e.portFromColOffset=g,e.portFromPos=h,e.portToColOffset=r,e.portToPos=l}else e.portFromColOffset=0,e.portFromPos=0,e.portToColOffset=0,e.portToPos=0;if(d=n.layer,c=o.layer,f=0,null!==(u=e.link)){var y=u.fromPort,m=u.toPort;if(null!==y&&null!==m){var v=u.fromNode;if(p=u.toNode,null!==v&&null!==p){var x=Gp(this,!0),w=Gp(this,!1),k=this.setsPortSpots?x:u.computeSpot(!0,y);q=this.setsPortSpots?w:u.computeSpot(!1,m);var M=u.isOrthogonal;k.gd()&&k.xf(w)&&q.gd()&&q.xf(x)?f=0:(x=u.getLinkPoint(v,y,k,!0,M,p,m,Mt.alloc()),w=u.getLinkDirection(v,y,x,k,!0,M,p,m),Mt.free(x),k.wt()||w!==Ap(this,e,!0)?this.setsPortSpots&&null!==v&&1===v.ports.count&&e.rev&&(f+=1):f+=1,k=u.getLinkPoint(p,m,q,!1,M,v,y,Mt.alloc()),u=u.getLinkDirection(p,m,k,q,!1,M,v,y),Mt.free(k),q.wt()||u!==Ap(this,e,!1)?this.setsPortSpots&&null!==p&&1===p.ports.count&&e.rev&&(f+=2):f+=2)}}}if(f=1===(p=f)||3===p,(p=2===p||3===p)&&((q=a.createVertex()).node=null,q.Wj=1,q.layer=d,q.near=n,a.Eh(q),(n=a.mk(n,q,e.link)).valid=!1,n.rev=e.rev,n.portFromColOffset=g,n.portToColOffset=0,n.portFromPos=h,n.portToPos=0,n=q),u=1,f&&u--,d-c>u&&0<d){for(e.valid=!1,(q=a.createVertex()).node=null,q.Wj=2,q.layer=d-1,a.Eh(q),(n=a.mk(n,q,e.link)).valid=!0,n.rev=e.rev,n.portFromColOffset=p?0:g,n.portToColOffset=0,n.portFromPos=p?0:h,n.portToPos=0,n=q,d--;d-c>u&&0<d;)(q=a.createVertex()).node=null,q.Wj=3,q.layer=d-1,a.Eh(q),(n=a.mk(n,q,e.link)).valid=!0,n.rev=e.rev,n.portFromColOffset=0,n.portToColOffset=0,n.portFromPos=0,n.portToPos=0,n=q,d--;(n=a.mk(q,o,e.link)).valid=!f,f&&(q.near=o),n.rev=e.rev,n.portFromColOffset=0,n.portToColOffset=r,n.portFromPos=0,n.portToPos=l}else e.valid=!0}}for(a=this.gc=[],b=0;b<=this.xa;b++)a[b]=0;for(b=this.network.vertexes.iterator;b.next();)b.value.index=-1;for(this.initializeIndices(),this.Zr=-1,t=this.sd=this.Co=0;t<=this.xa;t++)a[t]>a[this.sd]&&(this.Zr=a[t]-1,this.sd=t),a[t]<a[this.Co]&&(this.Co=t);for(this.No=[],t=0;t<a.length;t++)this.No[t]=[];for(b.reset();b.next();)a=b.value,this.No[a.layer][a.index]=a;for(this.Da=-1,a=0;a<=this.xa;a++){for(b=Xp(this,a),t=0,e=this.gc[a],o=0;o<e;o++)n=b[o],t+=this.nodeMinColumnSpace(n,!0),n.column=t,t+=1,t+=this.nodeMinColumnSpace(n,!1);this.Da=Math.max(this.Da,t-1),qp(this,a,b)}this.reduceCrossings(),this.straightenAndPack(),this.updateParts()}this.network=null,this.isValidLayout=!0},fp.prototype.linkMinLength=function(){return 1},fp.prototype.nodeMinLayerSpace=function(a,b){return null===a.node?0:90===this.J||270===this.J?b?a.focus.y+10:a.bounds.height-a.focus.y+10:b?a.focus.x+10:a.bounds.width-a.focus.x+10},fp.prototype.nodeMinColumnSpace=function(a,b){if(null===a.node)return 0;var t=b?a.Pv:a.Ov;return null!==t?t:90===(t=this.J)||270===t?b?a.Pv=a.focus.x/this.Zb+1|0:a.Ov=(a.bounds.width-a.focus.x)/this.Zb+1|0:b?a.Pv=a.focus.y/this.Zb+1|0:a.Ov=(a.bounds.height-a.focus.y)/this.Zb+1|0},fp.prototype.countCrossings=function(){for(var a=0,b=0;b<=this.xa;b++)for(var t=yp(this,b,1),e=this.gc[b],n=0;n<e;n++)for(var o=n;o<e;o++)a+=t[n*e+o];return a},fp.prototype.normalize=function(){var a=1/0;this.Da=-1;for(var b=this.network.vertexes.iterator;b.next();){var t=b.value;a=Math.min(a,t.column-this.nodeMinColumnSpace(t,!0)),this.Da=Math.max(this.Da,t.column+this.nodeMinColumnSpace(t,!1))}for(b.reset();b.next();)b.value.column-=a;this.Da-=a},fp.prototype.removeCycles=function(){for(var a=this.network.edges.iterator;a.next();)a.value.rev=!1;switch(this.Pk){default:case Kp:var b=0,t=(a=this.network).vertexes.count-1,e=[];e.length=t+1;for(var n=a.vertexes.iterator;n.next();)n.value.valid=!0;for(;null!==kp(a);){for(n=Mp(a);null!==n;)e[t]=n,t--,n.valid=!1,n=Mp(a);for(n=Sp(a);null!==n;)e[b]=n,b++,n.valid=!1,n=Sp(a);n=null;for(var o=0,g=this.network.vertexes.iterator;g.next();){var r=g.value;if(r.valid){for(var h=0,l=r.destinationEdges;l.next();)l.value.toVertex.valid&&h++;l=0;for(var c=r.sourceEdges;c.next();)c.value.fromVertex.valid&&l++;(null===n||o<h-l)&&(n=r,o=h-l)}}null!==n&&(e[b]=n,b++,n.valid=!1)}for(b=0;b<a.vertexes.count;b++)e[b].index=b;for(e=a.edges.iterator;e.next();)(b=e.value).fromVertex.index>b.toVertex.index&&(a.Em(b),b.rev=!0);break;case Up:for(e=this.network.vertexes.iterator;e.next();)(a=e.value).fm=-1,a.finish=-1;for(a=this.network.edges.iterator;a.next();)a.value.forest=!1;for(this.Mo=0,e.reset();e.next();)0===(b=e.value).sourceEdges.count&&Pp(this,b);for(e.reset();e.next();)-1===(b=e.value).fm&&Pp(this,b);for(a.reset();a.next();)(e=a.value).forest||(t=(b=e.fromVertex).finish,o=(n=e.toVertex).finish,n.fm<b.fm&&t<o&&(this.network.Em(e),e.rev=!0));break;case Hp:for(b=(a=this.network).vertexes.iterator,e=1/0;b.next();)e=Math.min(e,b.value.layer);if(1/0>e){if(0>e)for(b.reset();b.next();)b.value.layer-=e;for(e=[],b.reset();b.next();)void 0===(n=e[(t=b.value).layer])?e[t.layer]=[t]:n.push(t);for(t=b=0;t<e.length;t++)if((n=e[t])&&0!==n.length){if(0<t)for(o=0;o<n.length;o++)n[o].layer-=b}else b++;for(e=a.edges.iterator;e.next();)(b=e.value).fromVertex.layer<b.toVertex.layer&&(a.Em(b),b.rev=!0)}}},fp.prototype.assignLayers=function(){switch(this.tl){case Jp:Np(this);break;case Zp:for(var a,b=this.network.vertexes.iterator;b.next();)a=Tp(this,b.value),this.xa=Math.max(a,this.xa);for(b.reset();b.next();)(a=b.value).layer=this.xa-a.layer;break;default:case Wp:for(Np(this),b=this.network.vertexes.iterator;b.next();)b.value.valid=!1;for(b.reset();b.next();)0===(a=b.value).sourceEdges.count&&Lp(this,a);for(a=1/0,b.reset();b.next();)a=Math.min(a,b.value.layer);for(this.xa=-1,b.reset();b.next();){var t=b.value;t.layer-=a,this.xa=Math.max(this.xa,t.layer)}}},fp.prototype.initializeIndices=function(){switch(this.il){default:case _p:for(var a=this.network.vertexes.iterator;a.next();){var b=a.value,t=b.layer;b.index=this.gc[t],this.gc[t]++}break;case $p:for(a=this.network.vertexes.iterator,b=this.xa;0<=b;b--)for(a.reset();a.next();)(t=a.value).layer===b&&-1===t.index&&jp(this,t);break;case Qp:for(a=this.network.vertexes.iterator,b=0;b<=this.xa;b++)for(a.reset();a.next();)(t=a.value).layer===b&&-1===t.index&&Dp(this,t)}},fp.prototype.reduceCrossings=function(){var t,e,n,g,o,a=this.countCrossings(),b=pp(this);for(t=0;t<this.zj;t++){for(e=0;e<=this.xa;e++)Fp(this,e,1),Op(this,e,1);var r=this.countCrossings();for(r<a&&(a=r,b=pp(this)),e=this.xa;0<=e;e--)Fp(this,e,-1),Op(this,e,-1);(r=this.countCrossings())<a&&(a=r,b=pp(this))}for(gp(this,b),t=0;t<this.zj;t++){for(e=0;e<=this.xa;e++)Fp(this,e,0),Op(this,e,0);for((r=this.countCrossings())<a&&(a=r,b=pp(this)),e=this.xa;0<=e;e--)Fp(this,e,0),Op(this,e,0);(r=this.countCrossings())<a&&(a=r,b=pp(this))}switch(gp(this,b),this.Ek){case tg:break;case eg:for(o=a+1;(e=this.countCrossings())<o;)for(o=e,t=this.xa;0<=t;t--)for(g=0;g<=t;g++){for(n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Op(this,e,-1)||n;for((r=this.countCrossings())>=a?gp(this,b):(a=r,b=pp(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Op(this,e,1)||n;for((r=this.countCrossings())>=a?gp(this,b):(a=r,b=pp(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Op(this,e,1)||n;for(r>=a?gp(this,b):(a=r,b=pp(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Op(this,e,-1)||n;for(r>=a?gp(this,b):(a=r,b=pp(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Op(this,e,0)||n;for(r>=a?gp(this,b):(a=r,b=pp(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Op(this,e,0)||n;r>=a?gp(this,b):(a=r,b=pp(this))}break;default:case ig:for(t=this.xa,g=0,o=a+1;(e=this.countCrossings())<o;){for(o=e,n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Op(this,e,-1)||n;for((r=this.countCrossings())>=a?gp(this,b):(a=r,b=pp(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Op(this,e,1)||n;for((r=this.countCrossings())>=a?gp(this,b):(a=r,b=pp(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Op(this,e,1)||n;for(r>=a?gp(this,b):(a=r,b=pp(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Op(this,e,-1)||n;for(r>=a?gp(this,b):(a=r,b=pp(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Op(this,e,0)||n;for(r>=a?gp(this,b):(a=r,b=pp(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Op(this,e,0)||n;r>=a?gp(this,b):(a=r,b=pp(this))}}gp(this,b)},fp.prototype.straightenAndPack=function(){var a=0!=(1&this.mg),b=7===this.mg;if(1e3<this.network.edges.count&&!b&&(a=!1),a){var t=[];for(b=0;b<=this.xa;b++)t[b]=0;for(var e,n=this.network.vertexes.iterator;n.next();){var o=n.value;b=o.layer,e=o.column,o=this.nodeMinColumnSpace(o,!1),t[b]=Math.max(t[b],e+o)}for(n.reset();n.next();)b=(o=n.value).layer,e=o.column,o.column=(8*(this.Da-t[b])>>1)+8*e;this.Da*=8}if(0!=(2&this.mg))for(t=!0;t;){for(t=!1,b=this.sd+1;b<=this.xa;b++)t=Bp(this,b,1)||t;for(b=this.sd-1;0<=b;b--)t=Bp(this,b,-1)||t;t=Bp(this,this.sd,0)||t}if(0!=(4&this.mg)){for(b=this.sd+1;b<=this.xa;b++)Rp(this,b,1);for(b=this.sd-1;0<=b;b--)Rp(this,b,-1);Rp(this,this.sd,0)}if(a&&(Vp(this,-1),Vp(this,1)),0!=(2&this.mg))for(t=!0;t;){for(t=!1,t=Bp(this,this.sd,0)||t,b=this.sd+1;b<=this.xa;b++)t=Bp(this,b,0)||t;for(b=this.sd-1;0<=b;b--)t=Bp(this,b,0)||t}},fp.prototype.commitLayout=function(){if(this.setsPortSpots)for(var a=Gp(this,!0),b=Gp(this,!1),t=this.network.edges.iterator;t.next();){var e=t.value.link;null!==e&&(e.fromSpot=a,e.toSpot=b)}this.commitNodes(),this.iv(),this.isRouting&&this.commitLinks()},fp.prototype.commitNodes=function(){this.Ld=[],this.rd=[],this.qd=[],this.Ga=[];for(var a=0;a<=this.xa;a++)this.Ld[a]=0,this.rd[a]=0,this.qd[a]=0,this.Ga[a]=0;for(a=this.network.vertexes.iterator;a.next();){var b=a.value,t=b.layer;this.Ld[t]=Math.max(this.Ld[t],this.nodeMinLayerSpace(b,!0)),this.rd[t]=Math.max(this.rd[t],this.nodeMinLayerSpace(b,!1))}b=0,t=this.ne;for(var e=0;e<=this.xa;e++){var n=t;0>=this.Ld[e]+this.rd[e]&&(n=0),0<e&&(b+=n/2),90===this.J||0===this.J?(b+=this.rd[e],this.qd[e]=b,b+=this.Ld[e]):(b+=this.Ld[e],this.qd[e]=b,b+=this.rd[e]),e<this.xa&&(b+=n/2),this.Ga[e]=b}for(t=b,b=this.arrangementOrigin,e=0;e<=this.xa;e++)270===this.J?this.qd[e]=b.y+this.qd[e]:90===this.J?(this.qd[e]=b.y+t-this.qd[e],this.Ga[e]=t-this.Ga[e]):180===this.J?this.qd[e]=b.x+this.qd[e]:(this.qd[e]=b.x+t-this.qd[e],this.Ga[e]=t-this.Ga[e]);for(a.reset(),t=e=1/0;a.next();){var o=(n=a.value).layer,g=0|n.column;if(270===this.J||90===this.J){var r=b.x+this.Zb*g;o=this.qd[o]}else r=this.qd[o],o=b.y+this.Zb*g;n.centerX=r,n.centerY=o,e=Math.min(n.x,e),t=Math.min(n.y,t)}for(e=b.x-e,b=b.y-t,this.Jf=new Mt(e,b),a.reset();a.next();)(t=a.value).x+=e,t.y+=b,t.commit()},fp.prototype.iv=function(){for(var a=0,b=this.ne,t=0;t<=this.xa;t++)a+=this.Ld[t],a+=this.rd[t];a+=this.xa*b,b=[],t=this.Zb*this.Da;for(var e=this.maxLayer;0<=e;e--)270===this.J?0===e?b.push(new Wt(0,0,t,Math.abs(this.Ga[0]))):b.push(new Wt(0,this.Ga[e-1],t,Math.abs(this.Ga[e-1]-this.Ga[e]))):90===this.J?0===e?b.push(new Wt(0,this.Ga[0],t,Math.abs(this.Ga[0]-a))):b.push(new Wt(0,this.Ga[e],t,Math.abs(this.Ga[e-1]-this.Ga[e]))):180===this.J?0===e?b.push(new Wt(0,0,Math.abs(this.Ga[0]),t)):b.push(new Wt(this.Ga[e-1],0,Math.abs(this.Ga[e-1]-this.Ga[e]),t)):0===e?b.push(new Wt(this.Ga[0],0,Math.abs(this.Ga[0]-a),t)):b.push(new Wt(this.Ga[e],0,Math.abs(this.Ga[e-1]-this.Ga[e]),t));this.commitLayers(b,this.Jf)},fp.prototype.commitLayers=function(){},fp.prototype.commitLinks=function(){for(var b,a=this.network.edges.iterator;a.next();)null!==(b=a.value.link)&&(b.Nh(),b.Zj(),b.sf());for(a.reset();a.next();)null!==(b=a.value.link)&&b.hj();for(a.reset();a.next();){var t=a.value;if(null!==(b=t.link)){b.Nh();var e=b,n=e.fromNode,o=e.toNode,g=e.fromPort,r=e.toPort;if(null!==n){var h=n.findVisibleNode();null!==h&&h!==n&&(n=h,g=h.port)}null!==o&&(null!==(h=o.findVisibleNode())&&h!==o&&(o=h,r=h.port));var l=b.computeSpot(!0,g);h=b.computeSpot(!1,r);var c=t.fromVertex,f=t.toVertex;if(t.valid){if(b.curve===vc&&4===b.pointsCount)if(c.column===f.column)t=b.getLinkPoint(n,g,l,!0,!1,o,r),g=b.getLinkPoint(o,r,h,!1,!1,n,g),t.u()||t.set(n.actualBounds.center),g.u()||g.set(o.actualBounds.center),b.Zj(),b.rf(t.x,t.y),b.rf((2*t.x+g.x)/3,(2*t.y+g.y)/3),b.rf((t.x+2*g.x)/3,(t.y+2*g.y)/3),b.rf(g.x,g.y);else{var p=!1,d=!1;if(null!==g&&l===pi&&(p=!0),null!==r&&h===pi&&(d=!0),p||d){var q=b.i(0).x;t=b.i(0).y,c=b.i(3).x,e=b.i(3).y,p&&(90===this.J||270===this.J?(p=q,f=(t+e)/2):(p=(q+c)/2,f=t),b.K(1,p,f),(l=b.getLinkPoint(n,g,l,!0,!1,o,r)).u()||l.set(n.actualBounds.center),b.K(0,l.x,l.y)),d&&(90===this.J||270===this.J?(l=c,t=(t+e)/2):(l=(q+c)/2,t=e),b.K(2,l,t),(n=b.getLinkPoint(o,r,h,!1,!1,n,g)).u()||n.set(o.actualBounds.center),b.K(3,n.x,n.y))}}b.sf()}else if(c.layer===f.layer)b.sf();else{if(p=d=!1,q=b.firstPickIndex+1,b.isOrthogonal){p=!0;var u=b.pointsCount;4<u&&b.points.removeRange(2,u-3)}else if(b.curve===vc)d=!0,4<(u=b.pointsCount)&&b.points.removeRange(2,u-3),4===u&&(q=2);else{u=b.pointsCount;var y=l===pi,m=h===pi;2<u&&y&&m?b.points.removeRange(1,u-2):3<u&&y&&!m?b.points.removeRange(1,u-3):3<u&&!y&&m?b.points.removeRange(2,u-2):4<u&&!y&&!m&&b.points.removeRange(2,u-3)}if(t.rev){for(;null!==f&&c!==f;){var v=u=null;for(y=f.sourceEdges.iterator;y.next()&&((m=y.value).link!==t.link||(u=m.fromVertex,v=m.toVertex,null!==u.node)););if(u!==c){y=b.i(q-1).x,m=b.i(q-1).y;var x=u.centerX,w=u.centerY;if(p)180===this.J||0===this.J?q===b.firstPickIndex+1?(b.m(q++,y,m),b.m(q++,y,w)):(null!==v?v.centerY:m)!==w&&(v=this.Ga[u.layer-1]+this.Jf.x,b.m(q++,v,m),b.m(q++,v,w)):q===b.firstPickIndex+1?(b.m(q++,y,m),b.m(q++,x,m)):(null!==v?v.centerX:y)!==x&&(v=this.Ga[u.layer-1]+this.Jf.y,b.m(q++,y,v),b.m(q++,x,v));else if(q===b.firstPickIndex+1){v=Math.max(10,this.Ld[f.layer]);var k=Math.max(10,this.rd[f.layer]);if(d)180===this.J?x<=f.bounds.x?(f=f.bounds.x,b.m(q++,f-v,w),b.m(q++,f,w),b.m(q++,f+k,w)):(b.m(q++,x-v,w),b.m(q++,x,w),b.m(q++,x+k,w)):90===this.J?w>=f.bounds.bottom?(f=f.bounds.y+f.bounds.height,b.m(q++,x,f+k),b.m(q++,x,f),b.m(q++,x,f-v)):(b.m(q++,x,w+k),b.m(q++,x,w),b.m(q++,x,w-v)):270===this.J?w<=f.bounds.y?(f=f.bounds.y,b.m(q++,x,f-v),b.m(q++,x,f),b.m(q++,x,f+k)):(b.m(q++,x,w-v),b.m(q++,x,w),b.m(q++,x,w+k)):0===this.J&&(x>=f.bounds.right?(f=f.bounds.x+f.bounds.width,b.m(q++,f+k,w),b.m(q++,f,w),b.m(q++,f-v,w)):(b.m(q++,x+k,w),b.m(q++,x,w),b.m(q++,x-v,w)));else{b.m(q++,y,m);var M=0;180===this.J||0===this.J?((180===this.J?x>=f.bounds.right:x<=f.bounds.x)&&(M=(0===this.J?-v:k)/2),b.m(q++,y+M,w)):((270===this.J?w>=f.bounds.bottom:w<=f.bounds.y)&&(M=(90===this.J?-v:k)/2),b.m(q++,x,m+M)),b.m(q++,x,w)}}else v=Math.max(10,this.Ld[u.layer]),k=Math.max(10,this.rd[u.layer]),180===this.J?(d&&b.m(q++,x-v,w),b.m(q++,x,w),d&&b.m(q++,x+k,w)):90===this.J?(d&&b.m(q++,x,w+k),b.m(q++,x,w),d&&b.m(q++,x,w-v)):270===this.J?(d&&b.m(q++,x,w-v),b.m(q++,x,w),d&&b.m(q++,x,w+k)):(d&&b.m(q++,x+k,w),b.m(q++,x,w),d&&b.m(q++,x-v,w))}f=u}(null===r||l!==pi||p)&&(y=b.i(q-1).x,m=b.i(q-1).y,x=b.i(q).x,w=b.i(q).y,p?(f=this.rd[c.layer],180===this.J||0===this.J?((p=m)>=c.bounds.y&&p<=c.bounds.bottom&&(180===this.J?x>=c.bounds.x:x<=c.bounds.right)&&(f=c.centerX+(180===this.J?-f:f),p=p<c.bounds.y+c.bounds.height/2?c.bounds.y-this.Zb/2:c.bounds.bottom+this.Zb/2,b.m(q++,f,m),b.m(q++,f,p)),b.m(q++,x,p)):((p=y)>=c.bounds.x&&p<=c.bounds.right&&(270===this.J?w>=c.bounds.y:w<=c.bounds.bottom)&&(f=c.centerY+(270===this.J?-f:f),p=p<c.bounds.x+c.bounds.width/2?c.bounds.x-this.Zb/2:c.bounds.right+this.Zb/2,b.m(q++,y,f),b.m(q++,p,f)),b.m(q++,p,w)),b.m(q++,x,w)):d?(v=Math.max(10,this.Ld[c.layer]),k=Math.max(10,this.rd[c.layer]),180===this.J&&x>=c.bounds.x?(f=c.bounds.x+c.bounds.width,b.K(q-2,f,m),b.K(q-1,f+k,m)):90===this.J&&w<=c.bounds.bottom?(f=c.bounds.y,b.K(q-2,y,f),b.K(q-1,y,f-v)):270===this.J&&w>=c.bounds.y?(f=c.bounds.y+c.bounds.height,b.K(q-2,y,f),b.K(q-1,y,f+k)):0===this.J&&x<=c.bounds.right&&(f=c.bounds.x,b.K(q-2,f,m),b.K(q-1,f-v,m))):(v=Math.max(10,this.Ld[c.layer]),k=Math.max(10,this.rd[c.layer]),p=0,180===this.J||0===this.J?((180===this.J?x<=c.bounds.x:x>=c.bounds.right)&&(p=(0===this.J?k:-v)/2),b.m(q++,x+p,m)):((270===this.J?w<=c.bounds.y:w>=c.bounds.bottom)&&(p=(90===this.J?k:-v)/2),b.m(q++,y,w+p)),b.m(q++,x,w)))}else{for(;null!==c&&c!==f;){for(v=u=null,c=c.destinationEdges.iterator;c.next()&&((y=c.value).link!==t.link||(u=y.toVertex,null!==(v=y.fromVertex).node&&(v=null),null!==u.node)););u!==f&&(y=b.i(q-1).x,m=b.i(q-1).y,x=u.centerX,w=u.centerY,p?180===this.J||0===this.J?(null!==v?v.centerY:m)!==w&&(v=this.Ga[u.layer]+this.Jf.x,q===b.firstPickIndex+1&&(v=0===this.J?Math.max(v,y):Math.min(v,y)),b.m(q++,v,m),b.m(q++,v,w)):(null!==v?v.centerX:y)!==x&&(v=this.Ga[u.layer]+this.Jf.y,q===b.firstPickIndex+1&&(v=90===this.J?Math.max(v,m):Math.min(v,m)),b.m(q++,y,v),b.m(q++,x,v)):(v=Math.max(10,this.Ld[u.layer]),k=Math.max(10,this.rd[u.layer]),180===this.J?(b.m(q++,x+k,w),d&&b.m(q++,x,w),b.m(q++,x-v,w)):90===this.J?(b.m(q++,x,w-v),d&&b.m(q++,x,w),b.m(q++,x,w+k)):270===this.J?(b.m(q++,x,w+k),d&&b.m(q++,x,w),b.m(q++,x,w-v)):(b.m(q++,x-v,w),d&&b.m(q++,x,w),b.m(q++,x+k,w)))),c=u}p&&(y=b.i(q-1).x,m=b.i(q-1).y,x=b.i(q).x,w=b.i(q).y,180===this.J||0===this.J?m!==w&&(v=0===this.J?Math.min(Math.max((x+y)/2,this.Ga[f.layer]+this.Jf.x),x):Math.max(Math.min((x+y)/2,this.Ga[f.layer]+this.Jf.x),x),b.m(q++,v,m),b.m(q++,v,w)):y!==x&&(v=90===this.J?Math.min(Math.max((w+m)/2,this.Ga[f.layer]+this.Jf.y),w):Math.max(Math.min((w+m)/2,this.Ga[f.layer]+this.Jf.y),w),b.m(q++,y,v),b.m(q++,x,v)))}null!==e&&d&&(null!==g&&(l===pi&&(l=b.i(0),e=b.i(2),l.w(e)||b.K(1,(l.x+e.x)/2,(l.y+e.y)/2)),(l=b.getLinkPoint(n,g,pi,!0,!1,o,r)).u()||l.set(n.actualBounds.center),b.K(0,l.x,l.y)),null!==r&&(h===pi&&(h=b.i(b.pointsCount-1),l=b.i(b.pointsCount-3),h.w(l)||b.K(b.pointsCount-2,(h.x+l.x)/2,(h.y+l.y)/2)),(n=b.getLinkPoint(o,r,pi,!1,!1,n,g)).u()||n.set(o.actualBounds.center),b.K(b.pointsCount-1,n.x,n.y))),b.sf(),t.commit()}}}this.avoidOrthogonalOverlaps()},fp.prototype.avoidOrthogonalOverlaps=function(){for(var a=new lt,b=this.network.edges.iterator;b.next();){var t=b.value.link;null!==t&&t.isOrthogonal&&!a.contains(t)&&a.add(t)}if(0<a.count)if(90===this.J||270===this.J){for(b=0,t=[],a=a.iterator;a.next();){var e=a.value;if(null!==e&&e.isOrthogonal)for(var n=2;n<e.pointsCount-3;n++){var o=e.i(n),g=e.i(n+1);if(this.A(o.y,g.y)&&!this.A(o.x,g.x)){var r=new ng;r.layer=Math.floor(o.y/2);var h=e.i(0),l=e.i(e.pointsCount-1);if(r.first=h.x*h.x+h.y,r.Xb=l.x*l.x+l.y,r.Tc=Math.min(o.x,g.x),r.tc=Math.max(o.x,g.x),r.index=n,r.link=e,n+2<e.pointsCount){h=e.i(n-1),l=e.i(n+2);var c=0;h.y<o.y?c=l.y<o.y?3:o.x<g.x?2:1:h.y>o.y&&(c=l.y>o.y?0:g.x<o.x?2:1),r.l=c}t.push(r)}}}if(1<t.length)for(t.sort(this.hy),a=0;a<t.length;){for(o=t[a].layer,e=a+1;e<t.length&&t[e].layer===o;)e++;if(1<e-a)for(o=a;o<e;){for(g=t[o].tc,n=a+1;n<e&&t[n].Tc<g;)g=Math.max(g,t[n].tc),n++;if(1<(g=n-o)){for(this.ej(t,this.Kt,o,o+g),c=1,r=t[o].Xb,h=o;h<n;h++)(l=t[h]).Xb!==r&&(c++,r=l.Xb);this.ej(t,this.gy,o,o+g);var f=1;for(r=t[o].first,h=o;h<n;h++)(l=t[h]).first!==r&&(f++,r=l.first);for(h=!0,l=f,c<f?(h=!1,l=c,r=t[o].Xb,this.ej(t,this.Kt,o,o+g)):r=t[o].first,c=0,f=o;f<n;f++){var p=t[f];(h?p.first:p.Xb)!==r&&(c++,r=h?p.first:p.Xb);var d=p.link;o=d.i(p.index),g=d.i(p.index+1);var q=this.linkSpacing*(c-(l-1)/2);b++,d.Nh(),d.K(p.index,o.x,o.y+q),d.K(p.index+1,g.x,g.y+q),d.sf()}}o=n}a=e}}else{for(b=0,t=[],a=a.iterator;a.next();)if(null!==(e=a.value)&&e.isOrthogonal)for(n=2;n<e.pointsCount-3;n++)o=e.i(n),g=e.i(n+1),this.A(o.x,g.x)&&!this.A(o.y,g.y)&&((r=new ng).layer=Math.floor(o.x/2),h=e.i(0),l=e.i(e.pointsCount-1),r.first=h.x+h.y*h.y,r.Xb=l.x+l.y*l.y,r.Tc=Math.min(o.y,g.y),r.tc=Math.max(o.y,g.y),r.index=n,r.link=e,n+2<e.pointsCount&&(h=e.i(n-1),l=e.i(n+2),c=0,h.x<o.x?c=l.x<o.x?3:o.y<g.y?2:1:h.x>o.x&&(c=l.x>o.x?0:g.y<o.y?2:1),r.l=c),t.push(r));if(1<t.length)for(t.sort(this.hy),a=0;a<t.length;){for(o=t[a].layer,e=a+1;e<t.length&&t[e].layer===o;)e++;if(1<e-a)for(o=a;o<e;){for(g=t[o].tc,n=a+1;n<e&&t[n].Tc<g;)g=Math.max(g,t[n].tc),n++;if(1<(g=n-o)){for(this.ej(t,this.Kt,o,o+g),c=1,r=t[o].Xb,h=o;h<n;h++)(l=t[h]).Xb!==r&&(c++,r=l.Xb);for(this.ej(t,this.gy,o,o+g),f=1,r=t[o].first,h=o;h<n;h++)(l=t[h]).first!==r&&(f++,r=l.first);for(h=!0,l=f,c<f?(h=!1,l=c,r=t[o].Xb,this.ej(t,this.Kt,o,o+g)):r=t[o].first,c=0,f=o;f<n;f++)p=t[f],(h?p.first:p.Xb)!==r&&(c++,r=h?p.first:p.Xb),o=(d=p.link).i(p.index),g=d.i(p.index+1),q=this.linkSpacing*(c-(l-1)/2),b++,d.Nh(),d.K(p.index,o.x+q,o.y),d.K(p.index+1,g.x+q,g.y),d.sf()}o=n}a=e}}},(n=fp.prototype).hy=function(a,b){return a instanceof ng&&b instanceof ng&&a!==b?a.layer<b.layer?-1:a.layer>b.layer?1:a.Tc<b.Tc?-1:a.Tc>b.Tc?1:a.tc<b.tc?-1:a.tc>b.tc?1:0:0},n.gy=function(a,b){return a instanceof ng&&b instanceof ng&&a!==b?a.first<b.first?-1:a.first>b.first||a.l<b.l?1:a.l>b.l||a.Tc<b.Tc?-1:a.Tc>b.Tc?1:a.tc<b.tc?-1:a.tc>b.tc?1:0:0},n.Kt=function(a,b){return a instanceof ng&&b instanceof ng&&a!==b?a.Xb<b.Xb?-1:a.Xb>b.Xb||a.l<b.l?1:a.l>b.l||a.Tc<b.Tc?-1:a.Tc>b.Tc?1:a.tc<b.tc?-1:a.tc>b.tc?1:0:0},n.A=function(a,b){return-1<(a-=b)&&1>a},n.ej=function(a,b,t,e){var n=a.length,o=e-t;if(!(1>=o))if((0>t||t>=n-1)&&N("not in range 0 <= from < length: "+t),2===o)0<b(e=a[t],n=a[t+1])&&(a[t]=n,a[t+1]=e);else if(0===t)if(e>=n)a.sort(b);else for((t=a.slice(0,e)).sort(b),b=0;b<e;b++)a[b]=t[b];else if(e>=n)for((e=a.slice(t)).sort(b),b=t;b<n;b++)a[b]=e[b-t];else for((n=a.slice(t,e)).sort(b),b=t;b<e;b++)a[b]=n[b-t]},v.Object.defineProperties(fp.prototype,{layerSpacing:{get:function(){return this.ne},set:function(a){this.ne!==a&&0<=a&&(this.ne=a,this.C())}},columnSpacing:{get:function(){return this.Zb},set:function(a){this.Zb!==a&&0<a&&(this.Zb=a,this.C())}},direction:{get:function(){return this.J},set:function(a){this.J!==a&&(0===a||90===a||180===a||270===a?(this.J=a,this.C()):N("LayeredDigraphLayout.direction must be 0, 90, 180, or 270"))}},cycleRemoveOption:{get:function(){return this.Pk},set:function(a){this.Pk===a||a!==Kp&&a!==Up&&a!==Hp||(this.Pk=a,this.C())}},layeringOption:{get:function(){return this.tl},set:function(a){this.tl===a||a!==Wp&&a!==Jp&&a!==Zp||(this.tl=a,this.C())}},initializeOption:{get:function(){return this.il},set:function(a){this.il===a||a!==$p&&a!==Qp&&a!==_p||(this.il=a,this.C())}},iterations:{get:function(){return this.zj},set:function(a){this.zj!==a&&0<=a&&(this.zj=a,this.C())}},aggressiveOption:{get:function(){return this.Ek},set:function(a){this.Ek===a||a!==tg&&a!==ig&&a!==eg||(this.Ek=a,this.C())}},packOption:{get:function(){return this.mg},set:function(a){this.mg!==a&&0<=a&&8>a&&(this.mg=a,this.C())}},setsPortSpots:{get:function(){return this.df},set:function(a){this.df!==a&&(this.df=a,this.C())}},linkSpacing:{get:function(){return this.ro},set:function(a){this.ro!==a&&0<=a&&(this.ro=a,this.C())}},maxLayer:{get:function(){return this.xa}},maxIndex:{get:function(){return this.Zr}},maxColumn:{get:function(){return this.Da}},minIndexLayer:{get:function(){return this.Co}},maxIndexLayer:{get:function(){return this.sd}}});var Up=new _(fp,"CycleDepthFirst",0),Kp=new _(fp,"CycleGreedy",1),Hp=new _(fp,"CycleFromLayers",2),Wp=new _(fp,"LayerOptimalLinkLength",0),Jp=new _(fp,"LayerLongestPathSink",1),Zp=new _(fp,"LayerLongestPathSource",2),$p=new _(fp,"InitDepthFirstOut",0),Qp=new _(fp,"InitDepthFirstIn",1),_p=new _(fp,"InitNaive",2),tg=new _(fp,"AggressiveNone",0),ig=new _(fp,"AggressiveLess",1),eg=new _(fp,"AggressiveMore",2);function ng(){this.index=this.tc=this.Tc=this.Xb=this.first=this.layer=0,this.link=null,this.l=0}function og(a){_c.call(this,a)}function rg(a){rf.call(this,a),this.Oa=this.Og=this.ui=-1,this.I=NaN,this.Y=null,this.valid=!1,this.finish=this.fm=NaN,this.Wj=0,this.Ov=this.Pv=null}function sg(a){af.call(this,a),this.l=this.Ia=this.Za=!1,this.Ha=this.I=NaN,this.Y=this.v=0}function ag(){Zc.call(this),this.Hb=new ct,this.ap=Eg,this.$c=zg,this.Xp=iy,this.Yr=hy,this.Lw=[],this.Zc=!0,this.Ab=ry,this.Ad=new qt(10,10).freeze();var a=new dt(this);this.T=new cy(a),this.U=new cy(a),this.Vu=[]}function hg(a){var b=new ct;for(a=a.iterator;a.next();){var t=a.value;t.initialized||b.add(t)}return b}function lg(a,b){var t=999999,e=null;for(b=b.iterator;b.next();){var n=b.value;switch(a.$c){case zg:n.sourceEdges.count<t&&(t=n.sourceEdges.count,e=n);break;case Vg:n.destinationEdges.count<t&&(t=n.destinationEdges.count,e=n);break;default:N("Unhandled path value "+a.$c.toString())}}return e}function ug(a,b){if(null!==b){switch(a.$c){case zg:if(0<b.destinationEdges.count){for(var t=new lt,e=b.destinationVertexes;e.next();){var n=e.value;cg(a,b,n)&&t.add(n)}0<t.count&&(b.children=t.na())}break;case Vg:if(0<b.sourceEdges.count){for(t=new lt,e=b.sourceVertexes;e.next();)cg(a,b,n=e.value)&&t.add(n);0<t.count&&(b.children=t.na())}break;default:N("Unhandled path value"+a.$c.toString())}for(e=(t=b.children).length,n=0;n<e;n++){var o=t[n];o.initialized=!0,o.level=b.level+1,o.parent=b,a.Hb.remove(o)}for(b=0;b<e;b++)ug(a,t[b])}}function cg(a,b,t){if(t.initialized){if(null===b)var e=!1;else{for(e=b.parent;null!==e&&e!==t;)e=e.parent;e=e===t}if(e||t.level>b.level)return!1;a.removeChild(t.parent,t)}return!0}function fg(a,b){if(null!==b){a.initializeTreeVertexValues(b),b.alignment===Zg&&a.sortTreeVertexChildren(b);for(var t=0,e=b.childrenCount,n=0,o=b.children,g=o.length,r=0;r<g;r++){var h=o[r];fg(a,h),t+=h.descendantCount+1,e=Math.max(e,h.maxChildrenCount),n=Math.max(n,h.maxGenerationCount)}b.descendantCount=t,b.maxChildrenCount=e,b.maxGenerationCount=0<e?n+1:0}}function dg(a,b){if(null!==b){a.assignTreeVertexValues(b);for(var t=(b=b.children).length,e=0;e<t;e++)dg(a,b[e])}}function pg(a,b){if(null!==b){b.alignment!==Zg&&a.sortTreeVertexChildren(b);for(var t=(b=b.children).length,e=0;e<t;e++)pg(a,b[e])}}function gg(a){return a===Jg||a===Zg||a===$g||a===Qg}function yg(a){return a===Jg||a===Zg}function mg(a){var b=a.parent;if(null!==b){var t=b.alignment;if(gg(t)){if(yg(t)){for(b=b.children,t=0;t<b.length&&a!==b[t];)t++;return 0==t%2}if(t===$g)return!0}}return!1}function vg(a,b){if(0===b.childrenCount){var t=!1,e=0;null!==b.parent&&(e=b.parent.angle,t=gg(t=b.parent.alignment));var n=mg(b);b.S.h(0,0),b.ta.h(b.width,b.height),null===b.parent||null===b.comments||(180!==e&&270!==e||t)&&!n?b.da.h(0,0):180===e&&!t||(90===e||270===e)&&n?b.da.h(b.width-2*b.focus.x,0):b.da.h(0,b.height-2*b.focus.y)}else{t=90===(e=Bg(b))||270===e;for(var o=0,g=(n=b.children).length,r=0;r<g;r++){var h=n[r];o=Math.max(o,t?h.ta.width:h.ta.height)}var l=b.alignment,c=l===Hg,f=l===Wg;r=gg(l);var p=Math.max(0,b.breadthLimit);h=Ig(b);var d=b.nodeSpacing,q=Rg(b),u=c||f?0:q/2,y=b.rowSpacing,m=0;(c||f||b.Fm||b.Gm&&1===b.maxGenerationCount)&&(m=Math.max(0,b.rowIndent)),c=b.width;var v=b.height,x=0,w=0,k=0,M=0,S=0,P=0,C=0,T=0,L=0;if(r&&!yg(l)&&135<e&&n.reverse(),yg(l))if(1<g)for(var A=0;A<g;A++){var j=n[A],D=j.ta;0==A%2&&A!==g-1&&(L=Math.max(L,(t?D.width:D.height)+wg(j)-d))}else 1===g&&(L=t?n[0].ta.width:n[0].ta.height);if(r)switch(l){case Jg:case Zg:L=(w=135>e?xg(b,n,L,x,w):bg(b,n,L,x,w)).x,x=w.width,w=w.height;break;case $g:for(a=0;a<g;a++)u=(p=n[a]).ta,k=0===C?0:y,t?(p.S.h(o-u.width,S+k),x=Math.max(x,u.width),w=Math.max(w,S+k+u.height),S+=k+u.height):(p.S.h(M+k,o-u.height),x=Math.max(x,M+k+u.width),w=Math.max(w,u.height),M+=k+u.width),C++;break;case Qg:for(o=0;o<g;o++)p=(a=n[o]).ta,u=0===C?0:y,t?(a.S.h(d/2+b.focus.x,S+u),x=Math.max(x,p.width),w=Math.max(w,S+u+p.height),S+=u+p.height):(a.S.h(M+u,d/2+b.focus.y),x=Math.max(x,M+u+p.width),w=Math.max(w,p.height),M+=u+p.width),C++}else for(A=0;A<g;A++){if(D=(j=n[A]).ta,t){0<p&&0<C&&M+d+D.width>p&&(M<o&&Ng(b,l,o-M,0,T,A-1),P++,C=0,T=A,k=w,M=0,S=135<e?-w-y:w+y);var F=0===C?u:d;Tg(a,j,0,S),j.S.h(M+F,S),x=Math.max(x,M+F+D.width),w=Math.max(w,k+(0===P?0:y)+D.height),M+=F+D.width}else 0<p&&0<C&&S+d+D.height>p&&(S<o&&Ng(b,l,0,o-S,T,A-1),P++,C=0,T=A,k=x,S=0,M=135<e?-x-y:x+y),F=0===C?u:d,Tg(a,j,M,0),j.S.h(M,S+F),w=Math.max(w,S+F+D.height),x=Math.max(x,k+(0===P?0:y)+D.width),S+=F+D.height;C++}switch(0<P&&(t?(w+=Math.max(0,h),M<x&&Ng(b,l,x-M,0,T,g-1),0<m&&(f||Cg(b,m,0,0,g-1),x+=m)):(x+=Math.max(0,h),S<w&&Ng(b,l,0,w-S,T,g-1),0<m&&(f||Cg(b,0,m,0,g-1),w+=m))),m=f=0,l){case Ug:t?f+=x/2-b.focus.x-q/2:m+=w/2-b.focus.y-q/2;break;case Kg:0<P?t?f+=x/2-b.focus.x-q/2:m+=w/2-b.focus.y-q/2:t?f+=(l=n[0].S.x+n[0].da.x)+(n[g-1].S.x+n[g-1].da.x+2*n[g-1].focus.x-l)/2-b.focus.x-q/2:m+=(l=n[0].S.y+n[0].da.y)+(n[g-1].S.y+n[g-1].da.y+2*n[g-1].focus.y-l)/2-b.focus.y-q/2;break;case Hg:t?(f-=q,x+=q):(m-=q,w+=q);break;case Wg:t?(f+=x-b.width+q,x+=q):(m+=w-b.height+q,w+=q);break;case Jg:case Zg:t?f+=1<g?L+d/2-b.focus.x:n[0].focus.x-b.focus.x+n[0].da.x:m+=1<g?L+d/2-b.focus.y:n[0].focus.y-b.focus.y+n[0].da.y;break;case $g:t?f+=x+d/2-b.focus.x:m+=w+d/2-b.focus.y;break;case Qg:break;default:N("Unhandled alignment value "+l.toString())}for(q=0;q<g;q++)l=n[q],t?l.S.h(l.S.x+l.da.x-f,l.S.y+(135<e?(r?-w:-l.ta.height)+l.da.y-h:v+h+l.da.y)):l.S.h(l.S.x+(135<e?(r?-x:-l.ta.width)+l.da.x-h:c+h+l.da.x),l.S.y+l.da.y-m);t?(x=Mg(b,x,f),0>f&&(f=0),135<e&&(m+=w+h),w=Math.max(Math.max(w,v),w+v+h)):(135<e&&(f+=x+h),x=Math.max(Math.max(x,c),x+c+h),w=Sg(b,w,m),0>m&&(m=0)),b.da.h(f,m),b.ta.h(x,w)}}function xg(a,b,t,e,n){var o=b.length;if(0===o)return new Wt(t,0,e,n);if(1===o)return new Wt(t,0,e=(a=b[0]).ta.width,n=a.ta.height);for(var g=a.nodeSpacing,r=a.rowSpacing,h=90===Bg(a),l=0,c=0,f=0,p=0;p<o;p++)if(!(0!=p%2||1<o&&p===o-1)){var d=b[p],q=d.ta,u=0===l?0:r;if(h){var y=wg(d)-g;d.S.h(t-(q.width+y),f+u),e=Math.max(e,q.width+y),n=Math.max(n,f+u+q.height),f+=u+q.height}else y=wg(d)-g,d.S.h(c+u,t-(q.height+y)),n=Math.max(n,q.height+y),e=Math.max(e,c+u+q.width),c+=u+q.width;l++}for(l=0,d=c,p=f,h?(c=t+g,f=0):(c=0,f=t+g),q=0;q<o;q++)if(0!=q%2){y=(u=b[q]).ta;var m=0===l?0:r;if(h){var v=wg(u)-g;u.S.h(c+v,f+m),e=Math.max(e,c+y.width+v),n=Math.max(n,f+m+y.height),f+=m+y.height}else v=wg(u)-g,u.S.h(c+m,f+v),e=Math.max(e,c+m+y.width),n=Math.max(n,f+y.height+v),c+=m+y.width;l++}return 1<o&&1==o%2&&(o=(b=b[o-1]).ta,r=null===b.parent?0:b.parent.rowSpacing,h?(b.S.h(t+g/2-b.focus.x-b.da.x,n+r),h=t+g/2-b.focus.x-b.da.x,e=Math.max(e,h+o.width),0>h&&(e-=h),n=Math.max(n,Math.max(p,f)+r+o.height),0>b.S.x&&(t=kg(a,b.S.x,!1,t,g))):(b.S.h(e+r,t+g/2-b.focus.y-b.da.y),e=Math.max(e,Math.max(d,c)+r+o.width),f=t+g/2-b.focus.y-b.da.y,n=Math.max(n,f+o.height),0>f&&(n-=f),0>b.S.y&&(t=kg(a,b.S.y,!0,t,g)))),new Wt(t,0,e,n)}function bg(a,b,t,e,n){var o=b.length;if(0===o)return new Wt(t,0,e,n);if(1===o)return new Wt(t,0,e=(b=b[0]).ta.width,n=b.ta.height);for(var g=a.nodeSpacing,r=a.rowSpacing,h=270===Bg(a),l=0,c=0,f=0,p=0;p<o;p++)if(!(0!=p%2||1<o&&p===o-1)){var d=b[p],q=d.ta,u=0===l?0:r;if(h){var y=wg(d)-g;f-=u+q.height,d.S.h(t-(q.width+y),f),e=Math.max(e,q.width+y),n=Math.max(n,Math.abs(f))}else y=wg(d)-g,c-=u+q.width,d.S.h(c,t-(q.height+y)),n=Math.max(n,q.height+y),e=Math.max(e,Math.abs(c));l++}for(l=0,d=c,p=f,h?(c=t+g,f=0):(c=0,f=t+g),q=0;q<o;q++)if(0!=q%2){y=(u=b[q]).ta;var m=0===l?0:r;if(h){var v=wg(u)-g;f-=m+y.height,u.S.h(c+v,f),e=Math.max(e,c+y.width+v),n=Math.max(n,Math.abs(f))}else v=wg(u)-g,c-=m+y.width,u.S.h(c,f+v),n=Math.max(n,f+y.height+v),e=Math.max(e,Math.abs(c));l++}for(1<o&&1==o%2&&(l=(r=b[o-1]).ta,q=null===r.parent?0:r.parent.rowSpacing,h?(r.S.h(t+g/2-r.focus.x-r.da.x,-n-l.height-q),c=t+g/2-r.focus.x-r.da.x,e=Math.max(e,c+l.width),0>c&&(e-=c),n=Math.max(n,Math.abs(Math.min(p,f))+q+l.height),0>r.S.x&&(t=kg(a,r.S.x,!1,t,g))):(r.S.h(-e-l.width-q,t+g/2-r.focus.y-r.da.y),e=Math.max(e,Math.abs(Math.min(d,c))+q+l.width),f=t+g/2-r.focus.y-r.da.y,n=Math.max(n,f+l.height),0>f&&(n-=f),0>r.S.y&&(t=kg(a,r.S.y,!0,t,g)))),a=0;a<o;a++)g=b[a],h?g.S.h(g.S.x,g.S.y+n):g.S.h(g.S.x+e,g.S.y);return new Wt(t,0,e,n)}function wg(a){return null===a.parent?0:a.parent.nodeSpacing}function kg(a,b,t,e,n){for(var o=(a=a.children).length,g=0;g<o;g++)t?a[g].S.h(a[g].S.x,a[g].S.y-b):a[g].S.h(a[g].S.x-b,a[g].S.y);return b=a[o-1],Math.max(e,t?b.da.y+b.focus.y-n/2:b.da.x+b.focus.x-n/2)}function Mg(a,b,t){switch(a.alignment){case Kg:case Ug:return t+a.width>b&&(b=t+a.width),0>t&&(b-=t),b;case Hg:return a.width>b?a.width:b;case Wg:return 2*a.focus.x>b?a.width:b+a.width-2*a.focus.x;case Jg:case Zg:return Math.max(a.width,Math.max(b,t+a.width)-Math.min(0,t));case $g:return a.width-a.focus.x+a.nodeSpacing/2+b;case Qg:return Math.max(a.width,a.focus.x+a.nodeSpacing/2+b);default:return b}}function Sg(a,b,t){switch(a.alignment){case Kg:case Ug:return t+a.height>b&&(b=t+a.height),0>t&&(b-=t),b;case Hg:return a.height>b?a.height:b;case Wg:return 2*a.focus.y>b?a.height:b+a.height-2*a.focus.y;case Jg:case Zg:return Math.max(a.height,Math.max(b,t+a.height)-Math.min(0,t));case $g:return a.height-a.focus.y+a.nodeSpacing/2+b;case Qg:return Math.max(a.height,a.focus.y+a.nodeSpacing/2+b);default:return b}}function Pg(a,b,t){switch(a){case Ug:case Kg:b/=2,t/=2;break;case Hg:t=b=0;break;case Wg:break;default:N("Unhandled alignment value "+a.toString())}return new Mt(b,t)}function Ng(a,b,t,e,n,o){Cg(a,(b=Pg(b,t,e)).x,b.y,n,o)}function Cg(a,b,t,e,n){if(0!==b||0!==t)for(a=a.children;e<=n;e++){var o=a[e].S;o.x+=b,o.y+=t}}function Tg(a,b,t,e){var n=b.parent;switch(a.$c){case zg:for(a=b.sourceEdges;a.next();)(b=a.value).fromVertex===n&&b.relativePoint.h(t,e);break;case Vg:for(a=b.destinationEdges;a.next();)(b=a.value).toVertex===n&&b.relativePoint.h(t,e);break;default:N("Unhandled path value "+a.$c.toString())}}function Lg(a,b,t){for(var e=0;e<a.length;e++){var n=a[e];n.x+=b,n.y+=t}}function Ag(a,b,t,e,n,o,g,r){var h=Bg(b),l=90===h||270===h,c=b.nodeSpacing;b=e;var f=n;e=o;var p=g,d=t.vq,q=t.Iq;g=t.ta;var u=l?Math.max(p,g.height):Math.max(e,g.width);if(null!==d&&h===Bg(t)||(d=jg(a,2),q=jg(a,2),l?(d[0].h(0,0),d[1].h(0,g.height),q[0].h(g.width,0),q[1].h(q[0].x,d[1].y)):(d[0].h(0,0),d[1].h(g.width,0),q[0].h(0,g.height),q[1].h(d[1].x,q[0].y))),l){if(p=9999999,!(null===f||2>f.length||null===d||2>d.length))for(n=t=0;t<f.length&&n<d.length;){o=f[t];var y=d[n];h=y.x,l=y.y,h+=e;var m=o;t+1<f.length&&(m=f[t+1]);var v=y;y=v.x,v=v.y,n+1<d.length&&(y=(v=d[n+1]).x,v=v.y,y+=e);var x=p;o.y===l?x=h-o.x:o.y>l&&o.y<v?x=h+(o.y-l)/(v-l)*(y-h)-o.x:l>o.y&&l<m.y&&(x=h-(o.x+(l-o.y)/(m.y-o.y)*(m.x-o.x))),x<p&&(p=x),m.y<=o.y?t++:v<=l?n++:(m.y<=v&&t++,v<=m.y&&n++)}if(p=e-p,t=d,n=p+=c,null===b||2>b.length||null===t||2>t.length)e=null;else{for(c=jg(a,b.length+t.length),e=o=h=0;o<t.length&&t[o].y<b[0].y;)l=t[o++],c[e++].h(l.x+n,l.y);for(;h<b.length;)l=b[h++],c[e++].h(l.x,l.y);for(h=b[b.length-1].y;o<t.length&&t[o].y<=h;)o++;for(;o<t.length&&t[o].y>h;)l=t[o++],c[e++].h(l.x+n,l.y);for(t=jg(a,e),h=0;h<e;h++)t[h].assign(c[h]);Dg(a,c),e=t}if(o=q,h=p,null===f||2>f.length||null===o||2>o.length)n=null;else{for(c=jg(a,f.length+o.length),n=l=t=0;t<f.length&&f[t].y<o[0].y;)m=f[t++],c[n++].h(m.x,m.y);for(;l<o.length;)m=o[l++],c[n++].h(m.x+h,m.y);for(o=o[o.length-1].y;t<f.length&&f[t].y<=o;)t++;for(;t<f.length&&f[t].y>o;)h=f[t++],c[n++].h(h.x,h.y);for(o=jg(a,n),t=0;t<n;t++)o[t].assign(c[t]);Dg(a,c),n=o}return o=Math.max(0,p)+g.width,g=u,Dg(a,b),Dg(a,d),Dg(a,f),Dg(a,q),r[0]=e,r[1]=n,new Wt(p,0,o,g)}if(e=9999999,!(null===f||2>f.length||null===d||2>d.length))for(n=t=0;t<f.length&&n<d.length;)o=f[t],h=(y=d[n]).x,l=y.y,l+=p,m=o,t+1<f.length&&(m=f[t+1]),y=(v=y).x,v=v.y,n+1<d.length&&(y=(v=d[n+1]).x,v=v.y,v+=p),x=e,o.x===h?x=l-o.y:o.x>h&&o.x<y?x=l+(o.x-h)/(y-h)*(v-l)-o.y:h>o.x&&h<m.x&&(x=l-(o.y+(h-o.x)/(m.x-o.x)*(m.y-o.y))),x<e&&(e=x),m.x<=o.x?t++:y<=h?n++:(m.x<=y&&t++,y<=m.x&&n++);if(p-=e,t=d,n=p+=c,null===b||2>b.length||null===t||2>t.length)e=null;else{for(c=jg(a,b.length+t.length),e=o=h=0;o<t.length&&t[o].x<b[0].x;)l=t[o++],c[e++].h(l.x,l.y+n);for(;h<b.length;)l=b[h++],c[e++].h(l.x,l.y);for(h=b[b.length-1].x;o<t.length&&t[o].x<=h;)o++;for(;o<t.length&&t[o].x>h;)l=t[o++],c[e++].h(l.x,l.y+n);for(t=jg(a,e),h=0;h<e;h++)t[h].assign(c[h]);Dg(a,c),e=t}if(o=q,h=p,null===f||2>f.length||null===o||2>o.length)n=null;else{for(c=jg(a,f.length+o.length),n=l=t=0;t<f.length&&f[t].x<o[0].x;)m=f[t++],c[n++].h(m.x,m.y);for(;l<o.length;)m=o[l++],c[n++].h(m.x,m.y+h);for(o=o[o.length-1].x;t<f.length&&f[t].x<=o;)t++;for(;t<f.length&&f[t].x>o;)h=f[t++],c[n++].h(h.x,h.y);for(o=jg(a,n),t=0;t<n;t++)o[t].assign(c[t]);Dg(a,c),n=o}return o=u,g=Math.max(0,p)+g.height,Dg(a,b),Dg(a,d),Dg(a,f),Dg(a,q),r[0]=e,r[1]=n,new Wt(p,0,o,g)}function jg(a,b){if(void 0!==(a=a.Vu[b])&&void 0!==(a=a.pop()))return a;a=[];for(var t=0;t<b;t++)a[t]=new Mt;return a}function Dg(a,b){var t=b.length,e=a.Vu[t];void 0===e&&(e=[],a.Vu[t]=e),e.push(b)}function Fg(a,b,t,e){if(null!==b){b.x=t,b.y=e;for(var n=(b=b.children).length,o=0;o<n;o++){var g=b[o];Fg(a,g,t+g.S.x,e+g.S.y)}}}function Og(a,b){if(null!==b){a.setPortSpots(b);for(var t=(b=b.children).length,e=0;e<t;e++)Og(a,b[e])}}function Bg(a){return 45>=(a=a.angle)?0:135>=a?90:225>=a?180:315>=a?270:0}function Ig(a){var b=Bg(a);b=90===b||270===b;var t=a.layerSpacing;if(0<a.layerSpacingParentOverlap){var e=Math.min(1,a.layerSpacingParentOverlap);t-=b?a.height*e:a.width*e}return t<(b?-a.height:-a.width)&&(t=b?-a.height:-a.width),t}function Rg(a){var b=Bg(a),t=a.nodeIndent;if(0<a.nodeIndentPastParent){var e=Math.min(1,a.nodeIndentPastParent);t+=90===b||270===b?a.width*e:a.height*e}return Math.max(0,t)}fp.className="LayeredDigraphLayout",fp.CycleDepthFirst=Up,fp.CycleGreedy=Kp,fp.CycleFromLayers=Hp,fp.LayerOptimalLinkLength=Wp,fp.LayerLongestPathSink=Jp,fp.LayerLongestPathSource=Zp,fp.InitDepthFirstOut=$p,fp.InitDepthFirstIn=Qp,fp.InitNaive=_p,fp.AggressiveNone=tg,fp.AggressiveLess=ig,fp.AggressiveMore=eg,fp.PackNone=0,fp.PackExpand=1,fp.PackStraighten=2,fp.PackMedian=4,fp.PackAll=7,ng.className="SegInfo",m(og,_c),og.prototype.createVertex=function(){return new rg(this)},og.prototype.createEdge=function(){return new sg(this)},og.className="LayeredDigraphNetwork",m(rg,rf),v.Object.defineProperties(rg.prototype,{layer:{get:function(){return this.ui},set:function(a){this.ui!==a&&(this.ui=a)}},column:{get:function(){return this.Og},set:function(a){this.Og!==a&&(this.Og=a)}},index:{get:function(){return this.Oa},set:function(a){this.Oa!==a&&(this.Oa=a)}},component:{get:function(){return this.I},set:function(a){this.I!==a&&(this.I=a)}},near:{get:function(){return this.Y},set:function(a){this.Y!==a&&(this.Y=a)}}}),rg.className="LayeredDigraphVertex",m(sg,af),v.Object.defineProperties(sg.prototype,{valid:{get:function(){return this.Za},set:function(a){this.Za!==a&&(this.Za=a)}},rev:{get:function(){return this.Ia},set:function(a){this.Ia!==a&&(this.Ia=a)}},forest:{get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a)}},portFromPos:{get:function(){return this.I},set:function(a){this.I!==a&&(this.I=a)}},portToPos:{get:function(){return this.Ha},set:function(a){this.Ha!==a&&(this.Ha=a)}},portFromColOffset:{get:function(){return this.v},set:function(a){this.v!==a&&(this.v=a)}},portToColOffset:{get:function(){return this.Y},set:function(a){this.Y!==a&&(this.Y=a)}}}),sg.className="LayeredDigraphEdge",m(ag,Zc),ag.prototype.cloneProtected=function(a){Zc.prototype.cloneProtected.call(this,a),a.ap=this.ap,a.Xp=this.Xp,a.Yr=this.Yr,a.Zc=this.Zc,a.Ab=this.Ab,a.Ad.assign(this.Ad),a.T.copyInheritedPropertiesFrom(this.T),a.U.copyInheritedPropertiesFrom(this.U)},ag.prototype.cb=function(a){a.classType===ag?0===a.name.indexOf("Alignment")?this.alignment=a:0===a.name.indexOf("Arrangement")?this.arrangement=a:0===a.name.indexOf("Compaction")?this.compaction=a:0===a.name.indexOf("Path")?this.path=a:0===a.name.indexOf("Sorting")?this.sorting=a:0===a.name.indexOf("Style")?this.treeStyle=a:N("Unknown enum value: "+a):Zc.prototype.cb.call(this,a)},ag.prototype.createNetwork=function(){return new dt(this)},ag.prototype.makeNetwork=function(a){function b(a){if(a instanceof Au)return!a.isLinkLabel&&"Comment"!==a.category;if(a instanceof Wu){var b=a.fromNode;return null!==b&&!b.isLinkLabel&&"Comment"!==b.category&&(null!==(a=a.toNode)&&!a.isLinkLabel&&"Comment"!==a.category)}return!1}var t=this.createNetwork();return a instanceof Vo?(t.xg(a.nodes,!0,b),t.xg(a.links,!0,b)):a instanceof qu?t.xg(a.memberParts,!1,b):t.xg(a.iterator,!1,b),t},ag.prototype.doLayout=function(a){null===this.network&&(this.network=this.makeNetwork(a)),this.arrangement!==ay&&(this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin));var b=this.diagram;if(null===b&&a instanceof Vo&&(b=a),this.path===Eg&&null!==b?this.$c=b.isTreePathToChildren?zg:Vg:this.$c=this.path===Eg?zg:this.path,0<this.network.vertexes.count){for(this.network.iq(),a=this.network.vertexes.iterator;a.next();)(b=a.value).initialized=!1,b.level=0,b.parent=null,b.children=[];if(0<this.Hb.count){for(a=new ct,b=this.Hb.iterator;b.next();){var t=b.value;t instanceof Au?null!==(t=this.network.Wi(t))&&a.add(t):t instanceof cy&&a.add(t)}this.Hb=a}for(0===this.Hb.count&&this.findRoots(),a=this.Hb.copy().iterator;a.next();)(b=a.value).initialized||(b.initialized=!0,ug(this,b));for(b=this.network.vertexes,a=null;0<(a=hg(b)).count;)null!==(b=lg(this,a))&&this.Hb.add(b),b.initialized=!0,ug(this,b),b=a;for(a=this.Hb.iterator;a.next();)(b=a.value)instanceof cy&&fg(this,b);for(a=this.Hb.iterator;a.next();)(b=a.value)instanceof cy&&dg(this,b);for(a=this.Hb.iterator;a.next();)(b=a.value)instanceof cy&&pg(this,b);if(this.gv(),this.layerStyle===uy){for(a=[],b=this.network.vertexes.iterator;b.next();){var e=(t=b.value).parent;null===e&&(e=t),e=0===e.angle||180===e.angle;var n=a[t.level];void 0===n&&(n=0),a[t.level]=Math.max(n,e?t.width:t.height)}for(b=0;b<a.length;b++)void 0===a[b]&&(a[b]=0);for(this.Lw=a,b=this.network.vertexes.iterator;b.next();)null===(e=(t=b.value).parent)&&(e=t),0===e.angle||180===e.angle?(180===e.angle&&(t.focusX+=a[t.level]-t.width),t.width=a[t.level]):(270===e.angle&&(t.focusY+=a[t.level]-t.height),t.height=a[t.level])}else if(this.layerStyle===ly)for(a=this.network.vertexes.iterator;a.next();){for(t=0===(b=a.value).angle||180===b.angle,e=-1,n=0;n<b.children.length;n++){var o=b.children[n];e=Math.max(e,t?o.width:o.height)}if(0<=e)for(n=0;n<b.children.length;n++)o=b.children[n],t?(180===b.angle&&(o.focusX+=e-o.width),o.width=e):(270===b.angle&&(o.focusY+=e-o.height),o.height=e)}for(a=this.Hb.iterator;a.next();)(b=a.value)instanceof cy&&this.layoutTree(b);this.arrangeTrees(),this.updateParts()}this.network=null,this.Hb=new ct,this.isValidLayout=!0},ag.prototype.findRoots=function(){for(var a=this.network.vertexes,b=a.iterator;b.next();){var t=b.value;switch(this.$c){case zg:0===t.sourceEdges.count&&this.Hb.add(t);break;case Vg:0===t.destinationEdges.count&&this.Hb.add(t);break;default:N("Unhandled path value "+this.$c.toString())}}0===this.Hb.count&&(null!==(a=lg(this,a))&&this.Hb.add(a))},ag.prototype.removeChild=function(a,b){if(null!==a&&null!==b){for(var t=a.children,e=0,n=0;n<t.length;n++)t[n]===b&&e++;if(0<e){e=Array(t.length-e);for(var o=n=0;o<t.length;o++)t[o]!==b&&(e[n++]=t[o]);a.children=e}}},ag.prototype.initializeTreeVertexValues=function(a){if(a.copyInheritedPropertiesFrom(function(a,b){switch(a.Xp){default:case iy:return null!==b.parent?b.parent:a.T;case oy:return null===b.parent?a.T:null===b.parent.parent?a.U:b.parent;case ny:return null!==b.parent?null!==b.parent.parent?b.parent.parent:a.U:a.T;case ey:var t=!0;if(0===b.childrenCount)t=!1;else for(var e=b.children,n=e.length,o=0;o<n;o++)if(0<e[o].childrenCount){t=!1;break}return t&&null!==b.parent?a.U:null!==b.parent?b.parent:a.T}}(this,a)),null!==a.parent&&a.parent.alignment===Zg){for(var b=a.angle,t=a.parent.children,e=0;e<t.length&&a!==t[e];)e++;0==e%2?e!==t.length-1&&(b=90===b?180:180===b?270:270===b?180:270):b=90===b?0:180===b?90:270===b?0:90,a.angle=b}a.initialized=!0},ag.prototype.assignTreeVertexValues=function(){},ag.prototype.sortTreeVertexChildren=function(a){switch(a.sorting){case Yg:break;case Gg:a.children.reverse();break;case Xg:a.children.sort(a.comparer);break;case qg:a.children.sort(a.comparer),a.children.reverse();break;default:N("Unhandled sorting value "+a.sorting.toString())}},ag.prototype.gv=function(){if(this.comments)for(var a=this.network.vertexes.iterator;a.next();)this.addComments(a.value)},ag.prototype.addComments=function(a){var b=a.angle,t=a.parent,e=0,n=!1;null!==t&&(e=t.angle,n=gg(n=t.alignment)),b=90===b||270===b,e=90===e||270===e,t=0===a.childrenCount;var o=0,g=0,r=0,h=a.commentSpacing;if(null!==a.node)for(var l=a.node.sv();l.next();){var c=l.value;"Comment"===c.category&&c.canLayout()&&(null===a.comments&&(a.comments=[]),a.comments.push(c),c.yb(),c=c.measuredBounds,b&&!t||!n&&!e&&t||n&&e&&t?(o=Math.max(o,c.width),g+=c.height+Math.abs(r)):(o+=c.width+Math.abs(r),g=Math.max(g,c.height)),r=h)}null!==a.comments&&(b&&!t||!n&&!e&&t||n&&e&&t?(o+=Math.abs(a.commentMargin),g=Math.max(0,g-a.height)):(g+=Math.abs(a.commentMargin),o=Math.max(0,o-a.width)),n=Wt.allocAt(0,0,a.bounds.width+o,a.bounds.height+g),a.bounds=n,Wt.free(n))},ag.prototype.layoutComments=function(a){if(null!==a.comments){var b=a.node.measuredBounds,t=a.parent,e=a.angle,n=0,o=!1;null!==t&&(n=t.angle,o=gg(o=t.alignment)),e=90===e||270===e,t=90===n||270===n;for(var g=0===a.childrenCount,r=mg(a),h=0,l=a.comments,c=l.length,f=Mt.alloc(),p=0;p<c;p++){var d=l[p],q=d.measuredBounds;if(e&&!g||!o&&!t&&g||o&&t&&g){if(135<n&&!o||t&&r)if(0<=a.commentMargin)for(f.h(a.bounds.x-a.commentMargin-q.width,a.bounds.y+h),d.move(f),d=d.wd();d.next();){var u=d.value;u.fromSpot=qi,u.toSpot=Ui}else for(f.h(a.bounds.x+2*a.focus.x-a.commentMargin,a.bounds.y+h),d.move(f),d=d.wd();d.next();)(u=d.value).fromSpot=Ui,u.toSpot=qi;else if(0<=a.commentMargin)for(f.h(a.bounds.x+2*a.focus.x+a.commentMargin,a.bounds.y+h),d.move(f),d=d.wd();d.next();)(u=d.value).fromSpot=Ui,u.toSpot=qi;else for(f.h(a.bounds.x+a.commentMargin-q.width,a.bounds.y+h),d.move(f),d=d.wd();d.next();)(u=d.value).fromSpot=qi,u.toSpot=Ui;h=0<=a.commentSpacing?h+(q.height+a.commentSpacing):h+(a.commentSpacing-q.height)}else{if(135<n&&!o||!t&&r)if(0<=a.commentMargin)for(f.h(a.bounds.x+h,a.bounds.y-a.commentMargin-q.height),d.move(f),d=d.wd();d.next();)(u=d.value).fromSpot=Xi,u.toSpot=Ki;else for(f.h(a.bounds.x+h,a.bounds.y+2*a.focus.y-a.commentMargin),d.move(f),d=d.wd();d.next();)(u=d.value).fromSpot=Ki,u.toSpot=Xi;else if(0<=a.commentMargin)for(f.h(a.bounds.x+h,a.bounds.y+2*a.focus.y+a.commentMargin),d.move(f),d=d.wd();d.next();)(u=d.value).fromSpot=Ki,u.toSpot=Xi;else for(f.h(a.bounds.x+h,a.bounds.y+a.commentMargin-q.height),d.move(f),d=d.wd();d.next();)(u=d.value).fromSpot=Xi,u.toSpot=Ki;h=0<=a.commentSpacing?h+(q.width+a.commentSpacing):h+(a.commentSpacing-q.width)}}if(Mt.free(f),b=h-a.commentSpacing-(e?b.height:b.width),this.$c===zg)for(a=a.destinationEdges;a.next();)null===(n=a.value.link)||n.isAvoiding||(n.fromEndSegmentLength=0<b?b:NaN);else for(a=a.sourceEdges;a.next();)null===(n=a.value.link)||n.isAvoiding||(n.toEndSegmentLength=0<b?b:NaN)}},ag.prototype.layoutTree=function(a){if(null!==a){for(var b=a.children,t=b.length,e=0;e<t;e++)this.layoutTree(b[e]);switch(a.compaction){case _g:vg(this,a);break;case ty:if(a.alignment===Zg)vg(this,a);else if(0===a.childrenCount)t=!1,b=0,null!==(e=a.parent)&&(b=e.angle,t=gg(t=e.alignment)),e=mg(a),a.S.h(0,0),a.ta.h(a.width,a.height),null===a.parent||null===a.comments||(180!==b&&270!==b||t)&&!e?a.da.h(0,0):180===b&&!t||(90===b||270===b)&&e?a.da.h(a.width-2*a.focus.x,0):a.da.h(0,a.height-2*a.focus.y),a.vq=null,a.Iq=null;else{var n=Bg(a);b=90===n||270===n;var o=0,g=a.children,r=g.length;for(t=0;t<r;t++)e=g[t],o=Math.max(o,b?e.ta.width:e.ta.height);var h=a.alignment,l=h===Wg,c=gg(h),f=Math.max(0,a.breadthLimit);t=Ig(a);var p=a.nodeSpacing,d=Rg(a),q=a.rowSpacing,u=0;(h===Hg||l||a.Fm||a.Gm&&1===a.maxGenerationCount)&&(u=Math.max(0,a.rowIndent)),e=a.width;var y=a.height,m=0,v=0,x=0,w=null,k=null,M=0,S=0,P=0,C=0,T=0,L=0,A=0,j=0;if(c&&!yg(h)&&135<n&&g.reverse(),yg(h))if(1<r)for(var D=0;D<r;D++)0==D%2&&D!==r-1&&(j=Math.max(j,b?g[D].ta.width:g[D].ta.height));else 1===r&&(j=b?g[0].ta.width:g[0].ta.height);if(c){switch(h){case Jg:j=(v=135>n?xg(a,g,j,m,v):bg(a,g,j,m,v)).x,m=v.width,v=v.height;break;case $g:for(w=0;w<r;w++)f=(k=g[w]).ta,x=0===L?0:q,b?(k.S.h(o-f.width,C+x),m=Math.max(m,f.width),v=Math.max(v,C+x+f.height),C+=x+f.height):(k.S.h(P+x,o-f.height),m=Math.max(m,P+x+f.width),v=Math.max(v,f.height),P+=x+f.width),L++;break;case Qg:for(w=0;w<r;w++)o=(k=g[w]).ta,f=0===L?0:q,b?(k.S.h(p/2+a.focus.x,C+f),m=Math.max(m,o.width),v=Math.max(v,C+f+o.height),C+=f+o.height):(k.S.h(P+f,p/2+a.focus.y),m=Math.max(m,P+f+o.width),v=Math.max(v,o.height),P+=f+o.width),L++}w=jg(this,2),k=jg(this,2),b?(w[0].h(0,0),w[1].h(0,v),k[0].h(m,0)):(w[0].h(0,0),w[1].h(m,0),k[0].h(0,v)),k[1].h(m,v)}else for(D=0;D<r;D++){var F=g[D],O=F.ta;if(b){0<f&&0<L&&P+p+O.width>f&&(P<o&&Ng(a,h,o-P,0,A,D-1),T++,L=0,A=D,x=v,P=0,C=135<n?-v-q:v+q),Tg(this,F,0,C);var B=0;if(0===L)w=F.vq,k=F.Iq,M=O.width,S=O.height,(null===w||null===k||n!==Bg(F))&&(w=jg(this,2),k=jg(this,2),w[0].h(0,0),w[1].h(0,S),k[0].h(M,0),k[1].h(M,S));else{var E=I();B=(S=Ag(this,a,F,w,k,M,S,E)).x,w=E[0],k=E[1],M=S.width,S=S.height,R(E),P<O.width&&0>B&&(Cg(a,-B,0,A,D-1),Lg(w,-B,0),Lg(k,-B,0),B=0)}F.S.h(B,C),m=Math.max(m,M),v=Math.max(v,x+(0===T?0:q)+O.height),P=M}else 0<f&&0<L&&C+p+O.height>f&&(C<o&&Ng(a,h,0,o-C,A,D-1),T++,L=0,A=D,x=m,C=0,P=135<n?-m-q:m+q),Tg(this,F,P,0),B=0,0===L?(w=F.vq,k=F.Iq,M=O.width,S=O.height,(null===w||null===k||n!==Bg(F))&&(w=jg(this,2),k=jg(this,2),w[0].h(0,0),w[1].h(M,0),k[0].h(0,S),k[1].h(M,S))):(B=(S=Ag(this,a,F,w,k,M,S,E=I())).x,w=E[0],k=E[1],M=S.width,S=S.height,R(E),C<O.height&&0>B&&(Cg(a,0,-B,A,D-1),Lg(w,0,-B),Lg(k,0,-B),B=0)),F.S.h(P,B),v=Math.max(v,S),m=Math.max(m,x+(0===T?0:q)+O.width),C=S;L++}switch(0<T&&(b?(v+=Math.max(0,t),P<m&&Ng(a,h,m-P,0,A,r-1),0<u&&(l||Cg(a,u,0,0,r-1),m+=u)):(m+=Math.max(0,t),C<v&&Ng(a,h,0,v-C,A,r-1),0<u&&(l||Cg(a,0,u,0,r-1),v+=u))),u=l=0,h){case Ug:b?l+=m/2-a.focus.x-d/2:u+=v/2-a.focus.y-d/2;break;case Kg:0<T?b?l+=m/2-a.focus.x-d/2:u+=v/2-a.focus.y-d/2:b?l+=(j=g[0].S.x+g[0].da.x)+(g[r-1].S.x+g[r-1].da.x+2*g[r-1].focus.x-j)/2-a.focus.x-d/2:u+=(j=g[0].S.y+g[0].da.y)+(g[r-1].S.y+g[r-1].da.y+2*g[r-1].focus.y-j)/2-a.focus.y-d/2;break;case Hg:b?(l-=d,m+=d):(u-=d,v+=d);break;case Wg:b?(l+=m-a.width+d,m+=d):(u+=v-a.height+d,v+=d);break;case Jg:b?l+=1<r?j+p/2-a.focus.x:g[0].focus.x-a.focus.x+g[0].da.x:u+=1<r?j+p/2-a.focus.y:g[0].focus.y-a.focus.y+g[0].da.y;break;case $g:b?l+=m+p/2-a.focus.x:u+=v+p/2-a.focus.y;break;case Qg:break;default:N("Unhandled alignment value "+h.toString())}for(d=0;d<r;d++)j=g[d],b?j.S.h(j.S.x+j.da.x-l,j.S.y+(135<n?(c?-v:-j.ta.height)+j.da.y-t:y+t+j.da.y)):j.S.h(j.S.x+(135<n?(c?-m:-j.ta.width)+j.da.x-t:e+t+j.da.x),j.S.y+j.da.y-u);if(r=g=0,c?b?(m=Mg(a,m,l),0>l&&(l=0),135<n&&(u+=v+t),v+=y+t,h===Qg&&(g+=p/2+a.focus.x),r+=y+t):(135<n&&(l+=m+t),m+=e+t,v=Sg(a,v,u),0>u&&(u=0),h===Qg&&(r+=p/2+a.focus.y),g+=e+t):b?(null===a.comments?e>m&&(g=(m=Pg(h,e-m,0)).x,r=m.y,m=e,l=0):m=Mg(a,m,l),0>l&&(g-=l,l=0),135<n&&(u+=v+t),v=Math.max(Math.max(v,y),v+y+t),r+=y+t):(135<n&&(l+=m+t),m=Math.max(Math.max(m,e),m+e+t),null===a.comments?y>v&&(g=(v=Pg(h,0,y-v)).x,r=v.y,v=y,u=0):v=Sg(a,v,u),0>u&&(r-=u,u=0),g+=e+t),0<T)n=jg(this,4),T=jg(this,4),b?(n[2].h(0,y+t),n[3].h(n[2].x,v),T[2].h(m,n[2].y),T[3].h(T[2].x,n[3].y)):(n[2].h(e+t,0),n[3].h(m,n[2].y),T[2].h(n[2].x,v),T[3].h(n[3].x,T[2].y));else{for(n=jg(this,w.length+2),T=jg(this,k.length+2),h=0;h<w.length;h++)c=w[h],n[h+2].h(c.x+g,c.y+r);for(h=0;h<k.length;h++)c=k[h],T[h+2].h(c.x+g,c.y+r)}b?(n[0].h(l,0),n[1].h(n[0].x,y),n[2].y<n[1].y&&(n[2].x>n[0].x?n[2].assign(n[1]):n[1].assign(n[2])),n[3].y<n[2].y&&(n[3].x>n[0].x?n[3].assign(n[2]):n[2].assign(n[3])),T[0].h(l+e,0),T[1].h(T[0].x,y),T[2].y<T[1].y&&(T[2].x<T[0].x?T[2].assign(T[1]):T[1].assign(T[2])),T[3].y<T[2].y&&(T[3].x<T[0].x?T[3].assign(T[2]):T[2].assign(T[3])),n[2].y-=t/2,T[2].y-=t/2):(n[0].h(0,u),n[1].h(e,n[0].y),n[2].x<n[1].x&&(n[2].y>n[0].y?n[2].assign(n[1]):n[1].assign(n[2])),n[3].x<n[2].x&&(n[3].y>n[0].y?n[3].assign(n[2]):n[2].assign(n[3])),T[0].h(0,u+y),T[1].h(e,T[0].y),T[2].x<T[1].x&&(T[2].y<T[0].y?T[2].assign(T[1]):T[1].assign(T[2])),T[3].x<T[2].x&&(T[3].y<T[0].y?T[3].assign(T[2]):T[2].assign(T[3])),n[2].x-=t/2,T[2].x-=t/2),Dg(this,w),Dg(this,k),a.vq=n,a.Iq=T,a.da.h(l,u),a.ta.h(m,v)}break;default:N("Unhandled compaction value "+a.compaction.toString())}}},ag.prototype.arrangeTrees=function(){if(this.Ab===ay)for(var a=this.Hb.iterator;a.next();){var b=a.value;if(b instanceof cy){var t=b.node;if(null!==t){var e=t.position;t=e.x,e=e.y,isFinite(t)||(t=0),isFinite(e)||(e=0),Fg(this,b,t,e)}}}else{for(a=[],b=this.Hb.iterator;b.next();)(t=b.value)instanceof cy&&a.push(t);switch(this.sorting){case Yg:break;case Gg:a.reverse();break;case Xg:a.sort(this.comparer);break;case qg:a.sort(this.comparer),a.reverse();break;default:N("Unhandled sorting value "+this.sorting.toString())}for(b=(t=this.arrangementOrigin).x,t=t.y,e=0;e<a.length;e++){var n=a[e];switch(Fg(this,n,b+n.da.x,t+n.da.y),this.Ab){case ry:t+=n.ta.height+this.Ad.height;break;case sy:b+=n.ta.width+this.Ad.width;break;default:N("Unhandled arrangement value "+this.Ab.toString())}}}},ag.prototype.commitLayout=function(){this.gw(),this.commitNodes(),this.iv(),this.isRouting&&this.commitLinks()},ag.prototype.commitNodes=function(){for(var a=this.network.vertexes.iterator;a.next();)a.value.commit();for(a.reset();a.next();)this.layoutComments(a.value)},ag.prototype.iv=function(){if(this.layerStyle===uy){for(var a=this.Lw,b=[],t=null,e=this.network.vertexes.iterator;e.next();){var n=e.value;null===t?t=n.bounds.copy():t.Hc(n.bounds);var o=b[n.level];o=void 0===o?Ig(n):Math.max(o,Ig(n)),b[n.level]=o}for(e=0;e<b.length;e++)void 0===b[e]&&(b[e]=0);if(90===this.angle||270===this.angle?(t.Vc(this.nodeSpacing/2,this.layerSpacing),e=new Mt(-this.nodeSpacing/2,-this.layerSpacing/2)):(t.Vc(this.layerSpacing,this.nodeSpacing/2),e=new Mt(-this.layerSpacing/2,-this.nodeSpacing/2)),n=[],t=90===this.angle||270===this.angle?t.width:t.height,o=0,180===this.angle||270===this.angle)for(var g=0;g<a.length;g++)o+=a[g]+b[g];for(g=0;g<a.length;g++){var r=a[g]+b[g];270===this.angle?(o-=r,n.push(new Wt(0,o,t,r))):90===this.angle?(n.push(new Wt(0,o,t,r)),o+=r):180===this.angle?(o-=r,n.push(new Wt(o,0,r,t))):(n.push(new Wt(o,0,r,t)),o+=r)}this.commitLayers(n,e)}},ag.prototype.commitLayers=function(){},ag.prototype.commitLinks=function(){for(var a=this.network.edges.iterator;a.next();)a.value.commit()},ag.prototype.gw=function(){for(var a=this.Hb.iterator;a.next();){var b=a.value;b instanceof cy&&Og(this,b)}},ag.prototype.setPortSpots=function(a){var b=a.alignment;if(gg(b)){var t=this.$c===zg,e=Bg(a);switch(e){case 0:var n=Ui;break;case 90:n=Ki;break;case 180:n=qi;break;default:n=Xi}var o=a.children,g=o.length;switch(b){case Jg:case Zg:for(b=0;b<g;b++){var r=o[b];if(null!==(r=(t?r.sourceEdges:r.destinationEdges).first())&&null!==(r=r.link)){var h=90===e||270===e?qi:Xi;if(1===g||b===g-1&&1==g%2)switch(e){case 0:h=qi;break;case 90:h=Xi;break;case 180:h=Ui;break;default:h=Ki}else 0==b%2&&(h=90===e||270===e?Ui:Ki);t?(a.setsPortSpot&&(r.fromSpot=n),a.setsChildPortSpot&&(r.toSpot=h)):(a.setsPortSpot&&(r.fromSpot=h),a.setsChildPortSpot&&(r.toSpot=n))}}break;case $g:for(e=90===e||270===e?Ui:Ki,o=t?a.destinationEdges:a.sourceEdges;o.next();)null!==(g=o.value.link)&&(t?(a.setsPortSpot&&(g.fromSpot=n),a.setsChildPortSpot&&(g.toSpot=e)):(a.setsPortSpot&&(g.fromSpot=e),a.setsChildPortSpot&&(g.toSpot=n)));break;case Qg:for(e=90===e||270===e?qi:Xi,o=t?a.destinationEdges:a.sourceEdges;o.next();)null!==(g=o.value.link)&&(t?(a.setsPortSpot&&(g.fromSpot=n),a.setsChildPortSpot&&(g.toSpot=e)):(a.setsPortSpot&&(g.fromSpot=e),a.setsChildPortSpot&&(g.toSpot=n)))}}else if(t=Bg(a),this.$c===zg){for(n=a.destinationEdges;n.next();)if(null!==(e=n.value.link)){if(a.setsPortSpot)if(a.portSpot.Mb())switch(t){case 0:e.fromSpot=Ui;break;case 90:e.fromSpot=Ki;break;case 180:e.fromSpot=qi;break;default:e.fromSpot=Xi}else e.fromSpot=a.portSpot;if(a.setsChildPortSpot)if(a.childPortSpot.Mb())switch(t){case 0:e.toSpot=qi;break;case 90:e.toSpot=Xi;break;case 180:e.toSpot=Ui;break;default:e.toSpot=Ki}else e.toSpot=a.childPortSpot}}else for(n=a.sourceEdges;n.next();)if(null!==(e=n.value.link)){if(a.setsPortSpot)if(a.portSpot.Mb())switch(t){case 0:e.toSpot=Ui;break;case 90:e.toSpot=Ki;break;case 180:e.toSpot=qi;break;default:e.toSpot=Xi}else e.toSpot=a.portSpot;if(a.setsChildPortSpot)if(a.childPortSpot.Mb())switch(t){case 0:e.fromSpot=qi;break;case 90:e.fromSpot=Xi;break;case 180:e.fromSpot=Ui;break;default:e.fromSpot=Ki}else e.fromSpot=a.childPortSpot}},v.Object.defineProperties(ag.prototype,{roots:{get:function(){return this.Hb},set:function(a){this.Hb!==a&&(this.Hb=a,this.C())}},path:{get:function(){return this.ap},set:function(a){this.ap!==a&&(this.ap=a,this.C())}},treeStyle:{get:function(){return this.Xp},set:function(a){this.Ab===a||a!==iy&&a!==ny&&a!==ey&&a!==oy||(this.Xp=a,this.C())}},layerStyle:{get:function(){return this.Yr},set:function(a){this.Ab===a||a!==hy&&a!==ly&&a!==uy||(this.Yr=a,this.C())}},comments:{get:function(){return this.Zc},set:function(a){this.Zc!==a&&(this.Zc=a,this.C())}},arrangement:{get:function(){return this.Ab},set:function(a){this.Ab===a||a!==ry&&a!==sy&&a!==ay||(this.Ab=a,this.C())}},arrangementSpacing:{get:function(){return this.Ad},set:function(a){this.Ad.w(a)||(this.Ad.assign(a),this.C())}},rootDefaults:{get:function(){return this.T},set:function(a){this.T!==a&&(this.T=a,this.C())}},alternateDefaults:{get:function(){return this.U},set:function(a){this.U!==a&&(this.U=a,this.C())}},sorting:{get:function(){return this.T.sorting},set:function(a){this.T.sorting===a||a!==Yg&&a!==Gg&&a!==Xg&&!qg||(this.T.sorting=a,this.C())}},comparer:{get:function(){return this.T.comparer},set:function(a){this.T.comparer!==a&&(this.T.comparer=a,this.C())}},angle:{get:function(){return this.T.angle},set:function(a){this.T.angle!==a&&(0===a||90===a||180===a||270===a?(this.T.angle=a,this.C()):N("TreeLayout.angle must be 0, 90, 180, or 270"))}},alignment:{get:function(){return this.T.alignment},set:function(a){this.T.alignment!==a&&(this.T.alignment=a,this.C())}},nodeIndent:{get:function(){return this.T.nodeIndent},set:function(a){this.T.nodeIndent!==a&&0<=a&&(this.T.nodeIndent=a,this.C())}},nodeIndentPastParent:{get:function(){return this.T.nodeIndentPastParent},set:function(a){this.T.nodeIndentPastParent!==a&&0<=a&&1>=a&&(this.T.nodeIndentPastParent=a,this.C())}},nodeSpacing:{get:function(){return this.T.nodeSpacing},set:function(a){this.T.nodeSpacing!==a&&(this.T.nodeSpacing=a,this.C())}},layerSpacing:{get:function(){return this.T.layerSpacing},set:function(a){this.T.layerSpacing!==a&&(this.T.layerSpacing=a,this.C())}},layerSpacingParentOverlap:{get:function(){return this.T.layerSpacingParentOverlap},set:function(a){this.T.layerSpacingParentOverlap!==a&&0<=a&&1>=a&&(this.T.layerSpacingParentOverlap=a,this.C())}},compaction:{get:function(){return this.T.compaction},set:function(a){this.T.compaction===a||a!==_g&&a!==ty||(this.T.compaction=a,this.C())}},breadthLimit:{get:function(){return this.T.breadthLimit},set:function(a){this.T.breadthLimit!==a&&0<=a&&(this.T.breadthLimit=a,this.C())}},rowSpacing:{get:function(){return this.T.rowSpacing},set:function(a){this.T.rowSpacing!==a&&(this.T.rowSpacing=a,this.C())}},rowIndent:{get:function(){return this.T.rowIndent},set:function(a){this.T.rowIndent!==a&&0<=a&&(this.T.rowIndent=a,this.C())}},commentSpacing:{get:function(){return this.T.commentSpacing},set:function(a){this.T.commentSpacing!==a&&(this.T.commentSpacing=a,this.C())}},commentMargin:{get:function(){return this.T.commentMargin},set:function(a){this.T.commentMargin!==a&&(this.T.commentMargin=a,this.C())}},setsPortSpot:{get:function(){return this.T.setsPortSpot},set:function(a){this.T.setsPortSpot!==a&&(this.T.setsPortSpot=a,this.C())}},portSpot:{get:function(){return this.T.portSpot},set:function(a){this.T.portSpot.w(a)||(this.T.portSpot=a,this.C())}},setsChildPortSpot:{get:function(){return this.T.setsChildPortSpot},set:function(a){this.T.setsChildPortSpot!==a&&(this.T.setsChildPortSpot=a,this.C())}},childPortSpot:{get:function(){return this.T.childPortSpot},set:function(a){this.T.childPortSpot.w(a)||(this.T.childPortSpot=a,this.C())}},alternateSorting:{get:function(){return this.U.sorting},set:function(a){this.U.sorting===a||a!==Yg&&a!==Gg&&a!==Xg&&!qg||(this.U.sorting=a,this.C())}},alternateComparer:{get:function(){return this.U.comparer},set:function(a){this.U.comparer!==a&&(this.U.comparer=a,this.C())}},alternateAngle:{get:function(){return this.U.angle},set:function(a){this.U.angle===a||0!==a&&90!==a&&180!==a&&270!==a||(this.U.angle=a,this.C())}},alternateAlignment:{get:function(){return this.U.alignment},set:function(a){this.U.alignment!==a&&(this.U.alignment=a,this.C())}},alternateNodeIndent:{get:function(){return this.U.nodeIndent},set:function(a){this.U.nodeIndent!==a&&0<=a&&(this.U.nodeIndent=a,this.C())}},alternateNodeIndentPastParent:{get:function(){return this.U.nodeIndentPastParent},set:function(a){this.U.nodeIndentPastParent!==a&&0<=a&&1>=a&&(this.U.nodeIndentPastParent=a,this.C())}},alternateNodeSpacing:{get:function(){return this.U.nodeSpacing},set:function(a){this.U.nodeSpacing!==a&&(this.U.nodeSpacing=a,this.C())}},alternateLayerSpacing:{get:function(){return this.U.layerSpacing},set:function(a){this.U.layerSpacing!==a&&(this.U.layerSpacing=a,this.C())}},alternateLayerSpacingParentOverlap:{get:function(){return this.U.layerSpacingParentOverlap},set:function(a){this.U.layerSpacingParentOverlap!==a&&0<=a&&1>=a&&(this.U.layerSpacingParentOverlap=a,this.C())}},alternateCompaction:{get:function(){return this.U.compaction},set:function(a){this.U.compaction===a||a!==_g&&a!==ty||(this.U.compaction=a,this.C())}},alternateBreadthLimit:{get:function(){return this.U.breadthLimit},set:function(a){this.U.breadthLimit!==a&&0<=a&&(this.U.breadthLimit=a,this.C())}},alternateRowSpacing:{get:function(){return this.U.rowSpacing},set:function(a){this.U.rowSpacing!==a&&(this.U.rowSpacing=a,this.C())}},alternateRowIndent:{get:function(){return this.U.rowIndent},set:function(a){this.U.rowIndent!==a&&0<=a&&(this.U.rowIndent=a,this.C())}},alternateCommentSpacing:{get:function(){return this.U.commentSpacing},set:function(a){this.U.commentSpacing!==a&&(this.U.commentSpacing=a,this.C())}},alternateCommentMargin:{get:function(){return this.U.commentMargin},set:function(a){this.U.commentMargin!==a&&(this.U.commentMargin=a,this.C())}},alternateSetsPortSpot:{get:function(){return this.U.setsPortSpot},set:function(a){this.U.setsPortSpot!==a&&(this.U.setsPortSpot=a,this.C())}},alternatePortSpot:{get:function(){return this.U.portSpot},set:function(a){this.U.portSpot.w(a)||(this.U.portSpot=a,this.C())}},alternateSetsChildPortSpot:{get:function(){return this.U.setsChildPortSpot},set:function(a){this.U.setsChildPortSpot!==a&&(this.U.setsChildPortSpot=a,this.C())}},alternateChildPortSpot:{get:function(){return this.U.childPortSpot},set:function(a){this.U.childPortSpot.w(a)||(this.U.childPortSpot=a,this.C())}}});var Eg=new _(ag,"PathDefault",-1),zg=new _(ag,"PathDestination",0),Vg=new _(ag,"PathSource",1),Yg=new _(ag,"SortingForwards",10),Gg=new _(ag,"SortingReverse",11),Xg=new _(ag,"SortingAscending",12),qg=new _(ag,"SortingDescending",13),Ug=new _(ag,"AlignmentCenterSubtrees",20),Kg=new _(ag,"AlignmentCenterChildren",21),Hg=new _(ag,"AlignmentStart",22),Wg=new _(ag,"AlignmentEnd",23),Jg=new _(ag,"AlignmentBus",24),Zg=new _(ag,"AlignmentBusBranching",25),$g=new _(ag,"AlignmentTopLeftBus",26),Qg=new _(ag,"AlignmentBottomRightBus",27),_g=new _(ag,"CompactionNone",30),ty=new _(ag,"CompactionBlock",31),iy=new _(ag,"StyleLayered",40),ey=new _(ag,"StyleLastParents",41),ny=new _(ag,"StyleAlternating",42),oy=new _(ag,"StyleRootOnly",43),ry=new _(ag,"ArrangementVertical",50),sy=new _(ag,"ArrangementHorizontal",51),ay=new _(ag,"ArrangementFixedRoots",52),hy=new _(ag,"LayerIndividual",60),ly=new _(ag,"LayerSiblings",61),uy=new _(ag,"LayerUniform",62);function dt(a){_c.call(this,a)}function cy(a){rf.call(this,a),this.Ha=!1,this.Ic=null,this.I=[],this.kd=this.Za=this.Y=this.Ia=0,this.Zc=null,this.S=new Mt(0,0),this.ta=new qt(0,0),this.da=new Mt(0,0),this.Gm=this.Fm=this.rA=!1,this.Iq=this.vq=null,this.Qc=Yg,this.Kc=sf,this.Yb=0,this.vb=Kg,this.ks=this.js=0,this.ls=20,this.ne=50,this.Xr=0,this.jr=ty,this.br=0,this.ys=25,this.ir=this.xs=10,this.hr=20,this.Ks=!0,this.us=zi,this.Js=!0,this.er=zi}function fy(a){af.call(this,a),this.Ku=new Mt(0,0)}ag.className="TreeLayout",ag.PathDefault=Eg,ag.PathDestination=zg,ag.PathSource=Vg,ag.SortingForwards=Yg,ag.SortingReverse=Gg,ag.SortingAscending=Xg,ag.SortingDescending=qg,ag.AlignmentCenterSubtrees=Ug,ag.AlignmentCenterChildren=Kg,ag.AlignmentStart=Hg,ag.AlignmentEnd=Wg,ag.AlignmentBus=Jg,ag.AlignmentBusBranching=Zg,ag.AlignmentTopLeftBus=$g,ag.AlignmentBottomRightBus=Qg,ag.CompactionNone=_g,ag.CompactionBlock=ty,ag.StyleLayered=iy,ag.StyleLastParents=ey,ag.StyleAlternating=ny,ag.StyleRootOnly=oy,ag.ArrangementVertical=ry,ag.ArrangementHorizontal=sy,ag.ArrangementFixedRoots=ay,ag.LayerIndividual=hy,ag.LayerSiblings=ly,ag.LayerUniform=uy,m(dt,_c),dt.prototype.createVertex=function(){return new cy(this)},dt.prototype.createEdge=function(){return new fy(this)},dt.className="TreeNetwork",m(cy,rf),cy.prototype.copyInheritedPropertiesFrom=function(a){null!==a&&(this.Qc=a.sorting,this.Kc=a.comparer,this.Yb=a.angle,this.vb=a.alignment,this.js=a.nodeIndent,this.ks=a.nodeIndentPastParent,this.ls=a.nodeSpacing,this.ne=a.layerSpacing,this.Xr=a.layerSpacingParentOverlap,this.jr=a.compaction,this.br=a.breadthLimit,this.ys=a.rowSpacing,this.xs=a.rowIndent,this.ir=a.commentSpacing,this.hr=a.commentMargin,this.Ks=a.setsPortSpot,this.us=a.portSpot,this.Js=a.setsChildPortSpot,this.er=a.childPortSpot)},v.Object.defineProperties(cy.prototype,{initialized:{get:function(){return this.Ha},set:function(a){this.Ha!==a&&(this.Ha=a)}},parent:{get:function(){return this.Ic},set:function(a){this.Ic!==a&&(this.Ic=a)}},children:{get:function(){return this.I},set:function(a){if(this.I!==a){if(null!==a)for(var b=a.length,t=0;t<b;t++);this.I=a}}},level:{get:function(){return this.Ia},set:function(a){this.Ia!==a&&(this.Ia=a)}},descendantCount:{get:function(){return this.Y},set:function(a){this.Y!==a&&(this.Y=a)}},maxChildrenCount:{get:function(){return this.Za},set:function(a){this.Za!==a&&(this.Za=a)}},maxGenerationCount:{get:function(){return this.kd},set:function(a){this.kd!==a&&(this.kd=a)}},comments:{get:function(){return this.Zc},set:function(a){if(this.Zc!==a){if(null!==a)for(var b=a.length,t=0;t<b;t++);this.Zc=a}}},sorting:{get:function(){return this.Qc},set:function(a){this.Qc!==a&&(this.Qc=a)}},comparer:{get:function(){return this.Kc},set:function(a){this.Kc!==a&&(this.Kc=a)}},angle:{get:function(){return this.Yb},set:function(a){this.Yb!==a&&(this.Yb=a)}},alignment:{get:function(){return this.vb},set:function(a){this.vb!==a&&(this.vb=a)}},nodeIndent:{get:function(){return this.js},set:function(a){this.js!==a&&(this.js=a)}},nodeIndentPastParent:{get:function(){return this.ks},set:function(a){this.ks!==a&&(this.ks=a)}},nodeSpacing:{get:function(){return this.ls},set:function(a){this.ls!==a&&(this.ls=a)}},layerSpacing:{get:function(){return this.ne},set:function(a){this.ne!==a&&(this.ne=a)}},layerSpacingParentOverlap:{get:function(){return this.Xr},set:function(a){this.Xr!==a&&(this.Xr=a)}},compaction:{get:function(){return this.jr},set:function(a){this.jr!==a&&(this.jr=a)}},breadthLimit:{get:function(){return this.br},set:function(a){this.br!==a&&(this.br=a)}},rowSpacing:{get:function(){return this.ys},set:function(a){this.ys!==a&&(this.ys=a)}},rowIndent:{get:function(){return this.xs},set:function(a){this.xs!==a&&(this.xs=a)}},commentSpacing:{get:function(){return this.ir},set:function(a){this.ir!==a&&(this.ir=a)}},commentMargin:{get:function(){return this.hr},set:function(a){this.hr!==a&&(this.hr=a)}},setsPortSpot:{get:function(){return this.Ks},set:function(a){this.Ks!==a&&(this.Ks=a)}},portSpot:{get:function(){return this.us},set:function(a){this.us.w(a)||(this.us=a)}},setsChildPortSpot:{get:function(){return this.Js},set:function(a){this.Js!==a&&(this.Js=a)}},childPortSpot:{get:function(){return this.er},set:function(a){this.er.w(a)||(this.er=a)}},childrenCount:{get:function(){return this.children.length}},relativePosition:{get:function(){return this.S},set:function(a){this.S.set(a)}},subtreeSize:{get:function(){return this.ta},set:function(a){this.ta.set(a)}},subtreeOffset:{get:function(){return this.da},set:function(a){this.da.set(a)}}}),cy.className="TreeVertex",m(fy,af),fy.prototype.commit=function(){var a=this.link;if(null!==a&&!a.isAvoiding){var b=this.network.layout,t=null,e=null;switch(b.$c){case zg:t=this.fromVertex,e=this.toVertex;break;case Vg:t=this.toVertex,e=this.fromVertex;break;default:N("Unhandled path value "+b.$c.toString())}if(null!==t&&null!==e)if(0!==(b=this.Ku).x||0!==b.y||t.rA){e=t.bounds;var n=Bg(t),o=Ig(t),g=t.rowSpacing;a.hj();var r,h=a.curve===vc,l=a.isOrthogonal;if(a.Nh(),l||h){for(r=2;4<a.pointsCount;)a.Yv(2);var c=a.i(1),f=a.i(2)}else{for(r=1;3<a.pointsCount;)a.Yv(1);c=a.i(0),f=a.i(a.pointsCount-1)}var p=a.i(a.pointsCount-1);0===n?(t.alignment===Wg?(n=e.bottom+b.y,0===b.y&&c.y>p.y+t.rowIndent&&(n=Math.min(n,Math.max(c.y,n-Rg(t))))):t.alignment===Hg?(n=e.top+b.y,0===b.y&&c.y<p.y-t.rowIndent&&(n=Math.max(n,Math.min(c.y,n+Rg(t))))):n=t.Fm||t.Gm&&1===t.maxGenerationCount?e.top-t.da.y+b.y:e.y+e.height/2+b.y,h?(a.m(r,c.x,n),r++,a.m(r,e.right+o,n),r++,a.m(r,e.right+o+(b.x-g)/3,n),r++,a.m(r,e.right+o+2*(b.x-g)/3,n),r++,a.m(r,e.right+o+(b.x-g),n),r++,a.m(r,f.x,n)):(l&&(a.m(r,e.right+o/2,c.y),r++),a.m(r,e.right+o/2,n),r++,a.m(r,e.right+o+b.x-(l?g/2:g),n),r++,l&&a.m(r,a.i(r-1).x,f.y))):90===n?(t.alignment===Wg?(n=e.right+b.x,0===b.x&&c.x>p.x+t.rowIndent&&(n=Math.min(n,Math.max(c.x,n-Rg(t))))):t.alignment===Hg?(n=e.left+b.x,0===b.x&&c.x<p.x-t.rowIndent&&(n=Math.max(n,Math.min(c.x,n+Rg(t))))):n=t.Fm||t.Gm&&1===t.maxGenerationCount?e.left-t.da.x+b.x:e.x+e.width/2+b.x,h?(a.m(r,n,c.y),r++,a.m(r,n,e.bottom+o),r++,a.m(r,n,e.bottom+o+(b.y-g)/3),r++,a.m(r,n,e.bottom+o+2*(b.y-g)/3),r++,a.m(r,n,e.bottom+o+(b.y-g)),r++,a.m(r,n,f.y)):(l&&(a.m(r,c.x,e.bottom+o/2),r++),a.m(r,n,e.bottom+o/2),r++,a.m(r,n,e.bottom+o+b.y-(l?g/2:g)),r++,l&&a.m(r,f.x,a.i(r-1).y))):180===n?(t.alignment===Wg?(n=e.bottom+b.y,0===b.y&&c.y>p.y+t.rowIndent&&(n=Math.min(n,Math.max(c.y,n-Rg(t))))):t.alignment===Hg?(n=e.top+b.y,0===b.y&&c.y<p.y-t.rowIndent&&(n=Math.max(n,Math.min(c.y,n+Rg(t))))):n=t.Fm||t.Gm&&1===t.maxGenerationCount?e.top-t.da.y+b.y:e.y+e.height/2+b.y,h?(a.m(r,c.x,n),r++,a.m(r,e.left-o,n),r++,a.m(r,e.left-o+(b.x+g)/3,n),r++,a.m(r,e.left-o+2*(b.x+g)/3,n),r++,a.m(r,e.left-o+(b.x+g),n),r++,a.m(r,f.x,n)):(l&&(a.m(r,e.left-o/2,c.y),r++),a.m(r,e.left-o/2,n),r++,a.m(r,e.left-o+b.x+(l?g/2:g),n),r++,l&&a.m(r,a.i(r-1).x,f.y))):270===n?(t.alignment===Wg?(n=e.right+b.x,0===b.x&&c.x>p.x+t.rowIndent&&(n=Math.min(n,Math.max(c.x,n-Rg(t))))):t.alignment===Hg?(n=e.left+b.x,0===b.x&&c.x<p.x-t.rowIndent&&(n=Math.max(n,Math.min(c.x,n+Rg(t))))):n=t.Fm||t.Gm&&1===t.maxGenerationCount?e.left-t.da.x+b.x:e.x+e.width/2+b.x,h?(a.m(r,n,c.y),r++,a.m(r,n,e.top-o),r++,a.m(r,n,e.top-o+(b.y+g)/3),r++,a.m(r,n,e.top-o+2*(b.y+g)/3),r++,a.m(r,n,e.top-o+(b.y+g)),r++,a.m(r,n,f.y)):(l&&(a.m(r,c.x,e.top-o/2),r++),a.m(r,n,e.top-o/2),r++,a.m(r,n,e.top-o+b.y+(l?g/2:g)),r++,l&&a.m(r,f.x,a.i(r-1).y))):N("Invalid angle "+n),a.sf()}else a=this.link,(o=Bg(t))!==Bg(e)&&(g=Ig(t),h=t.bounds,t=e.bounds,0===o&&t.left-h.right<g+1||90===o&&t.top-h.bottom<g+1||180===o&&h.left-t.right<g+1||270===o&&h.top-t.bottom<g+1||(a.hj(),t=a.curve===vc,b=a.isOrthogonal,e=gg(this.fromVertex.alignment),a.Nh(),0===o?(o=h.right+g/2,t?4===a.pointsCount&&(t=a.i(3).y,a.K(1,o-20,a.i(1).y),a.m(2,o-20,t),a.m(3,o,t),a.m(4,o+20,t),a.K(5,a.i(5).x,t)):b?e?a.K(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.K(2,o,a.i(2).y),a.K(3,o,a.i(3).y)):4===a.pointsCount?a.m(2,o,a.i(2).y):3===a.pointsCount?a.K(1,o,a.i(2).y):2===a.pointsCount&&a.m(1,o,a.i(1).y)):90===o?(o=h.bottom+g/2,t?4===a.pointsCount&&(t=a.i(3).x,a.K(1,a.i(1).x,o-20),a.m(2,t,o-20),a.m(3,t,o),a.m(4,t,o+20),a.K(5,t,a.i(5).y)):b?e?a.K(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.K(2,a.i(2).x,o),a.K(3,a.i(3).x,o)):4===a.pointsCount?a.m(2,a.i(2).x,o):3===a.pointsCount?a.K(1,a.i(2).x,o):2===a.pointsCount&&a.m(1,a.i(1).x,o)):180===o?(o=h.left-g/2,t?4===a.pointsCount&&(t=a.i(3).y,a.K(1,o+20,a.i(1).y),a.m(2,o+20,t),a.m(3,o,t),a.m(4,o-20,t),a.K(5,a.i(5).x,t)):b?e?a.K(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.K(2,o,a.i(2).y),a.K(3,o,a.i(3).y)):4===a.pointsCount?a.m(2,o,a.i(2).y):3===a.pointsCount?a.K(1,o,a.i(2).y):2===a.pointsCount&&a.m(1,o,a.i(1).y)):270===o&&(o=h.top-g/2,t?4===a.pointsCount&&(t=a.i(3).x,a.K(1,a.i(1).x,o+20),a.m(2,t,o+20),a.m(3,t,o),a.m(4,t,o-20),a.K(5,t,a.i(5).y)):b?e?a.K(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.K(2,a.i(2).x,o),a.K(3,a.i(3).x,o)):4===a.pointsCount?a.m(2,a.i(2).x,o):3===a.pointsCount?a.K(1,a.i(2).x,o):2===a.pointsCount&&a.m(1,a.i(1).x,o)),a.sf()))}},v.Object.defineProperties(fy.prototype,{relativePoint:{get:function(){return this.Ku},set:function(a){this.Ku.set(a)}}}),fy.className="TreeEdge",ze.prototype.initializeStandardTools=function(){this.Va("Action",new Fn,this.mouseDownTools),this.Va("Relinking",new kn,this.mouseDownTools),this.Va("LinkReshaping",new Sn,this.mouseDownTools),this.Va("Rotating",new jn,this.mouseDownTools),this.Va("Resizing",new An,this.mouseDownTools),this.Va("Linking",new vn,this.mouseMoveTools),this.Va("Dragging",new He,this.mouseMoveTools),this.Va("DragSelecting",new Bn,this.mouseMoveTools),this.Va("Panning",new In,this.mouseMoveTools),this.Va("ContextMenu",new zn,this.mouseUpTools),this.Va("TextEditing",new Hn,this.mouseUpTools),this.Va("ClickCreating",new On,this.mouseUpTools),this.Va("ClickSelecting",new Dn,this.mouseUpTools)},Jh("Horizontal",new vh),Jh("Spot",new bh),Jh("Table",new kh),Jh("Viewbox",new Ph),Jh("TableRow",new Mh),Jh("TableColumn",new Sh),Jh("Graduated",new Ah),Jh("Grid",new Nh),ds.add(br.type,Lf),ds.add(Sd.type,Ff);var dy=w.go,py={get licenseKey(){return Vo.licenseKey},set licenseKey(a){Vo.licenseKey=a},get version(){return Vo.version},Group:qu,EnumValue:_,List:lt,Set:ct,Map:kt,Point:Mt,Size:qt,Rect:Wt,Margin:hi,Spot:Zi,Geometry:oe,PathFigure:ve,PathSegment:xe,InputEvent:Te,DiagramEvent:Le,ChangedEvent:Ae,Model:Bf,GraphLinksModel:br,TreeModel:Sd,Binding:ud,Transaction:Be,UndoManager:Ie,CommandHandler:$s,Tool:Ee,DraggingTool:He,DraggingInfo:Ys,LinkingBaseTool:yn,LinkingTool:vn,RelinkingTool:kn,LinkReshapingTool:Sn,ResizingTool:An,RotatingTool:jn,ClickSelectingTool:Dn,ActionTool:Fn,ClickCreatingTool:On,HTMLInfo:Rn,ContextMenuTool:zn,DragSelectingTool:Bn,PanningTool:In,TextEditingTool:Hn,ToolManager:ze,Animation:Po,AnimationManager:lo,AnimationTrigger:Oo,Layer:Eo,Diagram:Vo,Palette:qs,Overview:Ks,Brush:Ya,GraphObject:_s,Panel:jh,RowColumnDefinition:_h,Shape:rl,TextBlock:ml,TextBlockMetrics:Xl,Picture:ql,Part:lu,Adornment:Lu,Node:Au,Link:Wu,Placeholder:Hu,Layout:Zc,LayoutNetwork:_c,LayoutVertex:rf,LayoutEdge:af,GridLayout:hf,PanelLayout:yh,CircularLayout:Pd,CircularNetwork:Jd,CircularVertex:Zd,CircularEdge:Qd,ForceDirectedLayout:_d,ForceDirectedNetwork:hp,ForceDirectedVertex:lp,ForceDirectedEdge:up,LayeredDigraphLayout:fp,LayeredDigraphNetwork:og,LayeredDigraphVertex:rg,LayeredDigraphEdge:sg,TreeLayout:ag,TreeNetwork:dt,TreeVertex:cy,TreeEdge:fy};dy&&dy.version!==py.version&&N("WARNING: a `go` object on the root object is already defined with a version mismatch."+dy.version+". Replaced with version: "+py.version),w.go=py,(void 0===w||void 0===w.module||"object"!=typeof w.module.exports)&&w.define&&"function"==typeof w.define&&w.define.amd&&w.define(py),"object"==typeof t.exports&&(t.exports=void 0!==e?e.go:self.go)}()}).call(this,n(65))}}]);